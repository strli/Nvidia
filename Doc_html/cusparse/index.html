<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="copyright" content="(C) Copyright 2005"></meta>
      <meta name="DC.rights.owner" content="(C) Copyright 2005"></meta>
      <meta name="DC.Type" content="concept"></meta>
      <meta name="DC.Title" content="cuSPARSE"></meta>
      <meta name="abstract" content="The API reference guide for cuSPARSE, the CUDA sparse matrix library."></meta>
      <meta name="description" content="The API reference guide for cuSPARSE, the CUDA sparse matrix library."></meta>
      <meta name="DC.Coverage" content="CUDA API References"></meta>
      <meta name="DC.subject" content="CUDA cuSPARSE, CUDA cuSPARSE asynchronous execution, CUDA cuSPARSE index format, CUDA cuSPARSE vector format, CUDA cuSPARSE matrix format, CUDA cuSPARSE type, CUDA cuSPARSE helper function, CUDA cuSPARSE format conversion, CUDA cuSPARSE preconditioners, CUDA cuSPARSE level function"></meta>
      <meta name="keywords" content="CUDA cuSPARSE, CUDA cuSPARSE asynchronous execution, CUDA cuSPARSE index format, CUDA cuSPARSE vector format, CUDA cuSPARSE matrix format, CUDA cuSPARSE type, CUDA cuSPARSE helper function, CUDA cuSPARSE format conversion, CUDA cuSPARSE preconditioners, CUDA cuSPARSE level function"></meta>
      <meta name="DC.Format" content="XHTML"></meta>
      <meta name="DC.Identifier" content="abstract"></meta>
      <link rel="stylesheet" type="text/css" href="../common/formatting/commonltr.css"></link>
      <link rel="stylesheet" type="text/css" href="../common/formatting/site.css"></link>
      <title>cuSPARSE :: CUDA Toolkit Documentation</title>
      <!--[if lt IE 9]>
      <script src="../common/formatting/html5shiv-printshiv.min.js"></script>
      <![endif]-->
      <script type="text/javascript" charset="utf-8" src="//assets.adobedtm.com/b92787824f2e0e9b68dc2e993f9bd995339fe417/satelliteLib-7ba51e58dc61bcb0e9311aadd02a0108ab24cc6c.js"></script>
      <script type="text/javascript" charset="utf-8" src="../common/formatting/jquery.min.js"></script>
      <script type="text/javascript" charset="utf-8" src="../common/formatting/jquery.ba-hashchange.min.js"></script>
      <script type="text/javascript" charset="utf-8" src="../common/formatting/jquery.scrollintoview.min.js"></script>
      <script type="text/javascript" src="../search/htmlFileList.js"></script>
      <script type="text/javascript" src="../search/htmlFileInfoList.js"></script>
      <script type="text/javascript" src="../search/nwSearchFnt.min.js"></script>
      <script type="text/javascript" src="../search/stemmers/en_stemmer.min.js"></script>
      <script type="text/javascript" src="../search/index-1.js"></script>
      <script type="text/javascript" src="../search/index-2.js"></script>
      <script type="text/javascript" src="../search/index-3.js"></script>
      <link rel="canonical" href="http://docs.nvidia.com/cuda/cusparse/index.html"></link>
      <link rel="stylesheet" type="text/css" href="../common/formatting/qwcode.highlight.css"></link>
   </head>
   <body>
      
      <header id="header"><span id="company">NVIDIA</span><span id="site-title">CUDA Toolkit Documentation</span><form id="search" method="get" action="search">
            <input type="text" name="search-text"></input><fieldset id="search-location">
               <legend>Search In:</legend>
               <label><input type="radio" name="search-type" value="site"></input>Entire Site</label>
               <label><input type="radio" name="search-type" value="document"></input>Just This Document</label></fieldset>
            <button type="reset">clear search</button>
            <button id="submit" type="submit">search</button></form>
      </header>
      <div id="site-content">
         <nav id="site-nav">
            <div class="category closed"><a href="../index.html" title="The root of the site.">CUDA Toolkit 
                  
                  
                  v10.1.168</a></div>
            <div class="category"><a href="index.html" title="cuSPARSE">cuSPARSE</a></div>
            <ul>
               <li>
                  <div class="section-link"><a href="#introduction">1.&nbsp;Introduction</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#naming-convention">1.1.&nbsp;Naming Conventions</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#asynchronous-execution">1.2.&nbsp;Asynchronous Execution</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#static-library">1.3.&nbsp;Static Library support</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#using-the-cusparse-api">2.&nbsp;Using the cuSPARSE API</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#thread-safety">2.1.&nbsp;Thread Safety</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#scalar-parameters2">2.2.&nbsp;Scalar Parameters</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#parallelism-with-streams">2.3.&nbsp;Parallelism with Streams</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusparse-indexing-and-data-formats">3.&nbsp;cuSPARSE Indexing and Data Formats</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#index-base-format">3.1.&nbsp;Index Base Format</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#vector-formats">3.2.&nbsp;Vector Formats</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#dense-format">3.2.1.&nbsp;Dense Format</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#sparse-format">3.2.2.&nbsp;Sparse Format</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#matrix-formats">3.3.&nbsp;Matrix Formats</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#dense-format2">3.3.1.&nbsp;Dense Format</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#coordinate-format-coo">3.3.2.&nbsp;Coordinate Format (COO)</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#compressed-sparse-row-format-csr">3.3.3.&nbsp;Compressed Sparse Row Format (CSR)</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#compressed-sparse-column-format-csc">3.3.4.&nbsp;Compressed Sparse Column Format (CSC)</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#ellpack-itpack-format-ell">3.3.5.&nbsp;Ellpack-Itpack Format (ELL)</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#hybrid-format-hyb">3.3.6.&nbsp;Hybrid Format (HYB)</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#block-compressed-sparse-row-format-bsr">3.3.7.&nbsp;Block Compressed Sparse Row Format (BSR)</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#extended-bsr-format-bsrx">3.3.8.&nbsp;Extended BSR Format (BSRX)</a></div>
                           </li>
                        </ul>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusparse-types-reference">4.&nbsp;cuSPARSE Types Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#data-types">4.1.&nbsp;Data types</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparseactiont">4.2.&nbsp;cusparseAction_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedirectiont">4.3.&nbsp;cusparseDirection_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsehandlet">4.4.&nbsp;cusparseHandle_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsehybmatt">4.5.&nbsp;cusparseHybMat_t</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusparsehybpartitiont">4.5.1.&nbsp;cusparseHybPartition_t</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsematdescrt">4.6.&nbsp;cusparseMatDescr_t</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusparsediagtypet">4.6.1.&nbsp;cusparseDiagType_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparsefillmodet">4.6.2.&nbsp;cusparseFillMode_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparseindexbaset">4.6.3.&nbsp;cusparseIndexBase_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparsematrixtypet">4.6.4.&nbsp;cusparseMatrixType_t</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparseoperationt">4.7.&nbsp;cusparseOperation_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsepointermode_t">4.8.&nbsp;cusparsePointerMode_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsealgmode_t">4.9.&nbsp;cusparseAlgMode_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsesolvepolicy_t">4.10.&nbsp;cusparseSolvePolicy_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsesolveanalysisinfot">4.11.&nbsp;cusparseSolveAnalysisInfo_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#unique_1799085396">4.12.&nbsp;cusparseSolveAnalysisInfo_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#csrsv2infot">4.13.&nbsp;csrsv2Info_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#csrsm2infot">4.14.&nbsp;csrsm2Info_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#csric02infot">4.15.&nbsp;csric02Info_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#csrilu02infot">4.16.&nbsp;csrilu02Info_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#bsrsv2infot">4.17.&nbsp;bsrsv2Info_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#bsrsvminfot">4.18.&nbsp;bsrsm2Info_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#bsric02infot">4.19.&nbsp;bsric02Info_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#bsrilu02infot">4.20.&nbsp;bsrilu02Info_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#csrgemm2infot">4.21.&nbsp;csrgemm2Info_t</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsestatust">4.22.&nbsp;cusparseStatus_t</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusparse-helper-function-reference">5.&nbsp;cuSPARSE Helper Function Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cusparsecreate">5.1.&nbsp;cusparseCreate()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreatesolveanalysisinfo">5.2.&nbsp;cusparseCreateSolveAnalysisInfo()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreatehybmat">5.3.&nbsp;cusparseCreateHybMat()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreatematdescr">5.4.&nbsp;cusparseCreateMatDescr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#unique_1860986088">5.5.&nbsp;cusparseCreateSolveAnalysisInfo()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroy">5.6.&nbsp;cusparseDestroy()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroysolveanalysisinfo">5.7.&nbsp;cusparseDestroySolveAnalysisInfo()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroyhybmat">5.8.&nbsp;cusparseDestroyHybMat()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroymatdescr">5.9.&nbsp;cusparseDestroyMatDescr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#unique_1747662931">5.10.&nbsp;cusparseDestroySolveAnalysisInfo()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsegetlevelinfo">5.11.&nbsp;cusparseGetLevelInfo()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsegetmatdiagtype">5.12.&nbsp;cusparseGetMatDiagType()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsegetmatfillmode">5.13.&nbsp;cusparseGetMatFillMode()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsegetmatindexbase">5.14.&nbsp;cusparseGetMatIndexBase()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsegetmattype">5.15.&nbsp;cusparseGetMatType()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsegetpointermode">5.16.&nbsp;cusparseGetPointerMode()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsegetversion">5.17.&nbsp;cusparseGetVersion()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsesetmatdiagtype">5.18.&nbsp;cusparseSetMatDiagType()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsesetmatfillmode">5.19.&nbsp;cusparseSetMatFillMode()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsesetmatindexbase">5.20.&nbsp;cusparseSetMatIndexBase()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsesetmattype">5.21.&nbsp;cusparseSetMatType()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsesetpointermode">5.22.&nbsp;cusparseSetPointerMode()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsesetstream">5.23.&nbsp;cusparseSetStream()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsegetstream">5.24.&nbsp;cusparseGetStream()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreateCsrsv2info">5.25.&nbsp;cusparseCreateCsrsv2Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroyCsrsv2info">5.26.&nbsp;cusparseDestroyCsrsv2Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreateCsrsm2info">5.27.&nbsp;cusparseCreateCsrsm2Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroyCsrsm2info">5.28.&nbsp;cusparseDestroyCsrsm2Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreateCsric02info">5.29.&nbsp;cusparseCreateCsric02Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroyCsric02info">5.30.&nbsp;cusparseDestroyCsric02Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreateCsrilu02info">5.31.&nbsp;cusparseCreateCsrilu02Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroyCsrilu02info">5.32.&nbsp;cusparseDestroyCsrilu02Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreateBsrsv2info">5.33.&nbsp;cusparseCreateBsrsv2Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroyBsrsv2info">5.34.&nbsp;cusparseDestroyBsrsv2Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreateBsrsm2info">5.35.&nbsp;cusparseCreateBsrsm2Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroyBsrsm2info">5.36.&nbsp;cusparseDestroyBsrsm2Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreateBsric02info">5.37.&nbsp;cusparseCreateBsric02Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroyBsric02info">5.38.&nbsp;cusparseDestroyBsric02Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreateBsrilu02info">5.39.&nbsp;cusparseCreateBsrilu02Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroyBsrilu02info">5.40.&nbsp;cusparseDestroyBsrilu02Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreateCsrgemm2info">5.41.&nbsp;cusparseCreateCsrgemm2Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroyCsrgemm2info">5.42.&nbsp;cusparseDestroyCsrgemm2Info()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsecreatePruneinfo">5.43.&nbsp;cusparseCreatePruneInfo()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparsedestroyPruneinfo">5.44.&nbsp;cusparseDestroyPruneInfo()</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusparse-level-1-function-reference">6.&nbsp;cuSPARSE Level 1 Function Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-axpyi">6.1.&nbsp;cusparse&lt;t&gt;axpyi()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-doti">6.2.&nbsp;cusparse&lt;t&gt;doti()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-dotci">6.3.&nbsp;cusparse&lt;t&gt;dotci()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-gthr">6.4.&nbsp;cusparse&lt;t&gt;gthr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-gthrz">6.5.&nbsp;cusparse&lt;t&gt;gthrz()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-roti">6.6.&nbsp;cusparse&lt;t&gt;roti()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-sctr">6.7.&nbsp;cusparse&lt;t&gt;sctr()</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusparse-level-2-function-reference">7.&nbsp;cuSPARSE Level 2 Function Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-bsrmv">7.1.&nbsp;cusparse&lt;t&gt;bsrmv()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-bsrxmv">7.2.&nbsp;cusparse&lt;t&gt;bsrxmv()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrmv">7.3.&nbsp;cusparse&lt;t&gt;csrmv()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-csrmvEx">7.4.&nbsp;cusparseCsrmvEx()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#unique_1245988031">7.5.&nbsp;cusparseCsrmvEx_bufferSize()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrmv_mergepath">7.6.&nbsp;cusparse&lt;t&gt;csrmv_mp()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-gemvi">7.7.&nbsp;cusparse&lt;t&gt;gemvi()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-gemvi_bufferSize">7.8.&nbsp;cusparse&lt;t&gt;gemvi_bufferSize()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-bsrsv2_bufferSize">7.9.&nbsp;cusparse&lt;t&gt;bsrsv2_bufferSize()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-bsrsv2_analysis">7.10.&nbsp;cusparse&lt;t&gt;bsrsv2_analysis()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-bsrsv2_solve">7.11.&nbsp;cusparse&lt;t&gt;bsrsv2_solve()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-bsrsv2_zeroPivot">7.12.&nbsp;cusparseXbsrsv2_zeroPivot()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsvanalysis">7.13.&nbsp;cusparse&lt;t&gt;csrsv_analysis()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-csrsvanalysisEx">7.14.&nbsp;cusparseCsrsv_analysisEx()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsvsolve">7.15.&nbsp;cusparse&lt;t&gt;csrsv_solve()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-csrsvsolveEx">7.16.&nbsp;cusparseCsrsv_solveEx()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsv2_bufferSize">7.17.&nbsp;cusparse&lt;t&gt;csrsv2_bufferSize()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsv2_analysis">7.18.&nbsp;cusparse&lt;t&gt;csrsv2_analysis()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsv2_solve">7.19.&nbsp;cusparse&lt;t&gt;csrsv2_solve()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsv2_zeroPivot">7.20.&nbsp;cusparseXcsrsv2_zeroPivot()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-hybmv">7.21.&nbsp;cusparse&lt;t&gt;hybmv()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-hybsvanalysis">7.22.&nbsp;cusparse&lt;t&gt;hybsv_analysis()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-hybsvsolve">7.23.&nbsp;cusparse&lt;t&gt;hybsv_solve()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-csr2cscEx2">7.24.&nbsp;cusparseCsr2cscEx2()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-csr2cscEx2_bufferSize">7.25.&nbsp;cusparseCsr2cscEx2_bufferSize()</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusparse-level-3-function-reference">8.&nbsp;cuSPARSE Level 3 Function Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrmm">8.1.&nbsp;cusparse&lt;t&gt;csrmm()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrmm2">8.2.&nbsp;cusparse&lt;t&gt;csrmm2()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsmanalysis">8.3.&nbsp;cusparse&lt;t&gt;csrsm_analysis()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsmsolve">8.4.&nbsp;cusparse&lt;t&gt;csrsm_solve()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsm2_bufferSize">8.5.&nbsp;cusparse&lt;t&gt;csrsm2_bufferSizeExt()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsm2_analysis">8.6.&nbsp;cusparse&lt;t&gt;csrsm2_analysis()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsm2_solve">8.7.&nbsp;cusparse&lt;t&gt;csrsm2_solve()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsm2_zeroPivot">8.8.&nbsp;cusparseXcsrsm2_zeroPivot()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-bsrmm">8.9.&nbsp;cusparse&lt;t&gt;bsrmm()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-bsrsm2_bufferSize">8.10.&nbsp;cusparse&lt;t&gt;bsrsm2_bufferSize()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-bsrsm2_analysis">8.11.&nbsp;cusparse&lt;t&gt;bsrsm2_analysis()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-bsrsm2_solve">8.12.&nbsp;cusparse&lt;t&gt;bsrsm2_solve()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-bsrsm2_zeroPivot">8.13.&nbsp;cusparseXbsrsm2_zeroPivot()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-gemmi">8.14.&nbsp;cusparse&lt;t&gt;gemmi()</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusparse-extra-function-reference">9.&nbsp;cuSPARSE Extra Function Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrgeam">9.1.&nbsp;cusparse&lt;t&gt;csrgeam()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrgeam2">9.2.&nbsp;cusparse&lt;t&gt;csrgeam2()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrgemm">9.3.&nbsp;cusparse&lt;t&gt;csrgemm()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrgemm2">9.4.&nbsp;cusparse&lt;t&gt;csrgemm2()</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusparse-preconditioners-reference">10.&nbsp;cuSPARSE Preconditioners Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#ic0">10.1.&nbsp;Incomplete Cholesky Factorization: level 0</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-csric0">10.1.1.&nbsp;cusparse&lt;t&gt;csric0()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-csric02_bufferSize">10.1.2.&nbsp;cusparse&lt;t&gt;csric02_bufferSize()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-csric02_analysis">10.1.3.&nbsp;cusparse&lt;t&gt;csric02_analysis()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-csric02">10.1.4.&nbsp;cusparse&lt;t&gt;csric02()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-csric02_zeroPivot">10.1.5.&nbsp;cusparseXcsric02_zeroPivot()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-bsric02_bufferSize">10.1.6.&nbsp;cusparse&lt;t&gt;bsric02_bufferSize()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-bsric02_analysis">10.1.7.&nbsp;cusparse&lt;t&gt;bsric02_analysis()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-bsric02">10.1.8.&nbsp;cusparse&lt;t&gt;bsric02()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-bsric02_zeroPivot">10.1.9.&nbsp;cusparseXbsric02_zeroPivot()</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#ilu0">10.2.&nbsp;Incomplete LU Factorization: level 0</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-csrilu0">10.2.1.&nbsp;cusparse&lt;t&gt;csrilu0()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-csrilu0Ex">10.2.2.&nbsp;cusparseCsrilu0Ex()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-csrilu02_numericBoost">10.2.3.&nbsp;cusparse&lt;t&gt;csrilu02_numericBoost()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-csrilu02_bufferSize">10.2.4.&nbsp;cusparse&lt;t&gt;csrilu02_bufferSize()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-csrilu02_analysis">10.2.5.&nbsp;cusparse&lt;t&gt;csrilu02_analysis()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-csrilu02_solve">10.2.6.&nbsp;cusparse&lt;t&gt;csrilu02()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-csrilu02_zeroPivot">10.2.7.&nbsp;cusparseXcsrilu02_zeroPivot()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-bsrilu02_numericBoost">10.2.8.&nbsp;cusparse&lt;t&gt;bsrilu02_numericBoost()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-bsrilu02_bufferSize">10.2.9.&nbsp;cusparse&lt;t&gt;bsrilu02_bufferSize()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-bsrilu02_analysis">10.2.10.&nbsp;cusparse&lt;t&gt;bsrilu02_analysis()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-bsrilu02">10.2.11.&nbsp;cusparse&lt;t&gt;bsrilu02()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-bsrilu02_zeroPivot">10.2.12.&nbsp;cusparseXbsrilu02_zeroPivot()</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#gtsv">10.3.&nbsp;tridiagonal solve</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-gtsv">10.3.1.&nbsp;cusparse&lt;t&gt;gtsv()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-gtsv_nopivot">10.3.2.&nbsp;cusparse&lt;t&gt;gtsv_nopivot()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-gtsv2_bufferSize">10.3.3.&nbsp;cusparse&lt;t&gt;gtsv2_buffSizeExt()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-gtsv2">10.3.4.&nbsp;cusparse&lt;t&gt;gtsv2()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-gtsv2_nopivot_bufferSize">10.3.5.&nbsp;cusparse&lt;t&gt;gtsv2_nopivot_bufferSizeExt()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-gtsv2_nopivot">10.3.6.&nbsp;cusparse&lt;t&gt;gtsv2_nopivot()</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#batch_gtsv">10.4.&nbsp;batched tridiagonal solve</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-gtsvstridedbatch">10.4.1.&nbsp;cusparse&lt;t&gt;gtsvStridedBatch()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-gtsv2stridedbatch_bufferSize">10.4.2.&nbsp;cusparse&lt;t&gt;gtsv2StridedBatch_bufferSizeExt()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-gtsv2stridedbatch">10.4.3.&nbsp;cusparse&lt;t&gt;gtsv2StridedBatch()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-gtsvInterleavedBatch">10.4.4.&nbsp;cusparse&lt;t&gt;gtsvInterleavedBatch()</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#batch_gpsv">10.5.&nbsp;batched pentadiagonal solve</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusparse-lt-t-gt-gpsvInterleavedBatch">10.5.1.&nbsp;cusparse&lt;t&gt;gpsvInterleavedBatch()</a></div>
                           </li>
                        </ul>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusparse-reorderings-reference">11.&nbsp;cuSPARSE Reorderings Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrcolor">11.1.&nbsp;cusparse&lt;t&gt;csrcolor()</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusparse-format-conversion-reference">12.&nbsp;cuSPARSE Format Conversion Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-bsr2csr">12.1.&nbsp;cusparse&lt;t&gt;bsr2csr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-gebsr2gebsc_bufferSize">12.2.&nbsp;cusparse&lt;t&gt;gebsr2gebsc_bufferSize()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-gebsr2gebsc">12.3.&nbsp;cusparse&lt;t&gt;gebsr2gebsc()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-gebsr2gebsr_bufferSize">12.4.&nbsp;cusparse&lt;t&gt;gebsr2gebsr_bufferSize()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-gebsr2gebsr">12.5.&nbsp;cusparse&lt;t&gt;gebsr2gebsr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-gebsr2csr">12.6.&nbsp;cusparse&lt;t&gt;gebsr2csr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csr2gebsr_bufferSize">12.7.&nbsp;cusparse&lt;t&gt;csr2gebsr_bufferSize()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csr2gebsr">12.8.&nbsp;cusparse&lt;t&gt;csr2gebsr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-coo2csr">12.9.&nbsp;cusparse&lt;t&gt;coo2csr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csc2dense">12.10.&nbsp;cusparse&lt;t&gt;csc2dense()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csc2hyb">12.11.&nbsp;cusparse&lt;t&gt;csc2hyb()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csr2bsr">12.12.&nbsp;cusparse&lt;t&gt;csr2bsr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csr2coo">12.13.&nbsp;cusparse&lt;t&gt;csr2coo()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csr2csc">12.14.&nbsp;cusparse&lt;t&gt;csr2csc()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-csr2cscEx">12.15.&nbsp;cusparseCsr2cscEx()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csr2dense">12.16.&nbsp;cusparse&lt;t&gt;csr2dense()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csr2csr_compress">12.17.&nbsp;cusparse&lt;t&gt;csr2csr_compress()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csr2hyb">12.18.&nbsp;cusparse&lt;t&gt;csr2hyb()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-dense2csc">12.19.&nbsp;cusparse&lt;t&gt;dense2csc()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-dense2csr">12.20.&nbsp;cusparse&lt;t&gt;dense2csr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-dense2hyb">12.21.&nbsp;cusparse&lt;t&gt;dense2hyb()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-hyb2csc">12.22.&nbsp;cusparse&lt;t&gt;hyb2csc()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-hyb2csr">12.23.&nbsp;cusparse&lt;t&gt;hyb2csr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-hyb2dense">12.24.&nbsp;cusparse&lt;t&gt;hyb2dense()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-nnz">12.25.&nbsp;cusparse&lt;t&gt;nnz()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-identity">12.26.&nbsp;cusparseCreateIdentityPermutation()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-coosort">12.27.&nbsp;cusparseXcoosort()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csrsort">12.28.&nbsp;cusparseXcsrsort()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-cscsort">12.29.&nbsp;cusparseXcscsort()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-csru2csr">12.30.&nbsp;cusparseXcsru2csr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-pruneDense2csr">12.31.&nbsp;cusparseXpruneDense2csr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-pruneCsr2csr">12.32.&nbsp;cusparseXpruneCsr2csr()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-pruneDense2csrByP">12.33.&nbsp;cusparseXpruneDense2csrPercentage()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-pruneCsr2csrByP">12.34.&nbsp;cusparseXpruneCsr2csrByPercentage()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-lt-t-gt-nnz_compress">12.35.&nbsp;cusparse&lt;t&gt;nnz_compress()</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusparse-generic-api-reference">13.&nbsp;cuSPARSE Generic API Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cusparse-generic-sparse-type-ref">13.1.&nbsp;Generic Types Reference</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-enum-data-types">13.1.1.&nbsp;cudaDataType_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-enum-formats">13.1.2.&nbsp;cusparseFormat_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-enum-layout">13.1.3.&nbsp;cusparseOrder_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-enum-alg">13.1.4.&nbsp;cusparseSpMMAlg_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-enum-index">13.1.5.&nbsp;cusparseIndexType_t</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-generic-sparse-ref">13.2.&nbsp;Generic Sparse API helper functions</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-sparse-create-coo">13.2.1.&nbsp;cusparseCreateCoo()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-sparse-destroy">13.2.2.&nbsp;cusparseDestroySpMat()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-sparse-get-batches">13.2.3.&nbsp;cusparseSpMatGetNumBatches()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-sparse-get-coo">13.2.4.&nbsp;cusparseCooGet()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-sparse-get-format">13.2.5.&nbsp;cusparseCooGet()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-sparse-get-index-base">13.2.6.&nbsp;cusparseSpMatGetIndexBase()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-sparse-set-batches">13.2.7.&nbsp;cusparseSpMatSetNumBatches()</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-generic-dense-ref">13.3.&nbsp;Generic Dense API helper functions</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-dense-create">13.3.1.&nbsp;cusparseCreateDnMat()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-dense-destro">13.3.2.&nbsp;cusparseDestroyDnMat()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-dense-get">13.3.3.&nbsp;cusparseDnMatGet()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-dense-get-batches">13.3.4.&nbsp;cusparseDnMatGetStridedBatch()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-dense-set-batches">13.3.5.&nbsp;cusparseDnMatSetNumBatches()</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusparse-generic-function-ref">13.4.&nbsp;Generic SpMM API functions</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-function-spmm">13.4.1.&nbsp;cusparseSpMM()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparse-generic-function-spmm-buffer">13.4.2.&nbsp;cusparseSpMM_bufferSize()</a></div>
                           </li>
                        </ul>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#appendix-b-cusparse-library-c---example">14.&nbsp;Appendix A: cuSPARSE Library C++ Example</a></div>
               </li>
               <li>
                  <div class="section-link"><a href="#appendix-c-cusparse-fortran-bindings">15.&nbsp;Appendix B: cuSPARSE Fortran Bindings</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#example-b">15.1.&nbsp;Example B, Fortran Application</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#csrmv_examples">16.&nbsp;Appendix C: Examples of sparse matrix vector multiplication</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#csrmvmp-example1">16.1.&nbsp;power method</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#coosort_examples">17.&nbsp;Appendix D: Examples of sorting</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#coosort-example1">17.1.&nbsp;COO sort</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#prune_examples">18.&nbsp;Appendix E: Examples of prune</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#prune-example1">18.1.&nbsp;prune dense to sparse</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#prune-example2">18.2.&nbsp;prune sparse to sparse</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#prune-example3">18.3.&nbsp;prune dense to sparse by percentage</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#prune-example4">18.4.&nbsp;prune sparse to sparse by percentage</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#gtsv_examples">19.&nbsp;Appendix F: Examples of gtsv</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#gtsv-example1">19.1.&nbsp;batched tridiagonal solver</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#gpsv_examples">20.&nbsp;Appendix G: Examples of gpsv</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#gpsv-example1">20.1.&nbsp;batched penta-diagonal solver</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#csrsm2_examples">21.&nbsp;Appendix H: Examples of csrsm2</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#csrsm2-example1">21.1.&nbsp;forward triangular solver</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#appendix-acknowledgements">22.&nbsp;Appendix I: Acknowledgements</a></div>
               </li>
               <li>
                  <div class="section-link"><a href="#bibliography">23.&nbsp;Bibliography</a></div>
               </li>
            </ul>
         </nav>
         <div id="resize-nav"></div>
         <nav id="search-results">
            <h2>Search Results</h2>
            <ol></ol>
         </nav>
         
         <div id="contents-container">
            <div id="breadcrumbs-container">
               <div id="eqn-warning">This document includes math equations
                  (highlighted in red) which are best viewed with <a target="_blank" href="https://www.mozilla.org/firefox">Firefox</a> version 4.0
                  or higher, or another <a target="_blank" href="http://www.w3.org/Math/Software/mathml_software_cat_browsers.html">MathML-aware
                     browser</a>. There is also a <a href="../../pdf/CUSPARSE_Library.pdf">PDF version of this document</a>.
                  
               </div>
               <div id="release-info">cuSPARSE
                  (<a href="../../pdf/CUSPARSE_Library.pdf">PDF</a>)
                  -
                   
                  
                  
                  v10.1.168
                  (<a href="https://developer.nvidia.com/cuda-toolkit-archive">older</a>)
                  -
                  Last updated April 24, 2019
                  -
                  <a href="mailto:CUDAIssues@nvidia.com?subject=CUDA Toolkit Documentation Feedback: cuSPARSE">Send Feedback</a></div>
            </div>
            <article id="contents">
               <div class="topic nested0" id="abstract"><a name="abstract" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#abstract" name="abstract" shape="rect">cuSPARSE</a></h2>
                  <div class="body conbody">
                     <p class="shortdesc">The API reference guide for cuSPARSE, the CUDA sparse matrix library.</p>
                  </div>
               </div>
               <div class="topic concept nested0" id="introduction"><a name="introduction" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#introduction" name="introduction" shape="rect">1.&nbsp;Introduction</a></h2>
                  <div class="body conbody">
                     <p class="p">The cuSPARSE library contains a set of basic linear algebra subroutines used for handling sparse
                        matrices. It is implemented on top of the NVIDIA® CUDA™ runtime (which is part of the
                        CUDA Toolkit) and is designed to be called from C and C++. The library routines can be classified
                        into four categories:
                     </p>
                     <div class="p"><a name="introduction__ul_wnl_2dp_sg" shape="rect">
                           <!-- --></a><ul class="ul" id="introduction__ul_wnl_2dp_sg">
                           <li class="li">Level 1: operations between a vector in sparse format and a vector in dense format</li>
                           <li class="li">Level 2: operations between a matrix in sparse format and a vector in dense format</li>
                           <li class="li">Level 3: operations between a matrix in sparse format and a set of vectors in dense format
                              (which can also usually be viewed as a dense tall matrix)
                           </li>
                           <li class="li">Conversion: operations that allow conversion between different matrix formats, and compression of csr matrices.</li>
                        </ul>
                     </div>
                     <p class="p">The cuSPARSE library allows developers to access the computational resources of the NVIDIA
                        graphics processing unit (GPU), although it does not auto-parallelize across multiple GPUs. The
                        cuSPARSE API assumes that input and output data reside in GPU (device) memory, unless it is
                        explicitly indicated otherwise by the string <samp class="ph codeph">DevHostPtr</samp> in a function parameter's
                        name (for example, the parameter <samp class="ph codeph">*resultDevHostPtr</samp> in the function
                        <samp class="ph codeph">cusparse&lt;t&gt;doti()</samp>).
                     </p>
                     <p class="p">It is the responsibility of the developer to allocate memory and to copy data between GPU memory
                        and CPU memory using standard CUDA runtime API routines, such as <samp class="ph codeph">cudaMalloc()</samp>,
                        <samp class="ph codeph">cudaFree()</samp>, <samp class="ph codeph">cudaMemcpy()</samp>, and
                        <samp class="ph codeph">cudaMemcpyAsync()</samp>.
                     </p>
                     <div class="p">
                        <div class="note note"><span class="notetitle">Note:</span> The cuSPARSE library requires hardware with compute capability (CC) of at least 2.0 or higher.
                           Please see the <em class="ph i">NVIDIA CUDA C Programming Guide, Appendix A</em> for a list of the compute
                           capabilities corresponding to all NVIDIA GPUs.
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="naming-convention"><a name="naming-convention" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#naming-convention" name="naming-convention" shape="rect">1.1.&nbsp;Naming Conventions</a></h3>
                     <div class="body conbody">
                        <p class="p">The cuSPARSE library functions are available for data types <samp class="ph codeph">float</samp>,
                           <samp class="ph codeph">double</samp>, <samp class="ph codeph">cuComplex</samp>, and <samp class="ph codeph">cuDoubleComplex</samp>.
                           The sparse Level 1, Level 2, and Level 3 functions follow this naming convention:
                        </p>
                        <p class="p"><samp class="ph codeph">cusparse</samp>&lt;<samp class="ph codeph">t</samp>&gt;[&lt;<samp class="ph codeph">matrix data
                              format</samp>&gt;]&lt;<samp class="ph codeph">operation</samp>&gt;[&lt;<samp class="ph codeph">output matrix
                              data format</samp>&gt;]
                        </p>
                        <p class="p">where &lt;<samp class="ph codeph">t</samp>&gt; can be <samp class="ph codeph">S</samp>, <samp class="ph codeph">D</samp>,
                           <samp class="ph codeph">C</samp>, <samp class="ph codeph">Z</samp>, or <samp class="ph codeph">X</samp>, corresponding to the data
                           types <samp class="ph codeph">float</samp>, <samp class="ph codeph">double</samp>, <samp class="ph codeph">cuComplex</samp>,
                           <samp class="ph codeph">cuDoubleComplex</samp>, and the generic type, respectively.
                        </p>
                        <p class="p">The &lt;<samp class="ph codeph">matrix data format</samp>&gt; can be <samp class="ph codeph">dense</samp>,
                           <samp class="ph codeph">coo</samp>, <samp class="ph codeph">csr</samp>, <samp class="ph codeph">csc</samp>, or <samp class="ph codeph">hyb</samp>,
                           corresponding to the dense, coordinate, compressed sparse row, compressed sparse column, and
                           hybrid storage formats, respectively.
                        </p>
                        <p class="p">Finally, the &lt;<samp class="ph codeph">operation</samp>&gt; can be <samp class="ph codeph">axpyi</samp>,
                           <samp class="ph codeph">doti</samp>, <samp class="ph codeph">dotci</samp>, <samp class="ph codeph">gthr</samp>,
                           <samp class="ph codeph">gthrz</samp>, <samp class="ph codeph">roti</samp>, or <samp class="ph codeph">sctr</samp>, corresponding to the
                           Level 1 functions; it also can be <samp class="ph codeph">mv</samp> or <samp class="ph codeph">sv</samp>, corresponding to
                           the Level 2 functions, as well as <samp class="ph codeph">mm</samp> or <samp class="ph codeph">sm</samp>, corresponding to
                           the Level 3 functions.
                        </p>
                        <p class="p">All of the functions have the return type <samp class="ph codeph">cusparseStatus_t</samp> and are explained in
                           more detail in the chapters that follow.
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="asynchronous-execution"><a name="asynchronous-execution" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#asynchronous-execution" name="asynchronous-execution" shape="rect">1.2.&nbsp;Asynchronous Execution</a></h3>
                     <div class="body conbody">
                        <p class="p">The cuSPARSE library functions are executed asynchronously with respect to the host and may
                           return control to the application on the host before the result is ready. Developers can use
                           the <samp class="ph codeph">cudaDeviceSynchronize()</samp> function to ensure that the execution of a
                           particular cuSPARSE library routine has completed.
                        </p>
                        <p class="p">A developer can also use the <samp class="ph codeph">cudaMemcpy()</samp> routine to copy data from the device
                           to the host and vice versa, using the <samp class="ph codeph">cudaMemcpyDeviceToHost</samp> and
                           <samp class="ph codeph">cudaMemcpyHostToDevice</samp> parameters, respectively. In this case there is no
                           need to add a call to <samp class="ph codeph">cudaDeviceSynchronize()</samp> because the call to
                           <samp class="ph codeph">cudaMemcpy()</samp> with the above parameters is blocking and completes only when
                           the results are ready on the host.
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" xml:lang="en-us" id="static-library"><a name="static-library" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#static-library" name="static-library" shape="rect">Static Library support</a></h3>
                     <div class="body conbody">
                        <p class="p">Starting with release 6.5, the cuSPARSE Library is also delivered in a static form as libcusparse_static.a on Linux and Mac
                           OSes.
                           The static cuSPARSE library and all others static maths libraries depend on a common thread abstraction layer library called
                           libculibos.a on Linux and Mac and culibos.lib on Windows.
                           
                        </p>
                        <p class="p">For example, on linux, to compile a small application using cuSPARSE against the dynamic library, the following command can
                           be used:
                        </p><pre xml:space="preserve">
    nvcc myCusparseApp.c  -lcusparse  -o myCusparseApp
</pre><p class="p">Whereas to compile against the static cuSPARSE library, the following command has to be used: </p><pre xml:space="preserve">     
    nvcc myCusparseApp.c  -lcusparse_static   -lculibos -o myCusparseApp
</pre><p class="p"> It is also possible to use the native Host C++ compiler.
                           Depending on the Host Operating system, some additional libraries like <samp class="ph codeph">pthread</samp> or  <samp class="ph codeph">dl</samp> might be needed on the linking line.
                           The following command on Linux is suggested :
                           
                        </p><pre xml:space="preserve">        
    g++ myCusparseApp.c  -lcusparse_static   -lculibos -lcudart_static -lpthread -ldl -I &lt;cuda-toolkit-path&gt;/include -L &lt;cuda-toolkit-path&gt;/lib64 -o myCusparseApp
 </pre><p class="p">Note that in the latter case, the library <samp class="ph codeph">cuda</samp> is not needed. The CUDA Runtime will try to open explicitly the <samp class="ph codeph">cuda</samp> library if needed. 
                           In the case of a system which does not have the CUDA driver installed, this allows the application to gracefully manage this
                           issue and potentially run if a CPU-only path is available.
                           
                        </p>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="using-the-cusparse-api"><a name="using-the-cusparse-api" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#using-the-cusparse-api" name="using-the-cusparse-api" shape="rect">2.&nbsp;Using the cuSPARSE API</a></h2>
                  <div class="body conbody">
                     <p class="p">This chapter describes how to use the cuSPARSE library API. It is not a reference for the cuSPARSE API data types and functions;
                        that is provided in subsequent chapters. 
                     </p>
                  </div>
                  <div class="topic concept nested1" id="thread-safety"><a name="thread-safety" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#thread-safety" name="thread-safety" shape="rect">2.1.&nbsp;Thread Safety</a></h3>
                     <div class="body conbody">
                        <p class="p">The library is thread safe and its functions can be called from multiple host threads.
                           			However, simultaneous read/writes of the same objects (or of the same handle) are not safe.
                           			Hence the handle must be private per thread, i.e., only one handle per thread is safe. 
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="scalar-parameters2"><a name="scalar-parameters2" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#scalar-parameters2" name="scalar-parameters2" shape="rect">2.2.&nbsp;Scalar Parameters</a></h3>
                     <div class="body conbody">
                        <p class="p">In the cuSPARSE API, the scalar parameters 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           and 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>β</mi>
                           </math>
                           can be passed by reference on the host or the device.
                        </p>
                        <p class="p">The few functions that return a scalar result, such as <samp class="ph codeph">doti()</samp> and
                           <samp class="ph codeph">nnz()</samp>, return the resulting value by reference on the host or the device.
                           Even though these functions return immediately, similarly to those that return matrix and
                           vector results, the scalar result is not ready until execution of the routine on the GPU
                           completes. This requires proper synchronization be used when reading the result from the
                           host.
                        </p>
                        <p class="p">This feature allows the cuSPARSE library functions to execute completely asynchronously using
                           streams, even when 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           and 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>β</mi>
                           </math>
                           are generated by a previous kernel. This situation arises, for example, when the
                           library is used to implement iterative methods for the solution of linear systems and
                           eigenvalue problems [3].
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="parallelism-with-streams"><a name="parallelism-with-streams" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#parallelism-with-streams" name="parallelism-with-streams" shape="rect">2.3.&nbsp;Parallelism with Streams</a></h3>
                     <div class="body conbody">
                        <p class="p">If the application performs several small independent computations, or if it makes data transfers
                           in parallel with the computation, CUDA streams can be used to overlap these tasks.
                        </p>
                        <p class="p">The application can conceptually associate a stream with each task. To achieve the overlap of
                           computation between the tasks, the developer should create CUDA streams using the
                           function <samp class="ph codeph">cudaStreamCreate()</samp> and set the stream to be used by each
                           individual cuSPARSE library routine by calling
                           <samp class="ph codeph">cusparseSetStream()</samp> just before calling the actual cuSPARSE
                           routine. Then, computations performed in separate streams would be overlapped
                           automatically on the GPU, when possible. This approach is especially useful when
                           the computation performed by a single task is relatively small and is not enough
                           to fill the GPU with work, or when there is a data transfer that can be performed
                           in parallel with the computation.
                        </p>
                        <p class="p">When streams are used, we recommend using the new cuSPARSE API with scalar parameters and results
                           passed by reference in the device memory to achieve maximum computational
                           overlap.
                        </p>
                        <p class="p">Although a developer can create many streams, in practice it is not possible to have more than 16
                           concurrent kernels executing at the same time.
                        </p>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusparse-indexing-and-data-formats"><a name="cusparse-indexing-and-data-formats" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusparse-indexing-and-data-formats" name="cusparse-indexing-and-data-formats" shape="rect">3.&nbsp;cuSPARSE Indexing and Data Formats</a></h2>
                  <div class="body conbody">
                     <p class="p">The cuSPARSE library supports dense and sparse vector, and dense and sparse matrix formats.</p>
                  </div>
                  <div class="topic concept nested1" id="index-base-format"><a name="index-base-format" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#index-base-format" name="index-base-format" shape="rect">3.1.&nbsp;Index Base Format</a></h3>
                     <div class="body conbody">
                        <p class="p">The library supports zero- and one-based indexing. The index base is selected through the <samp class="ph codeph">cusparseIndexBase_t</samp> type, which is passed as a standalone parameter or as a field in the matrix descriptor <samp class="ph codeph">cusparseMatDescr_t</samp> type.
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="vector-formats"><a name="vector-formats" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#vector-formats" name="vector-formats" shape="rect">3.2.&nbsp;Vector Formats</a></h3>
                     <div class="body conbody">
                        <p class="p">This section describes dense and sparse vector formats.</p>
                     </div>
                     <div class="topic concept nested2" id="dense-format"><a name="dense-format" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#dense-format" name="dense-format" shape="rect">3.2.1.&nbsp;Dense Format</a></h3>
                        <div class="body conbody">
                           <p class="p">Dense vectors are represented with a single data array that is stored linearly in memory, such as
                              the following 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>7</mn>
                                 <mo>×</mo>
                                 <mn>1</mn>
                              </math>
                              dense vector.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfenced open="[" close="]">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mn>1.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>2.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>3.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>4.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">(This vector is referenced again in the next section.)</p>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="sparse-format"><a name="sparse-format" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#sparse-format" name="sparse-format" shape="rect">3.2.2.&nbsp;Sparse Format</a></h3>
                        <div class="body conbody">
                           <p class="p">Sparse vectors are represented with two arrays.</p>
                           <ul class="ul">
                              <li class="li">
                                 <p class="p">The <em class="ph i">data array</em> has the nonzero values from the equivalent array in dense format.
                                 </p>
                              </li>
                              <li class="li">
                                 <p class="p">The <em class="ph i">integer index array</em> has the positions of the corresponding nonzero values in the equivalent array in dense format.
                                 </p>
                              </li>
                           </ul>
                           <p class="p">For example, the dense vector&nbsp;in section 3.2.1 can be stored as a sparse vector with
                              one-based indexing.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd></mtd>
                                                      <mtd></mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd></mtd>
                                                      <mtd></mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>7</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">It can also be stored as a sparse vector with zero-based indexing.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd></mtd>
                                                      <mtd></mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd></mtd>
                                                      <mtd></mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>6</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">In each example, the top row is the data array and the bottom row is the index array, and it
                              is assumed that the indices are provided in increasing order and that each index appears only
                              once.
                           </p>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="matrix-formats"><a name="matrix-formats" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#matrix-formats" name="matrix-formats" shape="rect">3.3.&nbsp;Matrix Formats</a></h3>
                     <div class="body conbody">
                        <p class="p">Dense and several sparse formats for matrices are discussed in this section.</p>
                     </div>
                     <div class="topic concept nested2" id="dense-format2"><a name="dense-format2" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#dense-format2" name="dense-format2" shape="rect">3.3.1.&nbsp;Dense Format</a></h3>
                        <div class="body conbody">
                           <p class="p">The dense matrix <samp class="ph codeph">X</samp> is assumed to be stored in column-major format in memory and
                              is represented by the following parameters.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">The number of rows in the matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">The number of columns in the matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">ldX</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">The leading dimension of <samp class="ph codeph">X</samp>, which must be greater than or equal to
                                          <samp class="ph codeph">m</samp>. If <samp class="ph codeph">ldX</samp> is greater than <samp class="ph codeph">m</samp>, then
                                          <samp class="ph codeph">X</samp> represents a sub-matrix of a larger matrix stored in
                                          memory
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">X</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the data array containing the matrix elements. It is assumed that enough storage
                                          is allocated for <samp class="ph codeph">X</samp> to hold all of the matrix elements and that
                                          cuSPARSE library functions may access values outside of the sub-matrix, but will never
                                          overwrite them.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">For example, <samp class="ph codeph">m×n</samp> dense matrix <samp class="ph codeph">X</samp> with leading dimension
                              <samp class="ph codeph">ldX</samp> can be stored with one-based indexing as shown.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfenced open="[" close="]">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                                  <mo>,</mo>
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                                  <mo>,</mo>
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋯</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                                  <mo>,</mo>
                                                                  <mi>n</mi>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>2</mn>
                                                                  <mo>,</mo>
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>2</mn>
                                                                  <mo>,</mo>
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋯</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>2</mn>
                                                                  <mo>,</mo>
                                                                  <mi>n</mi>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mo>⋮</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋮</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋱</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋮</mo>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mi>m</mi>
                                                                  <mo>,</mo>
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mi>m</mi>
                                                                  <mo>,</mo>
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋯</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mi>m</mi>
                                                                  <mo>,</mo>
                                                                  <mi>n</mi>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mo>⋮</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋮</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋱</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋮</mo>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mi>l</mi>
                                                                  <mi>d</mi>
                                                                  <mi>X</mi>
                                                                  <mo>,</mo>
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mi>l</mi>
                                                                  <mi>d</mi>
                                                                  <mi>X</mi>
                                                                  <mo>,</mo>
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋯</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mi>l</mi>
                                                                  <mi>d</mi>
                                                                  <mi>X</mi>
                                                                  <mo>,</mo>
                                                                  <mi>n</mi>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">Its elements are arranged linearly in memory in the order below.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfenced open="[" close="]">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                                  <mo>,</mo>
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>2</mn>
                                                                  <mo>,</mo>
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋯</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mi>m</mi>
                                                                  <mo>,</mo>
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋯</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mi>l</mi>
                                                                  <mi>d</mi>
                                                                  <mi>X</mi>
                                                                  <mo>,</mo>
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋯</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                                  <mo>,</mo>
                                                                  <mi>n</mi>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>2</mn>
                                                                  <mo>,</mo>
                                                                  <mi>n</mi>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋯</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mi>m</mi>
                                                                  <mo>,</mo>
                                                                  <mi>n</mi>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <mo>⋯</mo>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>X</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mi>l</mi>
                                                                  <mi>d</mi>
                                                                  <mi>X</mi>
                                                                  <mo>,</mo>
                                                                  <mi>n</mi>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="note note"><span class="notetitle">Note:</span> This format and notation are similar to those used in the NVIDIA CUDA cuBLAS
                              library.
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="coordinate-format-coo"><a name="coordinate-format-coo" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#coordinate-format-coo" name="coordinate-format-coo" shape="rect">3.3.2.&nbsp;Coordinate Format (COO)</a></h3>
                        <div class="body conbody">
                           <p class="p">The <samp class="ph codeph">m×n</samp> sparse matrix <samp class="ph codeph">A</samp> is represented in COO format
                              by the following parameters.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">The number of nonzero elements in the matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">cooValA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the data array of length <samp class="ph codeph">nnz</samp> that holds all nonzero
                                          values of <samp class="ph codeph">A</samp> in row-major format.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">cooRowIndA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the integer array of length <samp class="ph codeph">nnz</samp> that contains the row
                                          indices of the corresponding elements in array <samp class="ph codeph">cooValA</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">cooColIndA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the integer array of length <samp class="ph codeph">nnz</samp> that contains the
                                          column indices of the corresponding elements in array
                                          <samp class="ph codeph">cooValA</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">A sparse matrix in COO format is assumed to be stored in row-major format: the index arrays
                              are first sorted by row indices and then within the same row by compressed column indices. It
                              is assumed that each pair of row and column indices appears only once.
                           </p>
                           <p class="p">For example, consider the following 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>4</mn>
                                 <mo>×</mo>
                                 <mn>5</mn>
                              </math>
                              matrix <samp class="ph codeph">A</samp>.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfenced open="[" close="]">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mn>1.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>4.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>2.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>3.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>5.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>7.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>8.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>9.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>6.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">It is stored in COO format with zero-based indexing this way.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>cooValA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>7.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>8.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>9.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>6.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>cooRowIndA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>cooColIndA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">In the COO format with one-based indexing, it is stored as shown.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>cooValA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>7.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>8.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>9.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>6.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>cooRowIndA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>cooColIndA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="compressed-sparse-row-format-csr"><a name="compressed-sparse-row-format-csr" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#compressed-sparse-row-format-csr" name="compressed-sparse-row-format-csr" shape="rect">3.3.3.&nbsp;Compressed Sparse Row Format (CSR)</a></h3>
                        <div class="body conbody">
                           <p class="p">The only way the CSR differs from the COO format is that the array containing the row indices is
                              compressed in CSR format. The <samp class="ph codeph">m×n</samp> sparse matrix <samp class="ph codeph">A</samp> is
                              represented in CSR format by the following parameters.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">The number of nonzero elements in the matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the data array of length <samp class="ph codeph">nnz</samp> that holds all nonzero values of A
                                          in row-major format.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the integer array of length <samp class="ph codeph">m+1</samp> that holds indices into the
                                          arrays <samp class="ph codeph">csrColIndA</samp> and <samp class="ph codeph">csrValA</samp>. The first
                                          <samp class="ph codeph">m</samp> entries of this array contain the indices of the first nonzero
                                          element in the <samp class="ph codeph">i</samp>th row for <samp class="ph codeph">i=i,...,m</samp>, while the last
                                          entry contains <samp class="ph codeph">nnz+csrRowPtrA(0)</samp>. In general,
                                          <samp class="ph codeph">csrRowPtrA(0)</samp> is <samp class="ph codeph">0</samp> or <samp class="ph codeph">1</samp> for zero-
                                          and one-based indexing, respectively.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the integer array of length <samp class="ph codeph">nnz</samp> that contains the column indices of the corresponding elements in array <samp class="ph codeph">csrValA</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">Sparse matrices  in CSR format are assumed to be stored in row-major CSR format, in other words,
                              the index arrays are first sorted by row indices and then within the same row by column
                              indices. It is assumed that each pair of row and column indices appears only once.
                           </p>
                           <p class="p">Consider again the 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>4</mn>
                                 <mo>×</mo>
                                 <mn>5</mn>
                              </math>
                              matrix<samp class="ph codeph">A</samp>.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfenced open="[" close="]">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mn>1.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>4.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>2.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>3.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>5.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>7.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>8.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>9.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>6.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">It is stored in CSR format with zero-based indexing as shown.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>csrValA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>7.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>8.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>9.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>6.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>csrRowPtrA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>7</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>9</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>csrColIndA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">This is how it is stored in CSR format with one-based indexing.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>csrValA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>7.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>8.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>9.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>6.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>csrRowPtrA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>8</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>10</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>csrColIndA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="compressed-sparse-column-format-csc"><a name="compressed-sparse-column-format-csc" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#compressed-sparse-column-format-csc" name="compressed-sparse-column-format-csc" shape="rect">3.3.4.&nbsp;Compressed Sparse Column Format (CSC)</a></h3>
                        <div class="body conbody">
                           <p class="p">The CSC format is different from the COO format in two ways: the matrix is stored in
                              column-major format, and the array containing the column indices is compressed in CSC format.
                              The <samp class="ph codeph">m×n</samp> matrix <samp class="ph codeph">A</samp> is represented in CSC format by the
                              following parameters.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">The number of nonzero elements in the matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">cscValA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the data array of length <samp class="ph codeph">nnz</samp> that holds all nonzero
                                          values of <samp class="ph codeph">A</samp> in column-major format.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">cscRowIndA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the integer array of length <samp class="ph codeph">nnz</samp> that contains the row
                                          indices of the corresponding elements in array <samp class="ph codeph">cscValA</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">cscColPtrA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the integer array of length <samp class="ph codeph">n+1</samp> that holds indices
                                          into the arrays <samp class="ph codeph">cscRowIndA</samp> and <samp class="ph codeph">cscValA</samp>. The first
                                          <samp class="ph codeph">n</samp> entries of this array contain the indices of the first nonzero
                                          element in the <samp class="ph codeph">i</samp>th row for <samp class="ph codeph">i=i,...,n</samp>, while the last
                                          entry contains <samp class="ph codeph">nnz+cscColPtrA(0)</samp>. In general,
                                          <samp class="ph codeph">cscColPtrA(0)</samp> is <samp class="ph codeph">0</samp> or <samp class="ph codeph">1</samp> for zero-
                                          and one-based indexing, respectively.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="note note"><span class="notetitle">Note:</span> The matrix <samp class="ph codeph">A</samp> in CSR format has exactly the same memory layout as its
                              transpose in CSC format (and vice versa).
                           </div>
                           <p class="p">For example, consider once again the 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>4</mn>
                                 <mo>×</mo>
                                 <mn>5</mn>
                              </math>
                              matrix <samp class="ph codeph">A</samp>.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfenced open="[" close="]">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mn>1.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>4.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>2.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>3.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>5.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>7.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>8.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>9.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>6.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">It is stored in CSC format with zero-based indexing this way.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>cscValA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>9.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>7.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>8.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>6.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>cscRowIndA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>cscColPtrA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>6</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>7</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>9</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">In CSC format with one-based indexing, this is how it is stored.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>cscValA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>9.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>7.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>8.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>6.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>cscRowIndA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>cscColPtrA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>7</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>8</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>10</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"> Each pair of row and column indices appears only once.</p>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="ellpack-itpack-format-ell"><a name="ellpack-itpack-format-ell" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#ellpack-itpack-format-ell" name="ellpack-itpack-format-ell" shape="rect">3.3.5.&nbsp;Ellpack-Itpack Format (ELL)</a></h3>
                        <div class="body conbody">
                           <p class="p">An <samp class="ph codeph">m×n</samp> sparse matrix <samp class="ph codeph">A</samp> with at most
                              <samp class="ph codeph">k</samp> nonzero elements per row is stored in the Ellpack-Itpack (ELL) format
                              [2] using two dense arrays of dimension <samp class="ph codeph">m×k</samp>. The first data
                              array contains the values of the nonzero elements in the matrix, while the second integer
                              array contains the corresponding column indices.
                           </p>
                           <p class="p">For example, consider the 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>4</mn>
                                 <mo>×</mo>
                                 <mn>5</mn>
                              </math>
                              matrix <samp class="ph codeph">A</samp>.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfenced open="[" close="]">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mn>1.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>4.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>2.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>3.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>5.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>7.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>8.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>9.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>6.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">This is how it is stored in ELL format with zero-based indexing.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>data</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>2.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>5.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>7.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>8.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>9.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>6.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>indices</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mo>−</mo>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mo>.</mo>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mo>−</mo>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mo>.</mo>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mo>−</mo>
                                                                        </mphantom>
                                                                     </mrow>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mo>.</mo>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mo>−</mo>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mo>.</mo>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">It is stored this way in ELL format with one-based indexing.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>data</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>2.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>5.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>7.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>8.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>9.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>6.0</mn>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0.0</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>indices</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mo>−</mo>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mo>.</mo>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mo>−</mo>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mo>.</mo>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mo>−</mo>
                                                                        </mphantom>
                                                                     </mrow>
                                                                     <mn>5</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mo>.</mo>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mo>−</mo>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mo>.</mo>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">Sparse matrices in ELL format are assumed to be stored in column-major format in memory.
                              Also, rows with less than <samp class="ph codeph">k</samp> nonzero elements are padded in the
                              <samp class="ph codeph">data</samp> and <samp class="ph codeph">indices</samp> arrays with zero and 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mo>−</mo>
                                 <mn>1</mn>
                              </math>
                              , respectively.
                           </p>
                           <p class="p">The ELL format is not supported directly, but it is used to store the regular part of the
                              matrix in the HYB format that is described in the next section.
                           </p>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="hybrid-format-hyb"><a name="hybrid-format-hyb" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#hybrid-format-hyb" name="hybrid-format-hyb" shape="rect">3.3.6.&nbsp;Hybrid Format (HYB)</a></h3>
                        <div class="body conbody">
                           <p class="p">The HYB sparse storage format is composed of a regular part, usually stored in ELL format,
                              and an irregular part, usually stored in COO format [1]. The ELL and COO parts are
                              always stored using zero-based indexing. HYB is implemented as an opaque data format that
                              requires the use of a conversion operation to store a matrix in it. The conversion operation
                              partitions the general matrix into the regular and irregular parts automatically or according
                              to developer-specified criteria.
                           </p>
                           <p class="p">For more information, please refer to the description of
                              <samp class="ph codeph">cusparseHybPartition_t</samp> type, as well as the description of the conversion
                              routines <samp class="ph codeph">dense2hyb</samp>, <samp class="ph codeph">csc2hyb</samp> and <samp class="ph codeph">csr2hyb</samp>.
                           </p>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="block-compressed-sparse-row-format-bsr"><a name="block-compressed-sparse-row-format-bsr" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#block-compressed-sparse-row-format-bsr" name="block-compressed-sparse-row-format-bsr" shape="rect">3.3.7.&nbsp;Block Compressed Sparse Row Format (BSR)</a></h3>
                        <div class="body conbody">
                           <p class="p">The only difference between the CSR and BSR formats is the format of the storage element. The
                              former stores primitive data types (<samp class="ph codeph">single</samp>, <samp class="ph codeph">double</samp>,
                              <samp class="ph codeph">cuComplex</samp>, and <samp class="ph codeph">cuDoubleComplex</samp>) whereas the latter stores
                              a two-dimensional square block of primitive data types. The dimension of the square block is 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>b</mi>
                                 <mi>l</mi>
                                 <mi>o</mi>
                                 <mi>c</mi>
                                 <mi>k</mi>
                                 <mi>D</mi>
                                 <mi>i</mi>
                                 <mi>m</mi>
                              </math>
                              . The <samp class="ph codeph">m×n</samp> sparse matrix <samp class="ph codeph">A</samp> is equivalent
                              to a block sparse matrix 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>b</mi>
                                 </msub>
                              </math>
                              with 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>m</mi>
                                 <mi>b</mi>
                                 <mo>=</mo>
                                 <mfrac>
                                    <mrow>
                                       <mi>m</mi>
                                       <mo>+</mo>
                                       <mi>b</mi>
                                       <mi>l</mi>
                                       <mi>o</mi>
                                       <mi>c</mi>
                                       <mi>k</mi>
                                       <mi>D</mi>
                                       <mi>i</mi>
                                       <mi>m</mi>
                                       <mo>−</mo>
                                       <mn>1</mn>
                                    </mrow>
                                    <mrow>
                                       <mi>b</mi>
                                       <mi>l</mi>
                                       <mi>o</mi>
                                       <mi>c</mi>
                                       <mi>k</mi>
                                       <mi>D</mi>
                                       <mi>i</mi>
                                       <mi>m</mi>
                                    </mrow>
                                 </mfrac>
                              </math>
                              block rows and 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>n</mi>
                                 <mi>b</mi>
                                 <mo>=</mo>
                                 <mfrac>
                                    <mrow>
                                       <mi>n</mi>
                                       <mo>+</mo>
                                       <mi>b</mi>
                                       <mi>l</mi>
                                       <mi>o</mi>
                                       <mi>c</mi>
                                       <mi>k</mi>
                                       <mi>D</mi>
                                       <mi>i</mi>
                                       <mi>m</mi>
                                       <mo>−</mo>
                                       <mn>1</mn>
                                    </mrow>
                                    <mrow>
                                       <mi>b</mi>
                                       <mi>l</mi>
                                       <mi>o</mi>
                                       <mi>c</mi>
                                       <mi>k</mi>
                                       <mi>D</mi>
                                       <mi>i</mi>
                                       <mi>m</mi>
                                    </mrow>
                                 </mfrac>
                              </math>
                              block columns. If 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>m</mi>
                              </math>
                              or 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>n</mi>
                              </math>
                              is not multiple of 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>b</mi>
                                 <mi>l</mi>
                                 <mi>o</mi>
                                 <mi>c</mi>
                                 <mi>k</mi>
                                 <mi>D</mi>
                                 <mi>i</mi>
                                 <mi>m</mi>
                              </math>
                              , then zeros are filled into 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>b</mi>
                                 </msub>
                              </math>
                              .
                           </p>
                           <p class="p"><samp class="ph codeph">A</samp> is represented in BSR format by the following parameters.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Block dimension of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">The number of block rows of <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">nb</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">The number of block columns of <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">The number of nonzero blocks in the matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the data array of length 
                                          
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>n</mi>
                                             <mi>n</mi>
                                             <mi>z</mi>
                                             <mi>b</mi>
                                             <mo>∗</mo>
                                             <mi>b</mi>
                                             <mi>l</mi>
                                             <mi>o</mi>
                                             <mi>c</mi>
                                             <mi>k</mi>
                                             <mi>D</mi>
                                             <mi>i</mi>
                                             <msup>
                                                <mi>m</mi>
                                                <mn>2</mn>
                                             </msup>
                                          </math>
                                          that holds all elements of nonzero blocks of <samp class="ph codeph">A</samp>. The
                                          block elements are stored in either column-major order or row-major order.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the integer array of length <samp class="ph codeph">mb+1</samp> that holds indices into the
                                          arrays <samp class="ph codeph">bsrColIndA</samp> and <samp class="ph codeph">bsrValA</samp>. The first
                                          <samp class="ph codeph">mb</samp> entries of this array contain the indices of the first nonzero
                                          block in the <samp class="ph codeph">i</samp>th block row for <samp class="ph codeph">i=1,...,mb</samp>, while the
                                          last entry contains <samp class="ph codeph">nnzb+bsrRowPtrA(0)</samp>. In general,
                                          <samp class="ph codeph">bsrRowPtrA(0)</samp> is <samp class="ph codeph">0</samp> or <samp class="ph codeph">1</samp> for zero-
                                          and one-based indexing, respectively.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the integer array of length <samp class="ph codeph">nnzb</samp> that contains the column indices of the corresponding blocks in array <samp class="ph codeph">bsrValA</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">As with CSR format, (row, column) indices of BSR are stored in row-major order. The index arrays
                              are first sorted by row indices and then within the same row by column indices.
                           </p>
                           <p class="p">For example, consider again the <samp class="ph codeph">4×5</samp> matrix <samp class="ph codeph">A</samp>.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfenced open="[" close="]">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mn>1.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>4.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>2.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>3.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>5.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>7.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>8.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>9.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>6.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">If 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>b</mi>
                                 <mi>l</mi>
                                 <mi>o</mi>
                                 <mi>c</mi>
                                 <mi>k</mi>
                                 <mi>D</mi>
                                 <mi>i</mi>
                                 <mi>m</mi>
                              </math>
                              is equal to 2, then 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>m</mi>
                                 <mi>b</mi>
                              </math>
                              is 2, 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>n</mi>
                                 <mi>b</mi>
                              </math>
                              is 3, and matrix <samp class="ph codeph">A</samp> is split into <samp class="ph codeph">2×3</samp>
                              block matrix 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>b</mi>
                                 </msub>
                              </math>
                              . The dimension of 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>b</mi>
                                 </msub>
                              </math>
                              is <samp class="ph codeph">4×6</samp>, slightly bigger than matrix 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                              </math>
                              , so zeros are filled in the last column of 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>b</mi>
                                 </msub>
                              </math>
                              . The element-wise view of 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>b</mi>
                                 </msub>
                              </math>
                              is this.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfenced open="[" close="]">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mn>1.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>4.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>2.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>3.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>5.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>7.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>8.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>9.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>6.0</mn>
                                                         </mtd>
                                                         <mtd>
                                                            <mn>0.0</mn>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">Based on zero-based indexing, the block-wise view of 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>b</mi>
                                 </msub>
                              </math>
                              can be represented as follows.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msub>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>b</mi>
                                                </mrow>
                                             </msub>
                                             <mo>=</mo>
                                             <mfenced open="[" close="]">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>00</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>01</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>02</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>10</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>11</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>12</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">The basic element of BSR is a nonzero 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>i</mi>
                                       <mi>j</mi>
                                    </mrow>
                                 </msub>
                              </math>
                              block, one that contains at least one nonzero element of <samp class="ph codeph">A</samp>.
                              Five of six blocks are nonzero in 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>b</mi>
                                 </msub>
                              </math>
                              . 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msub>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mn>00</mn>
                                                </mrow>
                                             </msub>
                                             <mo>=</mo>
                                             <mfenced open="[" close="]">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mn>1</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>4</mn>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>2</mn>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                             <mo>,</mo>
                                             <msub>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mn>01</mn>
                                                </mrow>
                                             </msub>
                                             <mo>=</mo>
                                             <mfenced open="[" close="]">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mn>3</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                             <mo>,</mo>
                                             <msub>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mn>10</mn>
                                                </mrow>
                                             </msub>
                                             <mo>=</mo>
                                             <mfenced open="[" close="]">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mn>5</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                             <mo>,</mo>
                                             <msub>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mn>11</mn>
                                                </mrow>
                                             </msub>
                                             <mo>=</mo>
                                             <mfenced open="[" close="]">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>7</mn>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mn>9</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                             <mo>,</mo>
                                             <msub>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mn>12</mn>
                                                </mrow>
                                             </msub>
                                             <mo>=</mo>
                                             <mfenced open="[" close="]">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mn>8</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mn>6</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">BSR format only stores the information of nonzero blocks, including block indices 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mo stretchy="false">(</mo>
                                 <mi>i</mi>
                                 <mo>,</mo>
                                 <mi>j</mi>
                                 <mo stretchy="false">)</mo>
                              </math>
                              and values 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>i</mi>
                                       <mi>j</mi>
                                    </mrow>
                                 </msub>
                              </math>
                              . Also row indices are compressed in CSR format.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrValA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="0.8em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>00</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>01</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>10</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>11</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>12</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrRowPtrA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrColIndA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">There are two ways to arrange the data element of block 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>i</mi>
                                       <mi>j</mi>
                                    </mrow>
                                 </msub>
                              </math>
                              : row-major order and column-major order. Under column-major order, the physical
                              storage of <samp class="ph codeph">bsrValA</samp> is this.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mtable columnalign="center center center center center" rowspacing="4pt" columnspacing="1em" columnlines="solid solid solid solid">
                                                <mtr>
                                                   <mtd>
                                                      <mi>b</mi>
                                                      <mi>s</mi>
                                                      <mi>r</mi>
                                                      <mi>V</mi>
                                                      <mi>a</mi>
                                                      <mi>l</mi>
                                                      <mi>A</mi>
                                                      <mo>=</mo>
                                                      <mo stretchy="false">[</mo>
                                                      <mn>1</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>4</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>2</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                   </mtd>
                                                   <mtd>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>3</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                   </mtd>
                                                   <mtd>
                                                      <mn>5</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                   </mtd>
                                                   <mtd>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>9</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>7</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                   </mtd>
                                                   <mtd>
                                                      <mn>8</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>6</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mo stretchy="false">]</mo>
                                                   </mtd>
                                                </mtr>
                                             </mtable>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">Under row-major order, the physical storage of <samp class="ph codeph">bsrValA</samp> is this.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mtable columnalign="center center center center center" rowspacing="4pt" columnspacing="1em" columnlines="solid solid solid solid">
                                                <mtr>
                                                   <mtd>
                                                      <mi>b</mi>
                                                      <mi>s</mi>
                                                      <mi>r</mi>
                                                      <mi>V</mi>
                                                      <mi>a</mi>
                                                      <mi>l</mi>
                                                      <mi>A</mi>
                                                      <mo>=</mo>
                                                      <mo stretchy="false">[</mo>
                                                      <mn>1</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>4</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>2</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                   </mtd>
                                                   <mtd>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>3</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                   </mtd>
                                                   <mtd>
                                                      <mn>5</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                   </mtd>
                                                   <mtd>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>7</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>9</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                   </mtd>
                                                   <mtd>
                                                      <mn>8</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>6</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mo stretchy="false">]</mo>
                                                   </mtd>
                                                </mtr>
                                             </mtable>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">Similarly, in BSR format with one-based indexing and column-major order, <samp class="ph codeph">A</samp> can
                              be represented by the following.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msub>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>b</mi>
                                                </mrow>
                                             </msub>
                                             <mo>=</mo>
                                             <mfenced open="[" close="]">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>11</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>12</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>13</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>21</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>22</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>23</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mtable columnalign="center center center center center" rowspacing="4pt" columnspacing="1em" columnlines="solid solid solid solid">
                                                <mtr>
                                                   <mtd>
                                                      <mi>b</mi>
                                                      <mi>s</mi>
                                                      <mi>r</mi>
                                                      <mi>V</mi>
                                                      <mi>a</mi>
                                                      <mi>l</mi>
                                                      <mi>A</mi>
                                                      <mo>=</mo>
                                                      <mo stretchy="false">[</mo>
                                                      <mn>1</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>4</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>2</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                   </mtd>
                                                   <mtd>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>3</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                   </mtd>
                                                   <mtd>
                                                      <mn>5</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                   </mtd>
                                                   <mtd>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>9</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>7</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                   </mtd>
                                                   <mtd>
                                                      <mn>8</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>6</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mn>0</mn>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mphantom>
                                                            <mn>.0</mn>
                                                         </mphantom>
                                                      </mrow>
                                                      <mo stretchy="false">]</mo>
                                                   </mtd>
                                                </mtr>
                                             </mtable>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrRowPtrA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>6</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrColIndA</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="note note"><span class="notetitle">Note:</span> 
                              The general BSR format has two parameters, <samp class="ph codeph">rowBlockDim</samp> and <samp class="ph codeph">colBlockDim</samp>.
                              <samp class="ph codeph">rowBlockDim</samp> is number of rows within a block and <samp class="ph codeph">colBlockDim</samp> is number of columns within a block.
                              If <samp class="ph codeph">rowBlockDim=colBlockDim</samp>, general BSR format is the same as BSR format.
                              If <samp class="ph codeph">rowBlockDim=colBlockDim=1</samp>, general BSR format is the same as CSR format.
                              The conversion routine gebsr2gebsr is used to do conversion among CSR, BSR and general BSR.
                              
                           </div>
                           <div class="note note"><span class="notetitle">Note:</span> In the cuSPARSE Library, the storage format of blocks in BSR format can be column-major or row-major, independently
                              of the base index. However, if the developer uses BSR format from the Math Kernel Library (MKL)
                              and wants to directly interface with the cuSPARSE Library, then <samp class="ph codeph">cusparseDirection_t</samp><samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp> should be used if the base index is one; otherwise,
                              <samp class="ph codeph">cusparseDirection_t</samp><samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> should be used.
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="extended-bsr-format-bsrx"><a name="extended-bsr-format-bsrx" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#extended-bsr-format-bsrx" name="extended-bsr-format-bsrx" shape="rect">3.3.8.&nbsp;Extended BSR Format (BSRX)</a></h3>
                        <div class="body conbody">
                           <p class="p">BSRX is the same as the BSR format,  but the array <samp class="ph codeph">bsrRowPtrA</samp> is separated into
                              two parts. The first nonzero block of each row is still specified by the array
                              <samp class="ph codeph">bsrRowPtrA</samp>, which is the same as in BSR, but the position next to the last
                              nonzero block of each row is specified by the array <samp class="ph codeph">bsrEndPtrA</samp>. Briefly, BSRX
                              format is simply like a 4-vector variant of BSR format.
                           </p>
                           <p class="p">Matrix <samp class="ph codeph">A</samp> is represented in BSRX format by the following parameters.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Block dimension of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">The number of block rows of <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">nb</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">The number of block columns of <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(integer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1"> number of nonzero blocks in the matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the data array of length 
                                          
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>n</mi>
                                             <mi>n</mi>
                                             <mi>z</mi>
                                             <mi>b</mi>
                                             <mo>∗</mo>
                                             <mi>b</mi>
                                             <mi>l</mi>
                                             <mi>o</mi>
                                             <mi>c</mi>
                                             <mi>k</mi>
                                             <mi>D</mi>
                                             <mi>i</mi>
                                             <msup>
                                                <mi>m</mi>
                                                <mn>2</mn>
                                             </msup>
                                          </math>
                                          that holds all the elements of the nonzero blocks of <samp class="ph codeph">A</samp>.
                                          The block elements are stored in either column-major order or row-major order.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the integer array of length <samp class="ph codeph">mb</samp> that holds indices into the arrays
                                          <samp class="ph codeph">bsrColIndA</samp> and <samp class="ph codeph">bsrValA</samp>;
                                          <samp class="ph codeph">bsrRowPtrA(i)</samp> is the position of the first nonzero block of the
                                          <samp class="ph codeph">i</samp>th block row in <samp class="ph codeph">bsrColIndA</samp> and
                                          <samp class="ph codeph">bsrValA</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">bsrEndPtrA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the integer array of length <samp class="ph codeph">mb</samp> that holds indices into the arrays
                                          <samp class="ph codeph">bsrColIndA</samp> and <samp class="ph codeph">bsrValA</samp>;
                                          <samp class="ph codeph">bsrRowPtrA(i)</samp> is the position next to the last nonzero block of the
                                          <samp class="ph codeph">i</samp>th block row in <samp class="ph codeph">bsrColIndA</samp> and
                                          <samp class="ph codeph">bsrValA</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                       <td class="entry" valign="top" width="10%" rowspan="1" colspan="1">(pointer)</td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">Points to the integer array of length <samp class="ph codeph">nnzb</samp> that contains the column indices of the corresponding blocks in array <samp class="ph codeph">bsrValA</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">A simple conversion between BSR and BSRX can be done as follows. Suppose the developer has a
                              <samp class="ph codeph">2×3</samp> block sparse matrix 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>b</mi>
                                 </msub>
                              </math>
                              represented as shown.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msub>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>b</mi>
                                                </mrow>
                                             </msub>
                                             <mo>=</mo>
                                             <mfenced open="[" close="]">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>00</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>01</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>02</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>10</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>11</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>A</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>12</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">Assume it has this BSR format.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrValA of BSR</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="0.8em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>00</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>01</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>10</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>11</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>12</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrRowPtrA of BSR</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrColIndA of BSR</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">The <samp class="ph codeph">bsrRowPtrA</samp> of the BSRX format is simply the first two elements of the
                              <samp class="ph codeph">bsrRowPtrA</samp> BSR format. The <samp class="ph codeph">bsrEndPtrA</samp> of BSRX format is
                              the last two elements of the <samp class="ph codeph">bsrRowPtrA</samp> of BSR format.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrRowPtrA of BSRX</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrEndPtrA of BSRX</mtext>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>5</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">The advantage of the BSRX format is that the developer can specify a submatrix in the original BSR
                              format by modifying <samp class="ph codeph">bsrRowPtrA</samp> and <samp class="ph codeph">bsrEndPtrA</samp> while keeping
                              <samp class="ph codeph">bsrColIndA</samp> and <samp class="ph codeph">bsrValA</samp> unchanged.
                           </p>
                           <p class="p">For example, to create another block matrix 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mover>
                                       <mi>A</mi>
                                       <mo stretchy="false">˜</mo>
                                    </mover>
                                 </mrow>
                                 <mo>=</mo>
                                 <mfenced open="[" close="]">
                                    <mtable rowspacing="4pt" columnspacing="1em">
                                       <mtr>
                                          <mtd>
                                             <mi>O</mi>
                                          </mtd>
                                          <mtd>
                                             <mi>O</mi>
                                          </mtd>
                                          <mtd>
                                             <mi>O</mi>
                                          </mtd>
                                       </mtr>
                                       <mtr>
                                          <mtd>
                                             <mi>O</mi>
                                          </mtd>
                                          <mtd>
                                             <msub>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mn>11</mn>
                                                </mrow>
                                             </msub>
                                          </mtd>
                                          <mtd>
                                             <mi>O</mi>
                                          </mtd>
                                       </mtr>
                                    </mtable>
                                 </mfenced>
                              </math>
                              that is slightly different from 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                              </math>
                              ,  the developer can keep <samp class="ph codeph">bsrColIndA</samp> and
                              <samp class="ph codeph">bsrValA</samp>, but reconstruct 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mover>
                                       <mi>A</mi>
                                       <mo stretchy="false">˜</mo>
                                    </mover>
                                 </mrow>
                              </math>
                              by properly setting of <samp class="ph codeph">bsrRowPtrA</samp> and
                              <samp class="ph codeph">bsrEndPtrA</samp>. The following 4-vector characterizes 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mover>
                                       <mi>A</mi>
                                       <mo stretchy="false">˜</mo>
                                    </mover>
                                 </mrow>
                              </math>
                              .
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrValA of&nbsp;</mtext>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mover>
                                                               <mi>A</mi>
                                                               <mo stretchy="false">˜</mo>
                                                            </mover>
                                                         </mrow>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="0.8em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>00</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>01</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>10</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>11</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <msub>
                                                                        <mi>A</mi>
                                                                        <mrow class="MJX-TeXAtom-ORD">
                                                                           <mn>12</mn>
                                                                        </mrow>
                                                                     </msub>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrColIndA of&nbsp;</mtext>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mover>
                                                               <mi>A</mi>
                                                               <mo stretchy="false">˜</mo>
                                                            </mover>
                                                         </mrow>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>1</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>2</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrRowPtrA of&nbsp;</mtext>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mover>
                                                               <mi>A</mi>
                                                               <mo stretchy="false">˜</mo>
                                                            </mover>
                                                         </mrow>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>3</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>bsrEndPtrA of&nbsp;</mtext>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mover>
                                                               <mi>A</mi>
                                                               <mo stretchy="false">˜</mo>
                                                            </mover>
                                                         </mrow>
                                                      </mtd>
                                                      <mtd>
                                                         <mo>=</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mfenced open="[" close="]">
                                                            <mtable rowspacing="4pt" columnspacing="1em">
                                                               <mtr>
                                                                  <mtd>
                                                                     <mn>0</mn>
                                                                     <mrow class="MJX-TeXAtom-ORD">
                                                                        <mphantom>
                                                                           <mn>.0</mn>
                                                                        </mphantom>
                                                                     </mrow>
                                                                  </mtd>
                                                                  <mtd>
                                                                     <mn>4</mn>
                                                                  </mtd>
                                                               </mtr>
                                                            </mtable>
                                                         </mfenced>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusparse-types-reference"><a name="cusparse-types-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusparse-types-reference" name="cusparse-types-reference" shape="rect">4.&nbsp;cuSPARSE Types Reference</a></h2>
                  <div class="topic concept nested1" id="data-types"><a name="data-types" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#data-types" name="data-types" shape="rect">4.1.&nbsp;Data types</a></h3>
                     <div class="body conbody">
                        <p class="p">The <samp class="ph codeph">float</samp>, <samp class="ph codeph">double</samp>, <samp class="ph codeph">cuComplex</samp>, and <samp class="ph codeph">cuDoubleComplex</samp> data types are supported. The first two are standard C data types, while the last two are exported from <samp class="ph codeph">cuComplex.h</samp>.
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparseactiont"><a name="cusparseactiont" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparseactiont" name="cusparseactiont" shape="rect">4.2.&nbsp;cusparseAction_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This type indicates whether the operation is performed only on indices or on data and indices.</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <thead class="thead" align="left">
                                 <tr class="row">
                                    <th class="entry" valign="top" width="50%" id="d54e10296" rowspan="1" colspan="1">
                                       Value
                                       
                                    </th>
                                    <th class="entry" valign="top" width="50%" id="d54e10299" rowspan="1" colspan="1">
                                       Meaning
                                       
                                    </th>
                                 </tr>
                              </thead>
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e10296" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_ACTION_SYMBOLIC</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e10299" rowspan="1" colspan="1">
                                       <p class="p">the operation is performed only on indices.</p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e10296" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_ACTION_NUMERIC</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e10299" rowspan="1" colspan="1">
                                       <p class="p">the operation is performed on data and indices.</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedirectiont"><a name="cusparsedirectiont" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedirectiont" name="cusparsedirectiont" shape="rect">4.3.&nbsp;cusparseDirection_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This type indicates whether the elements of a dense matrix should be parsed by rows or by columns (assuming column-major storage
                           in memory of the dense matrix) in function cusparse[S|D|C|Z]nnz. Besides storage format of blocks in BSR format is also controlled
                           by this type.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <thead class="thead" align="left">
                                 <tr class="row">
                                    <th class="entry" valign="top" width="50%" id="d54e10365" rowspan="1" colspan="1">
                                       Value
                                       
                                    </th>
                                    <th class="entry" valign="top" width="50%" id="d54e10368" rowspan="1" colspan="1">
                                       Meaning
                                       
                                    </th>
                                 </tr>
                              </thead>
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e10365" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e10368" rowspan="1" colspan="1">
                                       <p class="p">the matrix should be parsed by rows.</p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e10365" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e10368" rowspan="1" colspan="1">
                                       <p class="p">the matrix should be parsed by columns.</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsehandlet"><a name="cusparsehandlet" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsehandlet" name="cusparsehandlet" shape="rect">4.4.&nbsp;cusparseHandle_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a pointer type to an opaque cuSPARSE context, which the user must initialize by calling prior to calling <samp class="ph codeph">cusparseCreate()</samp> any other library function. The handle created and returned by <samp class="ph codeph">cusparseCreate()</samp> must be passed to every cuSPARSE function.
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsehybmatt"><a name="cusparsehybmatt" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsehybmatt" name="cusparsehybmatt" shape="rect">4.5.&nbsp;cusparseHybMat_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a pointer type to an opaque structure holding the matrix in HYB format, which is created by <samp class="ph codeph">cusparseCreateHybMat</samp> and destroyed by <samp class="ph codeph">cusparseDestroyHybMat</samp>.
                        </p>
                     </div>
                     <div class="topic concept nested2" id="cusparsehybpartitiont"><a name="cusparsehybpartitiont" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparsehybpartitiont" name="cusparsehybpartitiont" shape="rect">4.5.1.&nbsp;cusparseHybPartition_t</a></h3>
                        <div class="body conbody">
                           <p class="p">This type indicates how to perform the partitioning of the matrix into regular (ELL) and irregular (COO) parts of the HYB
                              format.
                           </p>
                           <p class="p">The partitioning is performed during the conversion of the matrix from a dense or sparse format into the HYB format and is
                              governed by the following rules. When <samp class="ph codeph">CUSPARSE_HYB_PARTITION_AUTO</samp> is selected, the cuSPARSE library automatically decides how much data to put into the regular and irregular parts of the
                              HYB format. When <samp class="ph codeph">CUSPARSE_HYB_PARTITION_USER</samp> is selected, the width of the regular part of the HYB format should be specified by the caller. When <samp class="ph codeph">CUSPARSE_HYB_PARTITION_MAX</samp> is selected, the width of the regular part of the HYB format equals to the maximum number of non-zero elements per row, in
                              other words, the entire matrix is stored in the regular part of the HYB format.
                           </p>
                           <p class="p">The <em class="ph i">default</em> is to let the library automatically decide how to split the data.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <thead class="thead" align="left">
                                    <tr class="row">
                                       <th class="entry" valign="top" width="50%" id="d54e10489" rowspan="1" colspan="1">
                                          Value
                                          
                                       </th>
                                       <th class="entry" valign="top" width="50%" id="d54e10492" rowspan="1" colspan="1">
                                          Meaning
                                          
                                       </th>
                                    </tr>
                                 </thead>
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10489" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_HYB_PARTITION_AUTO</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10492" rowspan="1" colspan="1">
                                          <p class="p">the automatic partitioning is selected (<em class="ph i">default</em>).
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10489" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_HYB_PARTITION_USER</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10492" rowspan="1" colspan="1">
                                          <p class="p">the user specified treshold is used.</p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10489" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_HYB_PARTITION_MAX</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10492" rowspan="1" colspan="1">
                                          <p class="p">the data is stored in ELL format.</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsematdescrt"><a name="cusparsematdescrt" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsematdescrt" name="cusparsematdescrt" shape="rect">4.6.&nbsp;cusparseMatDescr_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This structure is used to describe the shape and properties of a matrix.</p><pre xml:space="preserve">typedef struct {
    cusparseMatrixType_t MatrixType;
    cusparseFillMode_t FillMode;
    cusparseDiagType_t DiagType;
    cusparseIndexBase_t IndexBase;
} cusparseMatDescr_t;</pre></div>
                     <div class="topic concept nested2" id="cusparsediagtypet"><a name="cusparsediagtypet" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparsediagtypet" name="cusparsediagtypet" shape="rect">4.6.1.&nbsp;cusparseDiagType_t</a></h3>
                        <div class="body conbody">
                           <p class="p">This type indicates if the matrix diagonal entries are unity. The diagonal elements are always
                              assumed to be present, but if <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> is passed to an API routine,
                              then the routine assumes that all diagonal entries are unity and will not read or modify those
                              entries. Note that in this case the routine assumes the diagonal entries are equal to one,
                              regardless of what those entries are actually set to in memory.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <thead class="thead" align="left">
                                    <tr class="row">
                                       <th class="entry" valign="top" width="50%" id="d54e10595" rowspan="1" colspan="1">
                                          Value
                                          
                                       </th>
                                       <th class="entry" valign="top" width="50%" id="d54e10598" rowspan="1" colspan="1">
                                          Meaning
                                          
                                       </th>
                                    </tr>
                                 </thead>
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10595" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10598" rowspan="1" colspan="1">
                                          <p class="p">the matrix diagonal has non-unit elements.</p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10595" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10598" rowspan="1" colspan="1">
                                          <p class="p">the matrix diagonal has unit elements.</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparsefillmodet"><a name="cusparsefillmodet" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparsefillmodet" name="cusparsefillmodet" shape="rect">4.6.2.&nbsp;cusparseFillMode_t</a></h3>
                        <div class="body conbody">
                           <p class="p">This type indicates if the lower or upper part of a matrix is stored in sparse storage.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <thead class="thead" align="left">
                                    <tr class="row">
                                       <th class="entry" valign="top" width="50%" id="d54e10664" rowspan="1" colspan="1">
                                          Value
                                          
                                       </th>
                                       <th class="entry" valign="top" width="50%" id="d54e10667" rowspan="1" colspan="1">
                                          Meaning
                                          
                                       </th>
                                    </tr>
                                 </thead>
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10664" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_FILL_MODE_LOWER</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10667" rowspan="1" colspan="1">
                                          <p class="p">the lower triangular part is stored.</p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10664" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_FILL_MODE_UPPER</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10667" rowspan="1" colspan="1">
                                          <p class="p">the upper triangular part is stored.</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparseindexbaset"><a name="cusparseindexbaset" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparseindexbaset" name="cusparseindexbaset" shape="rect">4.6.3.&nbsp;cusparseIndexBase_t</a></h3>
                        <div class="body conbody">
                           <p class="p">This type indicates if the base of the matrix indices is zero or one.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <thead class="thead" align="left">
                                    <tr class="row">
                                       <th class="entry" valign="top" width="50%" id="d54e10733" rowspan="1" colspan="1">
                                          Value
                                          
                                       </th>
                                       <th class="entry" valign="top" width="50%" id="d54e10736" rowspan="1" colspan="1">
                                          Meaning
                                          
                                       </th>
                                    </tr>
                                 </thead>
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10733" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10736" rowspan="1" colspan="1">
                                          <p class="p">the base index is zero.</p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10733" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10736" rowspan="1" colspan="1">
                                          <p class="p">the base index is one.</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparsematrixtypet"><a name="cusparsematrixtypet" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparsematrixtypet" name="cusparsematrixtypet" shape="rect">4.6.4.&nbsp;cusparseMatrixType_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              This type indicates the type of matrix stored in sparse storage. 
                              Notice that for symmetric, Hermitian and triangular matrices only their lower or upper part is assumed to be stored.
                              
                           </p>
                           <p class="p">
                              The whole idea of matrix type and fill mode is to keep minimum storage for symmetric/Hermitian matrix, and 
                              also to take advantage of symmetric property on SpMV (Sparse Matrix Vector multiplication). 
                              To compute <samp class="ph codeph">y=A*x</samp> when <samp class="ph codeph">A</samp> is symmetric and only lower triangular part is stored,
                              two steps are needed. 
                              First step is to compute <samp class="ph codeph">y=(L+D)*x</samp> and second step is to compute <samp class="ph codeph">y=L^T*x + y</samp>. 
                              Given the fact that the transpose operation <samp class="ph codeph">y=L^T*x</samp> is 10x slower than 
                              non-transpose version <samp class="ph codeph">y=L*x</samp>,
                              the symmetric property does not show up any performance gain. 
                              It is better for the user to extend the symmetric matrix to a general matrix and apply <samp class="ph codeph">y=A*x</samp>
                              with matrix type <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              
                           </p>
                           <p class="p">
                              In general, SpMV, preconditioners (incomplete Cholesky or incomplete LU) and triangular solver are combined together 
                              in iterative solvers, for example PCG and GMRES.
                              If the user always uses general matrix (instead of symmetric matrix), there is no need to support other than 
                              general matrix in preconditioners. 
                              Therefore the new routines, <samp class="ph codeph">[bsr|csr]sv2</samp> (triangular solver), 
                              <samp class="ph codeph">[bsr|csr]ilu02</samp> (incomplete LU) and 
                              <samp class="ph codeph">[bsr|csr]ic02</samp> (incomplete Cholesky), only support matrix type <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <thead class="thead" align="left">
                                    <tr class="row">
                                       <th class="entry" valign="top" width="50%" id="d54e10846" rowspan="1" colspan="1">
                                          Value
                                          
                                       </th>
                                       <th class="entry" valign="top" width="50%" id="d54e10849" rowspan="1" colspan="1">
                                          Meaning
                                          
                                       </th>
                                    </tr>
                                 </thead>
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10846" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10849" rowspan="1" colspan="1">
                                          <p class="p">the matrix is general.</p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10846" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_MATRIX_TYPE_SYMMETRIC</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10849" rowspan="1" colspan="1">
                                          <p class="p">the matrix is symmetric.</p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10846" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_MATRIX_TYPE_HERMITIAN</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10849" rowspan="1" colspan="1">
                                          <p class="p">the matrix is Hermitian.</p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e10846" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_MATRIX_TYPE_TRIANGULAR</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e10849" rowspan="1" colspan="1">
                                          <p class="p">the matrix is triangular.</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparseoperationt"><a name="cusparseoperationt" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparseoperationt" name="cusparseoperationt" shape="rect">4.7.&nbsp;cusparseOperation_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This type indicates which operations need to be performed with the sparse matrix.</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <thead class="thead" align="left">
                                 <tr class="row">
                                    <th class="entry" valign="top" width="50%" id="d54e10947" rowspan="1" colspan="1">
                                       Value
                                       
                                    </th>
                                    <th class="entry" valign="top" width="50%" id="d54e10950" rowspan="1" colspan="1">
                                       Meaning
                                       
                                    </th>
                                 </tr>
                              </thead>
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e10947" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e10950" rowspan="1" colspan="1">
                                       <p class="p">the non-transpose operation is selected.</p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e10947" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_OPERATION_TRANSPOSE</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e10950" rowspan="1" colspan="1">
                                       <p class="p">the transpose operation is selected.</p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e10947" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e10950" rowspan="1" colspan="1">
                                       <p class="p"></p>
                                       <p class="p"></p>
                                       <p class="p">the conjugate transpose operation is selected.</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsepointermode_t"><a name="cusparsepointermode_t" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsepointermode_t" name="cusparsepointermode_t" shape="rect">4.8.&nbsp;cusparsePointerMode_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This type indicates whether the scalar values are passed by reference on the host or device. It is important to point out
                           that if several scalar values are passed by reference in the function call, all of them will conform to the same single pointer
                           mode. The pointer mode can be set and retrieved using <samp class="ph codeph">cusparseSetPointerMode()</samp> and <samp class="ph codeph">cusparseGetPointerMode()</samp> routines, respectively.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <thead class="thead" align="left">
                                 <tr class="row">
                                    <th class="entry" valign="top" width="50%" id="d54e11041" rowspan="1" colspan="1">
                                       Value
                                       
                                    </th>
                                    <th class="entry" valign="top" width="50%" id="d54e11044" rowspan="1" colspan="1">
                                       Meaning
                                       
                                    </th>
                                 </tr>
                              </thead>
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e11041" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_POINTER_MODE_HOST</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e11044" rowspan="1" colspan="1">
                                       <p class="p">the scalars are passed by reference on the host.</p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e11041" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_POINTER_MODE_DEVICE</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e11044" rowspan="1" colspan="1">
                                       <p class="p">the scalars are passed by reference on the device.</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsealgmode_t"><a name="cusparsealgmode_t" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsealgmode_t" name="cusparsealgmode_t" shape="rect">4.9.&nbsp;cusparseAlgMode_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is type for algorithm parameter to cusparseCsrmvEx() and cusparseCsrmvEx_bufferSize() functions. Note that previously
                           defined values <samp class="ph codeph">CUSPARSE_ALG0</samp> (for naive algorithm) and <samp class="ph codeph">CUSPARSE_ALG1</samp> (for merge path algorithm) are deprecated and replaced by named aliases specified below.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <thead class="thead" align="left">
                                 <tr class="row">
                                    <th class="entry" valign="top" width="50%" id="d54e11116" rowspan="1" colspan="1">
                                       Value
                                       
                                    </th>
                                    <th class="entry" valign="top" width="50%" id="d54e11119" rowspan="1" colspan="1">
                                       Meaning
                                       
                                    </th>
                                 </tr>
                              </thead>
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e11116" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_ALG_NAIVE</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e11119" rowspan="1" colspan="1">
                                       <p class="p">Use default naive algorithm.</p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e11116" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_ALG_MERGE_PATH</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e11119" rowspan="1" colspan="1">
                                       <p class="p">Use load-balancing algorithm that suits better for irregular nonzero-patterns.</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsesolvepolicy_t"><a name="cusparsesolvepolicy_t" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsesolvepolicy_t" name="cusparsesolvepolicy_t" shape="rect">4.10.&nbsp;cusparseSolvePolicy_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This type indicates whether level information is generated and used in 
                           <samp class="ph codeph">csrsv2, csric02, csrilu02, bsrsv2, bsric02 and bsrilu02</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <thead class="thead" align="left">
                                 <tr class="row">
                                    <th class="entry" valign="top" width="50%" id="d54e11188" rowspan="1" colspan="1">
                                       Value
                                       
                                    </th>
                                    <th class="entry" valign="top" width="50%" id="d54e11191" rowspan="1" colspan="1">
                                       Meaning
                                       
                                    </th>
                                 </tr>
                              </thead>
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e11188" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e11191" rowspan="1" colspan="1">
                                       <p class="p">no level information is generated and used.</p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" headers="d54e11188" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp></p>
                                    </td>
                                    <td class="entry" valign="top" width="50%" headers="d54e11191" rowspan="1" colspan="1">
                                       <p class="p">generate and use level information.</p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsesolveanalysisinfot"><a name="cusparsesolveanalysisinfot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsesolveanalysisinfot" name="cusparsesolveanalysisinfot" shape="rect">4.11.&nbsp;cusparseSolveAnalysisInfo_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a pointer type to an opaque structure holding the information collected in the analysis phase of the solution of the
                           sparse triangular linear system. It is expected to be passed unchanged to the solution phase of the sparse triangular linear
                           system.
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="unique_1799085396"><a name="unique_1799085396" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#unique_1799085396" name="unique_1799085396" shape="rect">cusparseSolveAnalysisInfo_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a pointer type to an opaque structure holding the information collected in the analysis phase of the solution of the
                           sparse triangular linear system. It is expected to be passed unchanged to the solution phase of the sparse triangular linear
                           system.
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="csrsv2infot"><a name="csrsv2infot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#csrsv2infot" name="csrsv2infot" shape="rect">4.13.&nbsp;csrsv2Info_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a pointer type to an opaque structure holding the information used in
                           <samp class="ph codeph">csrsv2_bufferSize()</samp>, <samp class="ph codeph">csrsv2_analysis()</samp>, and
                           <samp class="ph codeph">csrsv2_solve()</samp>. 
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="csrsm2infot"><a name="csrsm2infot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#csrsm2infot" name="csrsm2infot" shape="rect">4.14.&nbsp;csrsm2Info_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a pointer type to an opaque structure holding the information used in
                           <samp class="ph codeph">csrsm2_bufferSize()</samp>, <samp class="ph codeph">csrsm2_analysis()</samp>, and
                           <samp class="ph codeph">csrsm2_solve()</samp>. 
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="csric02infot"><a name="csric02infot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#csric02infot" name="csric02infot" shape="rect">4.15.&nbsp;csric02Info_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a pointer type to an opaque structure holding the information used in
                           <samp class="ph codeph">csric02_bufferSize()</samp>, <samp class="ph codeph">csric02_analysis()</samp>, and
                           <samp class="ph codeph">csric02()</samp>. 
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="csrilu02infot"><a name="csrilu02infot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#csrilu02infot" name="csrilu02infot" shape="rect">4.16.&nbsp;csrilu02Info_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a pointer type to an opaque structure holding the information used in
                           <samp class="ph codeph">csrilu02_bufferSize()</samp>, <samp class="ph codeph">csrilu02_analysis()</samp>, and
                           <samp class="ph codeph">csrilu02()</samp>. 
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="bsrsv2infot"><a name="bsrsv2infot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#bsrsv2infot" name="bsrsv2infot" shape="rect">4.17.&nbsp;bsrsv2Info_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a pointer type to an opaque structure holding the information used in
                           <samp class="ph codeph">bsrsv2_bufferSize()</samp>, <samp class="ph codeph">bsrsv2_analysis()</samp>, and
                           <samp class="ph codeph">bsrsv2_solve()</samp>. 
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="bsrsvminfot"><a name="bsrsvminfot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#bsrsvminfot" name="bsrsvminfot" shape="rect">bsrsm2Info_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a pointer type to an opaque structure holding the information used in
                           <samp class="ph codeph">bsrsm2_bufferSize()</samp>, <samp class="ph codeph">bsrsm2_analysis()</samp>, and
                           <samp class="ph codeph">bsrsm2_solve()</samp>. 
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="bsric02infot"><a name="bsric02infot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#bsric02infot" name="bsric02infot" shape="rect">4.19.&nbsp;bsric02Info_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a pointer type to an opaque structure holding the information used in
                           <samp class="ph codeph">bsric02_bufferSize()</samp>, <samp class="ph codeph">bsric02_analysis()</samp>, and
                           <samp class="ph codeph">bsric02()</samp>. 
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="bsrilu02infot"><a name="bsrilu02infot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#bsrilu02infot" name="bsrilu02infot" shape="rect">4.20.&nbsp;bsrilu02Info_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a pointer type to an opaque structure holding the information used in
                           <samp class="ph codeph">bsrilu02_bufferSize()</samp>, <samp class="ph codeph">bsrilu02_analysis()</samp>, and
                           <samp class="ph codeph">bsrilu02()</samp>. 
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="csrgemm2infot"><a name="csrgemm2infot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#csrgemm2infot" name="csrgemm2infot" shape="rect">4.21.&nbsp;csrgemm2Info_t</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This is a pointer type to an opaque structure holding the information used in
                           <samp class="ph codeph">csrgemm2_bufferSizeExt()</samp>, and <samp class="ph codeph">csrgemm2()</samp>. 
                           
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsestatust"><a name="cusparsestatust" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsestatust" name="cusparsestatust" shape="rect">4.22.&nbsp;cusparseStatus_t</a></h3>
                     <div class="body conbody">
                        <p class="p">This is a status type returned by the library functions and it can have the following values.</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                       <p class="p"></p>
                                       <p class="p"></p>
                                       <p class="p">The operation completed successfully.</p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                       <p class="p"></p>
                                       <p class="p"></p>
                                       <p class="p">The cuSPARSE library was not initialized. This is usually caused by the lack of a prior call, an error in the CUDA Runtime
                                          API called by the cuSPARSE routine, or an error in the hardware setup.
                                       </p>
                                       <p class="p"><strong class="ph b">To correct:</strong> call <samp class="ph codeph">cusparseCreate()</samp> prior to the function call; and check that the hardware, an appropriate version of the driver, and the cuSPARSE library are
                                          correctly installed.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                       <p class="p"></p>
                                       <p class="p"></p>
                                       <p class="p">Resource allocation failed inside the cuSPARSE library. This is usually caused by a <samp class="ph codeph">cudaMalloc()</samp> failure.
                                       </p>
                                       <p class="p"><strong class="ph b">To correct:</strong> prior to the function call, deallocate previously allocated memory as much as possible.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                       <p class="p"></p>
                                       <p class="p"></p>
                                       <p class="p">An unsupported value or parameter was passed to the function (a negative vector size, for example).</p>
                                       <p class="p"><strong class="ph b">To correct:</strong> ensure that all the parameters being passed have valid values.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                       <p class="p"></p>
                                       <p class="p"></p>
                                       <p class="p">The function requires a feature absent from the device architecture; usually caused by the lack of support for atomic operations
                                          or double precision.
                                       </p>
                                       <p class="p"><strong class="ph b">To correct:</strong> compile and run the application on a device with appropriate compute capability, which is 1.1 for 32-bit atomic operations
                                          and 1.3 for double precision.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MAPPING_ERROR</samp></td>
                                    <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                       <p class="p"></p>
                                       <p class="p"></p>
                                       <p class="p">An access to GPU memory space failed, which is usually caused by a failure to bind a texture.</p>
                                       <p class="p"><strong class="ph b">To correct:</strong> prior to the function call, unbind any previously bound textures.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                       <p class="p"></p>
                                       <p class="p"></p>
                                       <p class="p">The GPU program failed to execute. This is often caused by a launch failure of the kernel on the GPU, which can be caused
                                          by multiple reasons.
                                       </p>
                                       <p class="p"><strong class="ph b">To correct:</strong> check that the hardware, an appropriate version of the driver, and the cuSPARSE library are correctly installed.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                       <p class="p"></p>
                                       <p class="p"></p>
                                       <p class="p">An internal cuSPARSE operation failed. This error is usually caused by a <samp class="ph codeph">cudaMemcpyAsync()
                                             </samp> failure.
                                       </p>
                                       <p class="p"><strong class="ph b">To correct:</strong> check that the hardware, an appropriate version of the driver, and the cuSPARSE library are correctly installed. Also, check
                                          that the memory passed as a parameter to the routine is not being deallocated prior to the routine’s completion.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                       <p class="p"></p>
                                       <p class="p"></p>
                                       <p class="p">The matrix type is not supported by this function. This is usually caused by passing an invalid matrix descriptor to the function.</p>
                                       <p class="p"><strong class="ph b">To correct:</strong> check that the fields in <samp class="ph codeph">cusparseMatDescr_t descrA</samp> were set correctly.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusparse-helper-function-reference"><a name="cusparse-helper-function-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusparse-helper-function-reference" name="cusparse-helper-function-reference" shape="rect">5.&nbsp;cuSPARSE Helper Function Reference</a></h2>
                  <div class="body conbody">
                     <p class="p">The cuSPARSE helper functions are described in this section.</p>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreate"><a name="cusparsecreate" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreate" name="cusparsecreate" shape="rect">5.1.&nbsp;cusparseCreate()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseCreate(cusparseHandle_t *handle)</pre><p class="p">This function initializes the cuSPARSE library and creates a handle on the cuSPARSE context. It must be called before any
                           other cuSPARSE API function is invoked. It allocates hardware resources necessary for accessing the GPU.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the handle to the cuSPARSE context.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the initialization succeeded.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the CUDA Runtime initialization failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device compute capability (CC) is less than 1.1. The CC of at least 1.1 is required.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreatesolveanalysisinfo"><a name="cusparsecreatesolveanalysisinfo" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreatesolveanalysisinfo" name="cusparsecreatesolveanalysisinfo" shape="rect">5.5.&nbsp;cusparseCreateSolveAnalysisInfo()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseCreateSolveAnalysisInfo(cusparseSolveAnalysisInfo_t *info)</pre><p class="p">This function creates and initializes the solve and analysis structure to <em class="ph i">default</em> values.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the solve and analysis structure.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreatehybmat"><a name="cusparsecreatehybmat" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreatehybmat" name="cusparsecreatehybmat" shape="rect">5.3.&nbsp;cusparseCreateHybMat()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseCreateHybMat(cusparseHybMat_t *hybA)</pre><p class="p">This function creates and initializes the <samp class="ph codeph">hybA</samp> opaque data structure.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">hybA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the hybrid format storage structure.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreatematdescr"><a name="cusparsecreatematdescr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreatematdescr" name="cusparsecreatematdescr" shape="rect">5.4.&nbsp;cusparseCreateMatDescr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseCreateMatDescr(cusparseMatDescr_t *descrA)</pre><p class="p">This function initializes the matrix descriptor. It sets the fields <samp class="ph codeph">MatrixType</samp> and <samp class="ph codeph">IndexBase</samp> to the <em class="ph i">default</em> values <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> , respectively, while leaving other fields uninitialized.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the matrix descriptor.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="unique_1860986088"><a name="unique_1860986088" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#unique_1860986088" name="unique_1860986088" shape="rect">cusparseCreateSolveAnalysisInfo()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseCreateSolveAnalysisInfo(cusparseSolveAnalysisInfo_t *info)</pre><p class="p">This function creates and initializes the solve and analysis structure to <em class="ph i">default</em> values.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the solve and analysis structure.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroy"><a name="cusparsedestroy" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroy" name="cusparsedestroy" shape="rect">5.6.&nbsp;cusparseDestroy()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseDestroy(cusparseHandle_t handle)</pre><p class="p">This function releases CPU-side resources used by the cuSPARSE library. The release of GPU-side resources may be deferred
                           until the application shuts down.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the handle to the cuSPARSE context.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the shutdown succeeded.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroysolveanalysisinfo"><a name="cusparsedestroysolveanalysisinfo" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroysolveanalysisinfo" name="cusparsedestroysolveanalysisinfo" shape="rect">5.10.&nbsp;cusparseDestroySolveAnalysisInfo()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseDestroySolveAnalysisInfo(cusparseSolveAnalysisInfo_t info)</pre><p class="p">This function destroys and releases any memory required by the structure.</p>
                        <p class="p"><strong class="ph b">Input</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the solve and analysis structure.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><strong class="ph b">Status Returened</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroyhybmat"><a name="cusparsedestroyhybmat" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroyhybmat" name="cusparsedestroyhybmat" shape="rect">5.8.&nbsp;cusparseDestroyHybMat()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseDestroyHybMat(cusparseHybMat_t hybA)
</pre><p class="p">This function destroys and releases any memory required by the <samp class="ph codeph">hybA</samp> structure.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">hybA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the hybrid format storage structure.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroymatdescr"><a name="cusparsedestroymatdescr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroymatdescr" name="cusparsedestroymatdescr" shape="rect">5.9.&nbsp;cusparseDestroyMatDescr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseDestroyMatDescr(cusparseMatDescr_t descrA)
</pre><p class="p">This function releases the memory allocated for the matrix descriptor.</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix descriptor.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="unique_1747662931"><a name="unique_1747662931" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#unique_1747662931" name="unique_1747662931" shape="rect">cusparseDestroySolveAnalysisInfo()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseDestroySolveAnalysisInfo(cusparseSolveAnalysisInfo_t info)</pre><p class="p">This function destroys and releases any memory required by the structure.</p>
                        <p class="p"><strong class="ph b">Input</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the solve and analysis structure.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><strong class="ph b">Status Returened</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsegetlevelinfo"><a name="cusparsegetlevelinfo" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsegetlevelinfo" name="cusparsegetlevelinfo" shape="rect">5.11.&nbsp;cusparseGetLevelInfo()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseGetLevelInfo(cusparseHandle_t handle, 
                     cusparseSolveAnalysisInfo_t info, 
                     int *nlevels, 
                     int **levelPtr, 
                     int **levelInd)</pre><p class="p">This function returns the number of levels and the assignment of rows into the levels computed by either the csrsv_analysis,
                           csrsm_analysis or hybsv_analysis routines.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the solve and analysis structure.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nlevels</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of levels.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">levelPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nlevels+1</samp> elements that contains the start of every level and the end of the last level plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">levelInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of	<samp class="ph codeph">m</samp> (number of rows in the matrix) elements that contains the row indices belonging to every level.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library or the solve analysis structure was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsegetmatdiagtype"><a name="cusparsegetmatdiagtype" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsegetmatdiagtype" name="cusparsegetmatdiagtype" shape="rect">5.12.&nbsp;cusparseGetMatDiagType()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseDiagType_t
cusparseGetMatDiagType(const cusparseMatDescr_t descrA)
</pre><p class="p">This function returns the <samp class="ph codeph">DiagType</samp> field of the matrix descriptor <samp class="ph codeph">descrA</samp>.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix descriptor.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph"></samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">One of the enumerated diagType types.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsegetmatfillmode"><a name="cusparsegetmatfillmode" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsegetmatfillmode" name="cusparsegetmatfillmode" shape="rect">5.13.&nbsp;cusparseGetMatFillMode()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseFillMode_t
cusparseGetMatFillMode(const cusparseMatDescr_t descrA)
</pre><p class="p">This function returns the <samp class="ph codeph">FillMode</samp> field of the matrix descriptor <samp class="ph codeph">descrA</samp>.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix descriptor.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph"></samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">One of the enumerated fillMode types.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsegetmatindexbase"><a name="cusparsegetmatindexbase" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsegetmatindexbase" name="cusparsegetmatindexbase" shape="rect">5.14.&nbsp;cusparseGetMatIndexBase()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseIndexBase_t
cusparseGetMatIndexBase(const cusparseMatDescr_t descrA)
</pre><p class="p">This function returns the <samp class="ph codeph">IndexBase</samp> field of the matrix descriptor <samp class="ph codeph">descrA</samp>.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix descriptor.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph"></samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">One of the enumerated indexBase types.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsegetmattype"><a name="cusparsegetmattype" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsegetmattype" name="cusparsegetmattype" shape="rect">5.15.&nbsp;cusparseGetMatType()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseMatrixType_t
cusparseGetMatType(const cusparseMatDescr_t descrA)
</pre><p class="p">This function returns the <samp class="ph codeph">MatrixType</samp> field of the matrix descriptor <samp class="ph codeph">descrA</samp>.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix descriptor.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph"></samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">One of the enumerated matrix types.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsegetpointermode"><a name="cusparsegetpointermode" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsegetpointermode" name="cusparsegetpointermode" shape="rect">5.16.&nbsp;cusparseGetPointerMode()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseGetPointerMode(cusparseHandlet handle, 
                       cusparsePointerMode_t *mode)
</pre><p class="p">This function obtains the pointer mode used by the cuSPARSE library. Please see the section on the <samp class="ph codeph">cusparsePointerMode_t</samp> type for more details.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the handle to the cuSPARSE context.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mode</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">One of the enumerated pointer mode types.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer mode was returned successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsegetversion"><a name="cusparsegetversion" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsegetversion" name="cusparsegetversion" shape="rect">5.17.&nbsp;cusparseGetVersion()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseGetVersion(cusparseHandle_t handle, int *version)
</pre><p class="p">This function returns the version number of the cuSPARSE library.</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the handle to the cuSPARSE context.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">version</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the version number of the library.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the version was returned successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsesetmatdiagtype"><a name="cusparsesetmatdiagtype" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsesetmatdiagtype" name="cusparsesetmatdiagtype" shape="rect">5.18.&nbsp;cusparseSetMatDiagType()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseSetMatDiagType(cusparseMatDescr_t descrA, 
                       cusparseDiagType_t diagType)
</pre><p class="p">This function sets the <samp class="ph codeph">DiagType</samp> field of the matrix descriptor <samp class="ph codeph">descrA</samp>.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">diagType</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">One of the enumerated diagType types.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix descriptor.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the field <samp class="ph codeph">DiagType</samp> was set successfully.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">An invalid <samp class="ph codeph">diagType</samp> parameter was passed.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsesetmatfillmode"><a name="cusparsesetmatfillmode" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsesetmatfillmode" name="cusparsesetmatfillmode" shape="rect">5.19.&nbsp;cusparseSetMatFillMode()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseSetMatFillMode(cusparseMatDescr_t descrA, 
                       cusparseFillMode_t fillMode)
</pre><p class="p">This function sets the <samp class="ph codeph">FillMode</samp> field of the matrix descriptor <samp class="ph codeph">descrA</samp>.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">fillMode</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">One of the enumerated fillMode types.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix descriptor.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the <samp class="ph codeph">FillMode</samp> field was set successfully.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">An invalid <samp class="ph codeph">fillMode</samp> parameter was passed.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsesetmatindexbase"><a name="cusparsesetmatindexbase" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsesetmatindexbase" name="cusparsesetmatindexbase" shape="rect">5.20.&nbsp;cusparseSetMatIndexBase()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseSetMatIndexBase(cusparseMatDescr_t descrA, 
                        cusparseIndexBase_t base)
</pre><p class="p">This function sets the <samp class="ph codeph">IndexBase</samp> field of the matrix descriptor <samp class="ph codeph">descrA</samp>.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">base</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">One of the enumerated indexBase types.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix descriptor.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the <samp class="ph codeph">IndexBase</samp> field was set successfully.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">An invalid <samp class="ph codeph">base</samp> parameter was passed.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsesetmattype"><a name="cusparsesetmattype" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsesetmattype" name="cusparsesetmattype" shape="rect">5.21.&nbsp;cusparseSetMatType()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseSetMatType(cusparseMatDescr_t descrA, cusparseMatrixType_t type)
</pre><p class="p">This function sets the <samp class="ph codeph">MatrixType</samp> field of the matrix descriptor <samp class="ph codeph">descrA</samp>.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">type</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">One of the enumerated matrix types.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix descriptor.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the <samp class="ph codeph">MatrixType</samp> field was set successfully.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">An invalid <samp class="ph codeph">type</samp> parameter was passed.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsesetpointermode"><a name="cusparsesetpointermode" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsesetpointermode" name="cusparsesetpointermode" shape="rect">5.22.&nbsp;cusparseSetPointerMode()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseSetPointerMode(cusparseHandle_t handle, 
                       cusparsePointerMode_t mode)
</pre><p class="p">This function sets the pointer mode used by the cuSPARSE library. The <em class="ph i">default</em> is for the values to be passed by reference on the host. Please see the section on the <samp class="ph codeph">cublasPointerMode_t</samp> type for more details.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the handle to the cuSPARSE context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mode</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">One of the enumerated pointer mode types.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer mode was set successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsesetstream"><a name="cusparsesetstream" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsesetstream" name="cusparsesetstream" shape="rect">5.23.&nbsp;cusparseSetStream()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseSetStream(cusparseHandle_t handle, cudaStream_t streamId)
</pre><p class="p">This function sets the stream to be used by the cuSPARSE library to execute its routines.</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the handle to the cuSPARSE context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">streamId</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the stream to be used by the library.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the stream was set successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsegetstream"><a name="cusparsegetstream" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsegetstream" name="cusparsegetstream" shape="rect">5.24.&nbsp;cusparseGetStream()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseGetStream(cusparseHandle_t handle, cudaStream_t *streamId)
</pre><p class="p">This function gets the cuSPARSE library stream, which is being used to to execute 
                           all calls to the cuSPARSE library functions.
                           If the cuSPARSE library stream is not set, all kernels use the default NULL stream.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the handle to the cuSPARSE context.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">streamId</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the stream to be used by the library.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the stream was returned successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreateCsrsv2info"><a name="cusparsecreateCsrsv2info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreateCsrsv2info" name="cusparsecreateCsrsv2info" shape="rect">5.25.&nbsp;cusparseCreateCsrsv2Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseCreateCsrsv2Info(csrsv2Info_t *info);
</pre><p class="p">This function creates and initializes the solve and analysis structure of csrsv2 to <em class="ph i">default</em> values.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the solve and analysis structure of csrsv2.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroyCsrsv2info"><a name="cusparsedestroyCsrsv2info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroyCsrsv2info" name="cusparsedestroyCsrsv2info" shape="rect">5.26.&nbsp;cusparseDestroyCsrsv2Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseDestroyCsrsv2Info(csrsv2Info_t info);
</pre><p class="p">This function destroys and releases any memory required by the structure.</p>
                        <p class="p"><strong class="ph b">Input</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the solve <samp class="ph codeph">(csrsv2_solve)</samp> and analysis <samp class="ph codeph">(csrsv2_analysis)</samp> structure.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><strong class="ph b">Status Returened</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreateCsrsm2info"><a name="cusparsecreateCsrsm2info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreateCsrsm2info" name="cusparsecreateCsrsm2info" shape="rect">5.27.&nbsp;cusparseCreateCsrsm2Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseCreateCsrsm2Info(csrsm2Info_t *info);
</pre><p class="p">This function creates and initializes the solve and analysis structure of csrsm2 to <em class="ph i">default</em> values.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the solve and analysis structure of csrsm2.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroyCsrsm2info"><a name="cusparsedestroyCsrsm2info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroyCsrsm2info" name="cusparsedestroyCsrsm2info" shape="rect">5.28.&nbsp;cusparseDestroyCsrsm2Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseDestroyCsrsm2Info(csrsm2Info_t info);
</pre><p class="p">This function destroys and releases any memory required by the structure.</p>
                        <p class="p"><strong class="ph b">Input</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the solve <samp class="ph codeph">(csrsm2_solve)</samp> and analysis <samp class="ph codeph">(csrsm2_analysis)</samp> structure.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><strong class="ph b">Status Returened</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreateCsric02info"><a name="cusparsecreateCsric02info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreateCsric02info" name="cusparsecreateCsric02info" shape="rect">5.29.&nbsp;cusparseCreateCsric02Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseCreateCsric02Info(csric02Info_t *info);
</pre><p class="p">This function creates and initializes the solve and analysis structure of incomplete Cholesky to <em class="ph i">default</em> values.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the solve and analysis structure of incomplete Cholesky.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroyCsric02info"><a name="cusparsedestroyCsric02info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroyCsric02info" name="cusparsedestroyCsric02info" shape="rect">5.30.&nbsp;cusparseDestroyCsric02Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseDestroyCsric02Info(csric02Info_t info);
</pre><p class="p">This function destroys and releases any memory required by the structure.</p>
                        <p class="p"><strong class="ph b">Input</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the solve <samp class="ph codeph">(csric02_solve)</samp> and analysis <samp class="ph codeph">(csric02_analysis)</samp> structure.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><strong class="ph b">Status Returened</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreateCsrilu02info"><a name="cusparsecreateCsrilu02info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreateCsrilu02info" name="cusparsecreateCsrilu02info" shape="rect">5.31.&nbsp;cusparseCreateCsrilu02Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseCreateCsrilu02Info(csrilu02Info_t *info);
</pre><p class="p">This function creates and initializes the solve and analysis structure of incomplete LU to <em class="ph i">default</em> values.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the solve and analysis structure of incomplete LU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroyCsrilu02info"><a name="cusparsedestroyCsrilu02info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroyCsrilu02info" name="cusparsedestroyCsrilu02info" shape="rect">5.32.&nbsp;cusparseDestroyCsrilu02Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseDestroyCsrilu02Info(csrilu02Info_t info);
</pre><p class="p">This function destroys and releases any memory required by the structure.</p>
                        <p class="p"><strong class="ph b">Input</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the solve <samp class="ph codeph">(csrilu02_solve)</samp> and analysis <samp class="ph codeph">(csrilu02_analysis)</samp> structure.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><strong class="ph b">Status Returened</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreateBsrsv2info"><a name="cusparsecreateBsrsv2info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreateBsrsv2info" name="cusparsecreateBsrsv2info" shape="rect">5.33.&nbsp;cusparseCreateBsrsv2Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseCreateBsrsv2Info(bsrsv2Info_t *info);
</pre><p class="p">This function creates and initializes the solve and analysis structure of bsrsv2 to <em class="ph i">default</em> values.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the solve and analysis structure of bsrsv2.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroyBsrsv2info"><a name="cusparsedestroyBsrsv2info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroyBsrsv2info" name="cusparsedestroyBsrsv2info" shape="rect">5.34.&nbsp;cusparseDestroyBsrsv2Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseDestroyBsrsv2Info(bsrsv2Info_t info);
</pre><p class="p">This function destroys and releases any memory required by the structure.</p>
                        <p class="p"><strong class="ph b">Input</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the solve <samp class="ph codeph">(bsrsv2_solve)</samp> and analysis <samp class="ph codeph">(bsrsv2_analysis)</samp> structure.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><strong class="ph b">Status Returened</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreateBsrsm2info"><a name="cusparsecreateBsrsm2info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreateBsrsm2info" name="cusparsecreateBsrsm2info" shape="rect">5.35.&nbsp;cusparseCreateBsrsm2Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseCreateBsrsm2Info(bsrsm2Info_t *info);
</pre><p class="p">This function creates and initializes the solve and analysis structure of bsrsm2 to <em class="ph i">default</em> values.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the solve and analysis structure of bsrsm2.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroyBsrsm2info"><a name="cusparsedestroyBsrsm2info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroyBsrsm2info" name="cusparsedestroyBsrsm2info" shape="rect">5.36.&nbsp;cusparseDestroyBsrsm2Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseDestroyBsrsm2Info(bsrsm2Info_t info);
</pre><p class="p">This function destroys and releases any memory required by the structure.</p>
                        <p class="p"><strong class="ph b">Input</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the solve <samp class="ph codeph">(bsrsm2_solve)</samp> and analysis <samp class="ph codeph">(bsrsm2_analysis)</samp> structure.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><strong class="ph b">Status Returened</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreateBsric02info"><a name="cusparsecreateBsric02info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreateBsric02info" name="cusparsecreateBsric02info" shape="rect">5.37.&nbsp;cusparseCreateBsric02Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseCreateBsric02Info(bsric02Info_t *info);
</pre><p class="p">
                           This function creates and initializes the solve and analysis structure of 
                           block incomplete Cholesky to <em class="ph i">default</em> values.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the solve and analysis structure of block incomplete Cholesky.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroyBsric02info"><a name="cusparsedestroyBsric02info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroyBsric02info" name="cusparsedestroyBsric02info" shape="rect">5.38.&nbsp;cusparseDestroyBsric02Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseDestroyBsric02Info(bsric02Info_t info);
</pre><p class="p">This function destroys and releases any memory required by the structure.</p>
                        <p class="p"><strong class="ph b">Input</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the solve <samp class="ph codeph">(bsric02_solve)</samp> and analysis <samp class="ph codeph">(bsric02_analysis)</samp> structure.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><strong class="ph b">Status Returened</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreateBsrilu02info"><a name="cusparsecreateBsrilu02info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreateBsrilu02info" name="cusparsecreateBsrilu02info" shape="rect">5.39.&nbsp;cusparseCreateBsrilu02Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseCreateBsrilu02Info(bsrilu02Info_t *info);
</pre><p class="p">
                           This function creates and initializes the solve and analysis structure of 
                           block incomplete LU to <em class="ph i">default</em> values.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the solve and analysis structure of block incomplete LU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroyBsrilu02info"><a name="cusparsedestroyBsrilu02info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroyBsrilu02info" name="cusparsedestroyBsrilu02info" shape="rect">5.40.&nbsp;cusparseDestroyBsrilu02Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseDestroyBsrilu02Info(bsrilu02Info_t info);
</pre><p class="p">This function destroys and releases any memory required by the structure.</p>
                        <p class="p"><strong class="ph b">Input</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the solve <samp class="ph codeph">(bsrilu02_solve)</samp> and analysis <samp class="ph codeph">(bsrilu02_analysis)</samp> structure.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><strong class="ph b">Status Returened</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreateCsrgemm2info"><a name="cusparsecreateCsrgemm2info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreateCsrgemm2info" name="cusparsecreateCsrgemm2info" shape="rect">5.41.&nbsp;cusparseCreateCsrgemm2Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseCreateCsrgemm2Info(csrgemm2Info_t *info);
</pre><p class="p">
                           This function creates and initializes analysis structure of 
                           general sparse matrix-matrix multiplication.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the analysis structure of general sparse matrix-matrix multiplication.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroyCsrgemm2info"><a name="cusparsedestroyCsrgemm2info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroyCsrgemm2info" name="cusparsedestroyCsrgemm2info" shape="rect">5.42.&nbsp;cusparseDestroyCsrgemm2Info()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseDestroyCsrgemm2Info(csrgemm2Info_t info);
</pre><p class="p">This function destroys and releases any memory required by the structure.</p>
                        <p class="p"><strong class="ph b">Input</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">opaque structure of csrgemm2.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><strong class="ph b">Status Returened</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsecreatePruneinfo"><a name="cusparsecreatePruneinfo" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsecreatePruneinfo" name="cusparsecreatePruneinfo" shape="rect">5.43.&nbsp;cusparseCreatePruneInfo()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseCreatePruneInfo(pruneInfo_t *info);
</pre><p class="p">This function creates and initializes structure of <samp class="ph codeph">prune</samp> to <em class="ph i">default</em> values.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the structure of <samp class="ph codeph">prune</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparsedestroyPruneinfo"><a name="cusparsedestroyPruneinfo" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroyPruneinfo" name="cusparsedestroyPruneinfo" shape="rect">5.44.&nbsp;cusparseDestroyPruneInfo()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseDestroyPruneInfo(pruneInfo_t info);
</pre><p class="p">This function destroys and releases any memory required by the structure.</p>
                        <p class="p"><strong class="ph b">Input</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure of <samp class="ph codeph">prune</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><strong class="ph b">Status Returened</strong></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources were released successfully.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusparse-level-1-function-reference"><a name="cusparse-level-1-function-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusparse-level-1-function-reference" name="cusparse-level-1-function-reference" shape="rect">6.&nbsp;cuSPARSE Level 1 Function Reference</a></h2>
                  <div class="body conbody">
                     <p class="p">This chapter describes sparse linear algebra functions that perform operations between dense and sparse vectors.</p>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-axpyi"><a name="cusparse-lt-t-gt-axpyi" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-axpyi" name="cusparse-lt-t-gt-axpyi" shape="rect">6.1.&nbsp;cusparse&lt;t&gt;axpyi()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSaxpyi(cusparseHandle_t handle, int nnz, 
               const float           *alpha, 
               const float           *xVal, const int *xInd, 
               float           *y, cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseDaxpyi(cusparseHandle_t handle, int nnz, 
               const double          *alpha, 
               const double          *xVal, const int *xInd, 
               double          *y, cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseCaxpyi(cusparseHandle_t handle, int nnz, 
               const cuComplex       *alpha, 
               const cuComplex       *xVal, const int *xInd, 
               cuComplex       *y, cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseZaxpyi(cusparseHandle_t handle, int nnz, 
               const cuDoubleComplex *alpha, 
               const cuDoubleComplex *xVal, const int *xInd, 
               cuDoubleComplex *y, cusparseIndexBase_t idxBase)</pre><p class="p">This function multiplies the vector <samp class="ph codeph">x</samp> in sparse format by the constant
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           
                           and adds the result to the vector <samp class="ph codeph">y</samp> in dense format. This operation can be written as
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>y</mi>
                                          <mo>=</mo>
                                          <mi>y</mi>
                                          <mo>+</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mi>x</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">In other words,</p><pre xml:space="preserve">for i=0 to nnz-1
    y[xInd[i]-idxBase] = y[xInd[i]-idxBase] + alpha*xVal[i]</pre><p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host,
                           			and it may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of elements in vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector with <samp class="ph codeph">nnz</samp> nonzero values of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer vector with <samp class="ph codeph">nnz</samp> indices of the nonzero values of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector in dense format.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or
                                       							<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; updated vector in dense format (that is unchanged if <samp class="ph codeph">nnz == 0</samp>).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the <samp class="ph codeph">idxBase</samp> is neither <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> nor <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-doti"><a name="cusparse-lt-t-gt-doti" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-doti" name="cusparse-lt-t-gt-doti" shape="rect">6.2.&nbsp;cusparse&lt;t&gt;doti()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSdoti(cusparseHandle_t handle, int nnz, 
              const float           *xVal, 
              const int *xInd, const float           *y, 
              float           *resultDevHostPtr, 
              cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseDdoti(cusparseHandle_t handle, int nnz, 
              const double          *xVal, 
              const int *xInd, const double          *y, 
              double          *resultDevHostPtr, 
              cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseCdoti(cusparseHandle_t handle, int nnz, 
              const cuComplex       *xVal, 
              const int *xInd, const cuComplex       *y, 
              cuComplex       *resultDevHostPtr, 
              cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseZdoti(cusparseHandle_t handle, int nnz, const 
              cuDoubleComplex *xVal, 
              const int *xInd, const cuDoubleComplex *y, 
              cuDoubleComplex *resultDevHostPtr, 
              cusparseIndexBase_t idxBase)</pre><p class="p">This function returns the dot product of a vector <samp class="ph codeph">x</samp> in sparse format and vector <samp class="ph codeph">y</samp> in dense format. This operation can be written as
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>r</mi>
                                          <mi>e</mi>
                                          <mi>s</mi>
                                          <mi>u</mi>
                                          <mi>l</mi>
                                          <mi>t</mi>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>y</mi>
                                             <mi>T</mi>
                                          </msup>
                                          <mi>x</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">In other words,</p><pre xml:space="preserve">for i=0 to nnz-1
    resultDevHostPtr += xVal[i]*y[xInd[i-idxBase]]
</pre><p class="p">This function requires some temporary extra storage that is allocated internally. It is executed
                           			asynchronously with respect to the host and may return control to the application on the
                           			host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of elements in vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector with <samp class="ph codeph">nnz</samp> nonzero values of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer vector with <samp class="ph codeph">nnz</samp> indices of the nonzero values of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector in dense format.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">resultDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">pointer to the location of the result in the device or host memory.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or
                                       							<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">resultDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">scalar result in the device or host memory (that is zero if <samp class="ph codeph">nnz == 0</samp>).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the reduction buffer could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the <samp class="ph codeph">idxBase</samp> is neither <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> nor <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-dotci"><a name="cusparse-lt-t-gt-dotci" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-dotci" name="cusparse-lt-t-gt-dotci" shape="rect">6.3.&nbsp;cusparse&lt;t&gt;dotci()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseCdotci(cusparseHandle_t handle, int nnz, 
               const cuComplex       *xVal, 
               const int *xInd, const cuComplex       *y, 
               cuComplex       *resultDevHostPtr, cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseZdotci(cusparseHandle_t handle, int nnz, 
               const cuDoubleComplex *xVal, 
               const int *xInd, const cuDoubleComplex *y, 
               cuDoubleComplex *resultDevHostPtr, cusparseIndexBase_t idxBase)</pre><p class="p">This function returns the dot product of a complex conjugate of vector <samp class="ph codeph">x</samp> in sparse format and vector <samp class="ph codeph">y</samp> in dense format. This operation can be written as
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>r</mi>
                                          <mi>e</mi>
                                          <mi>s</mi>
                                          <mi>u</mi>
                                          <mi>l</mi>
                                          <mi>t</mi>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>x</mi>
                                             <mi>H</mi>
                                          </msup>
                                          <mi>y</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">In other words,</p><pre xml:space="preserve">for i=0 to nnz-1
	resultDevHostPtr += <math xmlns="http://www.w3.org/1998/Math/MathML"><mover><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext>xVal[i]</mtext></mrow></mrow><mo accent="false">¯</mo></mover></math>*y[xInd[i-idxBase]]
</pre><p class="p">This function requires some temporary extra storage that is allocated internally. It is executed
                           			asynchronously with respect to the host and may return control to the application on the
                           			host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of elements in vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector with <samp class="ph codeph">nnz</samp> nonzero values of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer vector with <samp class="ph codeph">nnz</samp> indices of the nonzero values of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector in dense format.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">resultDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">pointer to the location of the result in the device or host memory.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or
                                       							<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">resultDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">scalar result in the device or host memory (that is zero if <samp class="ph codeph">nnz == 0</samp>).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the reduction buffer could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the <samp class="ph codeph">idxBase</samp> is neither <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> nor <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-gthr"><a name="cusparse-lt-t-gt-gthr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gthr" name="cusparse-lt-t-gt-gthr" shape="rect">6.4.&nbsp;cusparse&lt;t&gt;gthr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSgthr(cusparseHandle_t handle, int nnz, 
              const float           *y, 
              float           *xVal, const int *xInd, 
              cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseDgthr(cusparseHandle_t handle, int nnz, 
              const double          *y, 
              double          *xVal, const int *xInd, 
              cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseCgthr(cusparseHandle_t handle, int nnz, 
              const cuComplex       *y, 
              cuComplex       *xVal, const int *xInd, 
              cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseZgthr(cusparseHandle_t handle, int nnz, 
              const cuDoubleComplex *y, 
              cuDoubleComplex *xVal, const int *xInd, 
              cusparseIndexBase_t idxBase)</pre><p class="p">This function gathers the elements of the vector <samp class="ph codeph">y</samp> listed in the index array <samp class="ph codeph">xInd</samp> into the data array <samp class="ph codeph">xVal</samp>.
                        </p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host and it may return control
                           to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of elements in vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector in dense format (of <samp class="ph codeph">size≥max(xInd)-idxBase+1</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer vector with <samp class="ph codeph">nnz</samp> indices of the nonzero values of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or
                                       							<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector with <samp class="ph codeph">nnz</samp> nonzero values that were gathered from vector <samp class="ph codeph">y</samp> (that is unchanged if <samp class="ph codeph">nnz == 0</samp>).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the <samp class="ph codeph">idxBase</samp> is neither <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> nor <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-gthrz"><a name="cusparse-lt-t-gt-gthrz" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gthrz" name="cusparse-lt-t-gt-gthrz" shape="rect">6.5.&nbsp;cusparse&lt;t&gt;gthrz()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSgthrz(cusparseHandle_t handle, int nnz, float           *y, 
               float           *xVal, const int *xInd, 
               cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseDgthrz(cusparseHandle_t handle, int nnz, double          *y, 
               double          *xVal, const int *xInd, 
               cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseCgthrz(cusparseHandle_t handle, int nnz, cuComplex       *y, 
               cuComplex       *xVal, const int *xInd, 
               cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseZgthrz(cusparseHandle_t handle, int nnz, cuDoubleComplex *y, 
               cuDoubleComplex *xVal, const int *xInd, 
               cusparseIndexBase_t idxBase)</pre><p class="p">This function gathers the elements of the vector <samp class="ph codeph">y</samp> listed in the index array
                           				<samp class="ph codeph">xInd</samp> into the data array <samp class="ph codeph">xVal</samp>. Also, it zeros out
                           			the gathered elements in the vector <samp class="ph codeph">y</samp>.
                        </p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host,
                           			and it may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of elements in vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector in dense format (of <samp class="ph codeph">size≥max(xInd)-idxBase+1</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer vector with <samp class="ph codeph">nnz</samp> indices of the nonzero values of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or
                                       							<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector with <samp class="ph codeph">nnz</samp> nonzero values that were gathered from vector <samp class="ph codeph">y</samp> (that is unchanged if <samp class="ph codeph">nnz == 0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector in dense format with elements indexed by <samp class="ph codeph">xInd</samp> set to zero (it is unchanged if <samp class="ph codeph">nnz == 0</samp>).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the <samp class="ph codeph">idxBase</samp> is neither <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> nor <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-roti"><a name="cusparse-lt-t-gt-roti" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-roti" name="cusparse-lt-t-gt-roti" shape="rect">6.6.&nbsp;cusparse&lt;t&gt;roti()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSroti(cusparseHandle_t handle, int nnz, float  *xVal, 
              const int *xInd, 
              float  *y, const float  *c, const float  *s, 
              cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseDroti(cusparseHandle_t handle, int nnz, double *xVal, 
              const int *xInd, 
              double *y, const double *c, const double *s, 
              cusparseIndexBase_t idxBase)</pre><p class="p">This function applies the Givens rotation matrix</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>G</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable columnalign="right right" rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>c</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>s</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mo>−</mo>
                                                         <mi>s</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>c</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">to sparse <samp class="ph codeph">x</samp> and dense <samp class="ph codeph">y</samp> vectors. In other words,
                        </p><pre xml:space="preserve">for i=0 to nnz-1
    y[xInd[i]-idxBase] = c * y[xInd[i]-idxBase] - s*xVal[i]
    x[i]               = c * xVal[i]            + s * y[xInd[i]-idxBase]
</pre><div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of elements in vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector with <samp class="ph codeph">nnz</samp> nonzero values of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer vector with <samp class="ph codeph">nnz</samp> indices of the nonzero values of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector in dense format.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">c</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">cosine element of the rotation matrix.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">s</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">sine element of the rotation matrix.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or
                                       							<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; updated vector in sparse format (that is unchanged if <samp class="ph codeph">nnz == 0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; updated vector in dense format (that is unchanged if <samp class="ph codeph">nnz == 0</samp>).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the <samp class="ph codeph">idxBase</samp> is neither <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> nor <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-sctr"><a name="cusparse-lt-t-gt-sctr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-sctr" name="cusparse-lt-t-gt-sctr" shape="rect">6.7.&nbsp;cusparse&lt;t&gt;sctr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSsctr(cusparseHandle_t handle, int nnz, 
              const float           *xVal, 
              const int *xInd, float           *y, 
              cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseDsctr(cusparseHandle_t handle, int nnz, 
              const double          *xVal, 
              const int *xInd, double          *y, 
              cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseCsctr(cusparseHandle_t handle, int nnz, 
              const cuComplex       *xVal, 
              const int *xInd, cuComplex       *y, 
              cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseZsctr(cusparseHandle_t handle, int nnz, 
              const cuDoubleComplex *xVal, 
              const int *xInd, cuDoubleComplex *y, 
              cusparseIndexBase_t idxBase)</pre><p class="p">This function scatters the elements of the vector <samp class="ph codeph">x</samp> in sparse format into the vector <samp class="ph codeph">y</samp> in dense format. It modifies only the elements of <samp class="ph codeph">y</samp> whose indices are listed in the array <samp class="ph codeph">xInd</samp>.
                        </p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host
                           			and may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of elements in vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector with <samp class="ph codeph">nnz</samp> nonzero values of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer vector with <samp class="ph codeph">nnz</samp> indices of the nonzero values of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense vector (of <samp class="ph codeph">size≥max(xInd)-idxBase+1</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or
                                       							<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector with <samp class="ph codeph">nnz</samp> nonzero values that were scattered from vector <samp class="ph codeph">x</samp> (that is unchanged if <samp class="ph codeph">nnz == 0</samp>).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the <samp class="ph codeph">idxBase</samp> is neither <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> nor <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE.</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusparse-level-2-function-reference"><a name="cusparse-level-2-function-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusparse-level-2-function-reference" name="cusparse-level-2-function-reference" shape="rect">7.&nbsp;cuSPARSE Level 2 Function Reference</a></h2>
                  <div class="body conbody">
                     <p class="p">This chapter describes the sparse linear algebra functions that perform operations between sparse matrices and dense vectors.</p>
                     <p class="p">In particular, the solution of sparse triangular linear systems is implemented in two phases. First, during the analysis phase,
                        the sparse triangular matrix is analyzed to determine the dependencies between its elements by calling the appropriate <samp class="ph codeph">csrsv_analysis()</samp> function. The analysis is specific to the sparsity pattern of the given matrix and to the selected <samp class="ph codeph">cusparseOperation_t</samp> type. The information from the analysis phase is stored in the parameter of type <samp class="ph codeph">cusparseSolveAnalysisInfo_t</samp> that has been initialized previously with a call to <samp class="ph codeph">cusparseCreateSolveAnalysisInfo()</samp>.
                     </p>
                     <p class="p">Second, during the solve phase, the given sparse triangular linear system is solved using the
                        information stored in the <samp class="ph codeph">cusparseSolveAnalysisInfo_t</samp> parameter by calling
                        the appropriate <samp class="ph codeph">csrsv_solve()</samp> function. The solve phase may be performed
                        multiple times with different right-hand sides, while the analysis phase needs to be performed
                        only once. This is especially useful when a sparse triangular linear system must be solved for
                        a set of different right-hand sides one at a time, while its coefficient matrix remains the
                        same.
                     </p>
                     <p class="p">Finally, once all the solves have completed, the opaque data structure pointed to by the <samp class="ph codeph">cusparseSolveAnalysisInfo_t</samp> parameter can be released by calling <samp class="ph codeph">cusparseDestroySolveAnalysisInfo()</samp>. For more information please refer to [3].
                     </p>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-bsrmv"><a name="cusparse-lt-t-gt-bsrmv" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrmv" name="cusparse-lt-t-gt-bsrmv" shape="rect">7.1.&nbsp;cusparse&lt;t&gt;bsrmv()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseSbsrmv(cusparseHandle_t handle, cusparseDirection_t dir,
    cusparseOperation_t trans, int mb, int nb, int nnzb,
    const float *alpha, const cusparseMatDescr_t descr,
    const float *bsrVal, const int *bsrRowPtr, const int *bsrColInd,
    int  blockDim, const float *x, 
    const float *beta, float *y)
cusparseStatus_t
cusparseDbsrmv(cusparseHandle_t handle, cusparseDirection_t dir,
    cusparseOperation_t trans, int mb, int nb, int nnzb,
    const double *alpha, const cusparseMatDescr_t descr,
    const double *bsrVal, const int *bsrRowPtr, const int *bsrColInd,
    int  blockDim, const double *x, 
    const double *beta, double *y)
cusparseStatus_t
cusparseCbsrmv(cusparseHandle_t handle, cusparseDirection_t dir,
    cusparseOperation_t trans, int mb, int nb, int nnzb,
    const cuComplex *alpha, const cusparseMatDescr_t descr,
    const cuComplex *bsrVal, const int *bsrRowPtr, const int *bsrColInd,
    int  blockDim, const cuComplex *x, 
    const cuComplex *beta, cuComplex *y)
cusparseStatus_t
cusparseZbsrmv(cusparseHandle_t handle, cusparseDirection_t dir,
    cusparseOperation_t trans, int mb, int nb, int nnzb,
    const cuDoubleComplex *alpha, const cusparseMatDescr_t descr,
    const cuDoubleComplex *bsrVal, const int *bsrRowPtr, const int *bsrColInd,
    int  blockDim, const cuDoubleComplex *x, 
    const cuDoubleComplex *beta, cuDoubleComplex *y)</pre><p class="p">This function performs the matrix-vector operation</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>x</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>+</mo>
                                          <mi>β</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">where 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>A</mi>
                              <mtext>&nbsp;is an &nbsp;</mtext>
                              <mo stretchy="false">(</mo>
                              <mi>m</mi>
                              <mi>b</mi>
                              <mo>∗</mo>
                              <mi>b</mi>
                              <mi>l</mi>
                              <mi>o</mi>
                              <mi>c</mi>
                              <mi>k</mi>
                              <mi>D</mi>
                              <mi>i</mi>
                              <mi>m</mi>
                              <mo stretchy="false">)</mo>
                              <mo>×</mo>
                              <mo stretchy="false">(</mo>
                              <mi>n</mi>
                              <mi>b</mi>
                              <mo>∗</mo>
                              <mi>b</mi>
                              <mi>l</mi>
                              <mi>o</mi>
                              <mi>c</mi>
                              <mi>k</mi>
                              <mi>D</mi>
                              <mi>i</mi>
                              <mi>m</mi>
                              <mo stretchy="false">)</mo>
                           </math>
                           sparse matrix that is defined in BSR storage format by the three arrays
                           <samp class="ph codeph">bsrVal</samp>, <samp class="ph codeph">bsrRowPtr</samp>, and <samp class="ph codeph">bsrColInd</samp>);
                           <samp class="ph codeph">x</samp> and <samp class="ph codeph">y</samp> are vectors; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                              <mtext>&nbsp;and&nbsp;</mtext>
                              <mi>β</mi>
                           </math>
                           are scalars; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <div class="p">Several comments on <samp class="ph codeph">bsrmv()</samp>:<a name="cusparse-lt-t-gt-bsrmv__ul_w14_5wq_nm" shape="rect">
                              <!-- --></a><ul class="ul" id="cusparse-lt-t-gt-bsrmv__ul_w14_5wq_nm">
                              <li class="li">
                                 <p class="p">Only <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> is supported, that is
                                 </p>
                                 <div class="tablenoborder"><a name="cusparse-lt-t-gt-bsrmv__table_gk2_vwq_nm" shape="rect">
                                       <!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="cusparse-lt-t-gt-bsrmv__table_gk2_vwq_nm" class="table" width="90%" frame="void" border="1" rules="all">
                                       <tbody class="tbody">
                                          <tr class="row">
                                             <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                                <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mtext>y</mtext>
                                                      </mrow>
                                                   </mrow>
                                                   <mo>=</mo>
                                                   <mi>α</mi>
                                                   <mo>∗</mo>
                                                   <mi>A</mi>
                                                   <mo>∗</mo>
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mtext>x</mtext>
                                                      </mrow>
                                                   </mrow>
                                                   <mo>+</mo>
                                                   <mi>β</mi>
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mrow class="MJX-TeXAtom-ORD"></mrow>
                                                   </mrow>
                                                   <mo>∗</mo>
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mtext>y</mtext>
                                                      </mrow>
                                                   </mrow>
                                                </math>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </div>
                              </li>
                              <li class="li">Only <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> is supported.
                              </li>
                              <li class="li">
                                 <p class="p">The size of vector <samp class="ph codeph">x</samp> should be 
                                    
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                       <mo stretchy="false">(</mo>
                                       <mi>n</mi>
                                       <mi>b</mi>
                                       <mo>∗</mo>
                                       <mi>b</mi>
                                       <mi>l</mi>
                                       <mi>o</mi>
                                       <mi>c</mi>
                                       <mi>k</mi>
                                       <mi>D</mi>
                                       <mi>i</mi>
                                       <mi>m</mi>
                                       <mo stretchy="false">)</mo>
                                    </math>
                                    at least, and the size of vector <samp class="ph codeph">y</samp> should be 
                                    
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                       <mo stretchy="false">(</mo>
                                       <mi>m</mi>
                                       <mi>b</mi>
                                       <mo>∗</mo>
                                       <mi>b</mi>
                                       <mi>l</mi>
                                       <mi>o</mi>
                                       <mi>c</mi>
                                       <mi>k</mi>
                                       <mi>D</mi>
                                       <mi>i</mi>
                                       <mi>m</mi>
                                       <mo stretchy="false">)</mo>
                                    </math>
                                    at least; otherwise, the kernel may return
                                    <samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp> because of an out-of-bounds
                                    array.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <p class="p">For example, suppose the user has a CSR format and wants to try <samp class="ph codeph">bsrmv()</samp>, the
                           following code demonstrates how to use <samp class="ph codeph">csr2bsr()</samp> conversion and
                           <samp class="ph codeph">bsrmv()</samp> multiplication in single precision.
                        </p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Suppose that A is m x n sparse matrix represented by CSR format, </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// hx is a host vector of size n, and hy is also a host vector of size m. </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// m and n are not multiple of blockDim.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: transform CSR to BSR with column-major order </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> base, nnz;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzb;
cusparseDirection_t dirA = CUSPARSE_DIRECTION_COLUMN;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> mb = (m + <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>-1)/<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nb = (n + <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>-1)/<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>;
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;bsrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) *(mb+1));
cusparseXcsr2bsrNnz(handle, dirA, m, n, 
        descrA, csrRowPtrA, csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, 
        descrC, bsrRowPtrC, &amp;nnzb);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;bsrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzb);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;bsrValC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>)*nnzb);
cusparseScsr2bsr(handle, dirA, m, n, 
        descrA, csrValA, csrRowPtrA, csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>,
        descrC, bsrValC, bsrRowPtrC, bsrColIndC);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: allocate vector x and vector y large enough for bsrmv </span>
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;x, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*(nb*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>));
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;y, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*(mb*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>));
cudaMemcpy(x, hx, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n, cudaMemcpyHostToDevice);
cudaMemcpy(y, hy, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*m, cudaMemcpyHostToDevice);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: perform bsrmv</span>
cusparseSbsrmv(handle, dirA, transA, mb, nb, nnzb, &amp;alpha, 
   descrC, bsrValC, bsrRowPtrC, bsrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, x, &amp;beta, y);
</pre><div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dir</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">trans</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       . Only <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> is
                                       supported.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block columns of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	nonzero blocks of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every block row and the end of the last block row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the nonzero blocks of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>, larger than zero.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector of
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>n</mi>
                                          <mi>b</mi>
                                          <mo>∗</mo>
                                          <mi>b</mi>
                                          <mi>l</mi>
                                          <mi>o</mi>
                                          <mi>c</mi>
                                          <mi>k</mi>
                                          <mi>D</mi>
                                          <mi>i</mi>
                                          <mi>m</mi>
                                       </math>
                                       		
                                       	elements.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication. If <samp class="ph codeph">beta</samp> is zero, <samp class="ph codeph">y</samp> does not have to be a valid input.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector of
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>m</mi>
                                          <mi>b</mi>
                                          <mo>∗</mo>
                                          <mi>b</mi>
                                          <mi>l</mi>
                                          <mi>o</mi>
                                          <mi>c</mi>
                                          <mi>k</mi>
                                          <mi>D</mi>
                                          <mi>i</mi>
                                          <mi>m</mi>
                                       </math>
                                       		
                                       	elements.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; updated vector.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnz&lt;0</samp>, <samp class="ph codeph">trans !=
                                          CUSPARSE_OPERATION_NON_TRANSPOSE</samp>, 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>b</mi>
                                          <mi>l</mi>
                                          <mi>o</mi>
                                          <mi>c</mi>
                                          <mi>k</mi>
                                          <mi>D</mi>
                                          <mi>i</mi>
                                          <mi>m</mi>
                                          <mo>&lt;</mo>
                                          <mn>1</mn>
                                       </math>
                                       , <samp class="ph codeph">dir</samp> is not row-major or column-major, or
                                       <samp class="ph codeph">IndexBase of descr</samp> is not base-0 or base-1 ).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-bsrxmv"><a name="cusparse-lt-t-gt-bsrxmv" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrxmv" name="cusparse-lt-t-gt-bsrxmv" shape="rect">7.2.&nbsp;cusparse&lt;t&gt;bsrxmv()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsrxmv(cusparseHandle_t handle, 
                cusparseDirection_t dir,
                cusparseOperation_t trans, 
                int sizeOfMask,
                int mb, 
                int nb, 
                int nnzb,
                const float *alpha, 
                const cusparseMatDescr_t descr,
                const float *bsrVal, 
                const int *bsrMaskPtr, 
                const int *bsrRowPtr, 
                const int *bsrEndPtr, 
                const int *bsrColInd,
                int blockDim, 
                const float *x, 
                const float *beta, 
                float *y)
cusparseStatus_t 
cusparseDbsrxmv(cusparseHandle_t handle, 
                cusparseDirection_t dir,
                cusparseOperation_t trans, 
                int sizeOfMask,
                int mb, 
                int nb, 
                int nnzb,
                const double *alpha, 
                const cusparseMatDescr_t descr,
                const double *bsrVal, 
                const int *bsrMaskPtr,
                const int *bsrRowPtr, 
                const int *bsrEndPtr, 
                const int *bsrColInd,
                int blockDim, 
                const double *x, 
                const double *beta, 
                double *y)
cusparseStatus_t 
cusparseCbsrxmv(cusparseHandle_t handle, 
                cusparseDirection_t dir,
                cusparseOperation_t trans, 
                int sizeOfMask,
                int mb, 
                int nb, 
                int nnzb,
                const cuComplex *alpha, 
                const cusparseMatDescr_t descr,
                const cuComplex *bsrVal, 
                const int *bsrMaskPtr,
                const int *bsrRowPtr, 
                const int *bsrEndPtr, 
                const int *bsrColInd,
                int blockDim, 
                const cuComplex *x, 
                const cuComplex *beta, 
                cuComplex *y)
cusparseStatus_t 
cusparseZbsrxmv(cusparseHandle_t handle, 
                cusparseDirection_t dir,
                cusparseOperation_t trans, 
                int sizeOfMask,
                int mb, 
                int nb, 
                int nnzb,
                const cuDoubleComplex *alpha, 
                const cusparseMatDescr_t descr,
                const cuDoubleComplex *bsrVal, 
                const int *bsrMaskPtr,
                const int *bsrRowPtr, 
                const int *bsrEndPtr, 
                const int *bsrColInd,
                int blockDim, 
                const cuDoubleComplex *x, 
                const cuDoubleComplex *beta, 
                cuDoubleComplex *y)
</pre><p class="p">This function performs a <samp class="ph codeph">bsrmv</samp> and a mask operation
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y(mask)</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mo maxsize="1.2em" minsize="1.2em">(</mo>
                                          </mrow>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>x</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>+</mo>
                                          <mi>β</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mo maxsize="1.2em" minsize="1.2em">)</mo>
                                          </mrow>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(mask)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">where 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>A</mi>
                              <mtext>&nbsp;is an&nbsp;</mtext>
                              <mo stretchy="false">(</mo>
                              <mi>m</mi>
                              <mi>b</mi>
                              <mo>∗</mo>
                              <mi>b</mi>
                              <mi>l</mi>
                              <mi>o</mi>
                              <mi>c</mi>
                              <mi>k</mi>
                              <mi>D</mi>
                              <mi>i</mi>
                              <mi>m</mi>
                              <mo stretchy="false">)</mo>
                              <mo>×</mo>
                              <mo stretchy="false">(</mo>
                              <mi>n</mi>
                              <mi>b</mi>
                              <mo>∗</mo>
                              <mi>b</mi>
                              <mi>l</mi>
                              <mi>o</mi>
                              <mi>c</mi>
                              <mi>k</mi>
                              <mi>D</mi>
                              <mi>i</mi>
                              <mi>m</mi>
                              <mo stretchy="false">)</mo>
                           </math>
                           sparse matrix that is defined in BSRX storage format by the four arrays
                           <samp class="ph codeph">bsrVal</samp>, <samp class="ph codeph">bsrRowPtr</samp>, <samp class="ph codeph">bsrEndPtr</samp>, and
                           <samp class="ph codeph">bsrColInd</samp>); <samp class="ph codeph">x</samp> and <samp class="ph codeph">y</samp> are vectors; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                              <mtext>&nbsp;and&nbsp;</mtext>
                              <mi>β</mi>
                           </math>
                           are scalars; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">The mask operation is defined by array <samp class="ph codeph">bsrMaskPtr</samp> which contains updated block row
                           indices of 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>y</mi>
                           </math>
                           . If row 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>i</mi>
                           </math>
                           is not specified in <samp class="ph codeph">bsrMaskPtr</samp>, then <samp class="ph codeph">bsrxmv()</samp>
                           does not touch row block 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>i</mi>
                           </math>
                           of 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>A</mi>
                           </math>
                           and 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>y</mi>
                           </math>
                           .
                        </p>
                        <p class="p">For example, consider the
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mn>2</mn>
                              <mo>×</mo>
                              <mn>3</mn>
                           </math>
                           block matrix 
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>A</mi>
                           </math>:
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mtable columnalign="right left right left right left right left right left right left" rowspacing=".5em" columnspacing="0.2777777777777778em 2em 0.2777777777777778em 2em 0.2777777777777778em 2em 0.2777777777777778em 2em 0.2777777777777778em 2em 0.2777777777777778em">
                                             <mtr>
                                                <mtd>
                                                   <mi>A</mi>
                                                   <mo>=</mo>
                                                   <mfenced open="[" close="]">
                                                      <mtable rowspacing="4pt" columnspacing="1em">
                                                         <mtr>
                                                            <mtd>
                                                               <msub>
                                                                  <mi>A</mi>
                                                                  <mrow class="MJX-TeXAtom-ORD">
                                                                     <mn>11</mn>
                                                                  </mrow>
                                                               </msub>
                                                            </mtd>
                                                            <mtd>
                                                               <msub>
                                                                  <mi>A</mi>
                                                                  <mrow class="MJX-TeXAtom-ORD">
                                                                     <mn>12</mn>
                                                                  </mrow>
                                                               </msub>
                                                            </mtd>
                                                            <mtd>
                                                               <mi>O</mi>
                                                            </mtd>
                                                         </mtr>
                                                         <mtr>
                                                            <mtd>
                                                               <msub>
                                                                  <mi>A</mi>
                                                                  <mrow class="MJX-TeXAtom-ORD">
                                                                     <mn>21</mn>
                                                                  </mrow>
                                                               </msub>
                                                            </mtd>
                                                            <mtd>
                                                               <msub>
                                                                  <mi>A</mi>
                                                                  <mrow class="MJX-TeXAtom-ORD">
                                                                     <mn>22</mn>
                                                                  </mrow>
                                                               </msub>
                                                            </mtd>
                                                            <mtd>
                                                               <msub>
                                                                  <mi>A</mi>
                                                                  <mrow class="MJX-TeXAtom-ORD">
                                                                     <mn>23</mn>
                                                                  </mrow>
                                                               </msub>
                                                            </mtd>
                                                         </mtr>
                                                      </mtable>
                                                   </mfenced>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">and its one-based BSR format (three vector form) is</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                             <mtr>
                                                <mtd>
                                                   <mtext>bsrVal</mtext>
                                                </mtd>
                                                <mtd>
                                                   <mo>=</mo>
                                                </mtd>
                                                <mtd>
                                                   <mfenced open="[" close="]">
                                                      <mtable rowspacing="4pt" columnspacing="1em">
                                                         <mtr>
                                                            <mtd>
                                                               <msub>
                                                                  <mi>A</mi>
                                                                  <mrow class="MJX-TeXAtom-ORD">
                                                                     <mn>11</mn>
                                                                  </mrow>
                                                               </msub>
                                                            </mtd>
                                                            <mtd>
                                                               <msub>
                                                                  <mi>A</mi>
                                                                  <mrow class="MJX-TeXAtom-ORD">
                                                                     <mn>12</mn>
                                                                  </mrow>
                                                               </msub>
                                                            </mtd>
                                                            <mtd>
                                                               <msub>
                                                                  <mi>A</mi>
                                                                  <mrow class="MJX-TeXAtom-ORD">
                                                                     <mn>21</mn>
                                                                  </mrow>
                                                               </msub>
                                                            </mtd>
                                                            <mtd>
                                                               <msub>
                                                                  <mi>A</mi>
                                                                  <mrow class="MJX-TeXAtom-ORD">
                                                                     <mn>22</mn>
                                                                  </mrow>
                                                               </msub>
                                                            </mtd>
                                                            <mtd>
                                                               <msub>
                                                                  <mi>A</mi>
                                                                  <mrow class="MJX-TeXAtom-ORD">
                                                                     <mn>23</mn>
                                                                  </mrow>
                                                               </msub>
                                                            </mtd>
                                                         </mtr>
                                                      </mtable>
                                                   </mfenced>
                                                </mtd>
                                             </mtr>
                                             <mtr>
                                                <mtd>
                                                   <mtext>bsrRowPtr</mtext>
                                                </mtd>
                                                <mtd>
                                                   <mo>=</mo>
                                                </mtd>
                                                <mtd>
                                                   <mfenced open="[" close="]">
                                                      <mtable rowspacing="4pt" columnspacing="1em">
                                                         <mtr>
                                                            <mtd>
                                                               <mn>1</mn>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mphantom>
                                                                     <mn>.0</mn>
                                                                  </mphantom>
                                                               </mrow>
                                                            </mtd>
                                                            <mtd>
                                                               <mn>3</mn>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mphantom>
                                                                     <mn>.0</mn>
                                                                  </mphantom>
                                                               </mrow>
                                                            </mtd>
                                                            <mtd>
                                                               <mn>6</mn>
                                                            </mtd>
                                                         </mtr>
                                                      </mtable>
                                                   </mfenced>
                                                </mtd>
                                             </mtr>
                                             <mtr>
                                                <mtd>
                                                   <mtext>bsrColInd</mtext>
                                                </mtd>
                                                <mtd>
                                                   <mo>=</mo>
                                                </mtd>
                                                <mtd>
                                                   <mfenced open="[" close="]">
                                                      <mtable rowspacing="4pt" columnspacing="1em">
                                                         <mtr>
                                                            <mtd>
                                                               <mn>1</mn>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mphantom>
                                                                     <mn>.0</mn>
                                                                  </mphantom>
                                                               </mrow>
                                                            </mtd>
                                                            <mtd>
                                                               <mn>2</mn>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mphantom>
                                                                     <mn>.0</mn>
                                                                  </mphantom>
                                                               </mrow>
                                                            </mtd>
                                                            <mtd>
                                                               <mn>1</mn>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mphantom>
                                                                     <mn>.0</mn>
                                                                  </mphantom>
                                                               </mrow>
                                                            </mtd>
                                                            <mtd>
                                                               <mn>2</mn>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mphantom>
                                                                     <mn>.0</mn>
                                                                  </mphantom>
                                                               </mrow>
                                                            </mtd>
                                                            <mtd>
                                                               <mn>3</mn>
                                                            </mtd>
                                                         </mtr>
                                                      </mtable>
                                                   </mfenced>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">Suppose we want to do the following <samp class="ph codeph">bsrmv</samp> operation on a matrix 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mover>
                                 <mi>A</mi>
                                 <mo accent="false">¯</mo>
                              </mover>
                           </math>
                           which is slightly different from 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>A</mi>
                           </math>
                           . 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mfenced open="[" close="]">
                                             <mtable rowspacing="4pt" columnspacing="1em">
                                                <mtr>
                                                   <mtd>
                                                      <msub>
                                                         <mi>y</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>1</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                </mtr>
                                                <mtr>
                                                   <mtd>
                                                      <msub>
                                                         <mi>y</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>2</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                </mtr>
                                             </mtable>
                                          </mfenced>
                                          <mo>:=</mo>
                                          <mi>a</mi>
                                          <mi>l</mi>
                                          <mi>p</mi>
                                          <mi>h</mi>
                                          <mi>a</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mo maxsize="2.470em" minsize="2.470em">(</mo>
                                          </mrow>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mover>
                                                <mi>A</mi>
                                                <mo stretchy="false">˜</mo>
                                             </mover>
                                          </mrow>
                                          <mo>=</mo>
                                          <mfenced open="[" close="]">
                                             <mtable rowspacing="4pt" columnspacing="1em">
                                                <mtr>
                                                   <mtd>
                                                      <mi>O</mi>
                                                   </mtd>
                                                   <mtd>
                                                      <mi>O</mi>
                                                   </mtd>
                                                   <mtd>
                                                      <mi>O</mi>
                                                   </mtd>
                                                </mtr>
                                                <mtr>
                                                   <mtd>
                                                      <mi>O</mi>
                                                   </mtd>
                                                   <mtd>
                                                      <msub>
                                                         <mi>A</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>22</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                   <mtd>
                                                      <mi>O</mi>
                                                   </mtd>
                                                </mtr>
                                             </mtable>
                                          </mfenced>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mo maxsize="2.470em" minsize="2.470em">)</mo>
                                          </mrow>
                                          <mo>∗</mo>
                                          <mfenced open="[" close="]">
                                             <mtable rowspacing="4pt" columnspacing="1em">
                                                <mtr>
                                                   <mtd>
                                                      <msub>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>1</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                </mtr>
                                                <mtr>
                                                   <mtd>
                                                      <msub>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>2</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                </mtr>
                                                <mtr>
                                                   <mtd>
                                                      <msub>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>3</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                </mtr>
                                             </mtable>
                                          </mfenced>
                                          <mo>+</mo>
                                          <mfenced open="[" close="]">
                                             <mtable rowspacing="4pt" columnspacing="1em">
                                                <mtr>
                                                   <mtd>
                                                      <msub>
                                                         <mi>y</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>1</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                </mtr>
                                                <mtr>
                                                   <mtd>
                                                      <mi>b</mi>
                                                      <mi>e</mi>
                                                      <mi>t</mi>
                                                      <mi>a</mi>
                                                      <mo>∗</mo>
                                                      <msub>
                                                         <mi>y</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>2</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                </mtr>
                                             </mtable>
                                          </mfenced>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">We don’t need to create another BSR format for the new matrix 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mover>
                                 <mi>A</mi>
                                 <mo accent="false">¯</mo>
                              </mover>
                           </math>
                           , all that we should do is to keep <samp class="ph codeph">bsrVal</samp> and
                           <samp class="ph codeph">bsrColInd</samp> unchanged, but modify <samp class="ph codeph">bsrRowPtr</samp> and add an
                           additional array <samp class="ph codeph">bsrEndPtr</samp> which points to the last nonzero elements per row
                           of 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mover>
                                 <mi>A</mi>
                                 <mo accent="false">¯</mo>
                              </mover>
                           </math>
                           plus 1.
                        </p>
                        <p class="p">For example, the following <samp class="ph codeph">bsrRowPtr</samp> and <samp class="ph codeph">bsrEndPtr</samp> can
                           represent matrix 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mover>
                                 <mi>A</mi>
                                 <mo accent="false">¯</mo>
                              </mover>
                           </math>
                           :
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                             <mtr>
                                                <mtd>
                                                   <mtext>bsrRowPtr</mtext>
                                                </mtd>
                                                <mtd>
                                                   <mo>=</mo>
                                                </mtd>
                                                <mtd>
                                                   <mfenced open="[" close="]">
                                                      <mtable rowspacing="4pt" columnspacing="1em">
                                                         <mtr>
                                                            <mtd>
                                                               <mn>1</mn>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mphantom>
                                                                     <mn>.0</mn>
                                                                  </mphantom>
                                                               </mrow>
                                                            </mtd>
                                                            <mtd>
                                                               <mn>4</mn>
                                                            </mtd>
                                                         </mtr>
                                                      </mtable>
                                                   </mfenced>
                                                </mtd>
                                             </mtr>
                                             <mtr>
                                                <mtd>
                                                   <mtext>bsrEndPtr</mtext>
                                                </mtd>
                                                <mtd>
                                                   <mo>=</mo>
                                                </mtd>
                                                <mtd>
                                                   <mfenced open="[" close="]">
                                                      <mtable rowspacing="4pt" columnspacing="1em">
                                                         <mtr>
                                                            <mtd>
                                                               <mn>1</mn>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mphantom>
                                                                     <mn>.0</mn>
                                                                  </mphantom>
                                                               </mrow>
                                                            </mtd>
                                                            <mtd>
                                                               <mn>5</mn>
                                                            </mtd>
                                                         </mtr>
                                                      </mtable>
                                                   </mfenced>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">Further we can use a mask operator (specified by array <samp class="ph codeph">bsrMaskPtr</samp>) to update
                           particular block row indices of 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>y</mi>
                           </math>
                           only because 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>y</mi>
                                 <mn>1</mn>
                              </msub>
                           </math>
                           is never changed. In this case, <samp class="ph codeph">bsrMaskPtr</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mo>=</mo>
                           </math>
                           [2] 
                           and <samp class="ph codeph">sizeOfMask</samp>=1.
                           
                        </p>
                        <p class="p">The mask operator is equivalent to the following operation:
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mfenced open="[" close="]">
                                             <mtable rowspacing="4pt" columnspacing="1em">
                                                <mtr>
                                                   <mtd>
                                                      <mo>?</mo>
                                                   </mtd>
                                                </mtr>
                                                <mtr>
                                                   <mtd>
                                                      <msub>
                                                         <mi>y</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>2</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                </mtr>
                                             </mtable>
                                          </mfenced>
                                          <mo>:=</mo>
                                          <mi>a</mi>
                                          <mi>l</mi>
                                          <mi>p</mi>
                                          <mi>h</mi>
                                          <mi>a</mi>
                                          <mo>∗</mo>
                                          <mfenced open="[" close="]">
                                             <mtable rowspacing="4pt" columnspacing="1em">
                                                <mtr>
                                                   <mtd>
                                                      <mo>?</mo>
                                                   </mtd>
                                                   <mtd>
                                                      <mo>?</mo>
                                                   </mtd>
                                                   <mtd>
                                                      <mo>?</mo>
                                                   </mtd>
                                                </mtr>
                                                <mtr>
                                                   <mtd>
                                                      <mi>O</mi>
                                                   </mtd>
                                                   <mtd>
                                                      <msub>
                                                         <mi>A</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>22</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                   <mtd>
                                                      <mi>O</mi>
                                                   </mtd>
                                                </mtr>
                                             </mtable>
                                          </mfenced>
                                          <mo>∗</mo>
                                          <mfenced open="[" close="]">
                                             <mtable rowspacing="4pt" columnspacing="1em">
                                                <mtr>
                                                   <mtd>
                                                      <msub>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>1</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                </mtr>
                                                <mtr>
                                                   <mtd>
                                                      <msub>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>2</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                </mtr>
                                                <mtr>
                                                   <mtd>
                                                      <msub>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>3</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                </mtr>
                                             </mtable>
                                          </mfenced>
                                          <mo>+</mo>
                                          <mi>b</mi>
                                          <mi>e</mi>
                                          <mi>t</mi>
                                          <mi>a</mi>
                                          <mo>∗</mo>
                                          <mfenced open="[" close="]">
                                             <mtable rowspacing="4pt" columnspacing="1em">
                                                <mtr>
                                                   <mtd>
                                                      <mo>?</mo>
                                                   </mtd>
                                                </mtr>
                                                <mtr>
                                                   <mtd>
                                                      <msub>
                                                         <mi>y</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mn>2</mn>
                                                         </mrow>
                                                      </msub>
                                                   </mtd>
                                                </mtr>
                                             </mtable>
                                          </mfenced>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"> If a block row is not present in the <samp class="ph codeph">bsrMaskPtr</samp>, then no calculation is performed on that row, 
                           and the corresponding value in <samp class="ph codeph">y</samp> is unmodified. 
                           The question mark "?" is used to inidcate row blocks not in <samp class="ph codeph">bsrMaskPtr</samp>. 
                           
                        </p>
                        <p class="p">In this case, first row block is not present in <samp class="ph codeph">bsrMaskPtr</samp>, 
                           so <samp class="ph codeph">bsrRowPtr[0]</samp> and <samp class="ph codeph">bsrEndPtr[0]</samp> are not touched also.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mtable columnalign="right center left" rowspacing=".5em" columnspacing="thickmathspace">
                                             <mtr>
                                                <mtd>
                                                   <mtext>bsrRowPtr</mtext>
                                                </mtd>
                                                <mtd>
                                                   <mo>=</mo>
                                                </mtd>
                                                <mtd>
                                                   <mfenced open="[" close="]">
                                                      <mtable rowspacing="4pt" columnspacing="1em">
                                                         <mtr>
                                                            <mtd>
                                                               <mo>?</mo>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mphantom>
                                                                     <mn>.0</mn>
                                                                  </mphantom>
                                                               </mrow>
                                                            </mtd>
                                                            <mtd>
                                                               <mn>4</mn>
                                                            </mtd>
                                                         </mtr>
                                                      </mtable>
                                                   </mfenced>
                                                </mtd>
                                             </mtr>
                                             <mtr>
                                                <mtd>
                                                   <mtext>bsrEndPtr</mtext>
                                                </mtd>
                                                <mtd>
                                                   <mo>=</mo>
                                                </mtd>
                                                <mtd>
                                                   <mfenced open="[" close="]">
                                                      <mtable rowspacing="4pt" columnspacing="1em">
                                                         <mtr>
                                                            <mtd>
                                                               <mo>?</mo>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mphantom>
                                                                     <mn>.0</mn>
                                                                  </mphantom>
                                                               </mrow>
                                                            </mtd>
                                                            <mtd>
                                                               <mn>5</mn>
                                                            </mtd>
                                                         </mtr>
                                                      </mtable>
                                                   </mfenced>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="p">A couple of comments on <samp class="ph codeph">bsrxmv()</samp>:<a name="cusparse-lt-t-gt-bsrxmv__ul_zbk_txr_nm" shape="rect">
                              <!-- --></a><ul class="ul" id="cusparse-lt-t-gt-bsrxmv__ul_zbk_txr_nm">
                              <li class="li">Only <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> and
                                 <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> are supported.
                              </li>
                              <li class="li">
                                 <p class="p">Parameters <samp class="ph codeph">bsrMaskPtr</samp>, <samp class="ph codeph">bsrRowPtr</samp>,
                                    <samp class="ph codeph">bsrEndPtr</samp> and <samp class="ph codeph">bsrColInd</samp> are consistent with base
                                    index, either one-based or zero-based. The above example is one-based.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dir</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">trans</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       . Only <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> is
                                       supported.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">sizeOfMask</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of updated block rows of 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>y</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block columns of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp> nonzero blocks of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrMaskPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">sizeOfMask</samp>
                                       elements that contains the indices corresponding to updated block rows. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp>
                                       	elements that contains the start of every block row.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrEndPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp> elements that contains the end of the every block row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of	<samp class="ph codeph">nnzb</samp> column indices of the nonzero blocks of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>, larger than zero.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector of
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>n</mi>
                                          <mi>b</mi>
                                          <mo>∗</mo>
                                          <mi>b</mi>
                                          <mi>l</mi>
                                          <mi>o</mi>
                                          <mi>c</mi>
                                          <mi>k</mi>
                                          <mi>D</mi>
                                          <mi>i</mi>
                                          <mi>m</mi>
                                       </math>
                                       		
                                       	elements.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication. If <samp class="ph codeph">beta</samp> is zero, <samp class="ph codeph">y</samp> does not have to be a valid input.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector of
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>m</mi>
                                          <mi>b</mi>
                                          <mo>∗</mo>
                                          <mi>b</mi>
                                          <mi>l</mi>
                                          <mi>o</mi>
                                          <mi>c</mi>
                                          <mi>k</mi>
                                          <mi>D</mi>
                                          <mi>i</mi>
                                          <mi>m</mi>
                                       </math>
                                       		
                                       	elements.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnz&lt;0</samp>, <samp class="ph codeph">trans !=
                                          CUSPARSE_OPERATION_NON_TRANSPOSE</samp>, 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>b</mi>
                                          <mi>l</mi>
                                          <mi>o</mi>
                                          <mi>c</mi>
                                          <mi>k</mi>
                                          <mi>D</mi>
                                          <mi>i</mi>
                                          <mi>m</mi>
                                          <mo>&lt;</mo>
                                          <mn>1</mn>
                                       </math>
                                       , <samp class="ph codeph">dir</samp> is not row-major or column-major, or
                                       <samp class="ph codeph">IndexBase of descr</samp> is not base-0 or base-1 ).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrmv"><a name="cusparse-lt-t-gt-csrmv" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrmv" name="cusparse-lt-t-gt-csrmv" shape="rect">7.3.&nbsp;cusparse&lt;t&gt;csrmv()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseScsrmv(cusparseHandle_t handle, cusparseOperation_t transA, 
               int m, int n, int nnz, const float           *alpha, 
               const cusparseMatDescr_t descrA, 
               const float           *csrValA, 
               const int *csrRowPtrA, const int *csrColIndA,
               const float           *x, const float           *beta, 
               float           *y)
cusparseStatus_t 
cusparseDcsrmv(cusparseHandle_t handle, cusparseOperation_t transA, 
               int m, int n, int nnz, const double          *alpha, 
               const cusparseMatDescr_t descrA, 
               const double          *csrValA, 
               const int *csrRowPtrA, const int *csrColIndA,
               const double          *x, const double          *beta, 
               double          *y)
cusparseStatus_t 
cusparseCcsrmv(cusparseHandle_t handle, cusparseOperation_t transA, 
               int m, int n, int nnz, const cuComplex       *alpha, 
               const cusparseMatDescr_t descrA, 
               const cuComplex       *csrValA, 
               const int *csrRowPtrA, const int *csrColIndA,
               const cuComplex       *x, const cuComplex       *beta, 
               cuComplex       *y)
cusparseStatus_t 
cusparseZcsrmv(cusparseHandle_t handle, cusparseOperation_t transA, 
               int m, int n, int nnz, const cuDoubleComplex *alpha, 
               const cusparseMatDescr_t descrA, 
               const cuDoubleComplex *csrValA, 
               const int *csrRowPtrA, const int *csrColIndA, 
               const cuDoubleComplex *x, const cuDoubleComplex *beta, 
               cuDoubleComplex *y)</pre><p class="p">This function performs the matrix-vector operation</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>x</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>+</mo>
                                          <mi>β</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×n</samp> sparse matrix that is defined in CSR storage
                           			format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           				<samp class="ph codeph">csrColIndA</samp>); <samp class="ph codeph">x</samp> and <samp class="ph codeph">y</samp> are vectors; 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                              <mtext>&nbsp;and&nbsp;</mtext>
                              <mi>β</mi>
                           </math>
                           			 are scalars; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">When using the (conjugate) transpose of a general matrix or a Hermitian/symmetric matrix, this
                           			routine may produce slightly different results during different runs with the same input
                           			parameters. For these matrix types it uses atomic operations to compute the final
                           			result, consequently many threads may be adding floating point numbers to the same
                           			memory location without any specific ordering, which may produce slightly different
                           			results for each run.
                        </p>
                        <p class="p">If exactly the same output is required for any input when multiplying by the transpose of a general matrix, the following
                           procedure can be used:
                        </p>
                        <p class="p">1. Convert the matrix from CSR to CSC format using one of the <samp class="ph codeph">csr2csc()</samp> functions. Notice that by interchanging the rows and columns of the result you are implicitly transposing the matrix.
                        </p>
                        <p class="p">2. Call the <samp class="ph codeph">csrmv()</samp> function with the <samp class="ph codeph">cusparseOperation_t</samp> parameter set to <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> and with the interchanged rows and columns of the matrix stored in CSC format. This (implicitly) multiplies the vector by
                           the transpose of the matrix in the original CSR format.
                        </p>
                        <p class="p">This function requires no extra storage for the general matrices when operation
                           				<samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> is selected. It requires some
                           			extra storage for Hermitian/symmetric matrices and for the general matrices when an
                           			operation different than <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> is selected.
                           			It is executed asynchronously with respect to the host and may return control to the
                           			application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">trans</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>,
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_SYMMETRIC</samp>, and
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_HERMITIAN</samp>. Also, the supported
                                       							index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector of <samp class="ph codeph">n</samp> elements if 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       							, and <samp class="ph codeph">m</samp> elements if 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>T</mi>
                                          </msup>
                                       </math>
                                       							 or 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>H</mi>
                                          </msup>
                                       </math>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication. If <samp class="ph codeph">beta</samp> is zero, <samp class="ph codeph">y</samp> does not have to be a valid input.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector of <samp class="ph codeph">m</samp> elements if 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       							, and <samp class="ph codeph">n</samp> elements if 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>T</mi>
                                          </msup>
                                       </math>
                                       							 or 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>H</mi>
                                          </msup>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; updated vector.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnz&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision (compute capability (c.c.) &gt;= 1.3 required),
                                       							symmetric/Hermitian matrix (c.c. &gt;= 1.2 required), or transpose
                                       							operation (c.c. &gt;= 1.1 required).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-csrmvEx"><a name="cusparse-csrmvEx" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-csrmvEx" name="cusparse-csrmvEx" shape="rect">7.4.&nbsp;cusparseCsrmvEx()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseCsrmvEx(cusparseHandle_t handle, 
                cusparseAlgMode_t alg,
                cusparseOperation_t transA, 
                int m, int n, int nnz,
                const void *alpha, cudaDataType alphatype,
                const cusparseMatDescr_t descrA,
                const void *csrValA, cudaDataType csrValAtype,
                const int *csrRowPtrA,
                const int *csrColIndA,
                const void *x, cudaDataType xtype,
                const void *beta, cudaDataType betatype,
                void *y, cudaDataType ytype,
                cudaDataType executiontype,
                void* buffer);
</pre><p class="p">This function is an extended version of <samp class="ph codeph">cusparse&lt;t&gt;csrmv()</samp> which performs the matrix-vector multiply operation. For detailed description of the functionality, see <samp class="ph codeph">cusparse&lt;t&gt;csrmv()</samp>. Also see <samp class="ph codeph">cusparseAlgMode_t</samp>
                           for <samp class="ph codeph">alg</samp> parameter description
                        </p>
                        <p class="p">For alg <samp class="ph codeph">CUSPARSE_ALG_NAIVE</samp>: for half-precision execution type, the minimum GPU architecture is SM_53. Also, for both half-precision IO and execution,
                           only CUSPARSE_MATRIX_TYPE_GENERAL and CUSPARSE_OPERATION_NON_TRANSPOSE are supported.
                        </p>
                        <p class="p">For alg <samp class="ph codeph">CUSPARSE_ALG_MERGE_PATH</samp>: half-precision is not supported, only CUSPARSE_MATRIX_TYPE_GENERAL, CUSPARSE_OPERATION_NON_TRANSPOSE and CUSPARSE_INDEX_BASE_ZERO
                           are supported. Input, output and execution types should be the same.
                        </p>
                        <p class="p">All pointers should be aligned with 128 bytes.</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input specifically required by <samp class="ph codeph">cusparseCsrmvEx</samp></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alg</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Algorithm implementation for csrmv, see <samp class="ph codeph">cusparseAlgMode_t</samp> for possible values.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alphatype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">alpha</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValAtype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">csrValA</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xtype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">betatype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">beta</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ytype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">y</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">executiontype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type used for computation.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">buffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Pointer to workspace buffer. Not currently used, however must be allocated and be aligned with word boundaries. Recommended
                                       to always use <samp class="ph codeph">cusparseCsrmvEx_bufferSize</samp> to obtain the right size for this buffer.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="unique_1245988031"><a name="unique_1245988031" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#unique_1245988031" name="unique_1245988031" shape="rect">cusparseCsrmvEx_bufferSize()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseCsrmvEx_bufferSize(cusparseHandle_t handle, 
                                                 cusparseAlgMode_t alg,
                                                 cusparseOperation_t transA, 
                                                 int m, int n, int nnz,
                                                 const void *alpha, cudaDataType alphatype,
                                                 const cusparseMatDescr_t descrA,
                                                 const void *csrValA, cudaDataType csrValAtype,
                                                 const int *csrRowPtrA,
                                                 const int *csrColIndA,
                                                 const void *x, cudaDataType xtype,
                                                 const void *beta, cudaDataType betatype,
                                                 void *y, cudaDataType ytype,
                                                 cudaDataType executiontype,
                                                 size_t *bufferSizeInBytes);
</pre><p class="p">This function returns the size of the workspace needed by <samp class="ph codeph">cusparseCsrmvEx</samp>. User needs to allocate a buffer of this size and give that buffer to <samp class="ph codeph">cusparseCsrmvEx</samp> as an argument. All the arguments are similar to <samp class="ph codeph">cusparseCsrmvEx</samp> except the following output argument.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output specifically required by cusparseCsrmvEx_bufferSize</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Pointer to a <samp class="ph codeph">size_t</samp> variable, which will be assigned with the size of workspace needed by <samp class="ph codeph">cusparseCsrmv</samp>. Returned number is always more than zero, so <samp class="ph codeph">cudaMalloc()</samp> with provided number of bytes needed would not return an error due to number of requested bytes being zero.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrmv_mergepath"><a name="cusparse-lt-t-gt-csrmv_mergepath" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrmv_mergepath" name="cusparse-lt-t-gt-csrmv_mergepath" shape="rect">7.6.&nbsp;cusparse&lt;t&gt;csrmv_mp()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseScsrmv_mp(cusparseHandle_t handle, cusparseOperation_t transA, 
               int m, int n, int nnz, 
               const float           *alpha, 
               const cusparseMatDescr_t descrA, 
               const float           *csrValA, 
               const int *csrRowPtrA, const int *csrColIndA,
               const float           *x, const float           *beta, 
               float           *y)
cusparseStatus_t 
cusparseDcsrmv_mp(cusparseHandle_t handle, cusparseOperation_t transA, 
               int m, int n, int nnz, 
               const double          *alpha, 
               const cusparseMatDescr_t descrA, 
               const double          *csrValA, 
               const int *csrRowPtrA, const int *csrColIndA,
               const double          *x, const double          *beta, 
               double          *y)
cusparseStatus_t 
cusparseCcsrmv_mp(cusparseHandle_t handle, cusparseOperation_t transA, 
               int m, int n, int nnz, 
               const cuComplex       *alpha, 
               const cusparseMatDescr_t descrA, 
               const cuComplex       *csrValA, 
               const int *csrRowPtrA, const int *csrColIndA,
               const cuComplex       *x, const cuComplex       *beta, 
               cuComplex       *y)
cusparseStatus_t 
cusparseZcsrmv_mp(cusparseHandle_t handle, cusparseOperation_t transA, 
               int m, int n, int nnz, 
               const cuDoubleComplex *alpha, 
               const cusparseMatDescr_t descrA, 
               const cuDoubleComplex *csrValA, 
               const int *csrRowPtrA, const int *csrColIndA, 
               const cuDoubleComplex *x, const cuDoubleComplex *beta, 
               cuDoubleComplex *y)
</pre><p class="p">This function performs a load-balanced matrix-vector operation</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>x</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>+</mo>
                                          <mi>β</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×n</samp> sparse matrix that is defined in CSR storage
                           			format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           				<samp class="ph codeph">csrColIndA</samp>); <samp class="ph codeph">x</samp> and <samp class="ph codeph">y</samp> are vectors; 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                              <mtext>&nbsp;and&nbsp;</mtext>
                              <mi>β</mi>
                           </math>
                           			 are scalars; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p"><em class="ph i">Note:</em> This function is deprecated in favor of <samp class="ph codeph">cusparseCsrmvEx()</samp> with <samp class="ph codeph">CUSPARSE_ALG_MERGE_PATH</samp> parameter which provides same functionality with better perfromance.
                           
                        </p>
                        <p class="p">
                           This routine was introduced specifically to address some of the loss of performance in the regular csrmv() code 
                           due to irregular sparsity patterns.  
                           The core kernels are based on the "MergePath" approach created by Duanne Merril. 
                           By using this approach, we are able to provide performance independent of a sparsity pattern across data types. 
                           
                        </p>
                        <p class="p">
                           Remark: <samp class="ph codeph">csrmv_mp</samp> only supports matrix type <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> and 
                           <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> operation.
                           
                        </p>
                        <p class="p">
                           Appendix C provides a simple example of <samp class="ph codeph">csrmv_mp</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">trans</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							.
                                       only support <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported
                                       							index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector of <samp class="ph codeph">n</samp> elements if 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       							, and <samp class="ph codeph">m</samp> elements if 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>T</mi>
                                          </msup>
                                       </math>
                                       							 or 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>H</mi>
                                          </msup>
                                       </math>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication. If <samp class="ph codeph">beta</samp> is zero, <samp class="ph codeph">y</samp> does not have to be a valid input.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector of <samp class="ph codeph">m</samp> elements if 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       							, and <samp class="ph codeph">n</samp> elements if 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>T</mi>
                                          </msup>
                                       </math>
                                       							 or 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>H</mi>
                                          </msup>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; updated vector.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnz&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision (compute capability (c.c.) &gt;= 1.3 required),
                                       							symmetric/Hermitian matrix (c.c. &gt;= 1.2 required), or transpose
                                       							operation (c.c. &gt;= 1.1 required).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-gemvi"><a name="cusparse-lt-t-gt-gemvi" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gemvi" name="cusparse-lt-t-gt-gemvi" shape="rect">7.7.&nbsp;cusparse&lt;t&gt;gemvi()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSgemvi(cusparseHandle_t handle, cusparseOperation_t transA, 
               int m, int n, const float           *alpha, 
               const float *A, 
               int lda, int nnz,
               const float           *x, 
               const int             *xInd,
               const float           *beta, 
               float                 *y,
               cusparseIndexBase_t    idxBase,
               void                  *pBuffer)
cusparseStatus_t 
cusparseDgemvi(cusparseHandle_t handle, cusparseOperation_t transA, 
               int m, int n, const double           *alpha, 
               const double *A, 
               int lda, int nnz,
               const double          *x, 
               const int             *xInd,
               const double          *beta, 
               double                *y,
               cusparseIndexBase_t    idxBase,
               void                  *pBuffer)
cusparseStatus_t 
cusparseCgemvi(cusparseHandle_t handle, cusparseOperation_t transA, 
               int m, int n, const cuComplex           *alpha, 
               const cuComplex *A, 
               int lda, int nnz,
               const cuComplex       *x, 
               const int             *xInd,
               const cuComplex       *beta, 
               cuComplex             *y,
               cusparseIndexBase_t    idxBase,
               void                  *pBuffer)
cusparseStatus_t 
cusparseZgemvi(cusparseHandle_t handle, cusparseOperation_t transA, 
               int m, int n, const cuDoubleComplex           *alpha, 
               const cuDoubleComplex *A, 
               int lda, int nnz,
               const cuDoubleComplex       *x, 
               const int             *xInd,
               const cuDoubleComplex       *beta, 
               cuDoubleComplex             *y,
               cusparseIndexBase_t    idxBase,
               void                  *pBuffer)
</pre><p class="p">This function performs the matrix-vector operation</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>x</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>+</mo>
                                          <mi>β</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×n</samp> dense matrix and a sparse vector x that is defined in a sparse storage format by the two arrays <samp class="ph codeph">xVal</samp>, <samp class="ph codeph">xInd</samp> of length <samp class="ph codeph">nnz</samp>, and
                           				<samp class="ph codeph">y</samp> is a dense vector; 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                              <mtext>&nbsp;and&nbsp;</mtext>
                              <mi>β</mi>
                           </math>
                           			 are scalars; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">To simplify the implementation, we have not (yet) optimized the transpose multiple case. We recommend the following for users
                           interested in this case. 
                        </p>
                        <p class="p">1. Convert the matrix from CSR to CSC format using one of the <samp class="ph codeph">csr2csc()</samp> functions. Notice that by interchanging the rows and columns of the result you are implicitly transposing the matrix.
                        </p>
                        <p class="p">2. Call the <samp class="ph codeph">gemvi()</samp> function with the <samp class="ph codeph">cusparseOperation_t</samp> parameter set to <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> and with the interchanged rows and columns of the matrix stored in CSC format. This (implicitly) multiplies the vector by
                           the transpose of the matrix in the original CSR format.
                        </p>
                        <p class="p">This function requires no extra storage for the general matrices when operation
                           				<samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> is selected. It requires some
                           			extra storage for Hermitian/symmetric matrices and for the general matrices when an
                           			operation different than <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> is selected.
                           			It is executed asynchronously with respect to the host and may return control to the
                           			application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">trans</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to dense matrix <samp class="ph codeph">A</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"> size of the leading dimension of <samp class="ph codeph">A</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of vector <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; sparse vector of <samp class="ph codeph">nnz</samp> elements of size <samp class="ph codeph">n</samp> if 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       							, and size <samp class="ph codeph">m</samp> if 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>T</mi>
                                          </msup>
                                       </math>
                                       							 or 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>H</mi>
                                          </msup>
                                       </math>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Indices of non-zero values in <samp class="ph codeph">x</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication. If <samp class="ph codeph">beta</samp> is zero, <samp class="ph codeph">y</samp> does not have to be a valid input.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense vector of <samp class="ph codeph">m</samp> elements if 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       							, and <samp class="ph codeph">n</samp> elements if 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>T</mi>
                                          </msup>
                                       </math>
                                       							 or 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>H</mi>
                                          </msup>
                                       </math>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"> 0 or 1, for 0 based or 1 based indexing, respectively </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"> working space buffer, of size given by <samp class="ph codeph">Xgemvi_getBufferSize()</samp></td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; updated dense vector.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnz&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision (compute capability (c.c.) &gt;= 1.3 required),
                                       							symmetric/Hermitian matrix (c.c. &gt;= 1.2 required), or transpose
                                       							operation (c.c. &gt;= 1.1 required).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-gemvi_bufferSize"><a name="cusparse-lt-t-gt-gemvi_bufferSize" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gemvi_bufferSize" name="cusparse-lt-t-gt-gemvi_bufferSize" shape="rect">7.8.&nbsp;cusparse&lt;t&gt;gemvi_bufferSize()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSgemvi_bufferSize(cusparseHandle_t handle,
                           cusparseOperation_t transA,
                           int m,
                           int n,
                           int nnz,
                           int *pBufferSize)

cusparseStatus_t 
cusparseDgemvi_bufferSize(cusparseHandle_t handle,
                           cusparseOperation_t transA,
                           int m,
                           int n,
                           int nnz,
                           int *pBufferSize)

cusparseStatus_t 
cusparseCgemvi_bufferSize(cusparseHandle_t handle,
                           cusparseOperation_t transA,
                           int m,
                           int n,
                           int nnz,
                           int *pBufferSize)

cusparseStatus_t 
cusparseZgemvi_bufferSize(cusparseHandle_t handle,
                           cusparseOperation_t transA,
                           int m,
                           int n,
                           int nnz,
                           int *pBufferSize)
</pre><p class="p">This function returns size of buffer used in <samp class="ph codeph">gemvi()</samp></p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(m)x(n)</samp> dense matrix. 
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation <samp class="ph codeph">op(A)</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">Y</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero entries of vector <samp class="ph codeph">x</samp> multiplying <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSize</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of elements needed the buffer used in <samp class="ph codeph">gemvi()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n, nnz&lt;=0</samp>)  
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-bsrsv2_bufferSize"><a name="cusparse-lt-t-gt-bsrsv2_bufferSize" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrsv2_bufferSize" name="cusparse-lt-t-gt-bsrsv2_bufferSize" shape="rect">7.9.&nbsp;cusparse&lt;t&gt;bsrsv2_bufferSize()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsrsv2_bufferSize(cusparseHandle_t handle,
                           cusparseDirection_t dirA,
                           cusparseOperation_t transA,
                           int mb,
                           int nnzb,
                           const cusparseMatDescr_t descrA,
                           float *bsrValA,
                           const int *bsrRowPtrA,
                           const int *bsrColIndA,
                           int blockDim,
                           bsrsv2Info_t info,
                           int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseDbsrsv2_bufferSize(cusparseHandle_t handle,
                           cusparseDirection_t dirA,
                           cusparseOperation_t transA,
                           int mb,
                           int nnzb,
                           const cusparseMatDescr_t descrA,
                           double *bsrValA,
                           const int *bsrRowPtrA,
                           const int *bsrColIndA,
                           int blockDim,
                           bsrsv2Info_t info,
                           int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseCbsrsv2_bufferSize(cusparseHandle_t handle,
                           cusparseDirection_t dirA,
                           cusparseOperation_t transA,
                           int mb,
                           int nnzb,
                           const cusparseMatDescr_t descrA,
                           cuComplex *bsrValA,
                           const int *bsrRowPtrA,
                           const int *bsrColIndA,
                           int blockDim,
                           bsrsv2Info_t info,
                           int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseZbsrsv2_bufferSize(cusparseHandle_t handle,
                           cusparseDirection_t dirA,
                           cusparseOperation_t transA,
                           int mb,
                           int nnzb,
                           const cusparseMatDescr_t descrA,
                           cuDoubleComplex *bsrValA,
                           const int *bsrRowPtrA,
                           const int *bsrColIndA,
                           int blockDim,
                           bsrsv2Info_t info,
                           int *pBufferSizeInBytes);

</pre><p class="p">This function returns size of the buffer used in <samp class="ph codeph">bsrsv2</samp>, a new sparse triangular
                           linear system <samp class="ph codeph">op(A)*y =</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math><samp class="ph codeph">x</samp>. 
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(mb*blockDim)x(mb*blockDim)</samp> sparse matrix that is
                           defined in BSR storage format by the three arrays <samp class="ph codeph">bsrValA</samp>,
                           <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>); <samp class="ph codeph">x</samp> and
                           <samp class="ph codeph">y</samp> are the right-hand-side and the solution vectors; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and 
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">Although there are six combinations in terms of parameter <samp class="ph codeph">trans</samp> and the upper
                           (lower) triangular part of <samp class="ph codeph">A</samp>, <samp class="ph codeph">bsrsv2_bufferSize()</samp> returns
                           the maximum size buffer among these combinations. The buffer size depends on the dimensions
                           <samp class="ph codeph">mb</samp>, <samp class="ph codeph">blockDim</samp>, and the number of nonzero blocks of the
                           matrix <samp class="ph codeph">nnzb</samp>. If the user changes the matrix, it is necessary to call
                           <samp class="ph codeph">bsrsv2_bufferSize()</samp> again to have the correct buffer size; otherwise a
                           segmentation fault may occur. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       .
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, 
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every block row and the end of the last block row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix A; must be larger than zero.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">record of internal states based on different algorithms.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in the <samp class="ph codeph">bsrsv2_analysis()</samp> and
                                       <samp class="ph codeph">bsrsv2_solve()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb,nnzb&lt;=0</samp>), 
                                       base index is not 0 or 1.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-bsrsv2_analysis"><a name="cusparse-lt-t-gt-bsrsv2_analysis" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrsv2_analysis" name="cusparse-lt-t-gt-bsrsv2_analysis" shape="rect">7.10.&nbsp;cusparse&lt;t&gt;bsrsv2_analysis()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsrsv2_analysis(cusparseHandle_t handle,
                         cusparseDirection_t dirA,
                         cusparseOperation_t transA,
                         int mb,
                         int nnzb,
                         const cusparseMatDescr_t descrA,
                         const float *bsrValA,
                         const int *bsrRowPtrA,
                         const int *bsrColIndA,
                         int blockDim,
                         bsrsv2Info_t info,
                         cusparseSolvePolicy_t policy,
                         void *pBuffer);

cusparseStatus_t 
cusparseDbsrsv2_analysis(cusparseHandle_t handle,
                         cusparseDirection_t dirA,
                         cusparseOperation_t transA,
                         int mb,
                         int nnzb,
                         const cusparseMatDescr_t descrA,
                         const double *bsrValA,
                         const int *bsrRowPtrA,
                         const int *bsrColIndA,
                         int blockDim,
                         bsrsv2Info_t info,
                         cusparseSolvePolicy_t policy,
                         void *pBuffer);

cusparseStatus_t 
cusparseCbsrsv2_analysis(cusparseHandle_t handle,
                         cusparseDirection_t dirA,
                         cusparseOperation_t transA,
                         int mb,
                         int nnzb,
                         const cusparseMatDescr_t descrA,
                         const cuComplex *bsrValA,
                         const int *bsrRowPtrA,
                         const int *bsrColIndA,
                         int blockDim,
                         bsrsv2Info_t info,
                         cusparseSolvePolicy_t policy,
                         void *pBuffer);

cusparseStatus_t 
cusparseZbsrsv2_analysis(cusparseHandle_t handle,
                         cusparseDirection_t dirA,
                         cusparseOperation_t transA,
                         int mb,
                         int nnzb,
                         const cusparseMatDescr_t descrA,
                         const cuDoubleComplex *bsrValA,
                         const int *bsrRowPtrA,
                         const int *bsrColIndA,
                         int blockDim,
                         bsrsv2Info_t info,
                         cusparseSolvePolicy_t policy,
                         void *pBuffer);

</pre><p class="p">This function performs the analysis phase of <samp class="ph codeph">bsrsv2</samp>, a new sparse triangular linear system
                           <samp class="ph codeph">op(A)*y =</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math><samp class="ph codeph">x</samp>.
                           
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(mb*blockDim)x(mb*blockDim)</samp> sparse matrix that is
                           defined in BSR storage format by the three arrays <samp class="ph codeph">bsrValA</samp>,
                           <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>); <samp class="ph codeph">x</samp> and
                           <samp class="ph codeph">y</samp> are the right-hand side and the solution vectors; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and 
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">The block of BSR format is of size <samp class="ph codeph">blockDim*blockDim</samp>, stored as column-major or
                           row-major as determined by parameter <samp class="ph codeph">dirA</samp>, which is either
                           <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp> or <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp>. The
                           matrix type must be <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, and the fill mode and
                           diagonal type are ignored. 
                        </p>
                        <p class="p">It is expected that this function will be executed only once for a given matrix and a particular
                           operation type.
                        </p>
                        <p class="p">This function requires a buffer size returned by <samp class="ph codeph">bsrsv2_bufferSize()</samp>. The
                           address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is not,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">bsrsv2_analysis()</samp> reports a structural zero and computes level
                           information, which stored in the opaque structure <samp class="ph codeph">info</samp>. The level information
                           can extract more parallelism for a triangular solver. However <samp class="ph codeph">bsrsv2_solve()</samp>
                           can be done without level information. To disable level information, the user needs to specify
                           the policy of the triangular solver as <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">bsrsv2_analysis()</samp> always reports the first structural zero, even when
                           parameter <samp class="ph codeph">policy</samp> is <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. No
                           structural zero is reported if <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> is specified, even if
                           block <samp class="ph codeph">A(j,j)</samp> is missing for some <samp class="ph codeph">j</samp>. The user needs to call
                           <samp class="ph codeph">cusparseXbsrsv2_zeroPivot()</samp> to know where the structural zero is. 
                        </p>
                        <p class="p">It is the user's choice whether to call <samp class="ph codeph">bsrsv2_solve()</samp> if
                           <samp class="ph codeph">bsrsv2_analysis()</samp> reports a structural zero. In this case, the user can
                           still call <samp class="ph codeph">bsrsv2_solve()</samp>, which will return a numerical zero at the same
                           position as a structural zero. However the result <samp class="ph codeph">x</samp> is meaningless. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       .
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, 
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every block row and the end of the last block row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix A, larger than zero.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateBsrsv2Info()</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                       <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is return by
                                       <samp class="ph codeph">bsrsv2_bufferSize()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure filled with information collected during the analysis phase (that should be passed to the solve phase unchanged).</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb,nnzb&lt;=0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-bsrsv2_solve"><a name="cusparse-lt-t-gt-bsrsv2_solve" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrsv2_solve" name="cusparse-lt-t-gt-bsrsv2_solve" shape="rect">7.11.&nbsp;cusparse&lt;t&gt;bsrsv2_solve()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsrsv2_solve(cusparseHandle_t handle,
                      cusparseDirection_t dirA,
                      cusparseOperation_t transA,
                      int mb,
                      int nnzb,
                      const float *alpha,
                      const cusparseMatDescr_t descrA,
                      const float *bsrValA,
                      const int *bsrRowPtrA,
                      const int *bsrColIndA,
                      int blockDim,
                      bsrsv2Info_t info,
                      const float *x,
                      float *y,
                      cusparseSolvePolicy_t policy,
                      void *pBuffer);

cusparseStatus_t 
cusparseDbsrsv2_solve(cusparseHandle_t handle,
                      cusparseDirection_t dirA,
                      cusparseOperation_t transA,
                      int mb,
                      int nnzb,
                      const double *alpha,
                      const cusparseMatDescr_t descrA,
                      const double *bsrValA,
                      const int *bsrRowPtrA,
                      const int *bsrColIndA,
                      int blockDim,
                      bsrsv2Info_t info,
                      const double *x,
                      double *y,
                      cusparseSolvePolicy_t policy,
                      void *pBuffer);

cusparseStatus_t 
cusparseCbsrsv2_solve(cusparseHandle_t handle,
                      cusparseDirection_t dirA,
                      cusparseOperation_t transA,
                      int mb,
                      int nnzb,
                      const cuComplex *alpha,
                      const cusparseMatDescr_t descrA,
                      const cuComplex *bsrValA,
                      const int *bsrRowPtrA,
                      const int *bsrColIndA,
                      int blockDim,
                      bsrsv2Info_t info,
                      const cuComplex *x,
                      cuComplex *y,
                      cusparseSolvePolicy_t policy,
                      void *pBuffer);

cusparseStatus_t 
cusparseZbsrsv2_solve(cusparseHandle_t handle,
                      cusparseDirection_t dirA,
                      cusparseOperation_t transA,
                      int mb,
                      int nnzb,
                      const cuDoubleComplex *alpha,
                      const cusparseMatDescr_t descrA,
                      const cuDoubleComplex *bsrValA,
                      const int *bsrRowPtrA,
                      const int *bsrColIndA,
                      int blockDim,
                      bsrsv2Info_t info,
                      const cuDoubleComplex *x,
                      cuDoubleComplex *y,
                      cusparseSolvePolicy_t policy,
                      void *pBuffer);

</pre><p class="p">This function performs the solve phase of <samp class="ph codeph">bsrsv2</samp>, a new sparse triangular linear system
                           <samp class="ph codeph">op(A)*y =</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math><samp class="ph codeph">x</samp>.
                           
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(mb*blockDim)x(mb*blockDim)</samp> sparse matrix that is
                           defined in BSR storage format by the three arrays <samp class="ph codeph">bsrValA</samp>,
                           <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>); <samp class="ph codeph">x</samp> and
                           <samp class="ph codeph">y</samp> are the right-hand-side and the solution vectors; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and 
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p"> The block in BSR format is of size <samp class="ph codeph">blockDim*blockDim</samp>, stored as column-major or
                           row-major as determined by parameter <samp class="ph codeph">dirA</samp>, which is either
                           <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp> or <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp>. The
                           matrix type must be <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, and the fill mode and
                           diagonal type are ignored. Function <samp class="ph codeph">bsrsv02_solve()</samp> can support an arbitrary
                           <samp class="ph codeph">blockDim</samp>. 
                        </p>
                        <p class="p">This function may be executed multiple times for a given matrix and a particular operation type.</p>
                        <p class="p">This function requires a buffer size returned by <samp class="ph codeph">bsrsv2_bufferSize()</samp>. The
                           address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is not,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                        </p>
                        <p class="p">Although <samp class="ph codeph">bsrsv2_solve()</samp> can be done without level information, the user still
                           needs to be aware of consistency. If <samp class="ph codeph">bsrsv2_analysis()</samp> is called with policy
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>, <samp class="ph codeph">bsrsv2_solve()</samp> can be run
                           with or without levels. On the other hand, if <samp class="ph codeph">bsrsv2_analysis()</samp> is called
                           with <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>, <samp class="ph codeph">bsrsv2_solve()</samp> can only
                           accept <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>; otherwise,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                        </p>
                        <p class="p">The level information may not improve the performance, but may spend extra time doing analysis.
                           For example, a tridiagonal matrix has no parallelism. In this case,
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> performs better than
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. If the user has an iterative solver, the
                           best approach is to do <samp class="ph codeph">bsrsv2_analysis()</samp> with
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp> once. Then do
                           <samp class="ph codeph">bsrsv2_solve()</samp> with <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> in the
                           first run, and with <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp> in the second run, and
                           pick the fastest one to perform the remaining iterations. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">bsrsv02_solve()</samp> has the same behavior as
                           <samp class="ph codeph">csrsv02_solve()</samp>. That is, <samp class="ph codeph">bsr2csr(bsrsv02(A)) =
                              csrsv02(bsr2csr(A))</samp>. The numerical zero of <samp class="ph codeph">csrsv02_solve()</samp> means
                           there exists some zero <samp class="ph codeph">A(j,j)</samp>. The numerical zero of
                           <samp class="ph codeph">bsrsv02_solve()</samp> means there exists some block <samp class="ph codeph">A(j,j)</samp> that
                           is not invertible. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">bsrsv2_solve()</samp> reports the first numerical zero, including a structural
                           zero. No numerical zero is reported if <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> is specified,
                           even if <samp class="ph codeph">A(j,j)</samp> is not invertible for some <samp class="ph codeph">j</samp>. The user needs
                           to call <samp class="ph codeph">cusparseXbsrsv2_zeroPivot()</samp> to know where the numerical zero
                           is. 
                        </p>
                        <p class="p">For example, suppose L is a lower triangular matrix with unit diagonal, then the following code
                           solves <samp class="ph codeph">L*y=x</samp> by level information. 
                        </p><pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Suppose that L is m x m sparse matrix represented by BSR format, </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// The number of block rows/columns is mb, and </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// the number of nonzero blocks is nnzb.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// L is lower triangular with unit diagonal. </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Assumption:</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - dimension of matrix L is m(=mb*blockDim),</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L has nnz(=nnzb*blockDim*blockDim) nonzero elements,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - handle is already created by cusparseCreate(),</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - (d_bsrRowPtr, d_bsrColInd, d_bsrVal) is BSR of L on device memory,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_x is right hand side vector on device memory.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_y is solution vector on device memory.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_x and d_y are of size m.</span>
cusparseMatDescr_t descr = 0;
bsrsv2Info_t info = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *pBuffer = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> structural_zero;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> numerical_zero;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> alpha = 1.;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy = CUSPARSE_SOLVE_POLICY_USE_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseOperation_t trans = CUSPARSE_OPERATION_NON_TRANSPOSE;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseDirection_t dir = CUSPARSE_DIRECTION_COLUMN;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create a descriptor which contains</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L is base-1</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L is lower triangular</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L has unit diagonal, specified by parameter CUSPARSE_DIAG_TYPE_UNIT</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//   (L may not have all diagonal elements.) </span>
cusparseCreateMatDescr(&amp;descr);
cusparseSetMatIndexBase(descr, CUSPARSE_INDEX_BASE_ONE);
cusparseSetMatFillMode(descr, CUSPARSE_FILL_MODE_LOWER);
cusparseSetMatDiagType(descr, CUSPARSE_DIAG_TYPE_UNIT);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: create a empty info structure</span>
cusparseCreateBsrsv2Info(&amp;info);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query how much memory used in bsrsv2, and allocate the buffer</span>
cusparseDbsrsv2_bufferSize(handle, dir, trans, mb, nnzb, descr,
    d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, &amp;pBufferSize);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// pBuffer returned by cudaMalloc is automatically aligned to 128 bytes.</span>
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;pBuffer, pBufferSize);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: perform analysis </span>
cusparseDbsrsv2_analysis(handle, dir, trans, mb, nnzb, descr, 
    d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>,
    info, policy, pBuffer);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// L has unit diagonal, so no structural zero is reported.</span>
status = cusparseXbsrsv2_zeroPivot(handle, info, &amp;structural_zero);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (CUSPARSE_STATUS_ZERO_PIVOT == status){
   printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"L(%d,%d) is missing\n"</span>, structural_zero, structural_zero);
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: solve L*y = x</span>
cusparseDbsrsv2_solve(handle, dir, trans, mb, nnzb, &amp;alpha, descr,
   d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info,
   d_x, d_y, policy, pBuffer);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// L has unit diagonal, so no numerical zero is reported.</span>
status = cusparseXbsrsv2_zeroPivot(handle, info, &amp;numerical_zero);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (CUSPARSE_STATUS_ZERO_PIVOT == status){
   printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"L(%d,%d) is zero\n"</span>, numerical_zero, numerical_zero);
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: free resources</span>
cudaFree(pBuffer);
cusparseDestroyBsrsv2Info(info);
cusparseDestroyMatDescr(descr);
cusparseDestroy(handle);
</pre><div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       . 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows and block columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, 
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every block row and the end of the last block row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix <samp class="ph codeph">A</samp>, larger than zero.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase (that should have been passed to the solve phase unchanged).</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; right-hand-side vector of size <samp class="ph codeph">m</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                       <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is returned by
                                       <samp class="ph codeph">bsrsv2_bufferSize()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; solution vector of size <samp class="ph codeph">m</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb,nnzb&lt;=0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MAPPING_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the texture binding failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-bsrsv2_zeroPivot"><a name="cusparse-lt-t-gt-bsrsv2_zeroPivot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrsv2_zeroPivot" name="cusparse-lt-t-gt-bsrsv2_zeroPivot" shape="rect">cusparseXbsrsv2_zeroPivot()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseXbsrsv2_zeroPivot(cusparseHandle_t handle,
                          bsrsv2Info_t info,
                          int *position);
</pre><p class="p">If the returned error code is <samp class="ph codeph">CUSPARSE_STATUS_ZERO_PIVOT</samp>,
                           <samp class="ph codeph">position=j</samp> means <samp class="ph codeph">A(j,j)</samp> is either structural zero or numerical
                           zero (singular block). Otherwise <samp class="ph codeph">position=-1</samp>. 
                        </p>
                        <p class="p">The <samp class="ph codeph">position</samp> can be 0-based or 1-based, the same as the matrix. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">cusparseXbsrsv2_zeroPivot()</samp> is a blocking call. It calls
                           <samp class="ph codeph">cudaDeviceSynchronize()</samp> to make sure all previous kernels are done. 
                        </p>
                        <p class="p">The <samp class="ph codeph">position</samp> can be in the host memory or device memory. The user can set the
                           proper mode with <samp class="ph codeph">cusparseSetPointerMode()</samp>. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> contains a structural zero or numerical zero if the user
                                       already called <samp class="ph codeph">bsrsv2_analysis()</samp> or <samp class="ph codeph">bsrsv2_solve()</samp>. 
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">position</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">if no structural or numerical zero, <samp class="ph codeph">position</samp> is -1; otherwise if
                                       <samp class="ph codeph">A(j,j)</samp> is missing or <samp class="ph codeph">U(j,j)</samp> is zero, <samp class="ph codeph">position=j</samp>. 
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> is not valid.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsvanalysis"><a name="cusparse-lt-t-gt-csrsvanalysis" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsvanalysis" name="cusparse-lt-t-gt-csrsvanalysis" shape="rect">7.13.&nbsp;cusparse&lt;t&gt;csrsv_analysis()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsrsv_analysis(cusparseHandle_t handle, 
                        cusparseOperation_t transA, 
                        int m, 
                        int nnz, 
                        const cusparseMatDescr_t descrA,
                        const float *csrValA, 
                        const int *csrRowPtrA, 
                        const int *csrColIndA, 
                        cusparseSolveAnalysisInfo_t info)
cusparseStatus_t 
cusparseDcsrsv_analysis(cusparseHandle_t handle, 
                        cusparseOperation_t transA, 
                        int m, 
                        int nnz, 
                        const cusparseMatDescr_t descrA,
                        const double *csrValA, 
                        const int *csrRowPtrA, 
                        const int *csrColIndA, 
                        cusparseSolveAnalysisInfo_t info)    
cusparseStatus_t 
cusparseCcsrsv_analysis(cusparseHandle_t handle, 
                        cusparseOperation_t transA, 
                        int m, 
                        int nnz, 
                        const cusparseMatDescr_t descrA,
                        const cuComplex *csrValA, 
                        const int *csrRowPtrA, 
                        const int *csrColIndA, 
                        cusparseSolveAnalysisInfo_t info)    
cusparseStatus_t 
cusparseZcsrsv_analysis(cusparseHandle_t handle, 
                        cusparseOperation_t transA, 
                        int m, 
                        int nnz, 
                        const cusparseMatDescr_t descrA,
                        const cuDoubleComplex *csrValA, 
                        const int *csrRowPtrA, 
                        const int *csrColIndA, 
                        cusparseSolveAnalysisInfo_t info)
</pre><p class="p">This function performs the analysis phase of the solution of a sparse triangular linear system</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>x</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">where <samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR
                           storage format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           <samp class="ph codeph">csrColIndA</samp>); <samp class="ph codeph">x</samp> and <samp class="ph codeph">y</samp> are the
                           right-hand-side and the solution vectors; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">
                           The routine <samp class="ph codeph">csrsv_analysis</samp> supports analysis phase of <samp class="ph codeph">csrsv_solve</samp>, 
                           <samp class="ph codeph">csric0</samp> and <samp class="ph codeph">csrilu0</samp>.
                           The user has to be careful of which routine is called after <samp class="ph codeph">csrsv_analysis</samp>. 
                           The matrix descriptor must be the same for <samp class="ph codeph">csrsv_analysis</samp> and its subsequent call to 
                           <samp class="ph codeph">csrsv_solve</samp>, <samp class="ph codeph">csric0</samp> and <samp class="ph codeph">csrilu0</samp>.
                           
                        </p>
                        <p class="p">
                           For <samp class="ph codeph">csrsv_solve</samp>, 
                           the matrix type must be <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_TRIANGULAR</samp>
                           or <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                           
                        </p>
                        <p class="p">
                           For <samp class="ph codeph">csrilu0</samp>, the matrix type must be <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                           
                        </p>
                        <p class="p">
                           For <samp class="ph codeph">csric0</samp>, the matrix type must be <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_SYMMETRIC</samp> or
                           <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_HERMITIAN</samp>.
                           
                        </p>
                        <p class="p">It is expected that this function will be executed only once for a given matrix and a particular
                           operation type.
                        </p>
                        <p class="p">This function requires a significant amount of extra storage that is proportional to the
                           matrix size. It is executed asynchronously with respect to the host and may return control to
                           the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">trans</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>. 
                                       The supported matrix types are <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_TRIANGULAR</samp> and 
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> for <samp class="ph codeph">csrsv_solve</samp>, 
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_SYMMETRIC</samp> and <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_HERMITIAN</samp>
                                       for <samp class="ph codeph">csric0</samp>,
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> for <samp class="ph codeph">csrilu0</samp>, 
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       column indices of the nonzero elements of matrix
                                       <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateSolveAnalysisInfo</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure filled with information collected during the analysis phase (that should be passed to the solve phase unchanged).</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-csrsvanalysisEx"><a name="cusparse-csrsvanalysisEx" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-csrsvanalysisEx" name="cusparse-csrsvanalysisEx" shape="rect">7.14.&nbsp;cusparseCsrsv_analysisEx()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t cusparseCsrsv_analysisEx(cusparseHandle_t handle, 
                                          cusparseOperation_t transA, 
                                          int m, int nnz,
                                          const cusparseMatDescr_t descrA, 
                                          const void *csrSortedValA, cudaDataType csrSortedValAtype,
                                          const int *csrSortedRowPtrA, 
                                          const int *csrSortedColIndA, 
                                          cusparseSolveAnalysisInfo_t info,
                                          cudaDataType executiontype);
</pre><p class="p">This function is an extended version of <samp class="ph codeph">cusparse&lt;t&gt;csrsv_analysis()</samp>. For detailed description of the functionality, see <samp class="ph codeph">cusparse&lt;t&gt;csrsv_analysis()</samp>.
                        </p>
                        <p class="p">This function does not support half-precision execution type, but it supports half-precision IO with single precision execution.</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input specifically required by <samp class="ph codeph">cusparseCsrsv_analysisEx</samp></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrSortedValAtype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">csrSortedValA</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">executiontype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type used for computation.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsvsolve"><a name="cusparse-lt-t-gt-csrsvsolve" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsvsolve" name="cusparse-lt-t-gt-csrsvsolve" shape="rect">7.15.&nbsp;cusparse&lt;t&gt;csrsv_solve()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t cusparseScsrsv_solve(cusparseHandle_t handle, 
                                      cusparseOperation_t transA, 
                                      int m, const float *alpha, 
                                      const cusparseMatDescr_t descrA, 
                                      const float *csrSortedValA, 
                                      const int *csrSortedRowPtrA, const int *csrSortedColIndA, 
                                      cusparseSolveAnalysisInfo_t info, 
                                      const float *f, float *x);

cusparseStatus_t cusparseDcsrsv_solve(cusparseHandle_t handle, 
                                      cusparseOperation_t transA, 
                                      int m, const double *alpha, 
                                      const cusparseMatDescr_t descrA, 
                                      const double *csrSortedValA, 
                                      const int *csrSortedRowPtrA, const int *csrSortedColIndA, 
                                      cusparseSolveAnalysisInfo_t info, 
                                      const double *f, double *x);

cusparseStatus_t cusparseCcsrsv_solve(cusparseHandle_t handle, 
                                      cusparseOperation_t transA, 
                                      int m, const cuComplex *alpha, 
                                      const cusparseMatDescr_t descrA, 
                                      const cuComplex *csrSortedValA, 
                                      const int *csrSortedRowPtrA, const int *csrSortedColIndA, 
                                      cusparseSolveAnalysisInfo_t info, 
                                      const cuComplex *f, cuComplex *x);

cusparseStatus_t cusparseZcsrsv_solve(cusparseHandle_t handle, 
                                      cusparseOperation_t transA, 
                                      int m, const cuDoubleComplex *alpha, 
                                      const cusparseMatDescr_t descrA, 
                                      const cuDoubleComplex *csrSortedValA, 
                                      const int *csrSortedRowPtrA, const int *csrSortedColIndA, 
                                      cusparseSolveAnalysisInfo_t info, 
                                      const cuDoubleComplex *f, cuDoubleComplex *x);      
</pre><p class="p">This function performs the solve phase of the solution of a sparse triangular linear system</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>x</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>f</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">where <samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR
                           storage format by the three arrays <samp class="ph codeph">csrSortedValA</samp>, <samp class="ph codeph">csrSortedRowPtrA</samp>, and
                           <samp class="ph codeph">csrSortedColIndA</samp>); <samp class="ph codeph">f</samp> and <samp class="ph codeph">x</samp> are the
                           right-hand-side and the solution vectors; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">This function may be executed multiple times for a given matrix and a particular operation type.</p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host
                           and may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">trans</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix types are
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_TRIANGULAR</samp> and
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, while the supported diagonal types
                                       are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and
                                       <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrSortedValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrSortedRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrSortedRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrSortedRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrSortedColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrSortedRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrSortedRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       column indices of the nonzero elements of matrix
                                       <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase (that should have been passed to the solve phase unchanged).</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">f</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; right-hand-side vector of size <samp class="ph codeph">m</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; solution vector of size <samp class="ph codeph">m</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MAPPING_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the texture binding failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-csrsvsolveEx"><a name="cusparse-csrsvsolveEx" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-csrsvsolveEx" name="cusparse-csrsvsolveEx" shape="rect">7.16.&nbsp;cusparseCsrsv_solveEx()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t cusparseCsrsv_solveEx(cusparseHandle_t handle, 
                                       cusparseOperation_t transA, 
                                       int m,
                                       const void *alpha, cudaDataType alphatype,
                                       const cusparseMatDescr_t descrA, 
                                       const void *csrSortedValA, cudaDataType csrSortedValAtype,
                                       const int *csrSortedRowPtrA, 
                                       const int *csrSortedColIndA, 
                                       cusparseSolveAnalysisInfo_t info, 
                                       const void *f, cudaDataType ftype,
                                       void *x, cudaDataType xtype,
                                       cudaDataType executiontype);
</pre><p class="p">This function is an extended version of <samp class="ph codeph">cusparse&lt;t&gt;csrsv_solve()</samp>. For detailed description of the functionality, see <samp class="ph codeph">cusparse&lt;t&gt;csrsv_solve()</samp>.
                        </p>
                        <p class="p">This function does not support half-precision execution type, but it supports half-precision IO with single precision execution.</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input specifically required by <samp class="ph codeph">cusparseCsrsv_solveEx</samp></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alphatype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">alpha</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrSortedValAtype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">csrSortedValA</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ftype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">f</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">xtype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">x</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">executiontype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type used for computation.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsv2_bufferSize"><a name="cusparse-lt-t-gt-csrsv2_bufferSize" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsv2_bufferSize" name="cusparse-lt-t-gt-csrsv2_bufferSize" shape="rect">7.17.&nbsp;cusparse&lt;t&gt;csrsv2_bufferSize()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsrsv2_bufferSize(cusparseHandle_t handle,
                           cusparseOperation_t transA,
                           int m,
                           int nnz,
                           const cusparseMatDescr_t descrA,
                           float *csrValA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           csrsv2Info_t info,
                           int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseDcsrsv2_bufferSize(cusparseHandle_t handle,
                           cusparseOperation_t transA,
                           int m,
                           int nnz,
                           const cusparseMatDescr_t descrA,
                           double *csrValA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           csrsv2Info_t info,
                           int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseCcsrsv2_bufferSize(cusparseHandle_t handle,
                           cusparseOperation_t transA,
                           int m,
                           int nnz,
                           const cusparseMatDescr_t descrA,
                           cuComplex *csrValA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           csrsv2Info_t info,
                           int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseZcsrsv2_bufferSize(cusparseHandle_t handle,
                           cusparseOperation_t transA,
                           int m,
                           int nnz,
                           const cusparseMatDescr_t descrA,
                           cuDoubleComplex *csrValA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           csrsv2Info_t info,
                           int *pBufferSizeInBytes);

</pre><p class="p">This function returns the size of the buffer used in <samp class="ph codeph">csrsv2</samp>, a new sparse
                           triangular linear system <samp class="ph codeph">op(A)*y =</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math><samp class="ph codeph">x</samp>. 
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                           format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           <samp class="ph codeph">csrColIndA</samp>); <samp class="ph codeph">x</samp> and <samp class="ph codeph">y</samp> are the
                           right-hand-side and the solution vectors; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">Although there are six combinations in terms of the parameter <samp class="ph codeph">trans</samp> and the
                           upper (lower) triangular part of <samp class="ph codeph">A</samp>, <samp class="ph codeph">csrsv2_bufferSize()</samp>
                           returns the maximum size buffer of these combinations. The buffer size depends on the
                           dimension and the  number of nonzero elements of the matrix. If the user changes the matrix,
                           it is necessary to call <samp class="ph codeph">csrsv2_bufferSize()</samp> again to have the correct buffer
                           size; otherwise, a segmentation fault may occur. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       .
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, 
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">record of internal states based on different algorithms.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in the <samp class="ph codeph">csrsv2_analysis</samp> and <samp class="ph codeph">csrsv2_solve</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>), 
                                       base index is not 0 or 1.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsv2_analysis"><a name="cusparse-lt-t-gt-csrsv2_analysis" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsv2_analysis" name="cusparse-lt-t-gt-csrsv2_analysis" shape="rect">7.18.&nbsp;cusparse&lt;t&gt;csrsv2_analysis()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsrsv2_analysis(cusparseHandle_t handle,
                         cusparseOperation_t transA,
                         int m,
                         int nnz,
                         const cusparseMatDescr_t descrA,
                         const float *csrValA,
                         const int *csrRowPtrA,
                         const int *csrColIndA,
                         csrsv2Info_t info,
                         cusparseSolvePolicy_t policy,
                         void *pBuffer);

cusparseStatus_t 
cusparseDcsrsv2_analysis(cusparseHandle_t handle,
                         cusparseOperation_t transA,
                         int m,
                         int nnz,
                         const cusparseMatDescr_t descrA,
                         const double *csrValA,
                         const int *csrRowPtrA,
                         const int *csrColIndA,
                         csrsv2Info_t info,
                         cusparseSolvePolicy_t policy,
                         void *pBuffer);

cusparseStatus_t 
cusparseCcsrsv2_analysis(cusparseHandle_t handle,
                         cusparseOperation_t transA,
                         int m,
                         int nnz,
                         const cusparseMatDescr_t descrA,
                         const cuComplex *csrValA,
                         const int *csrRowPtrA,
                         const int *csrColIndA,
                         csrsv2Info_t info,
                         cusparseSolvePolicy_t policy,
                         void *pBuffer);

cusparseStatus_t 
cusparseZcsrsv2_analysis(cusparseHandle_t handle,
                         cusparseOperation_t transA,
                         int m,
                         int nnz,
                         const cusparseMatDescr_t descrA,
                         const cuDoubleComplex *csrValA,
                         const int *csrRowPtrA,
                         const int *csrColIndA,
                         csrsv2Info_t info,
                         cusparseSolvePolicy_t policy,
                         void *pBuffer);

</pre><p class="p">This function performs the analysis phase of <samp class="ph codeph">csrsv2</samp>, a new sparse triangular linear system
                           <samp class="ph codeph">op(A)*y =</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math><samp class="ph codeph">x</samp>.
                           
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                           format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           <samp class="ph codeph">csrColIndA</samp>); <samp class="ph codeph">x</samp> and <samp class="ph codeph">y</samp> are the
                           right-hand-side and the solution vectors; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">It is expected that this function will be executed only once for a given matrix and a particular operation type.</p>
                        <p class="p">This function requires a buffer size returned by <samp class="ph codeph">csrsv2_bufferSize()</samp>. The
                           address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is not,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">csrsv2_analysis()</samp> reports a structural zero and computes level
                           information that is stored in opaque structure <samp class="ph codeph">info</samp>. The level information
                           can extract more parallelism for a triangular solver. However <samp class="ph codeph">csrsv2_solve()</samp>
                           can be done without level information. To disable level information, the user needs to specify
                           the policy of the triangular solver as <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">csrsv2_analysis()</samp> always reports the first structural zero, even if the
                           policy is <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. No structural zero is reported if
                           <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> is specified, even if <samp class="ph codeph">A(j,j)</samp> is
                           missing for some <samp class="ph codeph">j</samp>. The user needs to call
                           <samp class="ph codeph">cusparseXcsrsv2_zeroPivot()</samp> to know where the structural zero is. 
                        </p>
                        <p class="p">It is the user's choice whether to call <samp class="ph codeph">csrsv2_solve()</samp> if
                           <samp class="ph codeph">csrsv2_analysis()</samp> reports a structural zero. In this case, the user can
                           still call <samp class="ph codeph">csrsv2_solve()</samp> which will return a numerical zero in the same
                           position as the structural zero. However the result <samp class="ph codeph">x</samp> is meaningless. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       . 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, 
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateCsrsv2Info()</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">The supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                       <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is returned by
                                       <samp class="ph codeph">csrsv2_bufferSize()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure filled with information collected during the analysis phase (that should be passed to the solve phase unchanged).</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsv2_solve"><a name="cusparse-lt-t-gt-csrsv2_solve" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsv2_solve" name="cusparse-lt-t-gt-csrsv2_solve" shape="rect">7.19.&nbsp;cusparse&lt;t&gt;csrsv2_solve()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsrsv2_solve(cusparseHandle_t handle,
                      cusparseOperation_t transA,
                      int m,
                      int nnz,
                      const float *alpha,
                      const cusparseMatDescr_t descra,
                      const float *csrValA,
                      const int *csrRowPtrA,
                      const int *csrColIndA,
                      csrsv2Info_t info,
                      const float *x,
                      float *y,
                      cusparseSolvePolicy_t policy,
                      void *pBuffer);

cusparseStatus_t 
cusparseDcsrsv2_solve(cusparseHandle_t handle,
                      cusparseOperation_t transA,
                      int m,
                      int nnz,
                      const double *alpha,
                      const cusparseMatDescr_t descra,
                      const double *csrValA,
                      const int *csrRowPtrA,
                      const int *csrColIndA,
                      csrsv2Info_t info,
                      const double *x,
                      double *y,
                      cusparseSolvePolicy_t policy,
                      void *pBuffer);

cusparseStatus_t 
cusparseCcsrsv2_solve(cusparseHandle_t handle,
                      cusparseOperation_t transA,
                      int m,
                      int nnz,
                      const cuComplex *alpha,
                      const cusparseMatDescr_t descra,
                      const cuComplex *csrValA,
                      const int *csrRowPtrA,
                      const int *csrColIndA,
                      csrsv2Info_t info,
                      const cuComplex *x,
                      cuComplex *y,
                      cusparseSolvePolicy_t policy,
                      void *pBuffer);

cusparseStatus_t 
cusparseZcsrsv2_solve(cusparseHandle_t handle,
                      cusparseOperation_t transA,
                      int m,
                      int nnz,
                      const cuDoubleComplex *alpha,
                      const cusparseMatDescr_t descra,
                      const cuDoubleComplex *csrValA,
                      const int *csrRowPtrA,
                      const int *csrColIndA,
                      csrsv2Info_t info,
                      const cuDoubleComplex *x,
                      cuDoubleComplex *y,
                      cusparseSolvePolicy_t policy,
                      void *pBuffer);

</pre><p class="p">This function performs the solve phase of <samp class="ph codeph">csrsv2</samp>, a new sparse triangular linear system
                           <samp class="ph codeph">op(A)*y =</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math><samp class="ph codeph">x</samp>.
                           
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                           format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           <samp class="ph codeph">csrColIndA</samp>); <samp class="ph codeph">x</samp> and <samp class="ph codeph">y</samp> are the
                           right-hand-side and the solution vectors; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">This function may be executed multiple times for a given matrix and a particular operation type.</p>
                        <p class="p">This function requires the buffer size returned by <samp class="ph codeph">csrsv2_bufferSize()</samp>. The
                           address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is not,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                        </p>
                        <p class="p">Although <samp class="ph codeph">csrsv2_solve()</samp> can be done without level information, the user still
                           needs to be aware of consistency. If <samp class="ph codeph">csrsv2_analysis()</samp> is called with policy
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>, <samp class="ph codeph">csrsv2_solve()</samp> can be run
                           with or without levels. On the contrary, if <samp class="ph codeph">csrsv2_analysis()</samp> is called with
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>, <samp class="ph codeph">csrsv2_solve()</samp> can only
                           accept <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>; otherwise,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                        </p>
                        <p class="p">The level information may not improve the performance but spend extra time doing analysis. For
                           example, a tridiagonal matrix has no parallelism. In this case,
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> performs better than
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. If the user has an iterative solver, the
                           best approach is to do <samp class="ph codeph">csrsv2_analysis()</samp> with
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp> once. Then do
                           <samp class="ph codeph">csrsv2_solve()</samp> with <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> in the
                           first run and with <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp> in the second run, picking
                           faster one to perform the remaining iterations. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">csrsv2_solve()</samp> reports the first numerical zero, including a structural
                           zero. If <samp class="ph codeph">status</samp> is 0, no numerical zero was found. Furthermore, no numerical
                           zero is reported if <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> is specified, even if
                           <samp class="ph codeph">A(j,j)</samp> is zero for some <samp class="ph codeph">j</samp>. The user needs to call
                           <samp class="ph codeph">cusparseXcsrsv2_zeroPivot()</samp> to know where the numerical zero is. 
                        </p>
                        <p class="p">For example, suppose L is a lower triangular matrix with unit diagonal, the following code solves
                           <samp class="ph codeph">L*y=x</samp> by level information. 
                        </p><pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Suppose that L is m x m sparse matrix represented by CSR format, </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// L is lower triangular with unit diagonal. </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Assumption:</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - dimension of matrix L is m,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L has nnz number zero elements,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - handle is already created by cusparseCreate(),</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - (d_csrRowPtr, d_csrColInd, d_csrVal) is CSR of L on device memory,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_x is right hand side vector on device memory,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_y is solution vector on device memory.</span>

cusparseMatDescr_t descr = 0;
csrsv2Info_t info = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *pBuffer = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> structural_zero;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> numerical_zero;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> alpha = 1.;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy = CUSPARSE_SOLVE_POLICY_USE_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseOperation_t trans = CUSPARSE_OPERATION_NON_TRANSPOSE;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create a descriptor which contains</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L is base-1</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L is lower triangular</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L has unit diagonal, specified by parameter CUSPARSE_DIAG_TYPE_UNIT</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//   (L may not have all diagonal elements.) </span>
cusparseCreateMatDescr(&amp;descr);
cusparseSetMatIndexBase(descr, CUSPARSE_INDEX_BASE_ONE);
cusparseSetMatFillMode(descr, CUSPARSE_FILL_MODE_LOWER);
cusparseSetMatDiagType(descr, CUSPARSE_DIAG_TYPE_UNIT);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: create a empty info structure</span>
cusparseCreateCsrsv2Info(&amp;info);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query how much memory used in csrsv2, and allocate the buffer</span>
cusparseDcsrsv2_bufferSize(handle, trans, m, nnz, descr,
    d_csrVal, d_csrRowPtr, d_csrColInd, &amp;pBufferSize);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// pBuffer returned by cudaMalloc is automatically aligned to 128 bytes.</span>
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;pBuffer, pBufferSize);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: perform analysis </span>
cusparseDcsrsv2_analysis(handle, trans, m, nnz, descr, 
    d_csrVal, d_csrRowPtr, d_csrColInd,
    info, policy, pBuffer);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// L has unit diagonal, so no structural zero is reported.</span>
status = cusparseXcsrsv2_zeroPivot(handle, info, &amp;structural_zero);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (CUSPARSE_STATUS_ZERO_PIVOT == status){
   printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"L(%d,%d) is missing\n"</span>, structural_zero, structural_zero);
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: solve L*y = x</span>
cusparseDcsrsv2_solve(handle, trans, m, nnz, &amp;alpha, descr,
   d_csrVal, d_csrRowPtr, d_csrColInd, info,
   d_x, d_y, policy, pBuffer);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// L has unit diagonal, so no numerical zero is reported.</span>
status = cusparseXcsrsv2_zeroPivot(handle, info, &amp;numerical_zero);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (CUSPARSE_STATUS_ZERO_PIVOT == status){
   printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"L(%d,%d) is zero\n"</span>, numerical_zero, numerical_zero);
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: free resources</span>
cudaFree(pBuffer);
cusparseDestroyCsrsv2Info(info);
cusparseDestroyMatDescr(descr);
cusparseDestroy(handle);
</pre><p class="p">
                           Remark: <samp class="ph codeph">csrsv2_solve()</samp> needs more nonzeros per row to achieve good performance.
                           It would perform better if more than 16 nonzeros per row in average.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       .
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, 
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase (that should have been passed to the solve phase unchanged).</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; right-hand-side vector of size <samp class="ph codeph">m</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">The supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                       <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is return by <samp class="ph codeph">csrsv2_bufferSize</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; solution vector of size <samp class="ph codeph">m</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MAPPING_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the texture binding failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsv2_zeroPivot"><a name="cusparse-lt-t-gt-csrsv2_zeroPivot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsv2_zeroPivot" name="cusparse-lt-t-gt-csrsv2_zeroPivot" shape="rect">cusparseXcsrsv2_zeroPivot()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseXcsrsv2_zeroPivot(cusparseHandle_t handle,
                          csrsv2Info_t info,
                          int *position);</pre><p class="p"> If the returned error code is <samp class="ph codeph">CUSPARSE_STATUS_ZERO_PIVOT</samp>,
                           <samp class="ph codeph">position=j</samp> means <samp class="ph codeph">A(j,j)</samp> has either a structural zero or a
                           numerical zero. Otherwise <samp class="ph codeph">position=-1</samp>. 
                        </p>
                        <p class="p">The <samp class="ph codeph">position</samp> can be 0-based or 1-based, the same as the matrix. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">cusparseXcsrsv2_zeroPivot()</samp> is a blocking call. It calls
                           <samp class="ph codeph">cudaDeviceSynchronize()</samp> to make sure all previous kernels are done. 
                        </p>
                        <p class="p">The <samp class="ph codeph">position</samp> can be in the host memory or device memory. The user can set the
                           proper mode with <samp class="ph codeph">cusparseSetPointerMode()</samp>. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> contains structural zero or numerical zero if the user already
                                       called <samp class="ph codeph">csrsv2_analysis()</samp> or <samp class="ph codeph">csrsv2_solve()</samp>. 
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">position</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">if no structural or numerical zero, <samp class="ph codeph">position</samp> is -1; otherwise, if
                                       <samp class="ph codeph">A(j,j)</samp> is missing or <samp class="ph codeph">U(j,j)</samp> is zero, <samp class="ph codeph">position=j</samp>. 
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> is not valid.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-hybmv"><a name="cusparse-lt-t-gt-hybmv" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-hybmv" name="cusparse-lt-t-gt-hybmv" shape="rect">7.21.&nbsp;cusparse&lt;t&gt;hybmv()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseShybmv(cusparseHandle_t handle, cusparseOperation_t transA,
               const float           *alpha, 
               const cusparseMatDescr_t descrA,
               const cusparseHybMat_t hybA, const float           *x,
               const float           *beta, float           *y)
cusparseStatus_t
cusparseDhybmv(cusparseHandle_t handle, cusparseOperation_t transA,
               const double          *alpha, 
               const cusparseMatDescr_t descrA,
               const cusparseHybMat_t hybA, const double          *x,
               const double          *beta, double          *y)
cusparseStatus_t
cusparseChybmv(cusparseHandle_t handle, cusparseOperation_t transA,
               const cuComplex       *alpha, 
               const cusparseMatDescr_t descrA,
               const cusparseHybMat_t hybA, const cuComplex       *x,
               const cuComplex       *beta, cuComplex       *y)
cusparseStatus_t
cusparseZhybmv(cusparseHandle_t handle, cusparseOperation_t transA,
               const cuDoubleComplex *alpha, 
               const cusparseMatDescr_t descrA,
               const cusparseHybMat_t hybA, const cuDoubleComplex *x,
               const cuDoubleComplex *beta, cuDoubleComplex *y)</pre><p class="p">This function performs the matrix-vector operation</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>x</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>+</mo>
                                          <mi>β</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×n</samp> sparse matrix that is defined in the HYB
                           			storage format by an opaque data structure <samp class="ph codeph">hybA</samp>, <samp class="ph codeph">x</samp> and
                           				<samp class="ph codeph">y</samp> are vectors, 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                              <mtext>&nbsp;and&nbsp;</mtext>
                              <mi>β</mi>
                           </math>
                           			 are scalars, and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>&nbsp;if transA == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">Notice that currently only
                           
                           	
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mtext>op</mtext>
                                 </mrow>
                              </mrow>
                              <mo stretchy="false">(</mo>
                              <mi>A</mi>
                              <mo stretchy="false">)</mo>
                              <mo>=</mo>
                              <mi>A</mi>
                           </math>
                           
                           is supported.
                        </p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host
                           			and may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       		
                                       	(currently only
                                       		
                                       			
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       		
                                       	is supported).
                                       	
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">hybA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix <samp class="ph codeph">A</samp> in HYB storage format.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector of <samp class="ph codeph">n</samp> elements.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication. If <samp class="ph codeph">beta</samp> is zero, <samp class="ph codeph">y</samp> does not have to be a valid input.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; vector of <samp class="ph codeph">m</samp> elements.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; updated vector.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the internally stored HYB format parameters are invalid.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-hybsvanalysis"><a name="cusparse-lt-t-gt-hybsvanalysis" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-hybsvanalysis" name="cusparse-lt-t-gt-hybsvanalysis" shape="rect">7.22.&nbsp;cusparse&lt;t&gt;hybsv_analysis()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseShybsv_analysis(cusparseHandle_t handle, 
                        cusparseOperation_t transA,
                        const cusparseMatDescr_t descrA, 
                        cusparseHybMat_t hybA,
                        cusparseSolveAnalysisInfo_t info)    
cusparseStatus_t
cusparseDhybsv_analysis(cusparseHandle_t handle, 
                        cusparseOperation_t transA,
                        const cusparseMatDescr_t descrA, 
                        cusparseHybMat_t hybA,
                        cusparseSolveAnalysisInfo_t info)    
cusparseStatus_t
cusparseChybsv_analysis(cusparseHandle_t handle, 
                        cusparseOperation_t transA,
                        const cusparseMatDescr_t descrA, 
                        cusparseHybMat_t hybA,
                        cusparseSolveAnalysisInfo_t info)    
cusparseStatus_t
cusparseZhybsv_analysis(cusparseHandle_t handle, 
                        cusparseOperation_t transA,
                        const cusparseMatDescr_t descrA, 
                        cusparseHybMat_t hybA,
                        cusparseSolveAnalysisInfo_t info) </pre><p class="p">This function performs the analysis phase of the solution of a sparse triangular linear system</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>x</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in HYB storage
                           			format by an opaque data structure <samp class="ph codeph">hybA</samp>, <samp class="ph codeph">x</samp> and
                           				<samp class="ph codeph">y</samp> are the right-hand-side and the solution vectors, 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           			 is a scalar, and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>&nbsp;if transA == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">Notice that currently only
                           
                           	
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mtext>op</mtext>
                                 </mrow>
                              </mrow>
                              <mo stretchy="false">(</mo>
                              <mi>A</mi>
                              <mo stretchy="false">)</mo>
                              <mo>=</mo>
                              <mi>A</mi>
                           </math>
                           
                           is supported.
                        </p>
                        <p class="p">It is expected that this function will be executed only once for a given matrix and a particular
                           			operation type.
                        </p>
                        <p class="p">This function requires a significant amount of extra storage that is proportional to the
                           			matrix size. It is executed asynchronously with respect to the host and may return
                           			control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       		
                                       	(currently only
                                       		
                                       			
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       		
                                       	is supported).
                                       	
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_TRIANGULAR</samp> and diagonal type
                                       								<samp class="ph codeph">USPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">hybA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix <samp class="ph codeph">A</samp> in HYB storage format.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateSolveAnalysisInfo()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure filled with information collected during the analysis phase (that should be passed to the solve phase unchanged).</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the internally stored HYB format parameters are invalid.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-hybsvsolve"><a name="cusparse-lt-t-gt-hybsvsolve" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-hybsvsolve" name="cusparse-lt-t-gt-hybsvsolve" shape="rect">7.23.&nbsp;cusparse&lt;t&gt;hybsv_solve()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseShybsv_solve(cusparseHandle_t handle, 
                     cusparseOperation_t transA,
                     const float           *alpha, 
                     const cusparseMatDescr_t descrA,
                     cusparseHybMat_t hybA, 
                     cusparseSolveAnalysisInfo_t info,
                     const float           *x, float           *y)
cusparseStatus_t 
cusparseDhybsv_solve(cusparseHandle_t handle, 
                     cusparseOperation_t transA,
                     const double          *alpha, 
                     const cusparseMatDescr_t descrA,
                     cusparseHybMat_t hybA, 
                     cusparseSolveAnalysisInfo_t info,
                     const double          *x, double          *y)
cusparseStatus_t 
cusparseChybsv_solve(cusparseHandle_t handle, 
                     cusparseOperation_t transA,
                     const cuComplex       *alpha, 
                     const cusparseMatDescr_t descrA,
                     cusparseHybMat_t hybA, 
                     cusparseSolveAnalysisInfo_t info,
                     const cuComplex       *x, cuComplex       *y)
cusparseStatus_t 
cusparseZhybsv_solve(cusparseHandle_t handle, 
                     cusparseOperation_t transA,
                     const cuDoubleComplex *alpha, 
                     const cusparseMatDescr_t descrA,
                     cusparseHybMat_t hybA, 
                     cusparseSolveAnalysisInfo_t info,
                     const cuDoubleComplex *x, cuDoubleComplex *y)</pre><p class="p">This function performs the solve phase of the solution of a sparse triangular linear system:</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>y</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>x</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in HYB storage
                           			format by an opaque data structure <samp class="ph codeph">hybA</samp>, <samp class="ph codeph">x</samp> and
                           				<samp class="ph codeph">y</samp> are the right-hand-side and the solution vectors, 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           			 is a scalar, and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>&nbsp;if transA == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">Notice that currently only
                           
                           	
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mtext>op</mtext>
                                 </mrow>
                              </mrow>
                              <mo stretchy="false">(</mo>
                              <mi>A</mi>
                              <mo stretchy="false">)</mo>
                              <mo>=</mo>
                              <mi>A</mi>
                           </math>
                           
                           is supported.
                        </p>
                        <p class="p">This function may be executed multiple times for a given matrix and a particular operation type.</p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host
                           			and may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       		
                                       	(currently only
                                       		
                                       			
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       		
                                       	is supported).
                                       	
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_TRIANGULAR</samp> and the diagonal
                                       							type is <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">hybA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix <samp class="ph codeph">A</samp> in HYB storage format.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase (that should be passed to the solve phase unchanged).</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; right-hand-side vector of size <samp class="ph codeph">m</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">y</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; solution vector of size <samp class="ph codeph">m</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the internally stored hyb format parameters are invalid.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MAPPING_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the texture binding failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-csr2cscEx2"><a name="cusparse-csr2cscEx2" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-csr2cscEx2" name="cusparse-csr2cscEx2" shape="rect">7.24.&nbsp;cusparseCsr2cscEx2()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseCsr2cscEx2(cusparseHandle_t     handle,
                   int                  m,
                   int                  n,
                   int                  nnz,
                   const void*          csrVal,
                   const int*           csrRowPtr,
                   const int*           csrColInd,
                   void*                cscVal,
                   int*                 cscColPtr,
                   int*                 cscRowInd,
                   cudaDataType         valType,
                   cusparseAction_t     copyValues,
                   cusparseIndexBase_t  idxBase,
                   cusparseCsr2CscAlg_t alg,
                   void*                buffer)</pre><p class="p">This function converts a sparse matrix in CSR format (that is defined by the three arrays <samp class="ph codeph">csrVal</samp>, <samp class="ph codeph">csrRowPtr</samp>, and <samp class="ph codeph">csrColInd</samp>) into a sparse matrix in CSC format (that is defined by arrays <samp class="ph codeph">cscVal</samp>, <samp class="ph codeph">cscRowInd</samp>, and <samp class="ph codeph">cscColPtr</samp>). The resulting matrix can also be seen as the transpose of the original sparse matrix. Notice that this routine can also
                           be used to convert a matrix in CSC format into a matrix in CSR format.
                        </p>
                        <p class="p">For alg <samp class="ph codeph">CUSPARSE_CSR2CSC_ALG1</samp>: it requires extra storage proportional to the number of nonzero values <samp class="ph codeph">nnz</samp>. It provides in output always the same matrix.
                        </p>
                        <p class="p">For alg <samp class="ph codeph">CUSPARSE_CSR2CSC_ALG2</samp>: it requires extra storage proportional to the number of rows <samp class="ph codeph">m</samp>. It does not ensure always the same ordering of CSC column indices and values. Also, it provides better performance then
                           <samp class="ph codeph">CUSPARSE_CSR2CSC_ALG1</samp> for regular matrices.
                        </p>
                        <p class="p">It is executed asynchronously with respect to the host, and it may return control to the application on the host before the
                           result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of the CSR input matrix; number of columns of the CSC ouput matrix</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of the CSR input matrix; number of rows of the CSC ouput matrix</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of the CSR and CSC matrices</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">value array of size <samp class="ph codeph">nnz</samp> of the CSR matrix; of same type as <samp class="ph codeph">valType</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of size <samp class="ph codeph">m + 1</samp> that containes the CSR row offsets
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of size <samp class="ph codeph">nnz</samp> that containes the CSR column indices
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph"></samp>valType
                                    </td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">value type for both CSR and CSC matrices</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph"></samp>copyValues
                                    </td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_ACTION_SYMBOLIC</samp> or <samp class="ph codeph">CUSPARSE_ACTION_NUMERIC</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph"></samp>idxBase
                                    </td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Index base <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or
                                       							<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph"></samp>alg
                                    </td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algorithm implementation. see <samp class="ph codeph">cusparseCsr2CscAlg_t</samp> for possible values.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph"></samp>buffer
                                    </td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">pointer to workspace buffer</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">value array of size <samp class="ph codeph">nnz</samp> of the CSC matrix; of same type as <samp class="ph codeph">valType</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscColPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of size <samp class="ph codeph">n + 1</samp> that containes the CSC column offsets
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscRowInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of size <samp class="ph codeph">nnz</samp> that containes the CSC row indices
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-csr2cscEx2_bufferSize"><a name="cusparse-csr2cscEx2_bufferSize" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-csr2cscEx2_bufferSize" name="cusparse-csr2cscEx2_bufferSize" shape="rect">cusparseCsr2cscEx2_bufferSize()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseCsr2cscEx2_bufferSize(cusparseHandle_t     handle,
                              int                  m,
                              int                  n,
                              int                  nnz,
                              const void*          csrVal,
                              const int*           csrRowPtr,
                              const int*           csrColInd,
                              void*                cscVal,
                              int*                 cscColPtr,
                              int*                 cscRowInd,
                              cudaDataType         valType,
                              cusparseAction_t     copyValues,
                              cusparseIndexBase_t  idxBase,
                              cusparseCsr2CscAlg_t alg,
                              size_t*              bufferSize)</pre><p class="p">This function returns the size of the workspace needed by <samp class="ph codeph">cusparseCsr2cscEx2()</samp>. User needs to allocate a buffer of this size and give that buffer to <samp class="ph codeph">cusparseCsr2cscEx2()</samp> as an argument. All the arguments are similar to <samp class="ph codeph">cusparseCsr2cscEx2()</samp> except the following output argument.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bufferSize</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of workspace needed by <samp class="ph codeph">cusparseCsr2cscEx2()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusparse-level-3-function-reference"><a name="cusparse-level-3-function-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusparse-level-3-function-reference" name="cusparse-level-3-function-reference" shape="rect">8.&nbsp;cuSPARSE Level 3 Function Reference</a></h2>
                  <div class="body conbody">
                     <p class="p">This chapter describes sparse linear algebra functions that perform operations between sparse and (usually tall) dense matrices.</p>
                     <p class="p">In particular, the solution of sparse triangular linear systems with multiple right-hand sides is implemented in two phases.
                        First, during the analysis phase, the sparse triangular matrix is analyzed to determine the dependencies between its elements
                        by calling the appropriate <samp class="ph codeph">csrsm_analysis()</samp> function. The analysis is specific to the sparsity pattern of the given matrix and to the selected <samp class="ph codeph">cusparseOperation_t</samp> type. The information from the analysis phase is stored in the parameter of type <samp class="ph codeph">cusparseSolveAnalysisInfo_t</samp> that has been initialized previously with a call to <samp class="ph codeph">cusparseCreateSolveAnalysisInfo()</samp>.
                     </p>
                     <p class="p">Second, during the solve phase, the given sparse triangular linear system is solved using the information stored in the <samp class="ph codeph">cusparseSolveAnalysisInfo_t</samp> parameter by calling the appropriate <samp class="ph codeph">csrsm_solve()</samp> function. The solve phase may be performed multiple times with different multiple right-hand sides, while the analysis phase
                        needs to be performed only once. This is especially useful when a sparse triangular linear system must be solved for different
                        sets of multiple right-hand sides one at a time, while its coefficient matrix remains the same.
                     </p>
                     <p class="p">Finally, once all the solves have completed, the opaque data structure pointed to by the <samp class="ph codeph">cusparseSolveAnalysisInfo_t</samp> parameter can be released by calling <samp class="ph codeph">cusparseDestroySolveAnalysisInfo()</samp>. For more information please refer to [3].
                     </p>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrmm"><a name="cusparse-lt-t-gt-csrmm" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrmm" name="cusparse-lt-t-gt-csrmm" shape="rect">8.1.&nbsp;cusparse&lt;t&gt;csrmm()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseScsrmm(cusparseHandle_t handle, 
    cusparseOperation_t transA, 
    int m, 
    int n, 
    int k, 
    int nnz, 
    const float *alpha, 
    const cusparseMatDescr_t descrA, 
    const float *csrValA, 
    const int *csrRowPtrA, 
    const int *csrColIndA,
    const float *B, 
    int ldb,
    const float *beta, 
    float *C, 
    int ldc)
cusparseStatus_t 
cusparseDcsrmm(cusparseHandle_t handle, 
    cusparseOperation_t transA, 
    int m, 
    int n, 
    int k, 
    int nnz, 
    const double *alpha, 
    const cusparseMatDescr_t descrA, 
    const double *csrValA, 
    const int *csrRowPtrA, 
    const int *csrColIndA,
    const double *B, 
    int ldb,
    const double *beta,
    double *C, 
    int ldc)
cusparseStatus_t 
cusparseCcsrmm(cusparseHandle_t handle, 
    cusparseOperation_t transA, 
    int m, 
    int n, 
    int k, 
    int nnz, 
    const cuComplex *alpha, 
    const cusparseMatDescr_t descrA, 
    const cuComplex *csrValA, 
    const int *csrRowPtrA, 
    const int *csrColIndA,
    const cuComplex *B, 
    int ldb,
    const cuComplex *beta, 
    cuComplex *C, 
    int ldc)
cusparseStatus_t 
cusparseZcsrmm(cusparseHandle_t handle, 
    cusparseOperation_t transA, 
    int m, 
    int n, 
    int k, 
    int nnz, 
    const cuDoubleComplex *alpha, 
    const cusparseMatDescr_t descrA, 
    const cuDoubleComplex *csrValA, 
    const int *csrRowPtrA, 
    const int *csrColIndA,
    const cuDoubleComplex *B, 
    int ldb,
    const cuDoubleComplex *beta,
    cuDoubleComplex *C, 
    int ldc)
</pre><p class="p">This function performs one of the following matrix-matrix operations:</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>C</mi>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mi>B</mi>
                                          <mo>+</mo>
                                          <mi>β</mi>
                                          <mo>∗</mo>
                                          <mi>C</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×k</samp> sparse matrix that is defined in CSR storage
                           			format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           				<samp class="ph codeph">csrColIndA</samp>); <samp class="ph codeph">B</samp> and <samp class="ph codeph">C</samp> are dense
                           			matrices; 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                              <mtext>&nbsp;and&nbsp;</mtext>
                              <mi>β</mi>
                           </math>
                           			 are scalars; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">When using the (conjugate) transpose of a general matrix or a Hermitian/symmetric matrix, this
                           			routine may produce slightly different results with the same input parameters during
                           			different runs of this function. For these matrix types it uses atomic operations to
                           			compute the final result; consequently, many threads may be adding floating point
                           			numbers to the same memory location without any specific ordering, which may produce
                           			slightly different results for each run.
                        </p>
                        <p class="p">If exactly the same output is required for any input when multiplying by the transpose of a general matrix, the following
                           procedure can be used:
                        </p>
                        <p class="p">1. Convert the matrix from CSR to CSC format using one of the <samp class="ph codeph">csr2csc()</samp> functions. Notice that by interchanging the rows and columns of the result you are implicitly transposing the matrix.
                        </p>
                        <p class="p">2. Call the <samp class="ph codeph">csrmm()</samp> function with the <samp class="ph codeph">cusparseOperation_t</samp> parameter set to <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> and with the interchanged rows and columns of the matrix stored in CSC format. This (implicitly) multiplies the vector by
                           the transpose of the matrix in the original CSR format.
                        </p>
                        <p class="p">This function requires no extra storage for the general matrices when operation
                           				<samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> is selected. It requires some
                           			extra storage for Hermitian/symmetric matrices and for the general matrices when an
                           			operation different from <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> is selected.
                           			It is executed asynchronously with respect to the host and may return control to the
                           			application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of dense matrices <samp class="ph codeph">B</samp> and <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">k</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix types are
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>,
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_SYMMETRIC</samp>, and
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_HERMITIAN</samp>. Also, the supported
                                       							index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(ldb, n)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp>. It must be at least
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, k)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       		
                                       	if
                                       		
                                       			
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       		
                                       	and at least
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, m)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       		
                                       	otherwise.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication. If <samp class="ph codeph">beta</samp> is zero, <samp class="ph codeph">C</samp> does not have to be a valid input.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">C</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(ldc, n)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldc</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">C</samp>. It must be at least
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, m)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       		
                                       	if
                                       		
                                       			
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       		
                                       	and at least
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, k)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       		
                                       	otherwise.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">C</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; updated array of dimensions <samp class="ph codeph">(ldc, n)</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n, k, nnz&lt;0</samp> or <samp class="ph codeph">ldb</samp>
                                       							and <samp class="ph codeph">ldc</samp> are incorrect).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrmm2"><a name="cusparse-lt-t-gt-csrmm2" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrmm2" name="cusparse-lt-t-gt-csrmm2" shape="rect">8.2.&nbsp;cusparse&lt;t&gt;csrmm2()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseScsrmm2(cusparseHandle_t         handle, 
                cusparseOperation_t      transA,    
                cusparseOperation_t      transB,    
                int                      m,         
                int                      n,         
                int                      k,         
                int                      nnz,       
                const float              *alpha,    
                const cusparseMatDescr_t descrA, 
                const float              *csrValA, 
                const int                *csrRowPtrA, 
                const int                *csrColIndA,
                const float              *B,
                int                      ldb,
                const float              *beta,
                float                    *C,
                int                      ldc)                
cusparseStatus_t 
cusparseDcsrmm2(cusparseHandle_t         handle, 
                cusparseOperation_t      transA, 
                cusparseOperation_t      transB,
                int                      m,
                int                      n,
                int                      k,
                int                      nnz, 
                const double             *alpha, 
                const cusparseMatDescr_t descrA, 
                const double             *csrValA, 
                const int                *csrRowPtrA,
                const int                *csrColIndA,
                const double             *B,
                int                      ldb,
                const double             *beta,
                double                   *C,
                int                      ldc)
cusparseStatus_t 
cusparseCcsrmm2(cusparseHandle_t         handle, 
                cusparseOperation_t      transA, 
                cusparseOperation_t      transB,
                int                      m,
                int                      n,
                int                      k,
                int                      nnz, 
                const cuComplex          *alpha, 
                const cusparseMatDescr_t descrA, 
                const cuComplex          *csrValA, 
                const int                *csrRowPtrA,
                const int                *csrColIndA,
                const cuComplex          *B,
                int                      ldb,
                const cuComplex          *beta,
                cuComplex                *C,
                int                      ldc)
cusparseStatus_t 
cusparseZcsrmm2(cusparseHandle_t         handle, 
                cusparseOperation_t      transA, 
                cusparseOperation_t      transB,
                int                      m,
                int                      n,
                int                      k,
                int                      nnz, 
                const cuDoubleComplex    *alpha, 
                const cusparseMatDescr_t descrA, 
                const cuDoubleComplex    *csrValA, 
                const int                *csrRowPtrA,
                const int                *csrColIndA,
                const cuDoubleComplex    *B,
                int                      ldb,
                const cuDoubleComplex    *beta,
                cuDoubleComplex          *C,
                int                      ldc)</pre><p class="p">This function performs one of the following matrix-matrix operations:</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>C</mi>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>B</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>+</mo>
                                          <mi>β</mi>
                                          <mo>∗</mo>
                                          <mi>C</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×k</samp> sparse matrix that is defined in CSR storage
                           format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           <samp class="ph codeph">csrColIndA</samp>); <samp class="ph codeph">B</samp> and <samp class="ph codeph">C</samp> are dense matrices; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                              <mtext>&nbsp;and&nbsp;</mtext>
                              <mi>β</mi>
                           </math>
                           are scalars; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transA == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transA == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transA == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">and</p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>B</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>B</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transB == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>B</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transB == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>B</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>not supported</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">If <samp class="ph codeph">op(B)=B</samp>, <samp class="ph codeph">cusparse&lt;t&gt;csrmm2()</samp> is the same as
                           <samp class="ph codeph">cusparse&lt;t&gt;csrmm()</samp>; otherwise, only <samp class="ph codeph">op(A)=A</samp> is
                           supported and the matrix type must be <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                        </p>
                        <p class="p">The motivation of <samp class="ph codeph">transpose(B)</samp> is to improve the  memory access of matrix
                           <samp class="ph codeph">B</samp>. The computational pattern of <samp class="ph codeph">A*transpose(B)</samp> with matrix
                           <samp class="ph codeph">B</samp> in column-major order is equivalent to <samp class="ph codeph">A*B</samp> with matrix
                           <samp class="ph codeph">B</samp> in row-major order. 
                        </p>
                        <p class="p">In practice, no operation in iterative solver or eigenvalue solver uses
                           <samp class="ph codeph">A*transpose(B)</samp>. However we can perform
                           <samp class="ph codeph">A*transpose(transpose(B))</samp> which is the same as <samp class="ph codeph">A*B</samp>. For
                           example, suppose <samp class="ph codeph">A</samp> is <samp class="ph codeph">m*k</samp>, <samp class="ph codeph">B</samp> is
                           <samp class="ph codeph">k*n</samp> and <samp class="ph codeph">C</samp> is <samp class="ph codeph">m*n</samp>, the following code
                           shows usage of <samp class="ph codeph">cusparseDcsrmm()</samp>.
                        </p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// A is m*k, B is k*n and C is m*n </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldb_B = k; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// leading dimension of B</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldc   = m; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// leading dimension of C</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// perform C:=alpha*A*B + beta*C</span>
    cusparseSetMatType(descrA, CUSPARSE_MATRIX_TYPE_GENERAL );
    cusparseDcsrmm(cusparse_handle, 
               CUSPARSE_OPERATION_NON_TRANSPOSE,
               m, n, k, nnz, alpha,
               descrA, csrValA, csrRowPtrA, csrColIndA,
               B, ldb_B,
               beta, C, ldc);  </pre><p class="p">Instead of using <samp class="ph codeph">A*B</samp>, our proposal is to transpose <samp class="ph codeph">B</samp> to
                           <samp class="ph codeph">Bt</samp> first by calling <samp class="ph codeph">cublas&lt;t&gt;geam()</samp>, then to perform
                           <samp class="ph codeph">A*transpose(Bt)</samp>. 
                        </p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: Bt := transpose(B)</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *Bt; 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldb_Bt = n; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// leading dimension of Bt</span>
    cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;Bt, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*ldb_Bt*k);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> one  = 1.0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> zero = 0.0;
    cublasSetPointerMode(cublas_handle, CUBLAS_POINTER_MODE_HOST);
    cublasDgeam(cublas_handle, CUBLAS_OP_T, CUBLAS_OP_T,
        n, k, &amp;one, B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldb_B, &amp;zero, B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldb_B, Bt, ldb_Bt);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: perform C:=alpha*A*transpose(Bt) + beta*C</span>
    cusparseDcsrmm2(cusparse_handle, 
               CUSPARSE_OPERATION_NON_TRANSPOSE,
               CUSPARSE_OPERATION_TRANSPOSE
               m, n, k, nnz, alpha,
               descrA, csrValA, csrRowPtrA, csrColIndA,
               Bt, ldb_Bt,
               beta, C, ldc);</pre><p class="p">Remark 1: <samp class="ph codeph">cublas&lt;t&gt;geam()</samp> and <samp class="ph codeph">cusparse&lt;t&gt;csrmm2()</samp>
                           are memory bound. The complexity of <samp class="ph codeph">cublas&lt;t&gt;geam()</samp> is
                           <samp class="ph codeph">2*n*k</samp>, and the minimum complexity of
                           <samp class="ph codeph">cusparse&lt;t&gt;csrmm2()</samp> is about <samp class="ph codeph">(nnz + nnz*n + 2*m*n)</samp>.
                           If <samp class="ph codeph">nnz</samp> per column <samp class="ph codeph">(=nnz/k)</samp> is large, it is worth paying the
                           extra cost on transposition because <samp class="ph codeph">A*transpose(B)</samp> may be 2× faster than
                           <samp class="ph codeph">A*B</samp> if the sparsity pattern of <samp class="ph codeph">A</samp> is not good. 
                        </p>
                        <p class="p">Remark 2: <samp class="ph codeph">A*transpose(B)</samp> is only supported on compute capability 2.0 and above.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation
                                       
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>B</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of dense matrix 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>op(B)</mi>
                                       </math>
                                       and <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">k</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix types is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                                       Also, the supported index bases are
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       column indices of the nonzero elements of matrix
                                       <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(ldb, n)</samp> if <samp class="ph codeph">op(B)=B</samp> and <samp class="ph codeph">(ldb,
                                          k)</samp> otherwise.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp>. If <samp class="ph codeph">op(B)=B</samp>, it must be at least 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, k)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       if 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       and at least 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, m)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       otherwise. If <samp class="ph codeph">op(B)!=B</samp>, it must be at least
                                       <samp class="ph codeph">max(1, n</samp>). 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication. If <samp class="ph codeph">beta</samp> is zero, <samp class="ph codeph">C</samp> does not have to be a valid input.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">C</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(ldc, n)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldc</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">C</samp>. It must be at least
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, m)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       		
                                       	if
                                       		
                                       			
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>=</mo>
                                          <mi>A</mi>
                                       </math>
                                       		
                                       	and at least
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, k)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       		
                                       	otherwise.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">C</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; updated array of dimensions <samp class="ph codeph">(ldc, n)</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n, k, nnz&lt;0</samp> or <samp class="ph codeph">ldb</samp>
                                       and <samp class="ph codeph">ldc</samp> are incorrect).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">if <samp class="ph codeph">op(B)=B</samp>, the device does not support double precision or if
                                       <samp class="ph codeph">op(B)=transpose(B)</samp> the device is below compute capability
                                       2.0.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">only <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> is
                                       supported otherwise.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsmanalysis"><a name="cusparse-lt-t-gt-csrsmanalysis" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsmanalysis" name="cusparse-lt-t-gt-csrsmanalysis" shape="rect">8.3.&nbsp;cusparse&lt;t&gt;csrsm_analysis()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseScsrsm_analysis(
    cusparseHandle_t handle, 
    cusparseOperation_t transA, 
    int m,  
    int nnz, 
    const cusparseMatDescr_t descrA, 
    const float *csrSortedValA, 
    const int *csrSortedRowPtrA, 
    const int *csrSortedColIndA, 
    cusparseSolveAnalysisInfo_t info)


cusparseStatus_t 
cusparseDcsrsm_analysis(
    cusparseHandle_t handle, 
    cusparseOperation_t transA, 
    int m, 
    int nnz, 
    const cusparseMatDescr_t descrA, 
    const double *csrSortedValA, 
    const int *csrSortedRowPtrA, 
    const int *csrSortedColIndA, 
    cusparseSolveAnalysisInfo_t info)


cusparseStatus_t 
cusparseCcsrsm_analysis(
    cusparseHandle_t handle, 
    cusparseOperation_t transA, 
    int m, 
    int nnz, 
    const cusparseMatDescr_t descrA, 
    const cuComplex *csrSortedValA, 
    const int *csrSortedRowPtrA, 
    const int *csrSortedColIndA, 
    cusparseSolveAnalysisInfo_t info)


cusparseStatus_t 
cusparseZcsrsm_analysis(
    cusparseHandle_t handle, 
    cusparseOperation_t transA, 
    int m, 
    int nnz, 
    const cusparseMatDescr_t descrA, 
    const cuDoubleComplex *csrSortedValA, 
    const int *csrSortedRowPtrA, 
    const int *csrSortedColIndA, 
    cusparseSolveAnalysisInfo_t info) 

</pre><p class="p">This function performs the analysis phase of the solution of a sparse triangular linear system</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>X</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>B</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">with multiple right-hand sides, where <samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse
                           matrix that is defined in CSR storage format by the three arrays <samp class="ph codeph">csrValA</samp>,
                           <samp class="ph codeph">csrRowPtrA</samp>, and <samp class="ph codeph">csrColIndA</samp>; <samp class="ph codeph">B</samp> and
                           <samp class="ph codeph">X</samp> are the right-hand-side and the solution dense matrices; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">It is expected that this function will be executed only once for a given matrix and a particular operation type.</p>
                        <p class="p">This function requires a significant amount of extra storage that is proportional to the matrix
                           size. It is executed asynchronously with respect to the host and may return control to the
                           application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       .
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix types are
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_TRIANGULAR</samp> and
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, while the supported diagonal types
                                       are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and
                                       <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       column indices of the nonzero elements of matrix
                                       <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info </samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateSolveAnalysisInfo()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure filled with information collected during the analysis phase (that should be passed to the solve phase unchanged).</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsmsolve"><a name="cusparse-lt-t-gt-csrsmsolve" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsmsolve" name="cusparse-lt-t-gt-csrsmsolve" shape="rect">8.4.&nbsp;cusparse&lt;t&gt;csrsm_solve()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseScsrsm_solve(
    cusparseHandle_t handle, 
    cusparseOperation_t transA, 
    int m, 
    int n, 
    const float *alpha, 
    const cusparseMatDescr_t descrA, 
    const float *csrSortedValA, 
    const int *csrSortedRowPtrA, 
    const int *csrSortedColIndA, 
    cusparseSolveAnalysisInfo_t info, 
    const float *B, 
    int ldb,
    float *X, 
    int ldx)

cusparseStatus_t 
cusparseDcsrsm_solve(
    cusparseHandle_t handle, 
    cusparseOperation_t transA, 
    int m, 
    int n, 
    const double *alpha, 
    const cusparseMatDescr_t descrA, 
    const double *csrSortedValA, 
    const int *csrSortedRowPtrA, 
    const int *csrSortedColIndA, 
    cusparseSolveAnalysisInfo_t info, 
    const double *B, 
    int ldb,
    double *X, 
    int ldx)

cusparseStatus_t 
cusparseCcsrsm_solve(
    cusparseHandle_t handle, 
    cusparseOperation_t transA, 
    int m, 
    int n, 
    const cuComplex *alpha, 
    const cusparseMatDescr_t descrA, 
    const cuComplex *csrSortedValA, 
    const int *csrSortedRowPtrA, 
    const int *csrSortedColIndA, 
    cusparseSolveAnalysisInfo_t info, 
    const cuComplex *B, 
    int ldb,
    cuComplex *X, 
    int ldx)

cusparseStatus_t 
cusparseZcsrsm_solve(
    cusparseHandle_t handle, 
    cusparseOperation_t transA, 
    int m, 
    int n, 
    const cuDoubleComplex *alpha, 
    const cusparseMatDescr_t descrA, 
    const cuDoubleComplex *csrSortedValA, 
    const int *csrSortedRowPtrA, 
    const int *csrSortedColIndA, 
    cusparseSolveAnalysisInfo_t info, 
    const cuDoubleComplex *B, 
    int ldb,
    cuDoubleComplex *X, 
    int ldx)

</pre><p class="p">This function performs the solve phase of the solution of a sparse triangular linear system</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>X</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>B</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">with multiple right-hand sides, where <samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×n</samp> sparse
                           matrix that is defined in CSR storage format by the three arrays <samp class="ph codeph">csrValA</samp>,
                           <samp class="ph codeph">csrRowPtrA</samp>, and <samp class="ph codeph">csrColIndA</samp>); <samp class="ph codeph">B</samp> and
                           <samp class="ph codeph">X</samp> are the right-hand-side and the solution dense matrices; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">This function may be executed multiple times for a given matrix and a particular operation type.</p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host
                           and may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation <samp class="ph codeph">op(A)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">X</samp> and <samp class="ph codeph">Y</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix types are
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_TRIANGULAR</samp> and
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, while the supported diagonal types
                                       are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and
                                       <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       column indices of the nonzero elements of matrix
                                       <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info </samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase (that should be passed to the solve phase unchanged).</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; right-hand-side array of dimensions <samp class="ph codeph">(ldb, n)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp> (that is ≥ 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, m)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       ).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">X</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; solution array of dimensions <samp class="ph codeph">(ldx, n)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldx</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">X</samp> (that is ≥ 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, m)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       ).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MAPPING_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the texture binding failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsm2_bufferSize"><a name="cusparse-lt-t-gt-csrsm2_bufferSize" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsm2_bufferSize" name="cusparse-lt-t-gt-csrsm2_bufferSize" shape="rect">8.5.&nbsp;cusparse&lt;t&gt;csrsm2_bufferSizeExt()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseScsrsm2_bufferSizeExt(
    cusparseHandle_t handle,
    int algo,
    cusparseOperation_t transA,
    cusparseOperation_t transB,
    int m,
    int nrhs,
    int nnz,
    const float *alpha,
    const cusparseMatDescr_t descrA,
    const float *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const float *B,
    int ldb,
    csrsm2Info_t info,
    cusparseSolvePolicy_t policy,
    size_t *pBufferSize)

cusparseStatus_t 
cusparseDcsrsm2_bufferSizeExt(
    cusparseHandle_t handle,
    int algo,
    cusparseOperation_t transA,
    cusparseOperation_t transB,
    int m,
    int nrhs,
    int nnz,
    const double *alpha,
    const cusparseMatDescr_t descrA,
    const double *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const double *B,
    int ldb,
    csrsm2Info_t info,
    cusparseSolvePolicy_t policy,
    size_t *pBufferSize)

cusparseStatus_t 
cusparseCcsrsm2_bufferSizeExt(
    cusparseHandle_t handle,
    int algo,
    cusparseOperation_t transA,
    cusparseOperation_t transB,
    int m,
    int nrhs,
    int nnz,
    const cuComplex *alpha,
    const cusparseMatDescr_t descrA,
    const cuComplex *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const cuComplex *B,
    int ldb,
    csrsm2Info_t info,
    cusparseSolvePolicy_t policy,
    size_t *pBufferSize)

cusparseStatus_t 
cusparseZcsrsm2_bufferSizeExt(
    cusparseHandle_t handle,
    int algo,
    cusparseOperation_t transA,
    cusparseOperation_t transB,
    int m,
    int nrhs,
    int nnz,
    const cuDoubleComplex *alpha,
    const cusparseMatDescr_t descrA,
    const cuDoubleComplex *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const cuDoubleComplex *B,
    int ldb,
    csrsm2Info_t info,
    cusparseSolvePolicy_t policy,
    size_t *pBufferSize)


</pre><p class="p">This function returns the size of the buffer used in <samp class="ph codeph">csrsm2</samp>, a sparse
                           triangular linear system <samp class="ph codeph">op(A) * op(X) =</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math><samp class="ph codeph">op(B)</samp>. 
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                           format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           <samp class="ph codeph">csrColIndA</samp>); <samp class="ph codeph">B</samp> and <samp class="ph codeph">X</samp> are the
                           right-hand-side matrix and the solution matrix; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">algo</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algo = 0 is non-block version; 
                                       algo = 1 is block version.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       .
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>B</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       .
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nrhs</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of right hand side matrix <samp class="ph codeph">op(B)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is 
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, 
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and
                                       <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; right-hand-side matrix.
                                       <samp class="ph codeph">op(B)</samp> is of size <samp class="ph codeph">m-by-nrhs</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp> and <samp class="ph codeph">X</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase
                                       (that should have been passed to the solve phase unchanged).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">The supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                       <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">record of internal states based on different algorithms.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSize</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in the <samp class="ph codeph">csrsm2_analysis</samp> and <samp class="ph codeph">csrsm2_solve</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>), 
                                       base index is not 0 or 1.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsm2_analysis"><a name="cusparse-lt-t-gt-csrsm2_analysis" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsm2_analysis" name="cusparse-lt-t-gt-csrsm2_analysis" shape="rect">8.6.&nbsp;cusparse&lt;t&gt;csrsm2_analysis()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseScsrsm2_analysis(
    cusparseHandle_t handle,
    int algo,
    cusparseOperation_t transA,
    cusparseOperation_t transB,
    int m,
    int nrhs,
    int nnz,
    const float *alpha,
    const cusparseMatDescr_t descrA,
    const float *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const float *B,
    int ldb,
    csrsm2Info_t info,
    cusparseSolvePolicy_t policy,
    void *pBuffer)

cusparseStatus_t 
cusparseDcsrsm2_analysis(
    cusparseHandle_t handle,
    int algo,
    cusparseOperation_t transA,
    cusparseOperation_t transB,
    int m,
    int nrhs,
    int nnz,
    const double *alpha,
    const cusparseMatDescr_t descrA,
    const double *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const double *B,
    int ldb,
    csrsm2Info_t info,
    cusparseSolvePolicy_t policy,
    void *pBuffer)

cusparseStatus_t 
cusparseCcsrsm2_analysis(
    cusparseHandle_t handle,
    int algo,
    cusparseOperation_t transA,
    cusparseOperation_t transB,
    int m,
    int nrhs,
    int nnz,
    const cuComplex *alpha,
    const cusparseMatDescr_t descrA,
    const cuComplex *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const cuComplex *B,
    int ldb,
    csrsm2Info_t info,
    cusparseSolvePolicy_t policy,
    void *pBuffer)

cusparseStatus_t
cusparseZcsrsm2_analysis(
    cusparseHandle_t handle,
    int algo,
    cusparseOperation_t transA,
    cusparseOperation_t transB,
    int m,
    int nrhs,
    int nnz,
    const cuDoubleComplex *alpha,
    const cusparseMatDescr_t descrA,
    const cuDoubleComplex *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const cuDoubleComplex *B,
    int ldb,
    csrsm2Info_t info,
    cusparseSolvePolicy_t policy,
    void *pBuffer)

</pre><p class="p">This function performs the analysis phase of <samp class="ph codeph">csrsm2</samp>, a sparse triangular linear system
                           <samp class="ph codeph">op(A) * op(X) =</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math><samp class="ph codeph">op(B)</samp>.
                           
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                           format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           <samp class="ph codeph">csrColIndA</samp>); <samp class="ph codeph">B</samp> and <samp class="ph codeph">X</samp> are the
                           right-hand-side matrix and the solution matrix; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">It is expected that this function will be executed only once for a given matrix and a particular operation type.</p>
                        <p class="p">This function requires a buffer size returned by <samp class="ph codeph">csrsm2_bufferSize()</samp>. The
                           address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is not,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">csrsm2_analysis()</samp> reports a structural zero and computes level
                           information that is stored in opaque structure <samp class="ph codeph">info</samp>. The level information
                           can extract more parallelism for a triangular solver. However <samp class="ph codeph">csrsm2_solve()</samp>
                           can be done without level information. To disable level information, the user needs to specify
                           the policy of the triangular solver as <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">csrsm2_analysis()</samp> always reports the first structural zero, even if the
                           policy is <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. No structural zero is reported if
                           <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> is specified, even if <samp class="ph codeph">A(j,j)</samp> is
                           missing for some <samp class="ph codeph">j</samp>. The user needs to call
                           <samp class="ph codeph">cusparseXcsrsm2_zeroPivot()</samp> to know where the structural zero is. 
                        </p>
                        <p class="p">It is the user's choice whether to call <samp class="ph codeph">csrsm2_solve()</samp> if
                           <samp class="ph codeph">csrsm2_analysis()</samp> reports a structural zero. In this case, the user can
                           still call <samp class="ph codeph">csrsm2_solve()</samp> which will return a numerical zero in the same
                           position as the structural zero. However the result <samp class="ph codeph">X</samp> is meaningless. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">algo</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algo = 0 is non-block version;
                                       algo = 1 is block version.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       . 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>B</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       . 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nrhs</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">op(B)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is 
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, 
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and 
                                       <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; right-hand-side matrix.
                                       <samp class="ph codeph">op(B)</samp> is of size <samp class="ph codeph">m-by-nrhs</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp> and <samp class="ph codeph">X</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateCsrsv2Info()</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">The supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                       <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is returned by
                                       <samp class="ph codeph">csrsm2_bufferSize()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure filled with information collected during the analysis phase 
                                       (that should be passed to the solve phase unchanged).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsm2_solve"><a name="cusparse-lt-t-gt-csrsm2_solve" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsm2_solve" name="cusparse-lt-t-gt-csrsm2_solve" shape="rect">8.7.&nbsp;cusparse&lt;t&gt;csrsm2_solve()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseScsrsm2_solve(
    cusparseHandle_t handle,
    int algo,
    cusparseOperation_t transA,
    cusparseOperation_t transB,
    int m,
    int nrhs,
    int nnz,
    const float *alpha,
    const cusparseMatDescr_t descrA,
    const float *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    float *B,
    int ldb,
    csrsm2Info_t info,
    cusparseSolvePolicy_t policy,
    void *pBuffer)

cusparseStatus_t 
cusparseDcsrsm2_solve(
    cusparseHandle_t handle,
    int algo,
    cusparseOperation_t transA,
    cusparseOperation_t transB,
    int m,
    int nrhs,
    int nnz,
    const double *alpha,
    const cusparseMatDescr_t descrA,
    const double *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    double *B,
    int ldb,
    csrsm2Info_t info,
    cusparseSolvePolicy_t policy,
    void *pBuffer)

cusparseStatus_t 
cusparseCcsrsm2_solve(
    cusparseHandle_t handle,
    int algo,
    cusparseOperation_t transA,
    cusparseOperation_t transB,
    int m,
    int nrhs,
    int nnz,
    const cuComplex *alpha,
    const cusparseMatDescr_t descrA,
    const cuComplex *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    cuComplex *B,
    int ldb,
    csrsm2Info_t info,
    cusparseSolvePolicy_t policy,
    void *pBuffer)

cusparseStatus_t
cusparseZcsrsm2_solve(
    cusparseHandle_t handle,
    int algo,
    cusparseOperation_t transA,
    cusparseOperation_t transB,
    int m,
    int nrhs,
    int nnz,
    const cuDoubleComplex *alpha,
    const cusparseMatDescr_t descrA,
    const cuDoubleComplex *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    cuDoubleComplex *B,
    int ldb,
    csrsm2Info_t info,
    cusparseSolvePolicy_t policy,
    void *pBuffer)

</pre><p class="p">This function performs the solve phase of <samp class="ph codeph">csrsm2</samp>, a sparse triangular linear system
                           <samp class="ph codeph">op(A) * op(X) =</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math><samp class="ph codeph">op(B)</samp>.
                           
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                           format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           <samp class="ph codeph">csrColIndA</samp>); <samp class="ph codeph">B</samp> and <samp class="ph codeph">X</samp> are the
                           right-hand-side matrix and the solution matrix; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transA == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transA == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transA == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p"><samp class="ph codeph">transB</samp> acts on both matrix <samp class="ph codeph">B</samp> and matrix <samp class="ph codeph">X</samp>, only 
                           <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp> and
                           <samp class="ph codeph">CUSPARSE_OPERATION_TRANSPOSE</samp>. 
                           The operation is in-place, matrix <samp class="ph codeph">B</samp> is overwritten by matrix <samp class="ph codeph">X</samp>.
                           
                        </p>
                        <p class="p"><samp class="ph codeph">ldb</samp> must be not less than <samp class="ph codeph">m</samp> if 
                           <samp class="ph codeph">transB</samp> = <samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp>.
                           Otherwise, <samp class="ph codeph">ldb</samp> must be not less than <samp class="ph codeph">nrhs</samp>.
                           
                        </p>
                        <p class="p">This function requires the buffer size returned by <samp class="ph codeph">csrsm2_bufferSize()</samp>. The
                           address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is not,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                        </p>
                        <p class="p">Although <samp class="ph codeph">csrsm2_solve()</samp> can be done without level information, the user still
                           needs to be aware of consistency. If <samp class="ph codeph">csrsm2_analysis()</samp> is called with policy
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>, <samp class="ph codeph">csrsm2_solve()</samp> can be run
                           with or without levels. On the contrary, if <samp class="ph codeph">csrsm2_analysis()</samp> is called with
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>, <samp class="ph codeph">csrsm2_solve()</samp> can only
                           accept <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>; otherwise,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                        </p>
                        <p class="p">The level information may not improve the performance but spend extra time doing analysis. For
                           example, a tridiagonal matrix has no parallelism. In this case,
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> performs better than
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. If the user has an iterative solver, the
                           best approach is to do <samp class="ph codeph">csrsm2_analysis()</samp> with
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp> once. Then do
                           <samp class="ph codeph">csrsm2_solve()</samp> with <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> in the
                           first run and with <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp> in the second run, picking
                           faster one to perform the remaining iterations. 
                           
                        </p>
                        <p class="p">Function <samp class="ph codeph">csrsm2_solve()</samp> reports the first numerical zero, including a structural
                           zero. If <samp class="ph codeph">status</samp> is 0, no numerical zero was found. Furthermore, no numerical
                           zero is reported if <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> is specified, even if
                           <samp class="ph codeph">A(j,j)</samp> is zero for some <samp class="ph codeph">j</samp>. The user needs to call
                           <samp class="ph codeph">cusparseXcsrsm2_zeroPivot()</samp> to know where the numerical zero is. 
                           
                        </p>
                        <p class="p"><samp class="ph codeph">csrsm2</samp> provides two algorithms specified by the parameter <samp class="ph codeph">algo</samp>.
                           <samp class="ph codeph">algo=0</samp> is non-block version and <samp class="ph codeph">algo=1</samp> is block version.
                           non-block version is memory-bound, limited by bandwidth.
                           block version partitions the matrix into small tiles and applies desne operations. 
                           Although it has more flops than non-block version, it may be faster if non-block version already 
                           reaches maximum bandwidth..
                           
                        </p>
                        <p class="p">
                           Appendix H shows an example of csrsm2. 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">algo</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algo = 0 is non-block version;
                                       algo = 1 is block version.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       .
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>B</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       .
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nrhs</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">op(B)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is 
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, 
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and 
                                       <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; right-hand-side matrix.
                                       <samp class="ph codeph">op(B)</samp> is of size <samp class="ph codeph">m-by-nrhs</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp> and <samp class="ph codeph">X</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase
                                       (that should have been passed to the solve phase unchanged).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">The supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                       <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is returned by <samp class="ph codeph">csrsm2_bufferSize</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">X</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; solution matrix,
                                       <samp class="ph codeph">op(X)</samp> is of size <samp class="ph codeph">m-by-nrhs</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsm2_zeroPivot"><a name="cusparse-lt-t-gt-csrsm2_zeroPivot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsm2_zeroPivot" name="cusparse-lt-t-gt-csrsm2_zeroPivot" shape="rect">8.8.&nbsp;cusparseXcsrsm2_zeroPivot()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseXcsrsm2_zeroPivot(cusparseHandle_t handle,
                          csrsm2Info_t info,
                          int *position);</pre><p class="p"> If the returned error code is <samp class="ph codeph">CUSPARSE_STATUS_ZERO_PIVOT</samp>,
                           <samp class="ph codeph">position=j</samp> means <samp class="ph codeph">A(j,j)</samp> has either a structural zero or a
                           numerical zero. Otherwise <samp class="ph codeph">position=-1</samp>. 
                        </p>
                        <p class="p">The <samp class="ph codeph">position</samp> can be 0-based or 1-based, the same as the matrix. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">cusparseXcsrsm2_zeroPivot()</samp> is a blocking call. It calls
                           <samp class="ph codeph">cudaDeviceSynchronize()</samp> to make sure all previous kernels are done. 
                        </p>
                        <p class="p">The <samp class="ph codeph">position</samp> can be in the host memory or device memory. The user can set the
                           proper mode with <samp class="ph codeph">cusparseSetPointerMode()</samp>. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> contains structural zero or numerical zero if the user already
                                       called <samp class="ph codeph">csrsm2_analysis()</samp> or <samp class="ph codeph">csrsm2_solve()</samp>. 
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">position</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">if no structural or numerical zero, <samp class="ph codeph">position</samp> is -1; otherwise, if
                                       <samp class="ph codeph">A(j,j)</samp> is missing or <samp class="ph codeph">U(j,j)</samp> is zero, <samp class="ph codeph">position=j</samp>. 
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> is not valid.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-bsrmm"><a name="cusparse-lt-t-gt-bsrmm" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrmm" name="cusparse-lt-t-gt-bsrmm" shape="rect">8.9.&nbsp;cusparse&lt;t&gt;bsrmm()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsrmm(cusparseHandle_t handle,
               cusparseDirection_t dirA,
               cusparseOperation_t transA,
               cusparseOperation_t transB,
               int mb,
               int n,
               int kb,
               int nnzb,
               const float *alpha,
               const cusparseMatDescr_t descrA,
               const float *bsrValA,
               const int *bsrRowPtrA,
               const int *bsrColIndA,
               const int  blockDim,
               const float *B,
               const int ldb,
               const float *beta,
               float *C,
               int ldc)

cusparseStatus_t 
cusparseDbsrmm(cusparseHandle_t handle,
               cusparseDirection_t dirA,
               cusparseOperation_t transA,
               cusparseOperation_t transB,
               int mb,
               int n,
               int kb,
               int nnzb,
               const double *alpha,
               const cusparseMatDescr_t descrA,
               const double *bsrValA,
               const int *bsrRowPtrA,
               const int *bsrColIndA,
               const int  blockDim,
               const double *B,
               const int ldb,
               const double *beta,
               double *C,
               int ldc)

cusparseStatus_t 
cusparseCbsrmm(cusparseHandle_t handle,
               cusparseDirection_t dirA,
               cusparseOperation_t transA,
               cusparseOperation_t transB,
               int mb,
               int n,
               int kb,
               int nnzb,
               const cuComplex *alpha,
               const cusparseMatDescr_t descrA,
               const cuComplex *bsrValA,
               const int *bsrRowPtrA,
               const int *bsrColIndA,
               const int  blockDim,
               const cuComplex *B,
               const int ldb,
               const cuComplex *beta,
               cuComplex *C,
               int ldc)

cusparseStatus_t 
cusparseZbsrmm(cusparseHandle_t handle,
               cusparseDirection_t dirA,
               cusparseOperation_t transA,
               cusparseOperation_t transB,
               int mb,
               int n,
               int kb,
               int nnzb,
               const cuDoubleComplex *alpha,
               const cusparseMatDescr_t descrA,
               const cuDoubleComplex *bsrValA,
               const int *bsrRowPtrA,
               const int *bsrColIndA,
               const int  blockDim,
               const cuDoubleComplex *B,
               const int ldb,
               const cuDoubleComplex *beta,
               cuDoubleComplex *C,
               int ldc)

</pre><p class="p">This function performs one of the following matrix-matrix operations:</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>C</mi>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>B</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>+</mo>
                                          <mi>β</mi>
                                          <mo>∗</mo>
                                          <mi>C</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">mb×kb</samp> sparse matrix that is defined in BSR
                           storage format by the three arrays <samp class="ph codeph">bsrValA</samp>, <samp class="ph codeph">bsrRowPtrA</samp>, and
                           <samp class="ph codeph">bsrColIndA</samp>; <samp class="ph codeph">B</samp> and <samp class="ph codeph">C</samp> are dense matrices; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                              <mtext>&nbsp;and&nbsp;</mtext>
                              <mi>β</mi>
                           </math>
                           are scalars; and
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transA == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transA == CUSPARSE_OPERATION_TRANSPOSE (not supported)</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transA == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE (not supported)</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">and</p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>B</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>B</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transB == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>B</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transB == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>B</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transB == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE (not supported)</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">The matrix type must be <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                        </p>
                        <p class="p">The motivation of <samp class="ph codeph">transpose(B)</samp> is to improve memory access of matrix
                           <samp class="ph codeph">B</samp>. The computational pattern of <samp class="ph codeph">A*transpose(B)</samp> with matrix
                           <samp class="ph codeph">B</samp> in column-major order is equivalent to <samp class="ph codeph">A*B</samp> with matrix
                           <samp class="ph codeph">B</samp> in row-major order. 
                        </p>
                        <p class="p">In practice, no operation in an iterative solver or eigenvalue solver uses
                           <samp class="ph codeph">A*transpose(B)</samp>. However, we can perform
                           <samp class="ph codeph">A*transpose(transpose(B))</samp> which is the same as <samp class="ph codeph">A*B</samp>. For
                           example, suppose <samp class="ph codeph">A</samp> is <samp class="ph codeph">mb*kb</samp>, <samp class="ph codeph">B</samp> is
                           <samp class="ph codeph">k*n</samp> and <samp class="ph codeph">C</samp> is <samp class="ph codeph">m*n</samp>, the following code
                           shows usage of <samp class="ph codeph">cusparseDbsrmm()</samp>.
                        </p><pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// A is mb*kb, B is k*n and C is m*n </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = mb*blockSize; 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> k = kb*blockSize;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldb_B = k; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// leading dimension of B</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldc   = m; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// leading dimension of C</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// perform C:=alpha*A*B + beta*C</span>
    cusparseSetMatType(descrA, CUSPARSE_MATRIX_TYPE_GENERAL );
    cusparseDbsrmm(cusparse_handle, 
               CUSPARSE_DIRECTION_COLUMN,
               CUSPARSE_OPERATION_NON_TRANSPOSE,
               CUSPARSE_OPERATION_NON_TRANSPOSE,
               mb, n, kb, nnzb, alpha,
               descrA, bsrValA, bsrRowPtrA, bsrColIndA, blockSize,
               B, ldb_B,
               beta, C, ldc);
    </pre><p class="p">Instead of using <samp class="ph codeph">A*B</samp>, our proposal is to transpose <samp class="ph codeph">B</samp> to
                           <samp class="ph codeph">Bt</samp> by first calling <samp class="ph codeph">cublas&lt;t&gt;geam()</samp>, and then to
                           perform <samp class="ph codeph">A*transpose(Bt)</samp>. 
                        </p><pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: Bt := transpose(B)</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = mb*blockSize; 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> k = kb*blockSize;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *Bt; 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldb_Bt = n; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// leading dimension of Bt</span>
    cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;Bt, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*ldb_Bt*k);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> one  = 1.0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> zero = 0.0;
    cublasSetPointerMode(cublas_handle, CUBLAS_POINTER_MODE_HOST);
    cublasDgeam(cublas_handle, CUBLAS_OP_T, CUBLAS_OP_T,
        n, k, &amp;one, B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldb_B, &amp;zero, B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldb_B, Bt, ldb_Bt);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: perform C:=alpha*A*transpose(Bt) + beta*C</span>
    cusparseDbsrmm(cusparse_handle, 
               CUSPARSE_DIRECTION_COLUMN,
               CUSPARSE_OPERATION_NON_TRANSPOSE,
               CUSPARSE_OPERATION_TRANSPOSE,
               mb, n, kb, nnzb, alpha,
               descrA, bsrValA, bsrRowPtrA, bsrColIndA, blockSize,
               Bt, ldb_Bt,
               beta, C, ldc);
    </pre><p class="p">Function <samp class="ph codeph">bsrmm()</samp> is only supported on compute capability 2.0 and above. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dir</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation <samp class="ph codeph">op(A)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation <samp class="ph codeph">op(B)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of dense matrix <samp class="ph codeph">op(B)</samp> and <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">kb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block columns of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of non-zero blocks of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported index bases are
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every block row and the end of the last block row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       column indices of the nonzero blocks of matrix
                                       <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix <samp class="ph codeph">A</samp>, larger than zero.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(ldb, n)</samp> if <samp class="ph codeph">op(B)=B</samp> and <samp class="ph codeph">(ldb,
                                          k)</samp> otherwise.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp>. If <samp class="ph codeph">op(B)=B</samp>, it must be at least 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, k)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       If <samp class="ph codeph">op(B) != B</samp>, it must be at least <samp class="ph codeph">max(1,
                                          n)</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication. If <samp class="ph codeph">beta</samp> is zero, <samp class="ph codeph">C</samp> does not have to be a valid input.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">C</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(ldc, n)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldc</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">C</samp>. It must be at least 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, m)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       if <samp class="ph codeph">op(A)=A</samp> and at least 
                                       
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo movablelimits="true">max</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>(1, k)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                       otherwise.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">C</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; updated array of dimensions <samp class="ph codeph">(ldc, n)</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">
                                       <p class="p">Either invalid parameters were passed (<samp class="ph codeph">mb, n, kb, nnzb&lt;0</samp>; or
                                          <samp class="ph codeph">ldb</samp> and <samp class="ph codeph">ldc</samp> are incorrect).
                                       </p>
                                       <p class="p">Either invalid or unsupported operations were passed (<samp class="ph codeph">op(A)</samp> is different from CUSPARSE_OPERATION_NON_TRANSPOSE,         
                                          or <samp class="ph codeph">op(B)</samp> is different from CUSPARSE_OPERATION_NON_TRANSPOSE or CUSPARSE_OPERATION_TRANSPOSE).
                                          
                                       </p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">if device is below compute capability 2.0.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">only <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> is supported otherwise.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-bsrsm2_bufferSize"><a name="cusparse-lt-t-gt-bsrsm2_bufferSize" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrsm2_bufferSize" name="cusparse-lt-t-gt-bsrsm2_bufferSize" shape="rect">8.10.&nbsp;cusparse&lt;t&gt;bsrsm2_bufferSize()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsrsm2_bufferSize(cusparseHandle_t handle,
                           cusparseDirection_t dirA,
                           cusparseOperation_t transA,
                           cusparseOperation_t transX,
                           int mb,
                           int n,
                           int nnzb,
                           const cusparseMatDescr_t descrA,
                           float *bsrSortedValA,
                           const int *bsrSortedRowPtrA,
                           const int *bsrSortedColIndA,
                           int blockDim,
                           bsrsm2Info_t info,
                           int *pBufferSizeInBytes)

cusparseStatus_t 
cusparseDbsrsm2_bufferSize(cusparseHandle_t handle,
                           cusparseDirection_t dirA,
                           cusparseOperation_t transA,
                           cusparseOperation_t transX,
                           int mb,
                           int n,
                           int nnzb,
                           const cusparseMatDescr_t descrA,
                           double *bsrSortedValA,
                           const int *bsrSortedRowPtrA,
                           const int *bsrSortedColIndA,
                           int blockDim,
                           bsrsm2Info_t info,
                           int *pBufferSizeInBytes)

cusparseStatus_t 
cusparseCbsrsm2_bufferSize(cusparseHandle_t handle,
                           cusparseDirection_t dirA,
                           cusparseOperation_t transA,
                           cusparseOperation_t transX,
                           int mb,
                           int n,
                           int nnzb,
                           const cusparseMatDescr_t descrA,
                           cuComplex *bsrSortedValA,
                           const int *bsrSortedRowPtrA,
                           const int *bsrSortedColIndA,
                           int blockDim,
                           bsrsm2Info_t info,
                           int *pBufferSizeInBytes)

cusparseStatus_t 
cusparseZbsrsm2_bufferSize(cusparseHandle_t handle,
                           cusparseDirection_t dirA,
                           cusparseOperation_t transA,
                           cusparseOperation_t transX,
                           int mb,
                           int n,
                           int nnzb,
                           const cusparseMatDescr_t descrA,
                           cuDoubleComplex *bsrSortedValA,
                           const int *bsrSortedRowPtrA,
                           const int *bsrSortedColIndA,
                           int blockDim,
                           bsrsm2Info_t info,
                           int *pBufferSizeInBytes)
</pre><p class="p">This function returns size of buffer used in <samp class="ph codeph">bsrsm2()</samp>, a new sparse triangular
                           linear system <samp class="ph codeph">op(A)*op(X)=</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math><samp class="ph codeph">op(B)</samp>. 
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(mb*blockDim)x(mb*blockDim)</samp> sparse matrix that is
                           defined in BSR storage format by the three arrays <samp class="ph codeph">bsrValA</samp>,
                           <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>); <samp class="ph codeph">B</samp> and
                           <samp class="ph codeph">X</samp> are the right-hand-side and the solution matrices; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and 
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">Although there are six combinations in terms of parameter <samp class="ph codeph">trans</samp> and the upper
                           (and lower) triangular part of <samp class="ph codeph">A</samp>, <samp class="ph codeph">bsrsm2_bufferSize()</samp>
                           returns the maximum size of the buffer among these combinations. The buffer size depends on
                           dimension <samp class="ph codeph">mb,blockDim</samp> and the number of nonzeros of the matrix,
                           <samp class="ph codeph">nnzb</samp>. If the user changes the matrix, it is necessary to call
                           <samp class="ph codeph">bsrsm2_bufferSize()</samp> again to get the correct buffer size, otherwise a
                           segmentation fault may occur. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation <samp class="ph codeph">op(A)</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transX</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation <samp class="ph codeph">op(X)</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">op(B)</samp> and <samp class="ph codeph">op(X)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, 
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every block row and the end of the last block row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       column indices of the nonzero blocks of matrix
                                       <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix <samp class="ph codeph">A</samp>; larger than zero.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">record internal states based on different algorithms.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in <samp class="ph codeph">bsrsm2_analysis()</samp> and
                                       <samp class="ph codeph">bsrsm2_solve()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb, n, nnzb&lt;=0</samp>); base index is not 0 or
                                       1. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-bsrsm2_analysis"><a name="cusparse-lt-t-gt-bsrsm2_analysis" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrsm2_analysis" name="cusparse-lt-t-gt-bsrsm2_analysis" shape="rect">8.11.&nbsp;cusparse&lt;t&gt;bsrsm2_analysis()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsrsm2_analysis(cusparseHandle_t handle,
                         cusparseDirection_t dirA,
                         cusparseOperation_t transA,
                         cusparseOperation_t transX,
                         int mb,
                         int n,
                         int nnzb,
                         const cusparseMatDescr_t descrA,
                         const float *bsrSortedVal,
                         const int *bsrSortedRowPtr,
                         const int *bsrSortedColInd,
                         int blockDim,
                         bsrsm2Info_t info,
                         cusparseSolvePolicy_t policy,
                         void *pBuffer)

cusparseStatus_t 
cusparseDbsrsm2_analysis(cusparseHandle_t handle,
                         cusparseDirection_t dirA,
                         cusparseOperation_t transA,
                         cusparseOperation_t transX,
                         int mb,
                         int n,
                         int nnzb,
                         const cusparseMatDescr_t descrA,
                         const double *bsrSortedVal,
                         const int *bsrSortedRowPtr,
                         const int *bsrSortedColInd,
                         int blockDim,
                         bsrsm2Info_t info,
                         cusparseSolvePolicy_t policy,
                         void *pBuffer)

cusparseStatus_t 
cusparseCbsrsm2_analysis(cusparseHandle_t handle,
                         cusparseDirection_t dirA,
                         cusparseOperation_t transA,
                         cusparseOperation_t transX,
                         int mb,
                         int n,
                         int nnzb,
                         const cusparseMatDescr_t descrA,
                         const cuComplex *bsrSortedVal,
                         const int *bsrSortedRowPtr,
                         const int *bsrSortedColInd,
                         int blockDim,
                         bsrsm2Info_t info,
                         cusparseSolvePolicy_t policy,
                         void *pBuffer)

cusparseStatus_t 
cusparseZbsrsm2_analysis(cusparseHandle_t handle,
                         cusparseDirection_t dirA,
                         cusparseOperation_t transA,
                         cusparseOperation_t transX,
                         int mb,
                         int n,
                         int nnzb,
                         const cusparseMatDescr_t descrA,
                         const cuDoubleComplex *bsrSortedVal,
                         const int *bsrSortedRowPtr,
                         const int *bsrSortedColInd,
                         int blockDim,
                         bsrsm2Info_t info,
                         cusparseSolvePolicy_t policy,
                         void *pBuffer)
</pre><p class="p">This function performs the analysis phase of <samp class="ph codeph">bsrsm2()</samp>, a new sparse triangular
                           linear system <samp class="ph codeph">op(A)*op(X) =</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math><samp class="ph codeph">op(B)</samp>. 
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(mb*blockDim)x(mb*blockDim)</samp> sparse matrix that is
                           defined in BSR storage format by the three arrays <samp class="ph codeph">bsrValA</samp>,
                           <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>); <samp class="ph codeph">B</samp> and
                           <samp class="ph codeph">X</samp> are the right-hand-side and the solution matrices; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar; and 
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">and</p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>X</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>X</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transX == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>X</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transX == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>X</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transX == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE (not supported)</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">
                           and <samp class="ph codeph">op(B)</samp> and <samp class="ph codeph">op(X)</samp> are equal.
                           
                        </p>
                        <p class="p"> The block of BSR format is of size <samp class="ph codeph">blockDim*blockDim</samp>, stored in column-major or
                           row-major as determined by parameter <samp class="ph codeph">dirA</samp>, which is either
                           <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>. The
                           matrix type must be <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, and the fill mode and
                           diagonal type are ignored. 
                        </p>
                        <p class="p">It is expected that this function will be executed only once for a given matrix and a particular operation type.</p>
                        <p class="p">This function requires the buffer size returned by <samp class="ph codeph">bsrsm2_bufferSize()</samp>. The
                           address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If not,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">bsrsm2_analysis()</samp> reports a structural zero and computes the level
                           information stored in opaque structure <samp class="ph codeph">info</samp>. The level information can
                           extract more parallelism during a triangular solver. However <samp class="ph codeph">bsrsm2_solve()</samp>
                           can be done without level information. To disable level information, the user needs to specify
                           the policy of the triangular solver as <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">bsrsm2_analysis()</samp> always reports the first structural zero, even if the
                           parameter <samp class="ph codeph">policy</samp> is <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. Besides,
                           no structural zero is reported if <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> is specified, even
                           if block <samp class="ph codeph">A(j,j)</samp> is missing for some <samp class="ph codeph">j</samp>. The user must call
                           <samp class="ph codeph">cusparseXbsrsm2_query_zero_pivot()</samp> to know where the structural zero is. 
                        </p>
                        <p class="p">Even when <samp class="ph codeph">bsrsm2_analysis()</samp> reports a structural zero, the user can still call asynchronously <samp class="ph codeph">bsrsm2_solve()</samp>. In this case, the solve
                           will return a numerical zero in the same position as the structural zero but this result <samp class="ph codeph">X</samp> is meaningless. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation <samp class="ph codeph">op(A)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transX</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation <samp class="ph codeph">op(B)</samp> and <samp class="ph codeph">op(X)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">op(B)</samp> and <samp class="ph codeph">op(X)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of non-zero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, 
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       nonzero blocks of matrix <samp class="ph codeph">A</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every block row and the end of the last block row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       column indices of the nonzero blocks of matrix
                                       <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix <samp class="ph codeph">A</samp>; larger than zero.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateBsrsm2Info</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">The supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                       <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user; the size is return by
                                       <samp class="ph codeph">bsrsm2_bufferSize()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure filled with information collected during the analysis phase (that should be passed to the solve phase unchanged).</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">
                                       <p class="p">Either invalid parameters were passed (<samp class="ph codeph">mb, n, nnzb&lt;=0</samp>).
                                       </p>
                                       <p class="p">Either invalid or unsupported operations were passed (<samp class="ph codeph">op(B) and op(X)</samp> are different from CUSPARSE_OPERATION_NON_TRANSPOSE or CUSPARSE_OPERATION_TRANSPOSE).
                                          
                                       </p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-bsrsm2_solve"><a name="cusparse-lt-t-gt-bsrsm2_solve" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrsm2_solve" name="cusparse-lt-t-gt-bsrsm2_solve" shape="rect">8.12.&nbsp;cusparse&lt;t&gt;bsrsm2_solve()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsrsm2_solve(cusparseHandle_t handle,
                      cusparseDirection_t dirA,
                      cusparseOperation_t transA,
                      cusparseOperation_t transX,
                      int mb,
                      int n,
                      int nnzb,
                      const float *alpha,
                      const cusparseMatDescr_t descrA,
                      const float *bsrSortedVal,
                      const int *bsrSortedRowPtr,
                      const int *bsrSortedColInd,
                      int blockDim,
                      bsrsm2Info_t info,
                      const float *B,
                      int ldb,
                      float *X,
                      int ldx,
                      cusparseSolvePolicy_t policy,
                      void *pBuffer)

cusparseStatus_t 
cusparseDbsrsm2_solve(cusparseHandle_t handle,
                      cusparseDirection_t dirA,
                      cusparseOperation_t transA,
                      cusparseOperation_t transX,
                      int mb,
                      int n,
                      int nnzb,
                      const double *alpha,
                      const cusparseMatDescr_t descrA,
                      const double *bsrSortedVal,
                      const int *bsrSortedRowPtr,
                      const int *bsrSortedColInd,
                      int blockDim,
                      bsrsm2Info_t info,
                      const double *B,
                      int ldb,
                      double *X,
                      int ldx,
                      cusparseSolvePolicy_t policy,
                      void *pBuffer)

cusparseStatus_t 
cusparseCbsrsm2_solve(cusparseHandle_t handle,
                      cusparseDirection_t dirA,
                      cusparseOperation_t transA,
                      cusparseOperation_t transX,
                      int mb,
                      int n,
                      int nnzb,
                      const cuComplex *alpha,
                      const cusparseMatDescr_t descrA,
                      const cuComplex *bsrSortedVal,
                      const int *bsrSortedRowPtr,
                      const int *bsrSortedColInd,
                      int blockDim,
                      bsrsm2Info_t info,
                      const cuComplex *B,
                      int ldb,
                      cuComplex *X,
                      int ldx,
                      cusparseSolvePolicy_t policy,
                      void *pBuffer)

cusparseStatus_t 
cusparseZbsrsm2_solve(cusparseHandle_t handle,
                      cusparseDirection_t dirA,
                      cusparseOperation_t transA,
                      cusparseOperation_t transX,
                      int mb,
                      int n,
                      int nnzb,
                      const cuDoubleComplex *alpha,
                      const cusparseMatDescr_t descrA,
                      const cuDoubleComplex *bsrSortedVal,
                      const int *bsrSortedRowPtr,
                      const int *bsrSortedColInd,
                      int blockDim,
                      bsrsm2Info_t info,
                      const cuDoubleComplex *B,
                      int ldb,
                      cuDoubleComplex *X,
                      int ldx,
                      cusparseSolvePolicy_t policy,
                      void *pBuffer)
</pre><p class="p">This function performs the solve phase of the solution of a sparse triangular linear system:</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op(X)</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op(B)</mtext>
                                             </mrow>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(mb*blockDim)x(mb*blockDim)</samp> sparse matrix that is
                           defined in BSR storage format by the three arrays <samp class="ph codeph">bsrValA</samp>,
                           <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>); <samp class="ph codeph">B</samp> and
                           <samp class="ph codeph">X</samp> are the right-hand-side and the solution matrices; 
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                           </math>
                           is a scalar, and 
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transA == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transA == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transA == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">and</p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>X</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>X</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transX == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>X</mi>
                                          <mi>T</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if transX == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>X</mi>
                                          <mi>H</mi>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>not supported</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">Only <samp class="ph codeph">op(A)=A</samp> is supported.
                           
                        </p>
                        <p class="p"><samp class="ph codeph">op(B)</samp> and <samp class="ph codeph">op(X)</samp> must be performed in the same way.
                           In other words, if <samp class="ph codeph">op(B)=B</samp>, <samp class="ph codeph">op(X)=X</samp>.
                           
                        </p>
                        <p class="p">The block of BSR format is of size <samp class="ph codeph">blockDim*blockDim</samp>, stored as column-major or
                           row-major as determined by parameter <samp class="ph codeph">dirA</samp>, which is either
                           <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>. The
                           matrix type must be <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, and the fill mode and
                           diagonal type are ignored. Function <samp class="ph codeph">bsrsm02_solve()</samp> can support an arbitrary
                           <samp class="ph codeph">blockDim</samp>. 
                        </p>
                        <p class="p">This function may be executed multiple times for a given matrix and a particular operation type.</p>
                        <p class="p">This function requires the buffer size returned by <samp class="ph codeph">bsrsm2_bufferSize()</samp>. The
                           address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is not,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                        </p>
                        <p class="p">Although <samp class="ph codeph">bsrsm2_solve()</samp> can be done without level information, the user still
                           needs to be aware of consistency. If <samp class="ph codeph">bsrsm2_analysis()</samp> is called with policy
                           <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>, <samp class="ph codeph">bsrsm2_solve()</samp> can be run
                           with or without levels. On the other hand, if <samp class="ph codeph">bsrsm2_analysis()</samp> is called
                           with <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>, <samp class="ph codeph">bsrsm2_solve()</samp> can only
                           accept <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>; otherwise,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                        </p>
                        <p class="p">Function <samp class="ph codeph">bsrsm02_solve()</samp> has the same behavior as
                           <samp class="ph codeph">bsrsv02_solve()</samp>, reporting the first numerical zero, including a structural
                           zero. The user must call <samp class="ph codeph">cusparseXbsrsm2_query_zero_pivot()</samp> to know where the
                           numerical zero is. 
                        </p>
                        <p class="p"> The motivation of <samp class="ph codeph">transpose(X)</samp> is to improve the memory access of matrix
                           <samp class="ph codeph">X</samp>. The computational pattern of <samp class="ph codeph">transpose(X)</samp> with matrix
                           <samp class="ph codeph">X</samp> in column-major order is equivalent to <samp class="ph codeph">X</samp> with matrix
                           <samp class="ph codeph">X</samp> in row-major order.  
                           
                        </p>
                        <p class="p">
                           In-place is supported and requires that <samp class="ph codeph">B</samp> and <samp class="ph codeph">X</samp> point to the same memory block, 
                           and <samp class="ph codeph">ldb=ldx</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                       <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation <samp class="ph codeph">op(A)</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transX</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation <samp class="ph codeph">op(B)</samp> and <samp class="ph codeph">op(X)</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">op(B)</samp> and <samp class="ph codeph">op(X)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of non-zero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>,
                                       while the supported diagonal types are <samp class="ph codeph">CUSPARSE_DIAG_TYPE_UNIT</samp> and <samp class="ph codeph">CUSPARSE_DIAG_TYPE_NON_UNIT</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       <samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       non-zero blocks of matrix <samp class="ph codeph">A</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       
                                       elements that contains the start of every block row and the end of the last block row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       column indices of the nonzero blocks of matrix
                                       <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix <samp class="ph codeph">A</samp>; larger than zero.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateBsrsm2Info()</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; right-hand-side array.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp>. If <samp class="ph codeph">op(B)=B</samp>,
                                       <samp class="ph codeph">ldb &gt;= (mb*blockDim)</samp>; otherwise, <samp class="ph codeph">ldb &gt;= n</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldx</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">X</samp>. If <samp class="ph codeph">op(X)=X</samp>, then
                                       <samp class="ph codeph">ldx &gt;= (mb*blockDim)</samp>. otherwise <samp class="ph codeph">ldx &gt;= n</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                       <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                       <samp class="ph codeph">bsrsm2_bufferSize()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">X</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; solution array with leading dimensions <samp class="ph codeph">ldx</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MAPPING_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the texture binding failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-bsrsm2_zeroPivot"><a name="cusparse-lt-t-gt-bsrsm2_zeroPivot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrsm2_zeroPivot" name="cusparse-lt-t-gt-bsrsm2_zeroPivot" shape="rect">cusparseXbsrsm2_zeroPivot()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseXbsrsm2_zeroPivot(cusparseHandle_t handle,
                          bsrsm2Info_t info,
                          int *position);
</pre><p class="p"> If the returned error code is <samp class="ph codeph">CUSPARSE_STATUS_ZERO_PIVOT</samp>,
                           <samp class="ph codeph">position=j</samp> means <samp class="ph codeph">A(j,j)</samp> is either a structural zero or a numerical
                           zero (singular block). Otherwise <samp class="ph codeph">position=-1</samp>. 
                        </p>
                        <p class="p">
                           The <samp class="ph codeph">position</samp> can be 0-base or 1-base, the same as the matrix.
                           
                        </p>
                        <p class="p">Function <samp class="ph codeph">cusparseXbsrsm2_zeroPivot()</samp> is a blocking call. It calls
                           <samp class="ph codeph">cudaDeviceSynchronize()</samp> to make sure all previous kernels are done. 
                        </p>
                        <p class="p"> The <samp class="ph codeph">position</samp> can be in the host memory or device memory. The user can set the
                           proper mode with <samp class="ph codeph">cusparseSetPointerMode()</samp>. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> contains a structural zero or a numerical zero if the user
                                       already called <samp class="ph codeph">bsrsm2_analysis()</samp> or <samp class="ph codeph">bsrsm2_solve()</samp>. 
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">position</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">if no structural or numerical zero, <samp class="ph codeph">position</samp> is -1; otherwise, if
                                       <samp class="ph codeph">A(j,j)</samp> is missing or <samp class="ph codeph">U(j,j)</samp> is zero, <samp class="ph codeph">position=j</samp>. 
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> is not valid.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-gemmi"><a name="cusparse-lt-t-gt-gemmi" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gemmi" name="cusparse-lt-t-gt-gemmi" shape="rect">8.14.&nbsp;cusparse&lt;t&gt;gemmi()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseSgemmi(cusparseHandle_t handle,
               int m,
               int n,
               int k,
               int nnz,
               const float *alpha, 
               const float *A,
               int lda,
               const float *cscValB,
               const int *cscColPtrB,
               const int *cscRowIndB,
               const float *beta, 
               float *C,
               int ldc);

cusparseStatus_t  
cusparseDgemmi(cusparseHandle_t handle,
               int m,
               int n,
               int k,
               int nnz,
               const double *alpha, 
               const double *A,
               int lda,
               const double *cscValB,
               const int *cscColPtrB,
               const int *cscRowIndB,
               const double *beta, 
               double *C,
               int ldc);

cusparseStatus_t  
cusparseCgemmi(cusparseHandle_t handle,
               int m,
               int n,
               int k,
               int nnz,
               const cuComplex *alpha, 
               const cuComplex *A,
               int lda,
               const cuComplex *cscValB,
               const int *cscColPtrB,
               const int *cscRowIndB,
               const cuComplex *beta, 
               cuComplex *C,
               int ldc);

cusparseStatus_t  
cusparseZgemmi(cusparseHandle_t handle,
               int m,
               int n,
               int k,
               int nnz,
               const cuDoubleComplex *alpha, 
               const cuDoubleComplex *A,
               int lda,
               const cuDoubleComplex *cscValB,
               const int *cscColPtrB,
               const int *cscRowIndB,
               const cuDoubleComplex *beta, 
               cuDoubleComplex *C,
               int ldc);

</pre><p class="p">This function performs the following matrix-matrix operations:</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>C</mi>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mi>A</mi>
                                          <mo>∗</mo>
                                          <mi>B</mi>
                                          <mo>+</mo>
                                          <mi>β</mi>
                                          <mo>∗</mo>
                                          <mi>C</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"><samp class="ph codeph">A</samp> and <samp class="ph codeph">C</samp> are dense matrices; 
                           <samp class="ph codeph">B</samp> is a <samp class="ph codeph">k×n</samp> sparse matrix that is defined in CSC storage 
                           format by the three arrays <samp class="ph codeph">cscValB</samp>, <samp class="ph codeph">cscColPtrB</samp>, and <samp class="ph codeph">cscRowIndB</samp>);
                           			
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                              <mtext>&nbsp;and&nbsp;</mtext>
                              <mi>β</mi>
                           </math>
                           			 are scalars; and
                           
                        </p>
                        <p class="p">
                           Remark: <samp class="ph codeph">B</samp> is base-0.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrices <samp class="ph codeph">B</samp> and <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">k</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of sparse matrix <samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(lda, k)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">A</samp>. It must be at least <samp class="ph codeph">m</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscValB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">cscColPtrB(k)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">cscColPtrB(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscColPtrB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">k</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscRowIndB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">cscColPtrB(k)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">cscColPtrB(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication. 
                                       If <samp class="ph codeph">beta</samp> is zero, <samp class="ph codeph">C</samp> does not have to be a valid input.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">C</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(ldc, n)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldc</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">C</samp>. It must be at least <samp class="ph codeph">m</samp></td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">C</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; updated array of dimensions <samp class="ph codeph">(ldc, n)</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n, k, nnz&lt;0</samp> or <samp class="ph codeph">lda</samp>
                                       							and <samp class="ph codeph">ldc</samp> are incorrect).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusparse-extra-function-reference"><a name="cusparse-extra-function-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusparse-extra-function-reference" name="cusparse-extra-function-reference" shape="rect">9.&nbsp;cuSPARSE Extra Function Reference</a></h2>
                  <div class="body conbody">
                     <p class="p">This chapter describes the extra routines used to manipulate sparse matrices.</p>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrgeam"><a name="cusparse-lt-t-gt-csrgeam" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrgeam" name="cusparse-lt-t-gt-csrgeam" shape="rect">9.1.&nbsp;cusparse&lt;t&gt;csrgeam()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseXcsrgeamNnz(cusparseHandle_t handle, 
                    int m, 
                    int n,
                    const cusparseMatDescr_t descrA, 
                    int nnzA,
                    const int *csrRowPtrA, 
                    const int *csrColIndA,
                    const cusparseMatDescr_t descrB, 
                    int nnzB,
                    const int *csrRowPtrB, 
                    const int *csrColIndB,
                    const cusparseMatDescr_t descrC, 
                    int *csrRowPtrC,
                    int *nnzTotalDevHostPtr)
cusparseStatus_t
cusparseScsrgeam(cusparseHandle_t handle, 
                 int m, 
                 int n,
                 const float *alpha,
                 const cusparseMatDescr_t descrA, 
                 int nnzA,
                 const float *csrValA, 
                 const int *csrRowPtrA, 
                 const int *csrColIndA,
                 const float *beta,
                 const cusparseMatDescr_t descrB, 
                 int nnzB,
                 const float *csrValB, 
                 const int *csrRowPtrB, 
                 const int *csrColIndB,
                 const cusparseMatDescr_t descrC,
                 float *csrValC, 
                 int *csrRowPtrC, 
                 int *csrColIndC)
cusparseStatus_t
cusparseDcsrgeam(cusparseHandle_t handle, 
                 int m, 
                 int n,
                 const double *alpha,
                 const cusparseMatDescr_t descrA, 
                 int nnzA,
                 const double *csrValA, 
                 const int *csrRowPtrA, 
                 const int *csrColIndA,
                 const double *beta,
                 const cusparseMatDescr_t descrB, 
                 int nnzB,
                 const double *csrValB, 
                 const int *csrRowPtrB, 
                 const int *csrColIndB,
                 const cusparseMatDescr_t descrC,
                 double *csrValC, 
                 int *csrRowPtrC, 
                 int *csrColIndC)
cusparseStatus_t
cusparseCcsrgeam(cusparseHandle_t handle, 
                 int m, 
                 int n,
                 const cuComplex *alpha,
                 const cusparseMatDescr_t descrA, 
                 int nnzA,
                 const cuComplex *csrValA, 
                 const int *csrRowPtrA, 
                 const int *csrColIndA,
                 const cuComplex *beta,
                 const cusparseMatDescr_t descrB, 
                 int nnzB,
                 const cuComplex *csrValB, 
                 const int *csrRowPtrB, 
                 const int *csrColIndB,
                 const cusparseMatDescr_t descrC,
                 cuComplex *csrValC, 
                 int *csrRowPtrC, 
                 int *csrColIndC)
cusparseStatus_t
cusparseZcsrgeam(cusparseHandle_t handle, 
                 int m, 
                 int n,
                 const cuDoubleComplex *alpha,
                 const cusparseMatDescr_t descrA, 
                 int nnzA,
                 const cuDoubleComplex *csrValA, 
                 const int *csrRowPtrA, 
                 const int *csrColIndA,
                 const cuDoubleComplex *beta,
                 const cusparseMatDescr_t descrB, 
                 int nnzB,
                 const cuDoubleComplex *csrValB, 
                 const int *csrRowPtrB, 
                 const int *csrColIndB,
                 const cusparseMatDescr_t descrC,
                 cuDoubleComplex *csrValC, 
                 int *csrRowPtrC, 
                 int *csrColIndC)
</pre><p class="p">This function performs following matrix-matrix operation</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>C</mi>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mi>A</mi>
                                          <mo>+</mo>
                                          <mi>β</mi>
                                          <mo>∗</mo>
                                          <mi>B</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">where <samp class="ph codeph">A</samp>, <samp class="ph codeph">B</samp>, and <samp class="ph codeph">C</samp> are
                           				<samp class="ph codeph">m×n</samp> sparse matrices (defined in CSR storage format by the
                           			three arrays <samp class="ph codeph">csrValA|csrValB|csrValC</samp>,
                           				<samp class="ph codeph">csrRowPtrA|csrRowPtrB|csrRowPtrC</samp>, and
                           				<samp class="ph codeph">csrColIndA|csrColIndB|csrcolIndC</samp> respectively), and 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                              <mtext>&nbsp;and&nbsp;</mtext>
                              <mi>β</mi>
                           </math>
                           			 are scalars. Since <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> have
                           			different sparsity patterns, cuSPARSE adopts a two-step approach to complete sparse
                           			matrix <samp class="ph codeph">C</samp>. In the first step, the user allocates
                           				<samp class="ph codeph">csrRowPtrC</samp> of <samp class="ph codeph">m+1</samp>elements and uses function
                           				<samp class="ph codeph">cusparseXcsrgeamNnz()</samp> to determine <samp class="ph codeph">csrRowPtrC</samp> and
                           			the total number of nonzero elements. In the second step, the user gathers
                           				<samp class="ph codeph">nnzC</samp> (number of nonzero elements of matrix <samp class="ph codeph">C</samp>)
                           			from either <samp class="ph codeph">(nnzC=*nnzTotalDevHostPtr)</samp> or
                           				<samp class="ph codeph">(nnzC=csrRowPtrC(m)-csrRowPtrC(0))</samp> and allocates <samp class="ph codeph">csrValC,
                              				csrColIndC</samp> of <samp class="ph codeph">nnzC</samp> elements respectively, then finally
                           			calls function <samp class="ph codeph">cusparse[S|D|C|Z]csrgeam()</samp> to complete matrix
                           				<samp class="ph codeph">C</samp>.
                        </p>
                        <p class="p">The general procedure is as follows:</p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> baseC, nnzC;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// nnzTotalDevHostPtr points to host memory</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *nnzTotalDevHostPtr = &amp;nnzC;
cusparseSetPointerMode(handle, CUSPARSE_POINTER_MODE_HOST);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1));
cusparseXcsrgeamNnz(handle, m, n,
        descrA, nnzA, csrRowPtrA, csrColIndA,
        descrB, nnzB, csrRowPtrB, csrColIndB,
        descrC, csrRowPtrC, nnzTotalDevHostPtr);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (NULL != nnzTotalDevHostPtr){
    nnzC = *nnzTotalDevHostPtr;
}<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
    cudaMemcpy(&amp;nnzC, csrRowPtrC+m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    cudaMemcpy(&amp;baseC, csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    nnzC -= baseC;
}
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzC);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrValC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzC);
cusparseScsrgeam(handle, m, n,
        alpha,
        descrA, nnzA,
        csrValA, csrRowPtrA, csrColIndA,
        beta,
        descrB, nnzB,
        csrValB, csrRowPtrB, csrColIndB,
        descrC,
        csrValC, csrRowPtrC, csrColIndC);</pre><div class="p">Several comments on <samp class="ph codeph">csrgeam()</samp>:<a name="cusparse-lt-t-gt-csrgeam__ul_ivn_fbt_nm" shape="rect">
                              <!-- --></a><ul class="ul" id="cusparse-lt-t-gt-csrgeam__ul_ivn_fbt_nm">
                              <li class="li">The other three combinations, NT, TN, and TT, are not supported by cuSPARSE. In
                                 					order to do any one of the three, the user should use the routine
                                 						<samp class="ph codeph">csr2csc()</samp> to convert 
                                 						
                                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <mi>A</mi>
                                 </math>
                                 					|
                                 						
                                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <mi>B</mi>
                                 </math>
                                 					 to 
                                 						
                                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <msup>
                                       <mi>A</mi>
                                       <mi>T</mi>
                                    </msup>
                                 </math>
                                 					|
                                 						
                                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <msup>
                                       <mi>B</mi>
                                       <mi>T</mi>
                                    </msup>
                                 </math>
                                 					.
                              </li>
                              <li class="li">Only <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> is supported. If either
                                 						<samp class="ph codeph">A</samp> or <samp class="ph codeph">B</samp> is symmetric or Hermitian, then the
                                 					user must extend the matrix to a full one and reconfigure the
                                 						<samp class="ph codeph">MatrixType</samp> field of the descriptor to
                                 						<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              </li>
                              <li class="li">If the sparsity pattern of matrix <samp class="ph codeph">C</samp> is known, the user can skip
                                 					the call to function <samp class="ph codeph">cusparseXcsrgeamNnz()</samp>. For example,
                                 					suppose that the user has an iterative algorithm which would update
                                 						<samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> iteratively but keep the sparsity
                                 					patterns. The user can call function <samp class="ph codeph">cusparseXcsrgeamNnz()</samp> once
                                 					to set up the sparsity pattern of <samp class="ph codeph">C</samp>, then call function
                                 						<samp class="ph codeph">cusparse[S|D|C|Z]geam()</samp> only for each iteration.
                              </li>
                              <li class="li">The pointers <samp class="ph codeph">alpha</samp> and <samp class="ph codeph">beta</samp> must be
                                 					valid.
                              </li>
                              <li class="li">When <samp class="ph codeph">alpha</samp> or <samp class="ph codeph">beta</samp> is zero, it is not
                                 					considered a special case by cuSPARSE. The sparsity pattern of
                                 						<samp class="ph codeph">C</samp> is independent of the value of <samp class="ph codeph">alpha</samp> and
                                 						<samp class="ph codeph">beta</samp>. If the user wants 
                                 						
                                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <mi>C</mi>
                                    <mo>=</mo>
                                    <mn>0</mn>
                                    <mo>×</mo>
                                    <mi>A</mi>
                                    <mo>+</mo>
                                    <mn>1</mn>
                                    <mo>×</mo>
                                    <msup>
                                       <mi>B</mi>
                                       <mrow class="MJX-TeXAtom-ORD">
                                          <mi>T</mi>
                                       </mrow>
                                    </msup>
                                 </math>
                                 					, then <samp class="ph codeph">csr2csc()</samp> is better than
                                 						<samp class="ph codeph">csrgeam()</samp>.
                              </li>
                           </ul>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of sparse matrix <samp class="ph codeph">A,B,C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of sparse matrix <samp class="ph codeph">A,B,C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzA</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication. If <samp class="ph codeph">beta</samp> is zero, <samp class="ph codeph">y</samp> does not have to be a valid input.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">B</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of sparse matrix <samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzB</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrB(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrB(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzB</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrB(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrB(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzC</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrC(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrC(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzC</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrC(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrC(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of
                                       								matrix<samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzTotalDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">total number of nonzero elements in device or host memory. It is equal to
                                       								<samp class="ph codeph">(csrRowPtrC(m)-csrRowPtrC(0))</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnz&lt;0</samp>, <samp class="ph codeph">IndexBase</samp> of
                                       								<samp class="ph codeph">descrA,descrB,descrC</samp> is not base-0 or base-1, or
                                       								<samp class="ph codeph">alpha</samp> or <samp class="ph codeph">beta</samp> is nil )).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrgeam2"><a name="cusparse-lt-t-gt-csrgeam2" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrgeam2" name="cusparse-lt-t-gt-csrgeam2" shape="rect">9.2.&nbsp;cusparse&lt;t&gt;csrgeam2()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseScsrgeam2_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    const float *alpha,
    const cusparseMatDescr_t descrA,
    int nnzA,
    const float *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const float *beta,
    const cusparseMatDescr_t descrB,
    int nnzB,
    const float *csrSortedValB,
    const int *csrSortedRowPtrB,
    const int *csrSortedColIndB,
    const cusparseMatDescr_t descrC,
    const float *csrSortedValC,
    const int *csrSortedRowPtrC,
    const int *csrSortedColIndC,
    size_t *pBufferSizeInBytes );

cusparseStatus_t 
cusparseDcsrgeam2_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    const double *alpha,
    const cusparseMatDescr_t descrA,
    int nnzA,
    const double *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const double *beta,
    const cusparseMatDescr_t descrB,
    int nnzB,
    const double *csrSortedValB,
    const int *csrSortedRowPtrB,
    const int *csrSortedColIndB,
    const cusparseMatDescr_t descrC,
    const double *csrSortedValC,
    const int *csrSortedRowPtrC,
    const int *csrSortedColIndC,
    size_t *pBufferSizeInBytes );

cusparseStatus_t 
cusparseCcsrgeam2_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    const cuComplex *alpha,
    const cusparseMatDescr_t descrA,
    int nnzA,
    const cuComplex *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const cuComplex *beta,
    const cusparseMatDescr_t descrB,
    int nnzB,
    const cuComplex *csrSortedValB,
    const int *csrSortedRowPtrB,
    const int *csrSortedColIndB,
    const cusparseMatDescr_t descrC,
    const cuComplex *csrSortedValC,
    const int *csrSortedRowPtrC,
    const int *csrSortedColIndC,
    size_t *pBufferSizeInBytes );

cusparseStatus_t 
cusparseZcsrgeam2_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    const cuDoubleComplex *alpha,
    const cusparseMatDescr_t descrA,
    int nnzA,
    const cuDoubleComplex *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const cuDoubleComplex *beta,
    const cusparseMatDescr_t descrB,
    int nnzB,
    const cuDoubleComplex *csrSortedValB,
    const int *csrSortedRowPtrB,
    const int *csrSortedColIndB,
    const cusparseMatDescr_t descrC,
    const cuDoubleComplex *csrSortedValC,
    const int *csrSortedRowPtrC,
    const int *csrSortedColIndC,
    size_t *pBufferSizeInBytes );


cusparseStatus_t 
cusparseXcsrgeam2Nnz(
    cusparseHandle_t handle,
    int m,
    int n,
    const cusparseMatDescr_t descrA,
    int nnzA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const cusparseMatDescr_t descrB,
    int nnzB,
    const int *csrSortedRowPtrB,
    const int *csrSortedColIndB,
    const cusparseMatDescr_t descrC,
    int *csrSortedRowPtrC,
    int *nnzTotalDevHostPtr,
    void *workspace );

</pre><pre xml:space="preserve">

cusparseStatus_t 
cusparseScsrgeam2(
    cusparseHandle_t handle,
    int m,
    int n,
    const float *alpha,
    const cusparseMatDescr_t descrA,
    int nnzA,
    const float *csrSortedValA,
    const int   *csrSortedRowPtrA,
    const int   *csrSortedColIndA,
    const float *beta,
    const cusparseMatDescr_t descrB,
    int nnzB,
    const float *csrSortedValB,
    const int   *csrSortedRowPtrB,
    const int   *csrSortedColIndB,
    const cusparseMatDescr_t descrC,
    float       *csrSortedValC,
    int         *csrSortedRowPtrC,
    int         *csrSortedColIndC,
    void *pBuffer );

cusparseStatus_t  
cusparseDcsrgeam2(
    cusparseHandle_t handle,
    int m,
    int n,
    const double *alpha,
    const cusparseMatDescr_t descrA,
    int nnzA,
    const double *csrSortedValA,
    const int    *csrSortedRowPtrA,
    const int    *csrSortedColIndA,
    const double *beta,
    const cusparseMatDescr_t descrB,
    int nnzB,
    const double *csrSortedValB,
    const int    *csrSortedRowPtrB,
    const int    *csrSortedColIndB,
    const cusparseMatDescr_t descrC,
    double *csrSortedValC,
    int    *csrSortedRowPtrC,
    int    *csrSortedColIndC,
    void *pBuffer );

cusparseStatus_t 
cusparseCcsrgeam2(
    cusparseHandle_t handle,
    int m,
    int n,
    const cuComplex *alpha,
    const cusparseMatDescr_t descrA,
    int nnzA,
    const cuComplex *csrSortedValA,
    const int       *csrSortedRowPtrA,
    const int       *csrSortedColIndA,
    const cuComplex *beta,
    const cusparseMatDescr_t descrB,
    int nnzB,
    const cuComplex *csrSortedValB,
    const int       *csrSortedRowPtrB,
    const int       *csrSortedColIndB,
    const cusparseMatDescr_t descrC,
    cuComplex *csrSortedValC,
    int       *csrSortedRowPtrC,
    int       *csrSortedColIndC,
    void *pBuffer );

cusparseStatus_t  
cusparseZcsrgeam2(
    cusparseHandle_t handle,
    int m,
    int n,
    const cuDoubleComplex *alpha,
    const cusparseMatDescr_t descrA,
    int nnzA,
    const cuDoubleComplex *csrSortedValA,
    const int *csrSortedRowPtrA,
    const int *csrSortedColIndA,
    const cuDoubleComplex *beta,
    const cusparseMatDescr_t descrB,
    int nnzB,
    const cuDoubleComplex *csrSortedValB,
    const int *csrSortedRowPtrB,
    const int *csrSortedColIndB,
    const cusparseMatDescr_t descrC,
    cuDoubleComplex *csrSortedValC,
    int *csrSortedRowPtrC,
    int *csrSortedColIndC,
    void *pBuffer );


</pre><p class="p">This function performs following matrix-matrix operation</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>C</mi>
                                          <mo>=</mo>
                                          <mi>α</mi>
                                          <mo>∗</mo>
                                          <mi>A</mi>
                                          <mo>+</mo>
                                          <mi>β</mi>
                                          <mo>∗</mo>
                                          <mi>B</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">where <samp class="ph codeph">A</samp>, <samp class="ph codeph">B</samp>, and <samp class="ph codeph">C</samp> are
                           				<samp class="ph codeph">m×n</samp> sparse matrices (defined in CSR storage format by the
                           			three arrays <samp class="ph codeph">csrValA|csrValB|csrValC</samp>,
                           				<samp class="ph codeph">csrRowPtrA|csrRowPtrB|csrRowPtrC</samp>, and
                           				<samp class="ph codeph">csrColIndA|csrColIndB|csrcolIndC</samp> respectively), and 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>α</mi>
                              <mtext>&nbsp;and&nbsp;</mtext>
                              <mi>β</mi>
                           </math>
                           			 are scalars. Since <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> have
                           			different sparsity patterns, cuSPARSE adopts a two-step approach to complete sparse
                           			matrix <samp class="ph codeph">C</samp>. In the first step, the user allocates
                           				<samp class="ph codeph">csrRowPtrC</samp> of <samp class="ph codeph">m+1</samp>elements and uses function
                           				<samp class="ph codeph">cusparseXcsrgeam2Nnz()</samp> to determine <samp class="ph codeph">csrRowPtrC</samp> and
                           			the total number of nonzero elements. In the second step, the user gathers
                           				<samp class="ph codeph">nnzC</samp> (number of nonzero elements of matrix <samp class="ph codeph">C</samp>)
                           			from either <samp class="ph codeph">(nnzC=*nnzTotalDevHostPtr)</samp> or
                           				<samp class="ph codeph">(nnzC=csrRowPtrC(m)-csrRowPtrC(0))</samp> and allocates <samp class="ph codeph">csrValC,
                              				csrColIndC</samp> of <samp class="ph codeph">nnzC</samp> elements respectively, then finally
                           			calls function <samp class="ph codeph">cusparse[S|D|C|Z]csrgeam2()</samp> to complete matrix
                           				<samp class="ph codeph">C</samp>.
                        </p>
                        <p class="p">The general procedure is as follows:</p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> baseC, nnzC;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* alpha, nnzTotalDevHostPtr points to host memory */</span>
size_t BufferSizeInBytes;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span> *buffer = NULL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *nnzTotalDevHostPtr = &amp;nnzC;
cusparseSetPointerMode(handle, CUSPARSE_POINTER_MODE_HOST);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1));
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* prepare buffer */</span>
cusparseScsrgeam2_bufferSizeExt(handle, m, n,
    alpha,
    descrA, nnzA,
    csrValA, csrRowPtrA, csrColIndA,
    beta,
    descrB, nnzB,
    csrValB, csrRowPtrB, csrColIndB,
    descrC,
    csrValC, csrRowPtrC, csrColIndC
    &amp;bufferSizeInBytes
    );
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;buffer, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>)*bufferSizeInBytes);
cusparseXcsrgeam2Nnz(handle, m, n,
        descrA, nnzA, csrRowPtrA, csrColIndA,
        descrB, nnzB, csrRowPtrB, csrColIndB,
        descrC, csrRowPtrC, nnzTotalDevHostPtr,
        buffer);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (NULL != nnzTotalDevHostPtr){
    nnzC = *nnzTotalDevHostPtr;
}<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
    cudaMemcpy(&amp;nnzC, csrRowPtrC+m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    cudaMemcpy(&amp;baseC, csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    nnzC -= baseC;
}
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzC);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrValC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzC);
cusparseScsrgeam2(handle, m, n,
        alpha,
        descrA, nnzA,
        csrValA, csrRowPtrA, csrColIndA,
        beta,
        descrB, nnzB,
        csrValB, csrRowPtrB, csrColIndB,
        descrC,
        csrValC, csrRowPtrC, csrColIndC
        buffer);
</pre><div class="p">
                           Several comments on <samp class="ph codeph">csrgeam2()</samp>:<a name="cusparse-lt-t-gt-csrgeam2__ul_ivn_fbt_nm" shape="rect">
                              <!-- --></a><ul class="ul" id="cusparse-lt-t-gt-csrgeam2__ul_ivn_fbt_nm">
                              <li class="li">The other three combinations, NT, TN, and TT, are not supported by cuSPARSE. In
                                 					order to do any one of the three, the user should use the routine
                                 						<samp class="ph codeph">csr2csc()</samp> to convert 
                                 						
                                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <mi>A</mi>
                                 </math>
                                 					|
                                 						
                                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <mi>B</mi>
                                 </math>
                                 					 to 
                                 						
                                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <msup>
                                       <mi>A</mi>
                                       <mi>T</mi>
                                    </msup>
                                 </math>
                                 					|
                                 						
                                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <msup>
                                       <mi>B</mi>
                                       <mi>T</mi>
                                    </msup>
                                 </math>
                                 					.
                              </li>
                              <li class="li">Only <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> is supported. If either
                                 						<samp class="ph codeph">A</samp> or <samp class="ph codeph">B</samp> is symmetric or Hermitian, then the
                                 					user must extend the matrix to a full one and reconfigure the
                                 						<samp class="ph codeph">MatrixType</samp> field of the descriptor to
                                 						<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              </li>
                              <li class="li">If the sparsity pattern of matrix <samp class="ph codeph">C</samp> is known, the user can skip
                                 					the call to function <samp class="ph codeph">cusparseXcsrgeam2Nnz()</samp>. For example,
                                 					suppose that the user has an iterative algorithm which would update
                                 						<samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> iteratively but keep the sparsity
                                 					patterns. The user can call function <samp class="ph codeph">cusparseXcsrgeam2Nnz()</samp> once
                                 					to set up the sparsity pattern of <samp class="ph codeph">C</samp>, then call function
                                 						<samp class="ph codeph">cusparse[S|D|C|Z]geam()</samp> only for each iteration.
                              </li>
                              <li class="li">The pointers <samp class="ph codeph">alpha</samp> and <samp class="ph codeph">beta</samp> must be
                                 					valid.
                              </li>
                              <li class="li">When <samp class="ph codeph">alpha</samp> or <samp class="ph codeph">beta</samp> is zero, it is not
                                 					considered a special case by cuSPARSE. The sparsity pattern of
                                 						<samp class="ph codeph">C</samp> is independent of the value of <samp class="ph codeph">alpha</samp> and
                                 						<samp class="ph codeph">beta</samp>. If the user wants 
                                 						
                                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <mi>C</mi>
                                    <mo>=</mo>
                                    <mn>0</mn>
                                    <mo>×</mo>
                                    <mi>A</mi>
                                    <mo>+</mo>
                                    <mn>1</mn>
                                    <mo>×</mo>
                                    <msup>
                                       <mi>B</mi>
                                       <mrow class="MJX-TeXAtom-ORD">
                                          <mi>T</mi>
                                       </mrow>
                                    </msup>
                                 </math>
                                 					, then <samp class="ph codeph">csr2csc()</samp> is better than
                                 						<samp class="ph codeph">csrgeam2()</samp>.
                              </li>
                              <li class="li"><samp class="ph codeph">csrgeam2()</samp> is the same as <samp class="ph codeph">csrgeam()</samp> except 
                                 <samp class="ph codeph">csrgeam2()</samp> needs explicit buffer where <samp class="ph codeph">csrgeam()</samp>
                                 allocates the buffer internally.
                                 
                              </li>
                           </ul>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of sparse matrix <samp class="ph codeph">A,B,C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of sparse matrix <samp class="ph codeph">A,B,C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzA</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication. If <samp class="ph codeph">beta</samp> is zero, <samp class="ph codeph">y</samp> does not have to be a valid input.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">B</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of sparse matrix <samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzB</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrB(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrB(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzB</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrB(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrB(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzC</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrC(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrC(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzC</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrC(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrC(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of
                                       								matrix<samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzTotalDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">total number of nonzero elements in device or host memory. It is equal to
                                       								<samp class="ph codeph">(csrRowPtrC(m)-csrRowPtrC(0))</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnz&lt;0</samp>, <samp class="ph codeph">IndexBase</samp> of
                                       								<samp class="ph codeph">descrA,descrB,descrC</samp> is not base-0 or base-1, or
                                       								<samp class="ph codeph">alpha</samp> or <samp class="ph codeph">beta</samp> is nil )).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrgemm"><a name="cusparse-lt-t-gt-csrgemm" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrgemm" name="cusparse-lt-t-gt-csrgemm" shape="rect">9.3.&nbsp;cusparse&lt;t&gt;csrgemm()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseXcsrgemmNnz(cusparseHandle_t handle,
                    cusparseOperation_t transA, 
                    cusparseOperation_t transB,
                    int m, 
                    int n, 
                    int k,
                    const cusparseMatDescr_t descrA, 
                    const int nnzA,                                     
                    const int *csrRowPtrA, 
                    const int *csrColIndA,
                    const cusparseMatDescr_t descrB, 
                    const int nnzB,                                     
                    const int *csrRowPtrB, 
                    const int *csrColIndB,
                    const cusparseMatDescr_t descrC, 
                    int *csrRowPtrC,
                    int *nnzTotalDevHostPtr ) 
cusparseStatus_t
cusparseScsrgemm(cusparseHandle_t handle,
                 cusparseOperation_t transA, 
                 cusparseOperation_t transB,
                 int m, 
                 int n, 
                 int k,
                 const cusparseMatDescr_t descrA, 
                 const int nnzA,
                 const float *csrValA,
                 const int *csrRowPtrA, 
                 const int *csrColIndA,
                 const cusparseMatDescr_t descrB, 
                 const int nnzB,                                     
                 const float *csrValB, 
                 const int *csrRowPtrB, 
                 const int *csrColIndB,
                 const cusparseMatDescr_t descrC,
                 float *csrValC,
                 const int *csrRowPtrC, 
                 int *csrColIndC )
cusparseStatus_t
cusparseDcsrgemm(cusparseHandle_t handle,
                 cusparseOperation_t transA, 
                 cusparseOperation_t transB,
                 int m, 
                 int n, 
                 int k,
                 const cusparseMatDescr_t descrA, 
                 const int nnzA,
                 const double *csrValA,
                 const int *csrRowPtrA, 
                 const int *csrColIndA,
                 const cusparseMatDescr_t descrB, 
                 const int nnzB,                            
                 const double *csrValB, 
                 const int *csrRowPtrB, 
                 const int *csrColIndB,
                 const cusparseMatDescr_t descrC,
                 double *csrValC,
                 const int *csrRowPtrC, 
                 int *csrColIndC )
cusparseStatus_t
cusparseCcsrgemm(cusparseHandle_t handle,
                 cusparseOperation_t transA, 
                 cusparseOperation_t transB,
                 int m, 
                 int n, 
                 int k,
                 const cusparseMatDescr_t descrA, 
                 const int nnzA,
                 const cuComplex *csrValA,
                 const int *csrRowPtrA, 
                 const int *csrColIndA,
                 const cusparseMatDescr_t descrB, 
                 const int nnzB,                            
                 const cuComplex *csrValB, 
                 const int *csrRowPtrB, 
                 const int *csrColIndB,
                 const cusparseMatDescr_t descrC,
                 cuComplex *csrValC,
                 const int *csrRowPtrC, 
                 int *csrColIndC )
cusparseStatus_t
cusparseZcsrgemm(cusparseHandle_t handle,
                 cusparseOperation_t transA, 
                 cusparseOperation_t transB,
                 int m, 
                 int n, 
                 int k,
                 const cusparseMatDescr_t descrA, 
                 const int nnzA,
                 const cuDoubleComplex *csrValA,
                 const int *csrRowPtrA, 
                 const int *csrColIndA,
                 const cusparseMatDescr_t descrB, 
                 const int nnzB,     
                 const cuDoubleComplex *csrValB,
                 const int *csrRowPtrB, 
                 const int *csrColIndB,
                 const cusparseMatDescr_t descrC,
                 cuDoubleComplex *csrValC,
                 const int *csrRowPtrC, int *csrColIndC )
</pre><p class="p">This function performs following matrix-matrix operation:</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>C</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                          <mo>∗</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>B</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">where 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mtext>op</mtext>
                                 </mrow>
                              </mrow>
                              <mo stretchy="false">(</mo>
                              <mi>A</mi>
                              <mo stretchy="false">)</mo>
                           </math>
                           			, 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mtext>op</mtext>
                                 </mrow>
                              </mrow>
                              <mo stretchy="false">(</mo>
                              <mi>B</mi>
                              <mo stretchy="false">)</mo>
                           </math>
                           			 and <samp class="ph codeph">C</samp> are <samp class="ph codeph">m×k</samp>,
                           				<samp class="ph codeph">k×n</samp>, and <samp class="ph codeph">m×n</samp> sparse matrices
                           			(defined in CSR storage format by the three arrays
                           				<samp class="ph codeph">csrValA|csrValB|csrValC</samp>,
                           				<samp class="ph codeph">csrRowPtrA|csrRowPtrB|csrRowPtrC</samp>, and
                           				<samp class="ph codeph">csrColIndA|csrColIndB|csrcolIndC</samp> respectively. The operation is
                           			defined by
                        </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                           <mrow class="MJX-TeXAtom-ORD">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mtext>op</mtext>
                              </mrow>
                           </mrow>
                           <mo stretchy="false">(</mo>
                           <mi>A</mi>
                           <mo stretchy="false">)</mo>
                           <mo>=</mo>
                           <mfenced open="{" close="">
                              <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                 <mtr>
                                    <mtd>
                                       <mi>A</mi>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                                 <mtr>
                                    <mtd>
                                       <msup>
                                          <mi>A</mi>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mi>T</mi>
                                          </mrow>
                                       </msup>
                                    </mtd>
                                    <mtd>
                                       <mtext>if trans != CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                    </mtd>
                                 </mtr>
                              </mtable>
                           </mfenced>
                        </math>
                        <p class="p">There are four versions, NN, NT, TN, and TT. NN stands for 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>C</mi>
                              <mo>=</mo>
                              <mi>A</mi>
                              <mo>*</mo>
                              <mi>B</mi>
                           </math>
                           			, NT stands for 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>C</mi>
                              <mo>=</mo>
                              <mi>A</mi>
                              <mo>*</mo>
                              <msup>
                                 <mi>B</mi>
                                 <mi>T</mi>
                              </msup>
                           </math>
                           			, TN stands for 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>C</mi>
                              <mo>=</mo>
                              <msup>
                                 <mi>A</mi>
                                 <mi>T</mi>
                              </msup>
                              <mo>*</mo>
                              <mi>B</mi>
                           </math>
                           			 and TT stands for 
                           				
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>C</mi>
                              <mo>=</mo>
                              <msup>
                                 <mi>A</mi>
                                 <mi>T</mi>
                              </msup>
                              <mo>*</mo>
                              <msup>
                                 <mi>B</mi>
                                 <mi>T</mi>
                              </msup>
                           </math>
                           			.
                        </p>
                        <p class="p">The cuSPARSE library adopts a two-step approach to complete sparse matrix. In the first step, the
                           			user allocates <samp class="ph codeph">csrRowPtrC</samp> of <samp class="ph codeph">m+1</samp> elements and uses the
                           			function <samp class="ph codeph">cusparseXcsrgemmNnz()</samp> to determine <samp class="ph codeph">csrRowPtrC</samp>
                           			and the total number of nonzero elements. In the second step, the user gathers
                           				<samp class="ph codeph">nnzC</samp> (the number of nonzero elements of matrix <samp class="ph codeph">C</samp>)
                           			from either <samp class="ph codeph">(nnzC=*nnzTotalDevHostPtr)</samp> or
                           				<samp class="ph codeph">(nnzC=csrRowPtrC(m)-csrRowPtrC(0))</samp> and allocates
                           				<samp class="ph codeph">csrValC</samp> and <samp class="ph codeph">csrColIndC</samp> of <samp class="ph codeph">nnzC</samp>
                           			elements respectively, then finally calls function
                           				<samp class="ph codeph">cusparse[S|D|C|Z]csrgemm()</samp> to complete matrix
                           			<samp class="ph codeph">C</samp>.
                        </p>
                        <p class="p">The general procedure is as follows:</p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> baseC, nnzC;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// nnzTotalDevHostPtr points to host memory</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *nnzTotalDevHostPtr = &amp;nnzC;
cusparseSetPointerMode(handle, CUSPARSE_POINTER_MODE_HOST);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1));
cusparseXcsrgemmNnz(handle, transA, transB, m, n, k, 
        descrA, nnzA, csrRowPtrA, csrColIndA,
        descrB, nnzB, csrRowPtrB, csrColIndB,
        descrC, csrRowPtrC, nnzTotalDevHostPtr );
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (NULL != nnzTotalDevHostPtr){
    nnzC = *nnzTotalDevHostPtr;
}<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
    cudaMemcpy(&amp;nnzC, csrRowPtrC+m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    cudaMemcpy(&amp;baseC, csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    nnzC -= baseC;
}
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzC);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrValC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzC);
cusparseScsrgemm(handle, transA, transB, m, n, k,
        descrA, nnzA,
        csrValA, csrRowPtrA, csrColIndA,
        descrB, nnzB,
        csrValB, csrRowPtrB, csrColIndB,
        descrC,
        csrValC, csrRowPtrC, csrColIndC);</pre><div class="p">Several comments on <samp class="ph codeph">csrgemm()</samp>:<a name="cusparse-lt-t-gt-csrgemm__ul_yph_5sy_nm" shape="rect">
                              <!-- --></a><ul class="ul" id="cusparse-lt-t-gt-csrgemm__ul_yph_5sy_nm">
                              <li class="li">Although NN, NT, TN and TT are supported, only the NN version is implemented. 
                                 For the NT, TN and TT versions, <samp class="ph codeph">csr2csc()</samp> is used to 
                                 transpose the relevant matrices, followed by a call to the NN version of <samp class="ph codeph">csrgemm()</samp>.
                                 		                
                              </li>
                              <li class="li">The NN version needs working space of size <samp class="ph codeph">nnzA</samp> integers at
                                 					least.
                              </li>
                              <li class="li">Only <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> is supported. If either
                                 						<samp class="ph codeph">A</samp> or <samp class="ph codeph">B</samp> is symmetric or Hermitian, the user
                                 					must extend the matrix to a full one and reconfigure the
                                 						<samp class="ph codeph">MatrixType</samp> field descriptor to
                                 						<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              </li>
                              <li class="li">Only devices of compute capability 2.0 or above are supported.</li>
                           </ul>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>B</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of sparse matrix
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       		
                                       	and <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of sparse matrix
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>B</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       		
                                       	and <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">k</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns/rows of sparse matrix 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>A</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 / 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>op</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo stretchy="false">(</mo>
                                          <mi>B</mi>
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzA</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mover>
                                                <mi>m</mi>
                                                <mo stretchy="false">˜</mo>
                                             </mover>
                                          </mrow>
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       							 elements that contains the start of every row and the end
                                       							of the last row plus one. 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mover>
                                                <mi>m</mi>
                                                <mo stretchy="false">˜</mo>
                                             </mover>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>m</mi>
                                       </math>
                                       							 if <samp class="ph codeph">transA</samp> ==
                                       								<samp class="ph codeph">CUSPARSE_OPERATION_NON_TRANSPOSE</samp>, otherwise 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mover>
                                                <mi>m</mi>
                                                <mo stretchy="false">˜</mo>
                                             </mover>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>k</mi>
                                       </math>
                                       							.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">B</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of sparse matrix <samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzB</samp> nonzero elements of matrix
                                       							<samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		
                                       		
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mover>
                                                <mi>k</mi>
                                                <mo stretchy="false">˜</mo>
                                             </mover>
                                          </mrow>
                                          <mo>+</mo>
                                          <mn>1</mn>
                                       </math>
                                       		
                                       	elements that contains the start of every row and the end of the last row plus one.
                                       		
                                       			
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mover>
                                                <mi>k</mi>
                                                <mo stretchy="false">˜</mo>
                                             </mover>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>k</mi>
                                       </math>
                                       		
                                       	if <samp class="ph codeph">transB == CUSPARSE_OPERATION_NON_TRANSPOSE</samp>, otherwise
                                       		
                                       			
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mover>
                                                <mi>k</mi>
                                                <mo stretchy="false">˜</mo>
                                             </mover>
                                          </mrow>
                                          <mo>=</mo>
                                          <mi>n</mi>
                                       </math>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzB</samp> column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzC</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrC(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrC(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzC</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrC(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrC(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzTotalDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">total number of nonzero elements in device or host memory. It is equal to <samp class="ph codeph">(csrRowPtrC(m)-csrRowPtrC(0))</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,k&lt;0</samp>; <samp class="ph codeph">IndexBase</samp> of
                                       								<samp class="ph codeph">descrA,descrB,descrC</samp> is not base-0 or base-1; or
                                       								<samp class="ph codeph">alpha</samp> or <samp class="ph codeph">beta</samp> is nil )).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrgemm2"><a name="cusparse-lt-t-gt-csrgemm2" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrgemm2" name="cusparse-lt-t-gt-csrgemm2" shape="rect">9.4.&nbsp;cusparse&lt;t&gt;csrgemm2()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsrgemm2_bufferSizeExt(cusparseHandle_t handle,
                                int m,
                                int n,
                                int k,
                                const float *alpha,
                                const cusparseMatDescr_t descrA,
                                int nnzA,
                                const int *csrRowPtrA,
                                const int *csrColIndA,
                                const cusparseMatDescr_t descrB,
                                int nnzB,
                                const int *csrRowPtrB,
                                const int *csrColIndB,
                                const float *beta,
                                const cusparseMatDescr_t descrD,
                                int nnzD,
                                const int *csrRowPtrD,
                                const int *csrColIndD,
                                csrgemm2Info_t info,
                                size_t *pBufferSizeInBytes );

cusparseStatus_t 
cusparseDcsrgemm2_bufferSizeExt(cusparseHandle_t handle,
                                int m,
                                int n,
                                int k,
                                const double *alpha,
                                const cusparseMatDescr_t descrA,
                                int nnzA,
                                const int *csrRowPtrA,
                                const int *csrColIndA,
                                const cusparseMatDescr_t descrB,
                                int nnzB,
                                const int *csrRowPtrB,
                                const int *csrColIndB,
                                const double *beta,
                                const cusparseMatDescr_t descrD,
                                int nnzD,
                                const int *csrRowPtrD,
                                const int *csrColIndD,
                                csrgemm2Info_t info,
                                size_t *pBufferSizeInBytes );

cusparseStatus_t 
cusparseCcsrgemm2_bufferSizeExt(cusparseHandle_t handle,
                                int m,
                                int n,
                                int k,
                                const cuComplex *alpha,
                                const cusparseMatDescr_t descrA,
                                int nnzA,
                                const int *csrRowPtrA,
                                const int *csrColIndA,
                                const cusparseMatDescr_t descrB,
                                int nnzB,
                                const int *csrRowPtrB,
                                const int *csrColIndB,
                                const cuComplex *beta,
                                const cusparseMatDescr_t descrD,
                                int nnzD,
                                const int *csrRowPtrD,
                                const int *csrColIndD,
                                csrgemm2Info_t info,
                                size_t *pBufferSizeInBytes );

cusparseStatus_t 
cusparseZcsrgemm2_bufferSizeExt(cusparseHandle_t handle,
                                int m,
                                int n,
                                int k,
                                const cuDoubleComplex *alpha,
                                const cusparseMatDescr_t descrA,
                                int nnzA,
                                const int *csrRowPtrA,
                                const int *csrColIndA,
                                const cusparseMatDescr_t descrB,
                                int nnzB,
                                const int *csrRowPtrB,
                                const int *csrColIndB,
                                const cuDoubleComplex *beta,
                                const cusparseMatDescr_t descrD,
                                int nnzD,
                                const int *csrRowPtrD,
                                const int *csrColIndD,
                                csrgemm2Info_t info,
                                size_t *pBufferSizeInBytes );

cusparseStatus_t 
cusparseXcsrgemm2Nnz(cusparseHandle_t handle,
                     int m,
                     int n,
                     int k,
                     const cusparseMatDescr_t descrA,
                     int nnzA,
                     const int *csrRowPtrA,
                     const int *csrColIndA,
                     const cusparseMatDescr_t descrB,
                     int nnzB,
                     const int *csrRowPtrB,
                     const int *csrColIndB,
                     const cusparseMatDescr_t descrD,
                     int nnzD,
                     const int *csrRowPtrD,
                     const int *csrColIndD,
                     const cusparseMatDescr_t descrC,
                     int *csrRowPtrC,
                     int *nnzTotalDevHostPtr,
                     const csrgemm2Info_t info,
                     void *pBuffer );

cusparseStatus_t 
cusparseScsrgemm2(cusparseHandle_t handle,
                  int m,
                  int n,
                  int k,
                  const float *alpha,
                  const cusparseMatDescr_t descrA,
                  int nnzA,
                  const float *csrValA,
                  const int *csrRowPtrA,
                  const int *csrColIndA,
                  const cusparseMatDescr_t descrB,
                  int nnzB,
                  const float *csrValB,
                  const int *csrRowPtrB,
                  const int *csrColIndB,
                  const float *beta,
                  const cusparseMatDescr_t descrD,
                  int nnzD,
                  const float *csrValD,
                  const int *csrRowPtrD,
                  const int *csrColIndD,
                  const cusparseMatDescr_t descrC,
                  float *csrValC,
                  const int *csrRowPtrC,
                  int *csrColIndC,
                  const csrgemm2Info_t info,
                  void *pBuffer );

cusparseStatus_t 
cusparseDcsrgemm2(cusparseHandle_t handle,
                  int m,
                  int n,
                  int k,
                  const double *alpha,
                  const cusparseMatDescr_t descrA,
                  int nnzA,
                  const double *csrValA,
                  const int *csrRowPtrA,
                  const int *csrColIndA,
                  const cusparseMatDescr_t descrB,
                  int nnzB,
                  const double *csrValB,
                  const int *csrRowPtrB,
                  const int *csrColIndB,
                  const double *beta,
                  const cusparseMatDescr_t descrD,
                  int nnzD,
                  const double *csrValD,
                  const int *csrRowPtrD,
                  const int *csrColIndD,
                  const cusparseMatDescr_t descrC,
                  double *csrValC,
                  const int *csrRowPtrC,
                  int *csrColIndC,
                  const csrgemm2Info_t info,
                  void *pBuffer );

cusparseStatus_t 
cusparseCcsrgemm2(cusparseHandle_t handle,
                  int m,
                  int n,
                  int k,
                  const cuComplex *alpha,
                  const cusparseMatDescr_t descrA,
                  int nnzA,
                  const cuComplex *csrValA,
                  const int *csrRowPtrA,
                  const int *csrColIndA,
                  const cusparseMatDescr_t descrB,
                  int nnzB,
                  const cuComplex *csrValB,
                  const int *csrRowPtrB,
                  const int *csrColIndB,
                  const cuComplex *beta,
                  const cusparseMatDescr_t descrD,
                  int nnzD,
                  const cuComplex *csrValD,
                  const int *csrRowPtrD,
                  const int *csrColIndD,
                  const cusparseMatDescr_t descrC,
                  cuComplex *csrValC,
                  const int *csrRowPtrC,
                  int *csrColIndC,
                  const csrgemm2Info_t info,
                  void *pBuffer );

cusparseStatus_t 
cusparseZcsrgemm2(cusparseHandle_t handle,
                  int m,
                  int n,
                  int k,
                  const cuDoubleComplex *alpha,
                  const cusparseMatDescr_t descrA,
                  int nnzA,
                  const cuDoubleComplex *csrValA,
                  const int *csrRowPtrA,
                  const int *csrColIndA,
                  const cusparseMatDescr_t descrB,
                  int nnzB,
                  const cuDoubleComplex *csrValB,
                  const int *csrRowPtrB,
                  const int *csrColIndB,
                  const cuDoubleComplex *beta,
                  const cusparseMatDescr_t descrD,
                  int nnzD,
                  const cuDoubleComplex *csrValD,
                  const int *csrRowPtrD,
                  const int *csrColIndD,
                  const cusparseMatDescr_t descrC,
                  cuDoubleComplex *csrValC,
                  const int *csrRowPtrC,
                  int *csrColIndC,
                  const csrgemm2Info_t info,
                  void *pBuffer );


</pre><p class="p">This function performs following matrix-matrix operation:</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>C</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>=</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>alpha</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>∗</mo>
                                          <mi>A</mi>
                                          <mo>∗</mo>
                                          <mi>B</mi>
                                          <mo>+</mo>
                                          <mrow class="MJX-TeXAtom-ORD">
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mtext>beta</mtext>
                                             </mrow>
                                          </mrow>
                                          <mo>∗</mo>
                                          <mi>D</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where <samp class="ph codeph">A</samp>, <samp class="ph codeph">B</samp>, <samp class="ph codeph">D</samp> and <samp class="ph codeph">C</samp> 
                           are <samp class="ph codeph">m×k</samp>, <samp class="ph codeph">k×n</samp>, <samp class="ph codeph">m×n</samp> and 
                           <samp class="ph codeph">m×n</samp> sparse matrices
                           (defined in CSR storage format by the three arrays
                           <samp class="ph codeph">csrValA|csrValB|csrValD|csrValC</samp>,
                           <samp class="ph codeph">csrRowPtrA|csrRowPtrB|csrRowPtrD|csrRowPtrC</samp>, and
                           <samp class="ph codeph">csrColIndA|csrColIndB|csrColIndD|csrcolIndC</samp> respectively. 
                           
                        </p>
                        <p class="p">
                           We provide <samp class="ph codeph">csrgemm2</samp> as a generalization of <samp class="ph codeph">csrgemm</samp>.
                           It provides more operations in terms of <samp class="ph codeph">alpha</samp> and <samp class="ph codeph">beta</samp>.
                           For example, <samp class="ph codeph">C = -A*B+D</samp> can be done by <samp class="ph codeph">csrgemm2</samp>.
                           
                        </p>
                        <p class="p">
                           The <samp class="ph codeph">csrgemm2</samp> uses <samp class="ph codeph">alpha</samp> and <samp class="ph codeph">beta</samp> 
                           to support the following operations:
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">beta </samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">operation</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">NULL</samp></td>
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">NULL</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">NULL</samp></td>
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">!NULL</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">C = beta*D</samp>, <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> are not used
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">!NULL</samp></td>
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">NULL</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">C = alpha*A*B</samp>, <samp class="ph codeph">D</samp> is not used
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">!NULL</samp></td>
                                    <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">!NULL</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">C = alpha*A*B + beta*D</samp></td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The numerical value of <samp class="ph codeph">alpha</samp> and <samp class="ph codeph">beta</samp> only affects the numerical 
                           values of <samp class="ph codeph">C</samp>, not its sparsity pattern.
                           For example, if <samp class="ph codeph">alpha</samp> and <samp class="ph codeph">beta</samp> are not zero, 
                           the sparsity pattern of <samp class="ph codeph">C</samp> is union of <samp class="ph codeph">A*B</samp> and <samp class="ph codeph">D</samp>,
                           independent of numerical value of <samp class="ph codeph">alpha</samp> and <samp class="ph codeph">beta</samp>. 
                           
                        </p>
                        <p class="p">
                           The following table shows different operations 
                           according to the value of <samp class="ph codeph">m</samp>, <samp class="ph codeph">n</samp> and <samp class="ph codeph">k</samp></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="37.5%" rowspan="1" colspan="1"><samp class="ph codeph">m,n,k</samp></td>
                                    <td class="entry" valign="top" width="62.5%" rowspan="1" colspan="1"><samp class="ph codeph">operation</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="37.5%" rowspan="1" colspan="1">m&lt;0 or n &lt;0 or k&lt;0</td>
                                    <td class="entry" valign="top" width="62.5%" rowspan="1" colspan="1">invalid</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="37.5%" rowspan="1" colspan="1">m is 0 or n is 0</td>
                                    <td class="entry" valign="top" width="62.5%" rowspan="1" colspan="1"><samp class="ph codeph">do nothing</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="37.5%" rowspan="1" colspan="1">m &gt;0 and n &gt;0 and k is 0</td>
                                    <td class="entry" valign="top" width="62.5%" rowspan="1" colspan="1">
                                       <p class="p">invalid if <samp class="ph codeph">beta</samp> is zero; 
                                       </p>
                                       <p class="p"><samp class="ph codeph">C = beta*D</samp> if <samp class="ph codeph">beta</samp> is not zero. 
                                       </p>
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="37.5%" rowspan="1" colspan="1">m &gt;0 and n &gt;0 and k &gt;0</td>
                                    <td class="entry" valign="top" width="62.5%" rowspan="1" colspan="1">
                                       <p class="p"><samp class="ph codeph">C = beta*D</samp> if <samp class="ph codeph">alpha</samp> is zero. 
                                       </p>
                                       <p class="p"><samp class="ph codeph">C = alpha*A*B</samp> if <samp class="ph codeph">beta</samp> is zero. 
                                       </p>
                                       <p class="p"><samp class="ph codeph">C = alpha*A*B + beta*D</samp> if <samp class="ph codeph">alpha</samp> and <samp class="ph codeph">beta</samp> are not zero. 
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           This function requires the buffer size returned by <samp class="ph codeph">csrgemm2_bufferSizeExt()</samp>. 
                           The address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. 
                           If it is not, <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           
                        </p>
                        <p class="p">
                           The cuSPARSE library adopts a two-step approach to complete sparse matrix. 
                           In the first step, the user allocates <samp class="ph codeph">csrRowPtrC</samp> of <samp class="ph codeph">m+1</samp> elements 
                           and uses the function <samp class="ph codeph">cusparseXcsrgemm2Nnz()</samp> to determine <samp class="ph codeph">csrRowPtrC</samp>
                           and the total number of nonzero elements. 
                           In the second step, the user gathers <samp class="ph codeph">nnzC</samp> (the number of nonzero elements of matrix <samp class="ph codeph">C</samp>)
                           from either <samp class="ph codeph">(nnzC=*nnzTotalDevHostPtr)</samp> or
                           <samp class="ph codeph">(nnzC=csrRowPtrC(m)-csrRowPtrC(0))</samp> and 
                           allocates <samp class="ph codeph">csrValC</samp> and <samp class="ph codeph">csrColIndC</samp> of <samp class="ph codeph">nnzC</samp>
                           elements respectively, then finally calls function <samp class="ph codeph">cusparse[S|D|C|Z]csrgemm2()</samp> 
                           to evaluate matrix <samp class="ph codeph">C</samp>.
                           
                        </p>
                        <p class="p">The general procedure of <samp class="ph codeph">C=-A*B+D</samp> is as follows:
                        </p><pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// assume matrices A, B and D are ready.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> baseC, nnzC;
csrgemm2Info_t info = NULL;
size_t bufferSize;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *buffer = NULL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// nnzTotalDevHostPtr points to host memory</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *nnzTotalDevHostPtr = &amp;nnzC;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> alpha = -1.0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> beta  =  1.0;
cusparseSetPointerMode(handle, CUSPARSE_POINTER_MODE_HOST);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create an opaque structure</span>
cusparseCreateCsrgemm2Info(&amp;info);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: allocate buffer for csrgemm2Nnz and csrgemm2</span>
cusparseDcsrgemm2_bufferSizeExt(handle, m, n, k, &amp;alpha,
    descrA, nnzA, csrRowPtrA, csrColIndA,
    descrB, nnzB, csrRowPtrB, csrColIndB,
    &amp;beta,
    descrD, nnzD, csrRowPtrD, csrColIndD,
    info,
    &amp;bufferSize);
cudaMalloc(&amp;buffer, bufferSize);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: compute csrRowPtrC</span>
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1));
cusparseXcsrgemm2Nnz(handle, m, n, k, 
        descrA, nnzA, csrRowPtrA, csrColIndA,
        descrB, nnzB, csrRowPtrB, csrColIndB,
        descrD, nnzD, csrRowPtrD, csrColIndD,
        descrC, csrRowPtrC, nnzTotalDevHostPtr,
        info, buffer );
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (NULL != nnzTotalDevHostPtr){
    nnzC = *nnzTotalDevHostPtr;
}<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
    cudaMemcpy(&amp;nnzC, csrRowPtrC+m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    cudaMemcpy(&amp;baseC, csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    nnzC -= baseC;
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: finish sparsity pattern and value of C</span>
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzC);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrValC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*nnzC);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Remark: set csrValC to null if only sparsity pattern is required.</span>
cusparseDcsrgemm2(handle, m, n, k, &amp;alpha,
        descrA, nnzA, csrValA, csrRowPtrA, csrColIndA,
        descrB, nnzB, csrValB, csrRowPtrB, csrColIndB,
        &amp;beta,
        descrD, nnzD, csrValD, csrRowPtrD, csrColIndD,
        descrC, csrValC, csrRowPtrC, csrColIndC,
        info, buffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: destroy the opaque structure</span>
cusparseDestroyCsrgemm2Info(info);

</pre><div class="p">
                           Several comments on <samp class="ph codeph">csrgemm2()</samp>:
                           <a name="cusparse-lt-t-gt-csrgemm2__ul_yph_5sy_nm" shape="rect">
                              <!-- --></a><ul class="ul" id="cusparse-lt-t-gt-csrgemm2__ul_yph_5sy_nm">
                              <li class="li">Only the NN version is supported. For other modes, the user has to transpose
                                 <samp class="ph codeph">A</samp> or  <samp class="ph codeph">B</samp> explicitly.
                                 
                              </li>
                              <li class="li">Only <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> is supported. 
                                 If either <samp class="ph codeph">A</samp> or <samp class="ph codeph">B</samp> is symmetric or Hermitian, the user
                                 must extend the matrix to a full one and reconfigure the <samp class="ph codeph">MatrixType</samp> field descriptor to
                                 <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                                 
                              </li>
                              <li class="li">if <samp class="ph codeph">csrValC</samp> is zero, only sparisty pattern of <samp class="ph codeph">C</samp> is calculated.
                                 
                              </li>
                              <li class="li">Only devices of compute capability 2.0 or above are supported.
                                 
                              </li>
                           </ul>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of sparse matrix <samp class="ph codeph">A</samp>, <samp class="ph codeph">D</samp>
                                       	       and <samp class="ph codeph">C</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of sparse matrix <samp class="ph codeph">B</samp>, <samp class="ph codeph">D</samp>
                                       	       and <samp class="ph codeph">C</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">k</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns/rows of sparse matrix <samp class="ph codeph">A</samp> / <samp class="ph codeph">B</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. 
                                       The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzA</samp> nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end
                                       of the last row plus one. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp> column indices of the nonzero elements of matrix
                                       <samp class="ph codeph">A</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">B</samp>. 
                                       The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of sparse matrix <samp class="ph codeph">B</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzB</samp> nonzero elements of matrix
                                       	       <samp class="ph codeph">B</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">k+1</samp> elements that contains the start of every row and 
                                       the end of the last row plus one.
                                       	
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndB</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzB</samp> column indices of the nonzero elements of matrix
                                       <samp class="ph codeph">B</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrD</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">D</samp>.
                                       The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzD</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of sparse matrix <samp class="ph codeph">D</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValD</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzD</samp> nonzero elements of matrix
                                       <samp class="ph codeph">D</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrD</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and
                                       the end of the last row plus one.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndD</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzD</samp> column indices of the nonzero elements of matrix
                                       <samp class="ph codeph">D</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; scalar used for multiplication.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>. 
                                       The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> only.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information used in <samp class="ph codeph">csrgemm2Nnz</samp> and <samp class="ph codeph">csrgemm2</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by <samp class="ph codeph">csrgemm2_bufferSizeExt</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzC</samp> nonzero elements of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and 
                                       the end of the last row plus one.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzC</samp> column indices of the nonzero elements of matrix
                                       <samp class="ph codeph">C</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in <samp class="ph codeph">csrgemm2Nnnz</samp> and
                                       <samp class="ph codeph">csrgemm2</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzTotalDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">total number of nonzero elements in device or host memory. 
                                       It is equal to <samp class="ph codeph">(csrRowPtrC(m)-csrRowPtrC(0))</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,k&lt;0</samp>; 
                                       <samp class="ph codeph">IndexBase</samp> of <samp class="ph codeph">descrA,descrB,descrD,descrC</samp> is not base-0 or base-1 
                                       ).
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusparse-preconditioners-reference"><a name="cusparse-preconditioners-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusparse-preconditioners-reference" name="cusparse-preconditioners-reference" shape="rect">10.&nbsp;cuSPARSE Preconditioners Reference</a></h2>
                  <div class="body conbody">
                     <p class="p">This chapter describes the routines that implement different preconditioners.</p>
                     <p class="p">In particular, the incomplete factorizations are implemented in two phases. First, during the
                        analysis phase, the sparse triangular matrix is analyzed to determine the dependencies between
                        its elements by calling the appropriate <samp class="ph codeph">csrsv_analysis()</samp> function. The
                        analysis is specific to the sparsity pattern of the given matrix and the selected
                        <samp class="ph codeph">cusparseOperation_t</samp> type. The information from the analysis phase is stored
                        in the parameter of type <samp class="ph codeph">cusparseSolveAnalysisInfo_t</samp> that has been
                        initialized previously with a call to <samp class="ph codeph">cusparseCreateSolveAnalysisInfo()</samp>.
                     </p>
                     <p class="p">Second, during the numerical factorization phase, the given coefficient matrix is factorized
                        using the information stored in the <samp class="ph codeph">cusparseSolveAnalysisInfo_t</samp> parameter by
                        calling the appropriate <samp class="ph codeph">csrilu0()</samp> or <samp class="ph codeph">csric0()</samp> function.
                     </p>
                     <p class="p">The analysis phase is shared across the sparse triangular solve, and the incomplete factorization
                        and must be performed only once. The resulting information can be passed to the numerical
                        factorization and the sparse triangular solve multiple times.
                     </p>
                     <p class="p">Finally, once the incomplete factorization and all the sparse triangular solves have completed, the opaque data structure
                        pointed to by the <samp class="ph codeph">cusparseSolveAnalysisInfo_t</samp> parameter can be released by calling <samp class="ph codeph">cusparseDestroySolveAnalysisInfo()</samp>.
                     </p>
                  </div>
                  <div class="topic concept nested1" id="ic0"><a name="ic0" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#ic0" name="ic0" shape="rect">10.1.&nbsp;Incomplete Cholesky Factorization: level 0</a></h3>
                     <div class="body conbody">
                        <p class="p">Different algorithms for ic0 are discussed in this section.</p>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-csric0"><a name="cusparse-lt-t-gt-csric0" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csric0" name="cusparse-lt-t-gt-csric0" shape="rect">10.1.1.&nbsp;cusparse&lt;t&gt;csric0()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsric0(cusparseHandle_t handle, 
                cusparseOperation_t trans, 
                int m, 
                const cusparseMatDescr_t descrA, 
                float *csrValM,
                const int *csrRowPtrA, 
                const int *csrColIndA, 
                cusparseSolveAnalysisInfo_t info)
cusparseStatus_t 
cusparseDcsric0(cusparseHandle_t handle, 
                cusparseOperation_t trans, 
                int m, 
                const cusparseMatDescr_t descrA, 
                double *csrValM,
                const int *csrRowPtrA, 
                const int *csrColIndA,  
                cusparseSolveAnalysisInfo_t info)
cusparseStatus_t 
cusparseCcsric0(cusparseHandle_t handle, 
                cusparseOperation_t trans, 
                int m, 
                const cusparseMatDescr_t descrA, 
                cuComplex *csrValM,
                const int *csrRowPtrA, 
                const int *csrColIndA,  
                cusparseSolveAnalysisInfo_t info)
cusparseStatus_t 
cusparseZcsric0(cusparseHandle_t handle, 
                cusparseOperation_t trans, 
                int m, 
                const cusparseMatDescr_t descrA, 
                cuDoubleComplex *csrValM,
                const int *csrRowPtrA, 
                const int *csrColIndA,  
                cusparseSolveAnalysisInfo_t info)
</pre><p class="p">This function computes the incomplete-Cholesky factorization with 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>0</mn>
                              </math>
                              fill-in and no pivoting:
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>o</mi>
                                             <mi>p</mi>
                                             <mo stretchy="false">(</mo>
                                             <mi>A</mi>
                                             <mo stretchy="false">)</mo>
                                             <mo>≈</mo>
                                             <msup>
                                                <mi>R</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>T</mi>
                                                </mrow>
                                             </msup>
                                             <mi>R</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mo>×</mo>
                              </math><samp class="ph codeph">m</samp> Hermitian/symmetric positive definite sparse matrix that is defined in CSR
                              storage format by the three arrays <samp class="ph codeph">csrValM</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                              <samp class="ph codeph">csrColIndA</samp>; and
                           </p>
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mtext>op</mtext>
                                 </mrow>
                              </mrow>
                              <mo stretchy="false">(</mo>
                              <mi>A</mi>
                              <mo stretchy="false">)</mo>
                              <mo>=</mo>
                              <mfenced open="{" close="">
                                 <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                    <mtr>
                                       <mtd>
                                          <mi>A</mi>
                                       </mtd>
                                       <mtd>
                                          <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                       </mtd>
                                    </mtr>
                                    <mtr>
                                       <mtd>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>T</mi>
                                          </msup>
                                       </mtd>
                                       <mtd>
                                          <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                       </mtd>
                                    </mtr>
                                    <mtr>
                                       <mtd>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>H</mi>
                                          </msup>
                                       </mtd>
                                       <mtd>
                                          <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                       </mtd>
                                    </mtr>
                                 </mtable>
                              </mfenced>
                           </math>
                           <p class="p">Notice that only a lower or upper Hermitian/symmetric part of the matrix <samp class="ph codeph">A</samp> is
                              actually stored. It is overwritten by the lower or upper triangular factors 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msup>
                                    <mi>R</mi>
                                    <mi>T</mi>
                                 </msup>
                              </math>
                              and 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>R</mi>
                              </math>
                              , respectively.
                           </p>
                           <p class="p">A call to this routine must be preceded by a call to the <samp class="ph codeph">csrsv_analysis()</samp>
                              routine.
                           </p>
                           <p class="p">
                              The matrix descriptor for <samp class="ph codeph">csrsv_analysis()</samp> and <samp class="ph codeph">csric0()</samp> must be the same.
                              Otherwise, runtime error would occur. 
                              
                           </p>
                           <p class="p">This function requires some extra storage. It is executed asynchronously with respect to the host
                              and may return control to the application on the host before the result is ready.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">trans</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation <samp class="ph codeph">op</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mi>A</mi>
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          .
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix types are
                                          <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_SYMMETRIC</samp> and
                                          <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_HERMITIAN</samp>. Also, the supported index bases are
                                          <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                          <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValM</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          column indices of the nonzero elements of matrix
                                          <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase (that should have been passed to the solve phase unchanged).</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValM</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; matrix containing the incomplete-Cholesky lower or upper triangular factor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;0</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-csric02_bufferSize"><a name="cusparse-lt-t-gt-csric02_bufferSize" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csric02_bufferSize" name="cusparse-lt-t-gt-csric02_bufferSize" shape="rect">10.1.2.&nbsp;cusparse&lt;t&gt;csric02_bufferSize()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsric02_bufferSize(cusparseHandle_t handle,
                            int m,
                            int nnz,
                            const cusparseMatDescr_t descrA,
                            float *csrValA,
                            const int *csrRowPtrA,
                            const int *csrColIndA,
                            csric02Info_t info,
                            int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseDcsric02_bufferSize(cusparseHandle_t handle,
                            int m,
                            int nnz,
                            const cusparseMatDescr_t descrA,
                            double *csrValA,
                            const int *csrRowPtrA,
                            const int *csrColIndA,
                            csric02Info_t info,
                            int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseCcsric02_bufferSize(cusparseHandle_t handle,
                            int m,
                            int nnz,
                            const cusparseMatDescr_t descrA,
                            cuComplex *csrValA,
                            const int *csrRowPtrA,
                            const int *csrColIndA,
                            csric02Info_t info,
                            int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseZcsric02_bufferSize(cusparseHandle_t handle,
                            int m,
                            int nnz,
                            const cusparseMatDescr_t descrA,
                            cuDoubleComplex *csrValA,
                            const int *csrRowPtrA,
                            const int *csrColIndA,
                            csric02Info_t info,
                            int *pBufferSizeInBytes);

</pre><p class="p">This function returns size of buffer used in computing the incomplete-Cholesky factorization with 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>0</mn>
                              </math>
                              fill-in and no pivoting:
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <msup>
                                                <mi>L</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                              <samp class="ph codeph">csrColIndA</samp>. 
                           </p>
                           <p class="p"> The buffer size depends on dimension <samp class="ph codeph">m</samp> and <samp class="ph codeph">nnz</samp>, the number of
                              nonzeros of the matrix. If the user changes the matrix, it is necessary to call
                              <samp class="ph codeph">csric02_bufferSize()</samp> again to have the correct buffer size; otherwise, a
                              segmentation fault may occur. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">record internal states based on different algorithms.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in <samp class="ph codeph">csric02_analysis()</samp> and
                                          <samp class="ph codeph">csric02()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-csric02_analysis"><a name="cusparse-lt-t-gt-csric02_analysis" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csric02_analysis" name="cusparse-lt-t-gt-csric02_analysis" shape="rect">10.1.3.&nbsp;cusparse&lt;t&gt;csric02_analysis()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsric02_analysis(cusparseHandle_t handle,
                          int m,
                          int nnz,
                          const cusparseMatDescr_t descrA,
                          const float *csrValA,
                          const int *csrRowPtrA,
                          const int *csrColIndA,
                          csric02Info_t info,
                          cusparseSolvePolicy_t policy,
                          void *pBuffer);

cusparseStatus_t 
cusparseDcsric02_analysis(cusparseHandle_t handle,
                          int m,
                          int nnz,
                          const cusparseMatDescr_t descrA,
                          const double *csrValA,
                          const int *csrRowPtrA,
                          const int *csrColIndA,
                          csric02Info_t info,
                          cusparseSolvePolicy_t policy,
                          void *pBuffer);

cusparseStatus_t 
cusparseCcsric02_analysis(cusparseHandle_t handle,
                          int m,
                          int nnz,
                          const cusparseMatDescr_t descrA,
                          const cuComplex *csrValA,
                          const int *csrRowPtrA,
                          const int *csrColIndA,
                          csric02Info_t info,
                          cusparseSolvePolicy_t policy,
                          void *pBuffer);

cusparseStatus_t 
cusparseZcsric02_analysis(cusparseHandle_t handle,
                          int m,
                          int nnz,
                          const cusparseMatDescr_t descrA,
                          const cuDoubleComplex *csrValA,
                          const int *csrRowPtrA,
                          const int *csrColIndA,
                          csric02Info_t info,
                          cusparseSolvePolicy_t policy,
                          void *pBuffer);

</pre><p class="p">This function performs the analysis phase of the incomplete-Cholesky factorization with 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>0</mn>
                              </math>
                              fill-in and no pivoting:
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <msup>
                                                <mi>L</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                              <samp class="ph codeph">csrColIndA</samp>. 
                           </p>
                           <p class="p">This function requires a buffer size returned by <samp class="ph codeph">csric02_bufferSize()</samp>. The
                              address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If not,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">csric02_analysis()</samp> reports a structural zero and computes level
                              information stored in the opaque structure <samp class="ph codeph">info</samp>. The level information can
                              extract more parallelism during incomplete Cholesky factorization. However
                              <samp class="ph codeph">csric02()</samp> can be done without level information. To disable level
                              information, the user must specify the policy of <samp class="ph codeph">csric02_analysis()</samp> and
                              <samp class="ph codeph">csric02()</samp> as <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">csric02_analysis()</samp> always reports the first structural zero, even if
                              the policy is <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. The user needs to call
                              <samp class="ph codeph">cusparseXcsric02_zeroPivot()</samp> to know where the structural zero is. 
                           </p>
                           <p class="p">It is the user's choice whether to call <samp class="ph codeph">csric02()</samp> if
                              <samp class="ph codeph">csric02_analysis()</samp> reports a structural zero. In this case, the user can
                              still call <samp class="ph codeph">csric02()</samp>, which will return a numerical zero at the same position
                              as the structural zero. However the result is meaningless. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateCsric02Info()</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                          <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                          <samp class="ph codeph">csric02_bufferSize()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in <samp class="ph codeph">csric02_analysis()</samp> and
                                          <samp class="ph codeph">csric02()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-csric02"><a name="cusparse-lt-t-gt-csric02" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csric02" name="cusparse-lt-t-gt-csric02" shape="rect">cusparse&lt;t&gt;csric02()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsric02(cusparseHandle_t handle,
                 int m,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 float *csrValA_valM,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 csric02Info_t info,
                 cusparseSolvePolicy_t policy,
                 void *pBuffer);

cusparseStatus_t 
cusparseDcsric02(cusparseHandle_t handle,
                 int m,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 double *csrValA_valM,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 csric02Info_t info,
                 cusparseSolvePolicy_t policy,
                 void *pBuffer);

cusparseStatus_t 
cusparseCcsric02(cusparseHandle_t handle,
                 int m,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 cuComplex *csrValA_valM,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 csric02Info_t info,
                 cusparseSolvePolicy_t policy,
                 void *pBuffer);

cusparseStatus_t 
cusparseZcsric02(cusparseHandle_t handle,
                 int m,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 cuDoubleComplex *csrValA_valM,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 csric02Info_t info,
                 cusparseSolvePolicy_t policy,
                 void *pBuffer);

</pre><p class="p">This function performs the solve phase of the computing the incomplete-Cholesky factorization
                              with 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>0</mn>
                              </math>
                              fill-in and no pivoting:
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <msup>
                                                <mi>L</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">This function requires a buffer size returned by <samp class="ph codeph">csric02_bufferSize()</samp>. The
                              address of <samp class="ph codeph">pBuffer</samp> must be a multiple of 128 bytes. If not,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           </p>
                           <p class="p">Although <samp class="ph codeph">csric02()</samp> can be done without level information, the user still needs
                              to be aware of consistency. If <samp class="ph codeph">csric02_analysis()</samp> is called with policy
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>, <samp class="ph codeph">csric02()</samp> can be run with
                              or without levels. On the other hand, if <samp class="ph codeph">csric02_analysis()</samp> is called with
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>, <samp class="ph codeph">csric02()</samp> can only accept
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>; otherwise,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">csric02()</samp> reports the first numerical zero, including a structural
                              zero. The user must call <samp class="ph codeph">cusparseXcsric02_zeroPivot()</samp> to know where
                              the numerical zero is. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">csric02()</samp> only takes the lower triangular part of matrix
                              <samp class="ph codeph">A</samp> to perform factorization. The matrix type must be
                              <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, the fill mode and diagonal type are ignored,
                              and the strictly upper triangular part is ignored and never touched. It does not matter if
                              <samp class="ph codeph">A</samp> is Hermitian or not. In other words, from the point of view of
                              <samp class="ph codeph">csric02()</samp><samp class="ph codeph">A</samp> is Hermitian and only the lower triangular part is provided. 
                           </p>
                           <div class="p">
                              <div class="note note"><span class="notetitle">Note:</span> In practice, a positive definite matrix may not have incomplete cholesky factorization.
                                 To the best of our knowledge, only matrix <samp class="ph codeph">M</samp> can guarantee the existence of
                                 incomplete cholesky factorization. If <samp class="ph codeph">csric02()</samp> failed cholesky
                                 factorization and reported a numerical zero, it is possible that incomplete cholesky
                                 factorization does not exist. 
                              </div>
                           </div>
                           <p class="p">For example, suppose <samp class="ph codeph">A</samp> is a real <samp class="ph codeph">m × m</samp> matrix, the
                              following code solves the precondition system <samp class="ph codeph">M*y = x</samp> where
                              <samp class="ph codeph">M</samp> is the product of Cholesky factorization <samp class="ph codeph">L</samp> and its
                              transpose. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>M</mi>
                                             <mo>=</mo>
                                             <mi>L</mi>
                                             <msup>
                                                <mi>L</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Suppose that A is m x m sparse matrix represented by CSR format, </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Assumption:</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - handle is already created by cusparseCreate(),</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - (d_csrRowPtr, d_csrColInd, d_csrVal) is CSR of A on device memory,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_x is right hand side vector on device memory,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_y is solution vector on device memory.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_z is intermediate result on device memory.</span>

cusparseMatDescr_t descr_M = 0;
cusparseMatDescr_t descr_L = 0;
csric02Info_t info_M  = 0;
csrsv2Info_t  info_L  = 0;
csrsv2Info_t  info_Lt = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize_M;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize_L;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize_Lt;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *pBuffer = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> structural_zero;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> numerical_zero;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> alpha = 1.;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy_M  = CUSPARSE_SOLVE_POLICY_NO_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy_L  = CUSPARSE_SOLVE_POLICY_NO_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy_Lt = CUSPARSE_SOLVE_POLICY_USE_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseOperation_t trans_L  = CUSPARSE_OPERATION_NON_TRANSPOSE;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseOperation_t trans_Lt = CUSPARSE_OPERATION_TRANSPOSE;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create a descriptor which contains</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix M is base-1</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L is base-1</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L is lower triangular</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L has non-unit diagonal </span>
cusparseCreateMatDescr(&amp;descr_M);
cusparseSetMatIndexBase(descr_M, CUSPARSE_INDEX_BASE_ONE);
cusparseSetMatType(descr_M, CUSPARSE_MATRIX_TYPE_GENERAL);

cusparseCreateMatDescr(&amp;descr_L);
cusparseSetMatIndexBase(descr_L, CUSPARSE_INDEX_BASE_ONE);
cusparseSetMatType(descr_L, CUSPARSE_MATRIX_TYPE_GENERAL);
cusparseSetMatFillMode(descr_L, CUSPARSE_FILL_MODE_LOWER);
cusparseSetMatDiagType(descr_L, CUSPARSE_DIAG_TYPE_NON_UNIT);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: create a empty info structure</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// we need one info for csric02 and two info's for csrsv2</span>
cusparseCreateCsric02Info(&amp;info_M);
cusparseCreateCsrsv2Info(&amp;info_L);
cusparseCreateCsrsv2Info(&amp;info_Lt);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query how much memory used in csric02 and csrsv2, and allocate the buffer</span>
cusparseDcsric02_bufferSize(handle, m, nnz,
    descr_M, d_csrVal, d_csrRowPtr, d_csrColInd, info_M, &amp;bufferSize_M);
cusparseDcsrsv2_bufferSize(handle, trans_L, m, nnz, 
    descr_L, d_csrVal, d_csrRowPtr, d_csrColInd, info_L, &amp;pBufferSize_L);
cusparseDcsrsv2_bufferSize(handle, trans_Lt, m, nnz, 
    descr_L, d_csrVal, d_csrRowPtr, d_csrColInd, info_Lt,&amp;pBufferSize_Lt);

pBufferSize = max(bufferSize_M, max(pBufferSize_L, pBufferSize_Lt));

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// pBuffer returned by cudaMalloc is automatically aligned to 128 bytes.</span>
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;pBuffer, pBufferSize);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: perform analysis of incomplete Cholesky on M</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//         perform analysis of triangular solve on L</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//         perform analysis of triangular solve on L' </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// The lower triangular part of M has the same sparsity pattern as L, so  </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// we can do analysis of csric02 and csrsv2 simultaneously.</span>

cusparseDcsric02_analysis(handle, m, nnz, descr_M,
    d_csrVal, d_csrRowPtr, d_csrColInd, info_M, 
    policy_M, pBuffer);
status = cusparseXcsric02_zeroPivot(handle, info_M, &amp;structural_zero);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (CUSPARSE_STATUS_ZERO_PIVOT == status){
   printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A(%d,%d) is missing\n"</span>, structural_zero, structural_zero);
}

cusparseDcsrsv2_analysis(handle, trans_L, m, nnz, descr_L, 
    d_csrVal, d_csrRowPtr, d_csrColInd,
    info_L, policy_L, pBuffer);

cusparseDcsrsv2_analysis(handle, trans_Lt, m, nnz, descr_L, 
    d_csrVal, d_csrRowPtr, d_csrColInd,
    info_Lt, policy_Lt, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: M = L * L'</span>
cusparseDcsric02(handle, m, nnz, descr_M,
    d_csrVal, d_csrRowPtr, d_csrColInd, info_M, policy_M, pBuffer);
status = cusparseXcsric02_zeroPivot(handle, info_M, &amp;numerical_zero);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (CUSPARSE_STATUS_ZERO_PIVOT == status){
   printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"L(%d,%d) is zero\n"</span>, numerical_zero, numerical_zero);
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: solve L*z = x</span>
cusparseDcsrsv2_solve(handle, trans_L, m, nnz, &amp;alpha, descr_L,
   d_csrVal, d_csrRowPtr, d_csrColInd, info_L,
   d_x, d_z, policy_L, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 7: solve L'*y = z</span>
cusparseDcsrsv2_solve(handle, trans_Lt, m, nnz, &amp;alpha, descr_L,
   d_csrVal, d_csrRowPtr, d_csrColInd, info_Lt,
   d_z, d_y, policy_Lt, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: free resources</span>
cudaFree(pBuffer);
cusparseDestroyMatDescr(descr_M);
cusparseDestroyMatDescr(descr_L);
cusparseDestroyCsric02Info(info_M);
cusparseDestroyCsrsv2Info(info_L);
cusparseDestroyCsrsv2Info(info_Lt);
cusparseDestroy(handle);</pre><div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA_valM</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase (that should have been passed to the solve phase unchanged).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                          <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                          <samp class="ph codeph">csric02_bufferSize()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA_valM</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; matrix containing the incomplete-Cholesky lower triangular factor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-csric02_zeroPivot"><a name="cusparse-lt-t-gt-csric02_zeroPivot" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csric02_zeroPivot" name="cusparse-lt-t-gt-csric02_zeroPivot" shape="rect">cusparseXcsric02_zeroPivot()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseXcsric02_zeroPivot(cusparseHandle_t handle,
                           csric02Info_t info,
                           int *position);</pre><p class="p"> If the returned error code is <samp class="ph codeph">CUSPARSE_STATUS_ZERO_PIVOT</samp>,
                              <samp class="ph codeph">position=j</samp> means <samp class="ph codeph">A(j,j)</samp> has either a structural zero or a
                              numerical zero; otherwise, <samp class="ph codeph">position=-1</samp>. 
                           </p>
                           <p class="p">The <samp class="ph codeph">position</samp> can be 0-based or 1-based, the same as the matrix. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">cusparseXcsric02_zeroPivot()</samp> is a blocking call. It calls
                              <samp class="ph codeph">cudaDeviceSynchronize()</samp> to make sure all previous kernels are done. 
                           </p>
                           <p class="p">The <samp class="ph codeph">position</samp> can be in the host memory or device memory. The user can set proper
                              mode with <samp class="ph codeph">cusparseSetPointerMode()</samp>. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> contains structural zero or numerical zero if the user already
                                          called <samp class="ph codeph">csric02_analysis()</samp> or <samp class="ph codeph">csric02()</samp>. 
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">position</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">if no structural or numerical zero, <samp class="ph codeph">position</samp> is -1; otherwise, if
                                          <samp class="ph codeph">A(j,j)</samp> is missing or <samp class="ph codeph">L(j,j)</samp> is zero, <samp class="ph codeph">position=j</samp>. 
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> is not valid.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-bsric02_bufferSize"><a name="cusparse-lt-t-gt-bsric02_bufferSize" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsric02_bufferSize" name="cusparse-lt-t-gt-bsric02_bufferSize" shape="rect">10.1.6.&nbsp;cusparse&lt;t&gt;bsric02_bufferSize()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsric02_bufferSize(cusparseHandle_t handle,
                            cusparseDirection_t dirA,
                            int mb,
                            int nnzb,
                            const cusparseMatDescr_t descrA,
                            float *bsrValA,
                            const int *bsrRowPtrA,
                            const int *bsrColIndA,
                            int blockDim,
                            bsric02Info_t info,
                            int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseDbsric02_bufferSize(cusparseHandle_t handle,
                            cusparseDirection_t dirA,
                            int mb,
                            int nnzb,
                            const cusparseMatDescr_t descrA,
                            double *bsrValA,
                            const int *bsrRowPtrA,
                            const int *bsrColIndA,
                            int blockDim,
                            bsric02Info_t info,
                            int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseCbsric02_bufferSize(cusparseHandle_t handle,
                            cusparseDirection_t dirA,
                            int mb,
                            int nnzb,
                            const cusparseMatDescr_t descrA,
                            cuComplex *bsrValA,
                            const int *bsrRowPtrA,
                            const int *bsrColIndA,
                            int blockDim,
                            bsric02Info_t info,
                            int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseZbsric02_bufferSize(cusparseHandle_t handle,
                            cusparseDirection_t dirA,
                            int mb,
                            int nnzb,
                            const cusparseMatDescr_t descrA,
                            cuDoubleComplex *bsrValA,
                            const int *bsrRowPtrA,
                            const int *bsrColIndA,
                            int blockDim,
                            bsric02Info_t info,
                            int *pBufferSizeInBytes);

</pre><p class="p">This function returns the size of a buffer used in computing the incomplete-Cholesky
                              factorization with 0 fill-in and no pivoting
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <msup>
                                                <mi>L</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(mb*blockDim)*(mb*blockDim)</samp> sparse matrix that is
                              defined in BSR storage format by the three arrays <samp class="ph codeph">bsrValA</samp>,
                              <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>. 
                           </p>
                           <p class="p">The buffer size depends on the dimensions of <samp class="ph codeph">mb</samp>, <samp class="ph codeph">blockDim</samp>, and
                              the number of nonzero blocks of the matrix <samp class="ph codeph">nnzb</samp>. If the user changes the
                              matrix, it is necessary to call <samp class="ph codeph">bsric02_bufferSize()</samp> again to have the
                              correct buffer size; otherwise, a segmentation fault may occur. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either
                                          <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                          <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows and block columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every block row and the end of the last block row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix A, larger than zero.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">record internal states based on different algorithms.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in <samp class="ph codeph">bsric02_analysis()</samp> and
                                          <samp class="ph codeph">bsric02()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb,nnzb&lt;=0</samp>); the base index is
                                          not 0 or 1. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-bsric02_analysis"><a name="cusparse-lt-t-gt-bsric02_analysis" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsric02_analysis" name="cusparse-lt-t-gt-bsric02_analysis" shape="rect">10.1.7.&nbsp;cusparse&lt;t&gt;bsric02_analysis()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsric02_analysis(cusparseHandle_t handle,
                          cusparseDirection_t dirA,
                          int mb,
                          int nnzb,
                          const cusparseMatDescr_t descrA,
                          const float *bsrValA,
                          const int *bsrRowPtrA,
                          const int *bsrColIndA,
                          int blockDim,
                          bsric02Info_t info,
                          cusparseSolvePolicy_t policy,
                          void *pBuffer);

cusparseStatus_t 
cusparseDbsric02_analysis(cusparseHandle_t handle,
                          cusparseDirection_t dirA,
                          int mb,
                          int nnzb,
                          const cusparseMatDescr_t descrA,
                          const double *bsrValA,
                          const int *bsrRowPtrA,
                          const int *bsrColIndA,
                          int blockDim,
                          bsric02Info_t info,
                          cusparseSolvePolicy_t policy,
                          void *pBuffer);

cusparseStatus_t 
cusparseCbsric02_analysis(cusparseHandle_t handle,
                          cusparseDirection_t dirA,
                          int mb,
                          int nnzb,
                          const cusparseMatDescr_t descrA,
                          const cuComplex *bsrValA,
                          const int *bsrRowPtrA,
                          const int *bsrColIndA,
                          int blockDim,
                          bsric02Info_t info,
                          cusparseSolvePolicy_t policy,
                          void *pBuffer);

cusparseStatus_t 
cusparseZbsric02_analysis(cusparseHandle_t handle,
                          cusparseDirection_t dirA,
                          int mb,
                          int nnzb,
                          const cusparseMatDescr_t descrA,
                          const cuDoubleComplex *bsrValA,
                          const int *bsrRowPtrA,
                          const int *bsrColIndA,
                          int blockDim,
                          bsric02Info_t info,
                          cusparseSolvePolicy_t policy,
                          void *pBuffer);

</pre><p class="p">This function performs the analysis phase of the incomplete-Cholesky factorization with 0 fill-in and no pivoting</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <msup>
                                                <mi>L</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(mb*blockDim)x(mb*blockDim)</samp> sparse matrix that is
                              defined in BSR storage format by the three arrays <samp class="ph codeph">bsrValA</samp>,
                              <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>. The
                              block in BSR format is of size <samp class="ph codeph">blockDim*blockDim</samp>, stored as
                              column-major or row-major as determined by parameter <samp class="ph codeph">dirA</samp>,
                              which is either <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp> or
                              <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp>. The matrix type must be
                              <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, and the fill mode and
                              diagonal type are ignored. 
                           </p>
                           <p class="p">This function requires a buffer size returned by <samp class="ph codeph">bsric02_bufferSize90</samp>. The
                              address of <samp class="ph codeph">pBuffer</samp> must be a multiple of 128 bytes. If it
                              is not, <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           </p>
                           <p class="p">Function<samp class="ph codeph">bsric02_analysis()</samp> reports structural zero and computes level
                              information stored in the opaque structure <samp class="ph codeph">info</samp>. The level
                              information can extract more parallelism during incomplete Cholesky
                              factorization. However <samp class="ph codeph">bsric02()</samp> can be done without level
                              information. To disable level information, the user needs to specify the
                              parameter <samp class="ph codeph">policy</samp> of <samp class="ph codeph">bsric02[_analysis| ]</samp>
                              as <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">bsric02_analysis</samp> always reports the first structural zero, even when
                              parameter <samp class="ph codeph">policy</samp> is
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. The user must call
                              <samp class="ph codeph">cusparseXbsric02_zeroPivot()</samp> to know where
                              the structural zero is. 
                           </p>
                           <p class="p">It is the user's choice whether to call <samp class="ph codeph">bsric02()</samp> if
                              <samp class="ph codeph">bsric02_analysis()</samp> reports a structural zero. In
                              this case, the user can still call <samp class="ph codeph">bsric02()</samp>, which returns
                              a numerical zero in the same position as the structural zero. However the
                              result is meaningless. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either
                                          <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                          <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows and block columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every block row and the end of the last block row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix A; must be larger than zero.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateBsric02Info()</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                          <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                          <samp class="ph codeph">bsric02_bufferSize()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure filled with information collected during the analysis phase (that should be passed to the solve phase unchanged).</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb,nnzb&lt;=0</samp>); the base index is
                                          not 0 or 1. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-bsric02"><a name="cusparse-lt-t-gt-bsric02" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsric02" name="cusparse-lt-t-gt-bsric02" shape="rect">cusparse&lt;t&gt;bsric02()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsric02(cusparseHandle_t handle,
                 cusparseDirection_t dirA,
                 int mb,
                 int nnzb,
                 const cusparseMatDescr_t descrA,
                 float *bsrValA,
                 const int *bsrRowPtrA,
                 const int *bsrColIndA,
                 int blockDim,
                 bsric02Info_t info,
                 cusparseSolvePolicy_t policy,
                 void *pBuffer);

cusparseStatus_t 
cusparseDbsric02(cusparseHandle_t handle,
                 cusparseDirection_t dirA,
                 int mb,
                 int nnzb,
                 const cusparseMatDescr_t descrA,
                 double *bsrValA,
                 const int *bsrRowPtrA,
                 const int *bsrColIndA,
                 int blockDim,
                 bsric02Info_t info,
                 cusparseSolvePolicy_t policy,
                 void *pBuffer);

cusparseStatus_t 
cusparseCbsric02(cusparseHandle_t handle,
                 cusparseDirection_t dirA,
                 int mb,
                 int nnzb,
                 const cusparseMatDescr_t descrA,
                 cuComplex *bsrValA,
                 const int *bsrRowPtrA,
                 const int *bsrColIndA,
                 int blockDim,
                 bsric02Info_t info,
                 cusparseSolvePolicy_t policy,
                 void *pBuffer);

cusparseStatus_t 
cusparseZbsric02(cusparseHandle_t handle,
                 cusparseDirection_t dirA,
                 int mb,
                 int nnzb,
                 const cusparseMatDescr_t descrA,
                 cuDoubleComplex *bsrValA,
                 const int *bsrRowPtrA,
                 const int *bsrColIndA,
                 int blockDim,
                 bsric02Info_t info,
                 cusparseSolvePolicy_t policy,
                 void *pBuffer);

</pre><p class="p">This function performs the solve phase of the incomplete-Cholesky factorization with 0 fill-in and no pivoting</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <msup>
                                                <mi>L</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(mb*blockDim)×(mb*blockDim)</samp> sparse matrix that is
                              defined in BSR storage format by the three arrays <samp class="ph codeph">bsrValA</samp>,
                              <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>. The block in BSR format is of
                              size <samp class="ph codeph">blockDim*blockDim</samp>, stored as column-major or row-major as determined by
                              parameter <samp class="ph codeph">dirA</samp>, which is either <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp> or
                              <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp>. The matrix type must be
                              <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, and the fill mode and diagonal type are
                              ignored. 
                           </p>
                           <p class="p">This function requires a buffer size returned by <samp class="ph codeph">bsric02_bufferSize()</samp>. The
                              address of <samp class="ph codeph">pBuffer</samp> must be a multiple of 128 bytes. If it is not,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           </p>
                           <p class="p">Although <samp class="ph codeph">bsric02()</samp> can be done without level information, the user must be aware
                              of consistency. If <samp class="ph codeph">bsric02_analysis()</samp> is called with policy
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>, <samp class="ph codeph">bsric02()</samp> can be run with
                              or without levels. On the other hand, if <samp class="ph codeph">bsric02_analysis()</samp> is called with
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>, <samp class="ph codeph">bsric02()</samp> can only accept
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>; otherwise,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">bsric02()</samp> has the same behavior as <samp class="ph codeph">csric02()</samp>. That is,
                              <samp class="ph codeph">bsr2csr(bsric02(A)) = csric02(bsr2csr(A))</samp>. The numerical zero of
                              <samp class="ph codeph">csric02()</samp> means there exists some zero <samp class="ph codeph">L(j,j)</samp>. The
                              numerical zero of <samp class="ph codeph">bsric02()</samp> means there exists some block
                              <samp class="ph codeph">Lj,j)</samp> that is not invertible. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">bsric02</samp> reports the first numerical zero, including a structural zero.
                              The user must call <samp class="ph codeph">cusparseXbsric02_zeroPivot()</samp> to know where the numerical
                              zero is. 
                           </p>
                           <p class="p">The <samp class="ph codeph">bsric02()</samp> function only takes the lower triangular part of matrix
                              <samp class="ph codeph">A</samp> to perform factorization. The strictly upper triangular part is ignored
                              and never touched. It does not matter if <samp class="ph codeph">A</samp> is Hermitian or not. In other
                              words, from the point of view of <samp class="ph codeph">bsric02()</samp>, <samp class="ph codeph">A</samp> is Hermitian
                              and only the lower triangular part is provided. Moreover, the imaginary part of diagonal
                              elements of diagonal blocks is ignored. 
                           </p>
                           <p class="p">For example, suppose <samp class="ph codeph">A</samp> is a real m-by-m matrix, where
                              <samp class="ph codeph">m=mb*blockDim</samp>. The following code solves precondition system <samp class="ph codeph">M*y =
                                 x</samp>, where <samp class="ph codeph">M</samp> is the product of Cholesky factorization
                              <samp class="ph codeph">L</samp> and its transpose. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>M</mi>
                                             <mo>=</mo>
                                             <mi>L</mi>
                                             <msup>
                                                <mi>L</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div><pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Suppose that A is m x m sparse matrix represented by BSR format, </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// The number of block rows/columns is mb, and </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// the number of nonzero blocks is nnzb.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Assumption:</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - handle is already created by cusparseCreate(),</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - (d_bsrRowPtr, d_bsrColInd, d_bsrVal) is BSR of A on device memory,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_x is right hand side vector on device memory,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_y is solution vector on device memory.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_z is intermediate result on device memory.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_x, d_y and d_z are of size m.</span>
cusparseMatDescr_t descr_M = 0;
cusparseMatDescr_t descr_L = 0;
bsric02Info_t info_M  = 0;
bsrsv2Info_t  info_L  = 0;
bsrsv2Info_t  info_Lt = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize_M;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize_L;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize_Lt;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *pBuffer = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> structural_zero;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> numerical_zero;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> alpha = 1.;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy_M  = CUSPARSE_SOLVE_POLICY_NO_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy_L  = CUSPARSE_SOLVE_POLICY_NO_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy_Lt = CUSPARSE_SOLVE_POLICY_USE_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseOperation_t trans_L  = CUSPARSE_OPERATION_NON_TRANSPOSE;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseOperation_t trans_Lt = CUSPARSE_OPERATION_TRANSPOSE;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseDirection_t dir = CUSPARSE_DIRECTION_COLUMN;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create a descriptor which contains</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix M is base-1</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L is base-1</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L is lower triangular</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L has non-unit diagonal </span>
cusparseCreateMatDescr(&amp;descr_M);
cusparseSetMatIndexBase(descr_M, CUSPARSE_INDEX_BASE_ONE);
cusparseSetMatType(descr_M, CUSPARSE_MATRIX_TYPE_GENERAL);

cusparseCreateMatDescr(&amp;descr_L);
cusparseSetMatIndexBase(descr_L, CUSPARSE_INDEX_BASE_ONE);
cusparseSetMatType(descr_L, CUSPARSE_MATRIX_TYPE_GENERAL);
cusparseSetMatFillMode(descr_L, CUSPARSE_FILL_MODE_LOWER);
cusparseSetMatDiagType(descr_L, CUSPARSE_DIAG_TYPE_NON_UNIT);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: create a empty info structure</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// we need one info for bsric02 and two info's for bsrsv2</span>
cusparseCreateBsric02Info(&amp;info_M);
cusparseCreateBsrsv2Info(&amp;info_L);
cusparseCreateBsrsv2Info(&amp;info_Lt);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query how much memory used in bsric02 and bsrsv2, and allocate the buffer</span>
cusparseDbsric02_bufferSize(handle, dir, mb, nnzb,
    descr_M, d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_M, &amp;bufferSize_M);
cusparseDbsrsv2_bufferSize(handle, dir, trans_L, mb, nnzb, 
    descr_L, d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_L, &amp;pBufferSize_L);
cusparseDbsrsv2_bufferSize(handle, dir, trans_Lt, mb, nnzb, 
    descr_L, d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_Lt, &amp;pBufferSize_Lt);

pBufferSize = max(bufferSize_M, max(pBufferSize_L, pBufferSize_Lt));

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// pBuffer returned by cudaMalloc is automatically aligned to 128 bytes.</span>
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;pBuffer, pBufferSize);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: perform analysis of incomplete Cholesky on M</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//         perform analysis of triangular solve on L</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//         perform analysis of triangular solve on L' </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// The lower triangular part of M has the same sparsity pattern as L, so  </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// we can do analysis of bsric02 and bsrsv2 simultaneously.</span>

cusparseDbsric02_analysis(handle, dir, mb, nnzb, descr_M,
    d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_M, 
    policy_M, pBuffer);
status = cusparseXbsric02_zeroPivot(handle, info_M, &amp;structural_zero);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (CUSPARSE_STATUS_ZERO_PIVOT == status){
   printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A(%d,%d) is missing\n"</span>, structural_zero, structural_zero);
}

cusparseDbsrsv2_analysis(handle, dir, trans_L, mb, nnzb, descr_L, 
    d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>,
    info_L, policy_L, pBuffer);

cusparseDbsrsv2_analysis(handle, dir, trans_Lt, mb, nnzb, descr_L, 
    d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>,
    info_Lt, policy_Lt, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: M = L * L'</span>
cusparseDbsric02_solve(handle, dir, mb, nnzb, descr_M,
    d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_M, policy_M, pBuffer);
status = cusparseXbsric02_zeroPivot(handle, info_M, &amp;numerical_zero);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (CUSPARSE_STATUS_ZERO_PIVOT == status){
   printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"L(%d,%d) is not positive definite\n"</span>, numerical_zero, numerical_zero);
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: solve L*z = x</span>
cusparseDbsrsv2_solve(handle, dir, trans_L, mb, nnzb, &amp;alpha, descr_L,
   d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_L,
   d_x, d_z, policy_L, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 7: solve L'*y = z</span>
cusparseDbsrsv2_solve(handle, dir, trans_Lt, mb, nnzb, &amp;alpha, descr_L,
   d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_Lt,
   d_z, d_y, policy_Lt, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: free resources</span>
cudaFree(pBuffer);
cusparseDestroyMatDescr(descr_M);
cusparseDestroyMatDescr(descr_L);
cusparseDestroyBsric02Info(info_M);
cusparseDestroyBsrsv2Info(info_L);
cusparseDestroyBsrsv2Info(info_Lt);
cusparseDestroy(handle);
</pre><div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either
                                          <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                          <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows and block columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every block row and the end of the last block row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix A, larger than zero.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase (that should have been passed to the solve phase unchanged).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                          <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is returned by
                                          <samp class="ph codeph">bsric02_bufferSize()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; matrix containing the incomplete-Cholesky lower triangular factor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb,nnzb&lt;=0</samp>); the base index is
                                          not 0 or 1. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-bsric02_zeroPivot"><a name="cusparse-lt-t-gt-bsric02_zeroPivot" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsric02_zeroPivot" name="cusparse-lt-t-gt-bsric02_zeroPivot" shape="rect">cusparseXbsric02_zeroPivot()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseXbsric02_zeroPivot(cusparseHandle_t handle,
                           bsric02Info_t info,
                           int *position);
</pre><p class="p">If the returned error code is <samp class="ph codeph">CUSPARSE_STATUS_ZERO_PIVOT</samp>,
                              <samp class="ph codeph">position=j</samp> means <samp class="ph codeph">A(j,j)</samp> has either a structural zero or a
                              numerical zero (the block is not positive definite). Otherwise <samp class="ph codeph">position=-1</samp>. 
                           </p>
                           <p class="p">The <samp class="ph codeph">position</samp> can be 0-based or 1-based, the same as the matrix. 
                           </p>
                           <p class="p">Function  <samp class="ph codeph">cusparseXbsric02_zeroPivot()</samp> is a blocking call. It calls
                              <samp class="ph codeph">cudaDeviceSynchronize()</samp> to make sure all previous kernels are done. 
                           </p>
                           <p class="p">The <samp class="ph codeph">position</samp> can be in the host memory or device memory. The user can set the
                              proper mode with <samp class="ph codeph">cusparseSetPointerMode()</samp>. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> contains a structural zero or a numerical zero if the user
                                          already called <samp class="ph codeph">bsric02_analysis()</samp> or <samp class="ph codeph">bsric02()</samp>. 
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">position</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">if no structural or numerical zero, <samp class="ph codeph">position</samp>  is -1, 
                                          otherwise if <samp class="ph codeph">A(j,j)</samp> is missing or <samp class="ph codeph">L(j,j)</samp> is not positive definite, <samp class="ph codeph">position=j</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> is not valid.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="ilu0"><a name="ilu0" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#ilu0" name="ilu0" shape="rect">10.2.&nbsp;Incomplete LU Factorization: level 0</a></h3>
                     <div class="body conbody">
                        <p class="p">Different algorithms for ilu0 are discussed in this section.</p>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-csrilu0"><a name="cusparse-lt-t-gt-csrilu0" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrilu0" name="cusparse-lt-t-gt-csrilu0" shape="rect">10.2.1.&nbsp;cusparse&lt;t&gt;csrilu0()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsrilu0(cusparseHandle_t handle, 
                 cusparseOperation_t trans, 
                 int m, 
                 const cusparseMatDescr_t descrA, 
                 float *csrValM,
                 const int *csrRowPtrA, 
                 const int *csrColIndA, 
                 cusparseSolveAnalysisInfo_t info)
cusparseStatus_t 
cusparseDcsrilu0(cusparseHandle_t handle, 
                 cusparseOperation_t trans, 
                 int m, 
                 const cusparseMatDescr_t descrA, 
                 double *csrValM,
                 const int *csrRowPtrA, 
                 const int *csrColIndA,  
                 cusparseSolveAnalysisInfo_t info)
cusparseStatus_t 
cusparseCcsrilu0(cusparseHandle_t handle, 
                 cusparseOperation_t trans, 
                 int m, 
                 const cusparseMatDescr_t descrA, 
                 cuComplex *csrValM,
                 const int *csrRowPtrA, 
                 const int *csrColIndA,  
                 cusparseSolveAnalysisInfo_t info)
cusparseStatus_t 
cusparseZcsrilu0(cusparseHandle_t handle, 
                 cusparseOperation_t trans, 
                 int m, 
                 const cusparseMatDescr_t descrA, 
                 cuDoubleComplex *csrValM,
                 const int *csrRowPtrA, 
                 const int *csrColIndA, 
                 cusparseSolveAnalysisInfo_t info)
</pre><p class="p">This function computes the incomplete-LU factorization with 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>0</mn>
                              </math>
                              fill-in and no pivoting:
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>o</mi>
                                             <mi>p</mi>
                                             <mo stretchy="false">(</mo>
                                             <mi>A</mi>
                                             <mo stretchy="false">)</mo>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mo>×</mo>
                              </math><samp class="ph codeph">m</samp> sparse matrix that is defined in CSR storage format by the three arrays
                              <samp class="ph codeph">csrValM</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and <samp class="ph codeph">csrColIndA</samp>;
                              and
                           </p>
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mtext>op</mtext>
                                 </mrow>
                              </mrow>
                              <mo stretchy="false">(</mo>
                              <mi>A</mi>
                              <mo stretchy="false">)</mo>
                              <mo>=</mo>
                              <mfenced open="{" close="">
                                 <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                    <mtr>
                                       <mtd>
                                          <mi>A</mi>
                                       </mtd>
                                       <mtd>
                                          <mtext>if trans == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                       </mtd>
                                    </mtr>
                                    <mtr>
                                       <mtd>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>T</mi>
                                          </msup>
                                       </mtd>
                                       <mtd>
                                          <mtext>if trans == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                       </mtd>
                                    </mtr>
                                    <mtr>
                                       <mtd>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>H</mi>
                                          </msup>
                                       </mtd>
                                       <mtd>
                                          <mtext>if trans == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                       </mtd>
                                    </mtr>
                                 </mtable>
                              </mfenced>
                           </math>
                           <p class="p">Notice that the diagonal of lower triangular factor 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>L</mi>
                              </math>
                              is unitary and need not be stored. Therefore, the input matrix is overwritten
                              with the resulting lower and upper triangular factors 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>L</mi>
                              </math>
                              and 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>U</mi>
                              </math>
                              , respectively.
                           </p>
                           <p class="p">A call to this routine must be preceded by a call to the <samp class="ph codeph">csrsv_analysis()</samp>
                              routine.
                           </p>
                           <p class="p">
                              The matrix descriptor for <samp class="ph codeph">csrsv_analysis()</samp> and <samp class="ph codeph">csrilu0()</samp> must be the same.
                              Otherwise, runtime error would occur.
                              
                           </p>
                           <p class="p">This function requires some extra storage. It is executed asynchronously with respect to the host
                              and may return control to the application on the host before the result is ready.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">trans</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation <samp class="ph codeph">op</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mi>A</mi>
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          .
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                          <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported index bases are
                                          <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                          <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValM</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          column indices of the nonzero elements of matrix
                                          <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase (that should have been passed to the solve phase unchanged).</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValM</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; matrix containing the incomplete-LU lower and upper triangular factors.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;0</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-csrilu0Ex"><a name="cusparse-csrilu0Ex" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-csrilu0Ex" name="cusparse-csrilu0Ex" shape="rect">10.2.2.&nbsp;cusparseCsrilu0Ex()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t CUSPARSEAPI cusparseCsrilu0Ex(cusparseHandle_t handle, 
                                              cusparseOperation_t trans, 
                                              int m, 
                                              const cusparseMatDescr_t descrA, 
                                              void *csrSortedValA_ValM, cudaDataType csrSortedValA_ValMtype,
                                              const int *csrSortedRowPtrA, 
                                              const int *csrSortedColIndA,
                                              cusparseSolveAnalysisInfo_t info,
                                              cudaDataType executiontype);
</pre><p class="p">This function is an extended version of <samp class="ph codeph">cusparse&lt;t&gt;csrilu0()</samp>. For detailed description of the functionality, see <samp class="ph codeph">cusparse&lt;t&gt;csrilu0()</samp>.
                           </p>
                           <p class="p">This function does not support half-precision execution type, but it supports half-precision IO with single precision execution.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input specifically required by <samp class="ph codeph">cusparseCsrilu0Ex</samp></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrSortedValA_ValMtype</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">csrSortedValA_ValM</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">executiontype</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type used for computation.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-csrilu02_numericBoost"><a name="cusparse-lt-t-gt-csrilu02_numericBoost" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrilu02_numericBoost" name="cusparse-lt-t-gt-csrilu02_numericBoost" shape="rect">cusparse&lt;t&gt;csrilu02_numericBoost()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsrilu02_numericBoost(cusparseHandle_t handle,
                               csrilu02Info_t info,
                               int enable_boost,
                               double *tol,
                               float *boost_val);

cusparseStatus_t 
cusparseDcsrilu02_numericBoost(cusparseHandle_t handle,
                               csrilu02Info_t info,
                               int enable_boost,
                               double *tol,
                               double *boost_val);

cusparseStatus_t 
cusparseCcsrilu02_numericBoost(cusparseHandle_t handle,
                               csrilu02Info_t info,
                               int enable_boost,
                               double *tol,
                               cuComplex *boost_val);

cusparseStatus_t 
cusparseZcsrilu02_numericBoost(cusparseHandle_t handle,
                               csrilu02Info_t info,
                               int enable_boost,
                               double *tol,
                               cuDoubleComplex *boost_val);

</pre><p class="p"> The user can use a boost value to replace a numerical value in incomplete LU factorization. The
                              <samp class="ph codeph">tol</samp> is used to determine a numerical zero, and the
                              <samp class="ph codeph">boost_val</samp> is used to replace a numerical zero. The
                              behavior is 
                           </p>
                           <p class="p">
                              if <samp class="ph codeph">tol &gt;= fabs(A(j,j))</samp>, then <samp class="ph codeph">A(j,j)=boost_val</samp>.
                              
                           </p>
                           <p class="p"> To enable a boost value, the user has to set parameter <samp class="ph codeph">enable_boost</samp> to 1 before
                              calling <samp class="ph codeph">csrilu02()</samp>. To disable a boost value, the user can
                              call <samp class="ph codeph">csrilu02_numericBoost()</samp> again with parameter
                              <samp class="ph codeph">enable_boost=0</samp>. 
                           </p>
                           <p class="p">
                              If <samp class="ph codeph">enable_boost=0</samp>, <samp class="ph codeph">tol</samp> and <samp class="ph codeph">boost_val</samp> are ignored.
                              
                           </p>
                           <p class="p"> Both <samp class="ph codeph">tol</samp> and <samp class="ph codeph">boost_val</samp> can be in the host memory or device
                              memory. The user can set the  proper mode with
                              <samp class="ph codeph">cusparseSetPointerMode()</samp>. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateCsrilu02Info()</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">enable_boost</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">disable boost by <samp class="ph codeph">enable_boost=0</samp>; otherwise, boost is
                                          enabled.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">tol</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">tolerance to determine a numerical zero.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">boost_val</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">boost value to replace a numerical zero.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> or pointer mode is not valid.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-csrilu02_bufferSize"><a name="cusparse-lt-t-gt-csrilu02_bufferSize" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrilu02_bufferSize" name="cusparse-lt-t-gt-csrilu02_bufferSize" shape="rect">10.2.4.&nbsp;cusparse&lt;t&gt;csrilu02_bufferSize()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsrilu02_bufferSize(cusparseHandle_t handle,
                             int m,
                             int nnz,
                             const cusparseMatDescr_t descrA,
                             float *csrValA,
                             const int *csrRowPtrA,
                             const int *csrColIndA,
                             csrilu02Info_t info,
                             int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseDcsrilu02_bufferSize(cusparseHandle_t handle,
                             int m,
                             int nnz,
                             const cusparseMatDescr_t descrA,
                             double *csrValA,
                             const int *csrRowPtrA,
                             const int *csrColIndA,
                             csrilu02Info_t info,
                             int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseCcsrilu02_bufferSize(cusparseHandle_t handle,
                             int m,
                             int nnz,
                             const cusparseMatDescr_t descrA,
                             cuComplex *csrValA,
                             const int *csrRowPtrA,
                             const int *csrColIndA,
                             csrilu02Info_t info,
                             int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseZcsrilu02_bufferSize(cusparseHandle_t handle,
                             int m,
                             int nnz,
                             const cusparseMatDescr_t descrA,
                             cuDoubleComplex *csrValA,
                             const int *csrRowPtrA,
                             const int *csrColIndA,
                             csrilu02Info_t info,
                             int *pBufferSizeInBytes);

</pre><p class="p">This function returns size of the buffer used in computing the incomplete-LU factorization with 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>0</mn>
                              </math>
                              fill-in and no pivoting:
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                              <samp class="ph codeph">csrColIndA</samp>. 
                           </p>
                           <p class="p"> The buffer size depends on the dimension <samp class="ph codeph">m</samp> and <samp class="ph codeph">nnz</samp>, the number
                              of nonzeros of the matrix. If the user changes the matrix, it is necessary to call
                              <samp class="ph codeph">csrilu02_bufferSize()</samp> again to have the correct buffer size; otherwise, a
                              segmentation fault may occur. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">record internal states based on different algorithms.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in <samp class="ph codeph">csrilu02_analysis()</samp> and
                                          <samp class="ph codeph">csrilu02()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-csrilu02_analysis"><a name="cusparse-lt-t-gt-csrilu02_analysis" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrilu02_analysis" name="cusparse-lt-t-gt-csrilu02_analysis" shape="rect">10.2.5.&nbsp;cusparse&lt;t&gt;csrilu02_analysis()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsrilu02_analysis(cusparseHandle_t handle,
                           int m,
                           int nnz,
                           const cusparseMatDescr_t descrA,
                           const float *csrValA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           csrilu02Info_t info,
                           cusparseSolvePolicy_t policy,
                           void *pBuffer);

cusparseStatus_t 
cusparseDcsrilu02_analysis(cusparseHandle_t handle,
                           int m,
                           int nnz,
                           const cusparseMatDescr_t descrA,
                           const double *csrValA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           csrilu02Info_t info,
                           cusparseSolvePolicy_t policy,
                           void *pBuffer);

cusparseStatus_t 
cusparseCcsrilu02_analysis(cusparseHandle_t handle,
                           int m,
                           int nnz,
                           const cusparseMatDescr_t descrA,
                           const cuComplex *csrValA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           csrilu02Info_t info,
                           cusparseSolvePolicy_t policy,
                           void *pBuffer);

cusparseStatus_t 
cusparseZcsrilu02_analysis(cusparseHandle_t handle,
                           int m,
                           int nnz,
                           const cusparseMatDescr_t descrA,
                           const cuDoubleComplex *csrValA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           csrilu02Info_t info,
                           cusparseSolvePolicy_t policy,
                           void *pBuffer);

</pre><p class="p">This function performs the analysis phase of the incomplete-LU factorization with 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>0</mn>
                              </math>
                              fill-in and no pivoting:
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>,
                              <samp class="ph codeph">csrRowPtrA</samp>, and <samp class="ph codeph">csrColIndA</samp>. 
                           </p>
                           <p class="p">This function requires the buffer size returned by <samp class="ph codeph">csrilu02_bufferSize()</samp>. The
                              address of <samp class="ph codeph">pBuffer</samp> must be a multiple of 128 bytes. If not,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">csrilu02_analysis()</samp> reports a structural zero and computes level
                              information stored in the opaque structure <samp class="ph codeph">info</samp>. The level
                              information can extract more parallelism during incomplete LU factorization;
                              however <samp class="ph codeph">csrilu02()</samp> can be done without level information.
                              To disable level information, the user must specify the policy of
                              <samp class="ph codeph">csrilu02()</samp> as
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. 
                           </p>
                           <p class="p">It is the user's choice whether to call <samp class="ph codeph">csrilu02()</samp> if
                              <samp class="ph codeph">csrilu02_analysis()</samp> reports a structural zero. In
                              this case, the user can still call <samp class="ph codeph">csrilu02()</samp>, which will
                              return a numerical zero at the same position as the structural zero. However
                              the result is meaningless. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateCsrilu02Info()</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                          <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is returned by
                                          <samp class="ph codeph">csrilu02_bufferSize()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure filled with information collected during the analysis phase (that should be passed to the solve phase unchanged).</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-csrilu02_solve"><a name="cusparse-lt-t-gt-csrilu02_solve" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrilu02_solve" name="cusparse-lt-t-gt-csrilu02_solve" shape="rect">10.2.6.&nbsp;cusparse&lt;t&gt;csrilu02()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsrilu02(cusparseHandle_t handle,
                  int m,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  float *csrValA_valM,
                  const int *csrRowPtrA,
                  const int *csrColIndA,
                  csrilu02Info_t info,
                  cusparseSolvePolicy_t policy,
                  void *pBuffer);

cusparseStatus_t 
cusparseDcsrilu02(cusparseHandle_t handle,
                  int m,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  double *csrValA_valM,
                  const int *csrRowPtrA,
                  const int *csrColIndA,
                  csrilu02Info_t info,
                  cusparseSolvePolicy_t policy,
                  void *pBuffer);

cusparseStatus_t 
cusparseCcsrilu02(cusparseHandle_t handle,
                  int m,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  cuComplex *csrValA_valM,
                  const int *csrRowPtrA,
                  const int *csrColIndA,
                  csrilu02Info_t info,
                  cusparseSolvePolicy_t policy,
                  void *pBuffer);

cusparseStatus_t 
cusparseZcsrilu02(cusparseHandle_t handle,
                  int m,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  cuDoubleComplex *csrValA_valM,
                  const int *csrRowPtrA,
                  const int *csrColIndA,
                  csrilu02Info_t info,
                  cusparseSolvePolicy_t policy,
                  void *pBuffer);
</pre><p class="p">This function performs the solve phase of the incomplete-LU factorization with 
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mn>0</mn>
                              </math>
                              fill-in and no pivoting:
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA_valM</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                              <samp class="ph codeph">csrColIndA</samp>. 
                           </p>
                           <p class="p">This function requires a buffer size returned by <samp class="ph codeph">csrilu02_bufferSize()</samp>. The
                              address of <samp class="ph codeph">pBuffer</samp> must be a multiple of 128 bytes. If not,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           </p>
                           <p class="p">The matrix type must be <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. The fill mode and diagonal
                              type are ignored. 
                           </p>
                           <p class="p">Although <samp class="ph codeph">csrilu02()</samp> can be done without level information, the user still needs
                              to be aware of consistency. If <samp class="ph codeph">csrilu02_analysis()</samp> is called with policy
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>, <samp class="ph codeph">csrilu02()</samp> can be run with or
                              without levels. On the other hand, if <samp class="ph codeph">csrilu02_analysis()</samp> is called with
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>, <samp class="ph codeph">csrilu02()</samp> can only accept
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>; otherwise,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">csrilu02()</samp> reports the first numerical zero, including a structural
                              zero. The user must call <samp class="ph codeph">cusparseXcsrilu02_zeroPivot()</samp> to know where the numerical
                              zero is. 
                           </p>
                           <p class="p">For example, suppose <samp class="ph codeph">A</samp> is a real <samp class="ph codeph">m × m</samp> matrix, the following
                              code solves precondition system <samp class="ph codeph">M*y = x</samp> where <samp class="ph codeph">M</samp> is the product of
                              LU factors <samp class="ph codeph">L</samp> and <samp class="ph codeph">U</samp>. 
                           </p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Suppose that A is m x m sparse matrix represented by CSR format, </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Assumption:</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - handle is already created by cusparseCreate(),</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - (d_csrRowPtr, d_csrColInd, d_csrVal) is CSR of A on device memory,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_x is right hand side vector on device memory,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_y is solution vector on device memory.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_z is intermediate result on device memory.</span>

cusparseMatDescr_t descr_M = 0;
cusparseMatDescr_t descr_L = 0;
cusparseMatDescr_t descr_U = 0;
csrilu02Info_t info_M  = 0;
csrsv2Info_t  info_L  = 0;
csrsv2Info_t  info_U  = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize_M;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize_L;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize_U;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *pBuffer = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> structural_zero;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> numerical_zero;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> alpha = 1.;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy_M = CUSPARSE_SOLVE_POLICY_NO_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy_L = CUSPARSE_SOLVE_POLICY_NO_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy_U = CUSPARSE_SOLVE_POLICY_USE_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseOperation_t trans_L  = CUSPARSE_OPERATION_NON_TRANSPOSE;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseOperation_t trans_U  = CUSPARSE_OPERATION_NON_TRANSPOSE;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create a descriptor which contains</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix M is base-1</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L is base-1</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L is lower triangular</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L has unit diagonal </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix U is base-1</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix U is upper triangular</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix U has non-unit diagonal</span>
cusparseCreateMatDescr(&amp;descr_M);
cusparseSetMatIndexBase(descr_M, CUSPARSE_INDEX_BASE_ONE);
cusparseSetMatType(descr_M, CUSPARSE_MATRIX_TYPE_GENERAL);

cusparseCreateMatDescr(&amp;descr_L);
cusparseSetMatIndexBase(descr_L, CUSPARSE_INDEX_BASE_ONE);
cusparseSetMatType(descr_L, CUSPARSE_MATRIX_TYPE_GENERAL);
cusparseSetMatFillMode(descr_L, CUSPARSE_FILL_MODE_LOWER);
cusparseSetMatDiagType(descr_L, CUSPARSE_DIAG_TYPE_UNIT);

cusparseCreateMatDescr(&amp;descr_U);
cusparseSetMatIndexBase(descr_U, CUSPARSE_INDEX_BASE_ONE);
cusparseSetMatType(descr_U, CUSPARSE_MATRIX_TYPE_GENERAL);
cusparseSetMatFillMode(descr_U, CUSPARSE_FILL_MODE_UPPER);
cusparseSetMatDiagType(descr_U, CUSPARSE_DIAG_TYPE_NON_UNIT);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: create a empty info structure</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// we need one info for csrilu02 and two info's for csrsv2</span>
cusparseCreateCsrilu02Info(&amp;info_M);
cusparseCreateCsrsv2Info(&amp;info_L);
cusparseCreateCsrsv2Info(&amp;info_U);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query how much memory used in csrilu02 and csrsv2, and allocate the buffer</span>
cusparseDcsrilu02_bufferSize(handle, m, nnz,
    descr_M, d_csrVal, d_csrRowPtr, d_csrColInd, info_M, &amp;pBufferSize_M);
cusparseDcsrsv2_bufferSize(handle, trans_L, m, nnz, 
    descr_L, d_csrVal, d_csrRowPtr, d_csrColInd, info_L, &amp;pBufferSize_L);
cusparseDcsrsv2_bufferSize(handle, trans_U, m, nnz, 
    descr_U, d_csrVal, d_csrRowPtr, d_csrColInd, info_U, &amp;pBufferSize_U);

pBufferSize = max(pBufferSize_M, max(pBufferSize_L, pBufferSize_U));

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// pBuffer returned by cudaMalloc is automatically aligned to 128 bytes.</span>
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;pBuffer, pBufferSize);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: perform analysis of incomplete Cholesky on M</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//         perform analysis of triangular solve on L</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//         perform analysis of triangular solve on U </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// The lower(upper) triangular part of M has the same sparsity pattern as L(U), </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// we can do analysis of csrilu0 and csrsv2 simultaneously.</span>

cusparseDcsrilu02_analysis(handle, m, nnz, descr_M,
    d_csrVal, d_csrRowPtr, d_csrColInd, info_M, 
    policy_M, pBuffer);
status = cusparseXcsrilu02_zeroPivot(handle, info_M, &amp;structural_zero);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (CUSPARSE_STATUS_ZERO_PIVOT == status){
   printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A(%d,%d) is missing\n"</span>, structural_zero, structural_zero);
}

cusparseDcsrsv2_analysis(handle, trans_L, m, nnz, descr_L, 
    d_csrVal, d_csrRowPtr, d_csrColInd,
    info_L, policy_L, pBuffer);

cusparseDcsrsv2_analysis(handle, trans_U, m, nnz, descr_U, 
    d_csrVal, d_csrRowPtr, d_csrColInd,
    info_U, policy_U, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: M = L * U</span>
cusparseDcsrilu02(handle, m, nnz, descr_M,
    d_csrVal, d_csrRowPtr, d_csrColInd, info_M, policy_M, pBuffer);
status = cusparseXcsrilu02_zeroPivot(handle, info_M, &amp;numerical_zero);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (CUSPARSE_STATUS_ZERO_PIVOT == status){
   printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"U(%d,%d) is zero\n"</span>, numerical_zero, numerical_zero);
}
 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: solve L*z = x</span>
cusparseDcsrsv2_solve(handle, trans_L, m, nnz, &amp;alpha, descr_L,
   d_csrVal, d_csrRowPtr, d_csrColInd, info_L,
   d_x, d_z, policy_L, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 7: solve U*y = z</span>
cusparseDcsrsv2_solve(handle, trans_U, m, nnz, &amp;alpha, descr_U,
   d_csrVal, d_csrRowPtr, d_csrColInd, info_U,
   d_z, d_y, policy_U, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: free resources</span>
cudaFree(pBuffer);
cusparseDestroyMatDescr(descr_M);
cusparseDestroyMatDescr(descr_L);
cusparseDestroyMatDescr(descr_U);
cusparseDestroyCsrilu02Info(info_M);
cusparseDestroyCsrsv2Info(info_L);
cusparseDestroyCsrsv2Info(info_U);
cusparseDestroy(handle);</pre><div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA_valM</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase (that should have been passed to the solve phase unchanged).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                          <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                          <samp class="ph codeph">csrilu02_bufferSize()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA_valM</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; matrix containing the incomplete-LU lower and upper triangular factors.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-csrilu02_zeroPivot"><a name="cusparse-lt-t-gt-csrilu02_zeroPivot" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrilu02_zeroPivot" name="cusparse-lt-t-gt-csrilu02_zeroPivot" shape="rect">cusparseXcsrilu02_zeroPivot()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseXcsrilu02_zeroPivot(cusparseHandle_t handle,
                            csrilu02Info_t info,
                            int *position);</pre><p class="p"> If the returned error code is <samp class="ph codeph">CUSPARSE_STATUS_ZERO_PIVOT</samp>,
                              <samp class="ph codeph">position=j</samp> means <samp class="ph codeph">A(j,j)</samp> has either a structural zero or a
                              numerical zero; otherwise, <samp class="ph codeph">position=-1</samp>. 
                           </p>
                           <p class="p">The <samp class="ph codeph">position</samp> can be 0-based or 1-based, the same as the matrix. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">cusparseXcsrilu02_zeroPivot()</samp> is a blocking call. It calls
                              <samp class="ph codeph">cudaDeviceSynchronize(</samp>) to make sure all previous kernels are done. 
                           </p>
                           <p class="p">The <samp class="ph codeph">position</samp> can be in the host memory or device memory. The user can set proper
                              mode with <samp class="ph codeph">cusparseSetPointerMode()</samp>. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> contains structural zero or numerical zero if the user already
                                          called <samp class="ph codeph">csrilu02_analysis()</samp> or <samp class="ph codeph">csrilu02()</samp>. 
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">position</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">if no structural or numerical zero, <samp class="ph codeph">position</samp> is -1; otherwise if
                                          <samp class="ph codeph">A(j,j)</samp> is missing or <samp class="ph codeph">U(j,j)</samp> is zero, <samp class="ph codeph">position=j</samp>. 
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> is not valid.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-bsrilu02_numericBoost"><a name="cusparse-lt-t-gt-bsrilu02_numericBoost" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrilu02_numericBoost" name="cusparse-lt-t-gt-bsrilu02_numericBoost" shape="rect">cusparse&lt;t&gt;bsrilu02_numericBoost()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsrilu02_numericBoost(cusparseHandle_t handle,
                               bsrilu02Info_t info,
                               int enable_boost,
                               double *tol,
                               float *boost_val);

cusparseStatus_t 
cusparseDbsrilu02_numericBoost(cusparseHandle_t handle,
                               bsrilu02Info_t info,
                               int enable_boost,
                               double *tol,
                               double *boost_val);

cusparseStatus_t 
cusparseCbsrilu02_numericBoost(cusparseHandle_t handle,
                               bsrilu02Info_t info,
                               int enable_boost,
                               double *tol,
                               cuComplex *boost_val);

cusparseStatus_t 
cusparseZbsrilu02_numericBoost(cusparseHandle_t handle,
                               bsrilu02Info_t info,
                               int enable_boost,
                               double *tol,
                               cuDoubleComplex *boost_val);

</pre><p class="p"> The user can use a boost value to replace a numerical value in incomplete LU factorization.
                              Parameter <samp class="ph codeph">tol</samp> is used to determine a numerical zero, and
                              <samp class="ph codeph">boost_val</samp> is used to replace a numerical zero. The
                              behavior is as follows:
                           </p>
                           <p class="p">
                              if <samp class="ph codeph">tol &gt;= fabs(A(j,j))</samp>, then reset each diagonal element of block <samp class="ph codeph">A(j,j)</samp> by <samp class="ph codeph">boost_val</samp>.
                              
                           </p>
                           <p class="p">To enable a boost value, the user sets parameter <samp class="ph codeph">enable_boost</samp> to 1 before
                              calling <samp class="ph codeph">bsrilu02()</samp>. To disable the boost value, the user
                              can call <samp class="ph codeph">bsrilu02_numericBoost()</samp> with parameter
                              <samp class="ph codeph">enable_boost=0</samp>. 
                           </p>
                           <p class="p">If <samp class="ph codeph">enable_boost=0</samp>, <samp class="ph codeph">tol</samp> and <samp class="ph codeph">boost_val</samp> are
                              ignored. 
                           </p>
                           <p class="p">Both <samp class="ph codeph">tol</samp> and <samp class="ph codeph">boost_val</samp> can be in host memory or device memory.
                              The user can set the proper mode with
                              <samp class="ph codeph">cusparseSetPointerMode()</samp>. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateBsrilu02Info()</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">enable_boost</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">disable boost by setting <samp class="ph codeph">enable_boost=0</samp>. Otherwise, boost is
                                          enabled.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">tol</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">tolerance to determine a numerical zero.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">boost_val</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">boost value to replace a numerical zero.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> or pointer mode is not valid.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-bsrilu02_bufferSize"><a name="cusparse-lt-t-gt-bsrilu02_bufferSize" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrilu02_bufferSize" name="cusparse-lt-t-gt-bsrilu02_bufferSize" shape="rect">10.2.9.&nbsp;cusparse&lt;t&gt;bsrilu02_bufferSize()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsrilu02_bufferSize(cusparseHandle_t handle,
                             cusparseDirection_t dirA,
                             int mb,
                             int nnzb,
                             const cusparseMatDescr_t descrA,
                             float *bsrValA,
                             const int *bsrRowPtrA,
                             const int *bsrColIndA,
                             int blockDim,
                             bsrilu02Info_t info,
                             int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseDbsrilu02_bufferSize(cusparseHandle_t handle,
                             cusparseDirection_t dirA,
                             int mb,
                             int nnzb,
                             const cusparseMatDescr_t descrA,
                             double *bsrValA,
                             const int *bsrRowPtrA,
                             const int *bsrColIndA,
                             int blockDim,
                             bsrilu02Info_t info,
                             int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseCbsrilu02_bufferSize(cusparseHandle_t handle,
                             cusparseDirection_t dirA,
                             int mb,
                             int nnzb,
                             const cusparseMatDescr_t descrA,
                             cuComplex *bsrValA,
                             const int *bsrRowPtrA,
                             const int *bsrColIndA,
                             int blockDim,
                             bsrilu02Info_t info,
                             int *pBufferSizeInBytes);

cusparseStatus_t 
cusparseZbsrilu02_bufferSize(cusparseHandle_t handle,
                             cusparseDirection_t dirA,
                             int mb,
                             int nnzb,
                             const cusparseMatDescr_t descrA,
                             cuDoubleComplex *bsrValA,
                             const int *bsrRowPtrA,
                             const int *bsrColIndA,
                             int blockDim,
                             bsrilu02Info_t info,
                             int *pBufferSizeInBytes);

</pre><p class="p">This function returns the size of the buffer used in computing the incomplete-LU factorization
                              with 0 fill-in and no pivoting
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(mb*blockDim)*(mb*blockDim)</samp> sparse matrix that is
                              defined in BSR storage format by the three arrays <samp class="ph codeph">bsrValA</samp>,
                              <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>. 
                           </p>
                           <p class="p"> The buffer size depends on the dimensions of <samp class="ph codeph">mb</samp>, <samp class="ph codeph">blockDim</samp>, and
                              the number of nonzero blocks of the matrix <samp class="ph codeph">nnzb</samp>. If the
                              user changes the matrix, it is necessary to call
                              <samp class="ph codeph">bsrilu02_bufferSize()</samp> again to have the correct
                              buffer size; otherwise, a segmentation fault may occur. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either
                                          <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                          <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every block row and the end of the last block row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix A, larger than zero.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">record internal states based on different algorithms.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in <samp class="ph codeph">bsrilu02_analysis()</samp> and
                                          <samp class="ph codeph">bsrilu02()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb,nnzb&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-bsrilu02_analysis"><a name="cusparse-lt-t-gt-bsrilu02_analysis" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrilu02_analysis" name="cusparse-lt-t-gt-bsrilu02_analysis" shape="rect">10.2.10.&nbsp;cusparse&lt;t&gt;bsrilu02_analysis()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsrilu02_analysis(cusparseHandle_t handle,
                           cusparseDirection_t dirA,
                           int mb,
                           int nnzb,
                           const cusparseMatDescr_t descrA,
                           float *bsrValA,
                           const int *bsrRowPtrA,
                           const int *bsrColIndA,
                           int blockDim,
                           bsrilu02Info_t info,
                           cusparseSolvePolicy_t policy,
                           void *pBuffer);

cusparseStatus_t 
cusparseDbsrilu02_analysis(cusparseHandle_t handle,
                           cusparseDirection_t dirA,
                           int mb,
                           int nnzb,
                           const cusparseMatDescr_t descrA,
                           double *bsrValA,
                           const int *bsrRowPtrA,
                           const int *bsrColIndA,
                           int blockDim,
                           bsrilu02Info_t info,
                           cusparseSolvePolicy_t policy,
                           void *pBuffer);

cusparseStatus_t 
cusparseCbsrilu02_analysis(cusparseHandle_t handle,
                           cusparseDirection_t dirA,
                           int mb,
                           int nnzb,
                           const cusparseMatDescr_t descrA,
                           cuComplex *bsrValA,
                           const int *bsrRowPtrA,
                           const int *bsrColIndA,
                           int blockDim,
                           bsrilu02Info_t info,
                           cusparseSolvePolicy_t policy,
                           void *pBuffer);

cusparseStatus_t 
cusparseZbsrilu02_analysis(cusparseHandle_t handle,
                           cusparseDirection_t dirA,
                           int mb,
                           int nnzb,
                           const cusparseMatDescr_t descrA,
                           cuDoubleComplex *bsrValA,
                           const int *bsrRowPtrA,
                           const int *bsrColIndA,
                           int blockDim,
                           bsrilu02Info_t info,
                           cusparseSolvePolicy_t policy,
                           void *pBuffer);

</pre><p class="p">This function performs the analysis phase of the incomplete-LU factorization with 0 fill-in and no pivoting</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(mb*blockDim)×(mb*blockDim)</samp> sparse matrix that is
                              defined in BSR storage format by the three arrays <samp class="ph codeph">bsrValA</samp>,
                              <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>. The
                              block in BSR format is of size <samp class="ph codeph">blockDim*blockDim</samp>, stored as
                              column-major or row-major as determined by parameter <samp class="ph codeph">dirA</samp>,
                              which is either <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp> or
                              <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp>. The matrix type must be
                              <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, and the fill mode and
                              diagonal type are ignored. 
                           </p>
                           <p class="p">This function requires a buffer size returned by <samp class="ph codeph">bsrilu02_bufferSize()</samp>. The
                              address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is
                              not, <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">bsrilu02_analysis()</samp> reports a structural zero and computes level
                              information stored in the opaque structure <samp class="ph codeph">info</samp>. The level
                              information can extract more parallelism during incomplete LU factorization.
                              However <samp class="ph codeph">bsrilu02()</samp> can be done without level information.
                              To disable level information, the user needs to specify the parameter
                              <samp class="ph codeph">policy</samp> of <samp class="ph codeph">bsrilu02[_analysis| ]</samp> as
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">bsrilu02_analysis()</samp> always reports the first structural zero, even with
                              parameter <samp class="ph codeph">policy</samp> is
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>. The user must call
                              <samp class="ph codeph">cusparseXbsrilu02_zeroPivot()</samp> to know where the
                              structural zero is. 
                           </p>
                           <p class="p">It is the user's choice whether to call <samp class="ph codeph">bsrilu02()</samp> if
                              <samp class="ph codeph">bsrilu02_analysis()</samp> reports a structural zero. In
                              this case, the user can still call <samp class="ph codeph">bsrilu02()</samp>, which will
                              return a numerical zero at the same position as the structural zero. However
                              the result is meaningless. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either
                                          <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                          <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows and block columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every block row and the end of the last block row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix A, larger than zero.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure initialized using <samp class="ph codeph">cusparseCreateBsrilu02Info()</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                          <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is returned by
                                          <samp class="ph codeph">bsrilu02_bufferSize()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure filled with information collected during the analysis phase (that should be passed to the solve phase unchanged).</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb,nnzb&lt;=0</samp>); the base index is
                                          not 0 or 1. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-bsrilu02"><a name="cusparse-lt-t-gt-bsrilu02" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrilu02" name="cusparse-lt-t-gt-bsrilu02" shape="rect">cusparse&lt;t&gt;bsrilu02()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSbsrilu02(cusparseHandle_t handle,
                  cusparseDirection_t dirA,
                  int mb,
                  int nnzb,
                  const cusparseMatDescr_t descry,
                  float *bsrValA,
                  const int *bsrRowPtrA,
                  const int *bsrColIndA,
                  int blockDim,
                  bsrilu02Info_t info,
                  cusparseSolvePolicy_t policy,
                  void *pBuffer);

cusparseStatus_t 
cusparseDbsrilu02(cusparseHandle_t handle,
                  cusparseDirection_t dirA,
                  int mb,
                  int nnzb,
                  const cusparseMatDescr_t descry,
                  double *bsrValA,
                  const int *bsrRowPtrA,
                  const int *bsrColIndA,
                  int blockDim,
                  bsrilu02Info_t info,
                  cusparseSolvePolicy_t policy,
                  void *pBuffer);

cusparseStatus_t 
cusparseCbsrilu02(cusparseHandle_t handle,
                  cusparseDirection_t dirA,
                  int mb,
                  int nnzb,
                  const cusparseMatDescr_t descry,
                  cuComplex *bsrValA,
                  const int *bsrRowPtrA,
                  const int *bsrColIndA,
                  int blockDim,
                  bsrilu02Info_t info,
                  cusparseSolvePolicy_t policy,
                  void *pBuffer);

cusparseStatus_t 
cusparseZbsrilu02(cusparseHandle_t handle,
                  cusparseDirection_t dirA,
                  int mb,
                  int nnzb,
                  const cusparseMatDescr_t descry,
                  cuDoubleComplex *bsrValA,
                  const int *bsrRowPtrA,
                  const int *bsrColIndA,
                  int blockDim,
                  bsrilu02Info_t info,
                  cusparseSolvePolicy_t policy,
                  void *pBuffer);

</pre><p class="p">This function performs the solve phase of the incomplete-LU factorization with 0 fill-in and no pivoting</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>≈</mo>
                                             <mi>L</mi>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">(mb*blockDim)×(mb*blockDim)</samp> sparse matrix that is
                              defined in BSR storage format by the three arrays <samp class="ph codeph">bsrValA</samp>,
                              <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>. The block in BSR format is of size
                              <samp class="ph codeph">blockDim*blockDim</samp>, stored as column-major or row-major determined by parameter
                              <samp class="ph codeph">dirA</samp>, which is either <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp> or
                              <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp>. The matrix type must be
                              <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>, and the fill mode and diagonal type are ignored.
                              Function <samp class="ph codeph">bsrilu02()</samp> supports an arbitrary <samp class="ph codeph">blockDim</samp>. 
                           </p>
                           <p class="p">This function requires a buffer size returned by <samp class="ph codeph">bsrilu02_bufferSize()</samp>. The
                              address of <samp class="ph codeph">pBuffer</samp> must be a multiple of 128 bytes. If it is not,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           </p>
                           <p class="p">Although <samp class="ph codeph">bsrilu02()</samp> can be used without level information, the user must be
                              aware of consistency. If <samp class="ph codeph">bsrilu02_analysis()</samp> is called with policy
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>, <samp class="ph codeph">bsrilu02()</samp> can be run with or
                              without levels. On the other hand, if <samp class="ph codeph">bsrilu02_analysis()</samp> is called with
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>, <samp class="ph codeph">bsrilu02()</samp> can only accept
                              <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp>; otherwise,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">bsrilu02()</samp> has the same behavior as <samp class="ph codeph">csrilu02()</samp>. That
                              is, <samp class="ph codeph">bsr2csr(bsrilu02(A)) = csrilu02(bsr2csr(A))</samp>. The numerical zero of
                              <samp class="ph codeph">csrilu02()</samp> means there exists some zero <samp class="ph codeph">U(j,j)</samp>. The numerical zero
                              of <samp class="ph codeph">bsrilu02()</samp> means there exists some block <samp class="ph codeph">U(j,j)</samp> that is not
                              invertible. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">bsrilu02</samp> reports the first numerical zero, including a structural zero.
                              The user must call <samp class="ph codeph">cusparseXbsrilu02_zeroPivot()</samp> to know where the numerical zero
                              is. 
                           </p>
                           <p class="p">For example, suppose <samp class="ph codeph">A</samp> is a real m-by-m matrix where
                              <samp class="ph codeph">m=mb*blockDim</samp>. The following code solves precondition system <samp class="ph codeph">M*y =
                                 x</samp>, where <samp class="ph codeph">M</samp> is the product of LU factors <samp class="ph codeph">L</samp> and
                              <samp class="ph codeph">U</samp>. 
                           </p><pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Suppose that A is m x m sparse matrix represented by BSR format, </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// The number of block rows/columns is mb, and </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// the number of nonzero blocks is nnzb.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Assumption:</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - handle is already created by cusparseCreate(),</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - (d_bsrRowPtr, d_bsrColInd, d_bsrVal) is BSR of A on device memory,</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_x is right hand side vector on device memory.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_y is solution vector on device memory.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_z is intermediate result on device memory.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - d_x, d_y and d_z are of size m.</span>
cusparseMatDescr_t descr_M = 0;
cusparseMatDescr_t descr_L = 0;
cusparseMatDescr_t descr_U = 0;
bsrilu02Info_t info_M = 0;
bsrsv2Info_t   info_L = 0;
bsrsv2Info_t   info_U = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize_M;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize_L;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize_U;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pBufferSize;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *pBuffer = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> structural_zero;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> numerical_zero;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> alpha = 1.;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy_M = CUSPARSE_SOLVE_POLICY_NO_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy_L = CUSPARSE_SOLVE_POLICY_NO_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy_U = CUSPARSE_SOLVE_POLICY_USE_LEVEL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseOperation_t trans_L  = CUSPARSE_OPERATION_NON_TRANSPOSE;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseOperation_t trans_U  = CUSPARSE_OPERATION_NON_TRANSPOSE;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseDirection_t dir = CUSPARSE_DIRECTION_COLUMN;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create a descriptor which contains</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix M is base-1</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L is base-1</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L is lower triangular</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix L has unit diagonal </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix U is base-1</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix U is upper triangular</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// - matrix U has non-unit diagonal</span>
cusparseCreateMatDescr(&amp;descr_M);
cusparseSetMatIndexBase(descr_M, CUSPARSE_INDEX_BASE_ONE);
cusparseSetMatType(descr_M, CUSPARSE_MATRIX_TYPE_GENERAL);

cusparseCreateMatDescr(&amp;descr_L);
cusparseSetMatIndexBase(descr_L, CUSPARSE_INDEX_BASE_ONE);
cusparseSetMatType(descr_L, CUSPARSE_MATRIX_TYPE_GENERAL);
cusparseSetMatFillMode(descr_L, CUSPARSE_FILL_MODE_LOWER);
cusparseSetMatDiagType(descr_L, CUSPARSE_DIAG_TYPE_UNIT);

cusparseCreateMatDescr(&amp;descr_U);
cusparseSetMatIndexBase(descr_U, CUSPARSE_INDEX_BASE_ONE);
cusparseSetMatType(descr_U, CUSPARSE_MATRIX_TYPE_GENERAL);
cusparseSetMatFillMode(descr_U, CUSPARSE_FILL_MODE_UPPER);
cusparseSetMatDiagType(descr_U, CUSPARSE_DIAG_TYPE_NON_UNIT);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: create a empty info structure</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// we need one info for bsrilu02 and two info's for bsrsv2</span>
cusparseCreateBsrilu02Info(&amp;info_M);
cusparseCreateBsrsv2Info(&amp;info_L);
cusparseCreateBsrsv2Info(&amp;info_U);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query how much memory used in bsrilu02 and bsrsv2, and allocate the buffer</span>
cusparseDbsrilu02_bufferSize(handle, dir, mb, nnzb,
    descr_M, d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_M, &amp;pBufferSize_M);
cusparseDbsrsv2_bufferSize(handle, dir, trans_L, mb, nnzb, 
    descr_L, d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_L, &amp;pBufferSize_L);
cusparseDbsrsv2_bufferSize(handle, dir, trans_U, mb, nnzb, 
    descr_U, d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_U, &amp;pBufferSize_U);

pBufferSize = max(pBufferSize_M, max(pBufferSize_L, pBufferSize_U));

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// pBuffer returned by cudaMalloc is automatically aligned to 128 bytes.</span>
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;pBuffer, pBufferSize);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: perform analysis of incomplete LU factorization on M</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//         perform analysis of triangular solve on L</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//         perform analysis of triangular solve on U </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// The lower(upper) triangular part of M has the same sparsity pattern as L(U), </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// we can do analysis of bsrilu0 and bsrsv2 simultaneously.</span>

cusparseDbsrilu02_analysis(handle, dir, mb, nnzb, descr_M,
    d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_M, 
    policy_M, pBuffer);
status = cusparseXbsrilu02_zeroPivot(handle, info_M, &amp;structural_zero);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (CUSPARSE_STATUS_ZERO_PIVOT == statuss){
   printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A(%d,%d) is missing\n"</span>, structural_zero, structural_zero);
}

cusparseDbsrsv2_analysis(handle, dir, trans_L, mb, nnzb, descr_L, 
    d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>,
    info_L, policy_L, pBuffer);

cusparseDbsrsv2_analysis(handle, dir, trans_U, mb, nnzb, descr_U, 
    d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>,
    info_U, policy_U, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: M = L * U</span>
cusparseDbsrilu02(handle, dir, mb, nnzb, descr_M,
    d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_M, policy_M, pBuffer);
status = cusparseXbsrilu02_zeroPivot(handle, info_M, &amp;numerical_zero);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (CUSPARSE_STATUS_ZERO_PIVOT == statuss){
   printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"block U(%d,%d) is not invertible\n"</span>, numerical_zero, numerical_zero);
}
 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: solve L*z = x</span>
cusparseDbsrsv2_solve(handle, dir, trans_L, mb, nnzb, &amp;alpha, descr_L,
   d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_L,
   d_x, d_z, policy_L, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 7: solve U*y = z</span>
cusparseDbsrsv2_solve(handle, dir, trans_U, mb, nnzb, &amp;alpha, descr_U,
   d_bsrVal, d_bsrRowPtr, d_bsrColInd, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>, info_U,
   d_z, d_y, policy_U, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: free resources</span>
cudaFree(pBuffer);
cusparseDestroyMatDescr(descr_M);
cusparseDestroyMatDescr(descr_L);
cusparseDestroyMatDescr(descr_U);
cusparseDestroyBsrilu02Info(info_M);
cusparseDestroyBsrsv2Info(info_L);
cusparseDestroyBsrsv2Info(info_U);
cusparseDestroy(handle);
</pre><div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks: either <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or
                                          <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows and block columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every block row and the end of the last block row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnzb</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(mb)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">bsrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix A; must be larger than zero.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information collected during the analysis phase (that should have been passed to the solve phase unchanged).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">policy</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the supported policies are <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_NO_LEVEL</samp> and
                                          <samp class="ph codeph">CUSPARSE_SOLVE_POLICY_USE_LEVEL</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                          <samp class="ph codeph">bsrilu02_bufferSize()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; matrix containing the incomplete-LU lower and upper triangular factors.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb,nnzb&lt;=0</samp>); the base index is
                                          not 0 or 1. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-bsrilu02_zeroPivot"><a name="cusparse-lt-t-gt-bsrilu02_zeroPivot" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsrilu02_zeroPivot" name="cusparse-lt-t-gt-bsrilu02_zeroPivot" shape="rect">cusparseXbsrilu02_zeroPivot()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseXbsrilu02_zeroPivot(cusparseHandle_t handle,
                            bsrilu02Info_t info,
                            int *position);
</pre><p class="p">If the returned error code is <samp class="ph codeph">CUSPARSE_STATUS_ZERO_PIVOT</samp>,
                              <samp class="ph codeph">position=j</samp> means <samp class="ph codeph">A(j,j)</samp> has either a structural zero or a
                              numerical zero (the block is not invertible). Otherwise <samp class="ph codeph">position=-1</samp>. 
                           </p>
                           <p class="p">The <samp class="ph codeph">position</samp> can be 0-based or 1-based, the same as the matrix. 
                           </p>
                           <p class="p">Function <samp class="ph codeph">cusparseXbsrilu02_zeroPivot()</samp> is a blocking call. It calls
                              <samp class="ph codeph">cudaDeviceSynchronize()</samp> to make sure all previous kernels are done. 
                           </p>
                           <p class="p">The <samp class="ph codeph">position</samp> can be in the host memory or device memory. The user can set proper
                              the mode with <samp class="ph codeph">cusparseSetPointerMode()</samp>. 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> contains structural zero or numerical zero if the user already
                                          called <samp class="ph codeph">bsrilu02_analysis()</samp> or <samp class="ph codeph">bsrilu02()</samp>. 
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">position</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">if no structural or numerical zero, <samp class="ph codeph">position</samp> is -1; otherwise if
                                          <samp class="ph codeph">A(j,j)</samp> is missing or <samp class="ph codeph">U(j,j)</samp> is not invertible,
                                          <samp class="ph codeph">position=j</samp>. 
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp> is not valid.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="gtsv"><a name="gtsv" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#gtsv" name="gtsv" shape="rect">10.3.&nbsp;tridiagonal solve</a></h3>
                     <div class="body conbody">
                        <p class="p">Different algorithms for tridiagonal solve are discussed in this section.</p>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-gtsv"><a name="cusparse-lt-t-gt-gtsv" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gtsv" name="cusparse-lt-t-gt-gtsv" shape="rect">10.3.1.&nbsp;cusparse&lt;t&gt;gtsv()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSgtsv(cusparseHandle_t handle, 
              int m, 
              int n,        
              const float *dl, 
              const float  *d,   
              const float *du, 
              float *B, 
              int ldb)                                
cusparseStatus_t
cusparseDgtsv(cusparseHandle_t handle, 
              int m, 
              int n,       
              const double *dl, 
              const double  *d,   
              const double *du, 
              double *B, 
              int ldb)
cusparseStatus_t 
cusparseCgtsv(cusparseHandle_t handle, 
              int m, 
              int n,       
              const cuComplex *dl, 
              const cuComplex  *d,  
              const cuComplex *du, 
              cuComplex *B, 
              int ldb)
cusparseStatus_t 
cusparseZgtsv(cusparseHandle_t handle, 
              int m, 
              int n,       
              const cuDoubleComplex *dl, 
              const cuDoubleComplex  *d,  
              const cuDoubleComplex *du, 
              cuDoubleComplex *B, 
              int ldb)
</pre><p class="p">This function computes the solution of a tridiagonal linear system with multiple
                              			right-hand sides:
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>∗</mo>
                                             <mi>Y</mi>
                                             <mo>=</mo>
                                             <mi>X</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">The coefficient matrix <samp class="ph codeph">A</samp> of each of these tri-diagonal linear system is defined
                              			with three vectors corresponding to its lower (<samp class="ph codeph">dl</samp>), main
                              				(<samp class="ph codeph">d</samp>), and upper (<samp class="ph codeph">du</samp>) matrix diagonals; the
                              			right-hand sides are stored in the dense matrix <samp class="ph codeph">X</samp>. Notice that solution
                              				<samp class="ph codeph">Y</samp> overwrites right-hand-side matrix <samp class="ph codeph">X</samp> on exit.
                           </p>
                           <p class="p">
                              Assuming <samp class="ph codeph">A</samp> is of size <samp class="ph codeph">m</samp> and base-1,  
                              <samp class="ph codeph">dl</samp>, <samp class="ph codeph">d</samp> and <samp class="ph codeph">du</samp> are defined by the following formula:
                              
                           </p>
                           <p class="p"><samp class="ph codeph">dl(i) := A(i, i-1)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p">
                              The first element of dl is out-of-bound (<samp class="ph codeph">dl(1) := A(1,0)</samp>), so <samp class="ph codeph">dl(1) = 0</samp>.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">d(i) = A(i,i)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p"><samp class="ph codeph">du(i) = A(i,i+1)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p">
                              The last element of du is out-of-bound (<samp class="ph codeph">du(m) := A(m,m+1)</samp>), so <samp class="ph codeph">du(m) = 0</samp>.
                              
                           </p>
                           <p class="p">
                              The routine does perform pivoting, which usually results in more accurate and more stable results
                              than <samp class="ph codeph">cusparse&lt;t&gt;gtsv_nopivot()</samp> at the expense of some execution time 
                              
                           </p>
                           <p class="p">
                              This routine requires significant amount of temporary extra storage (<samp class="ph codeph">min(m,8)
                                 ×(3+n)×sizeof(&lt;type&gt;)</samp>). 
                              The temporary storage is managed by <samp class="ph codeph">cudaMalloc</samp> and <samp class="ph codeph">cudaFree</samp>
                              which stop concurrency.
                              The user can call <samp class="ph codeph">cusparse&lt;t&gt;gtsv2()</samp> which 
                              has no explicit <samp class="ph codeph">cudaMalloc</samp> and <samp class="ph codeph">cudaFree</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the size of the linear system (must be ≥ 3).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of right-hand sides, columns of matrix <samp class="ph codeph">B</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dl</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the lower diagonal of the tri-diagonal linear system. The first element of each lower diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">d</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the main diagonal of the tri-diagonal linear system.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">du</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the upper diagonal of the tri-diagonal linear system. The last element of each upper diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense right-hand-side array of dimensions <samp class="ph codeph">(ldb, n)</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp> (that is ≥ 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo movablelimits="true">max</mo>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mtext>(1, m))</mtext>
                                                </mrow>
                                             </mrow>
                                          </math>
                                          							.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense solution array of dimensions <samp class="ph codeph">(ldb, n)</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;3, n&lt;0</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-gtsv_nopivot"><a name="cusparse-lt-t-gt-gtsv_nopivot" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gtsv_nopivot" name="cusparse-lt-t-gt-gtsv_nopivot" shape="rect">10.3.2.&nbsp;cusparse&lt;t&gt;gtsv_nopivot()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSgtsv_nopivot(cusparseHandle_t handle, int m, int n,        
              const float           *dl, const float            *d,   
              const float           *du, float *B, int ldb)                                
cusparseStatus_t
cusparseDgtsv_nopivot(cusparseHandle_t handle, int m, int n,       
              const double          *dl, const double           *d,   
              const double          *du, double *B, int ldb)
cusparseStatus_t 
cusparseCgtsv_nopivot(cusparseHandle_t handle, int m, int n,       
              const cuComplex       *dl, const cuComplex        *d,  
              const cuComplex       *du, cuComplex       *B, int ldb)
cusparseStatus_t 
cusparseZgtsv_nopivot(cusparseHandle_t handle, int m, int n,       
              const cuDoubleComplex *dl, const cuDoubleComplex  *d,  
              const cuDoubleComplex *du, cuDoubleComplex *B, int ldb)</pre><p class="p">This function computes the solution of a tridiagonal linear system with multiple right-hand
                              			sides:
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>∗</mo>
                                             <mi>Y</mi>
                                             <mo>=</mo>
                                             <mi>X</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">The coefficient matrix <samp class="ph codeph">A</samp> of each of these tri-diagonal linear system is defined
                              			with three vectors corresponding to its lower (<samp class="ph codeph">dl</samp>), main
                              				(<samp class="ph codeph">d</samp>), and upper (<samp class="ph codeph">du</samp>) matrix diagonals; the
                              			right-hand sides are stored in the dense matrix <samp class="ph codeph">X</samp>. Notice that solution
                              				<samp class="ph codeph">Y</samp> overwrites right-hand-side matrix <samp class="ph codeph">X</samp> on exit.
                           </p>
                           <p class="p">The routine does not perform any pivoting and uses a combination of the Cyclic Reduction (CR) and
                              			the Parallel Cyclic Reduction (PCR) algorithms to find the solution. It achieves better
                              			performance when <samp class="ph codeph">m</samp> is a power of 2.
                           </p>
                           <p class="p">
                              This routine requires a significant amount of temporary extra storage
                              (<samp class="ph codeph">m×(3+n)×sizeof(&lt;type&gt;)</samp>). 
                              The temporary storage is managed by <samp class="ph codeph">cudaMalloc</samp> and <samp class="ph codeph">cudaFree</samp>
                              which stop concurrency.
                              The user can call <samp class="ph codeph">cusparse&lt;t&gt;gtsv2_nopivot()</samp> which
                              has no explicit <samp class="ph codeph">cudaMalloc</samp> and <samp class="ph codeph">cudaFree</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the size of the linear system (must be ≥ 3).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of right-hand sides, columns of matrix <samp class="ph codeph">B</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dl</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the lower diagonal of the tri-diagonal linear system. The first element of each lower diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">d</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the main diagonal of the tri-diagonal linear system.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">du</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the upper diagonal of the tri-diagonal linear system. The last element of each upper diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense right-hand-side array of dimensions <samp class="ph codeph">(ldb, n)</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp>. (that is ≥ 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo movablelimits="true">max</mo>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mtext>(1, m))</mtext>
                                                </mrow>
                                             </mrow>
                                          </math>
                                          							.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense solution array of dimensions <samp class="ph codeph">(ldb, n)</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;3, n&lt;0</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-gtsv2_bufferSize"><a name="cusparse-lt-t-gt-gtsv2_bufferSize" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gtsv2_bufferSize" name="cusparse-lt-t-gt-gtsv2_bufferSize" shape="rect">10.3.3.&nbsp;cusparse&lt;t&gt;gtsv2_buffSizeExt()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t cusparseSgtsv2_bufferSizeExt(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const float *dl,  
    const float  *d,    
    const float *du, 
    const float *B,     
    int ldb,
    size_t *bufferSizeInBytes)

cusparseStatus_t cusparseDgtsv2_bufferSizeExt(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const double *dl,  
    const double  *d,    
    const double *du, 
    const double *B,     
    int ldb,
    size_t *bufferSizeInBytes)

cusparseStatus_t cusparseCgtsv2_bufferSizeExt(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const cuComplex *dl,  
    const cuComplex  *d,    
    const cuComplex *du, 
    const cuComplex *B,     
    int ldb,
    size_t *bufferSizeInBytes)

cusparseStatus_t cusparseZgtsv2_bufferSizeExt(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const cuDoubleComplex *dl,  
    const cuDoubleComplex  *d,    
    const cuDoubleComplex *du, 
    const cuDoubleComplex *B,     
    int ldb,
    size_t *bufferSizeInBytes)

</pre><p class="p">
                              This function returns the size of the buffer used in <samp class="ph codeph">gtsv2</samp>
                              which computes the solution of a tridiagonal linear system with multiple
                              right-hand sides.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>∗</mo>
                                             <mi>X</mi>
                                             <mo>=</mo>
                                             <mi>B</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The coefficient matrix <samp class="ph codeph">A</samp> of each of these tri-diagonal linear system is defined
                              with three vectors corresponding to its lower (<samp class="ph codeph">dl</samp>), main
                              (<samp class="ph codeph">d</samp>), and upper (<samp class="ph codeph">du</samp>) matrix diagonals; the
                              right-hand sides are stored in the dense matrix <samp class="ph codeph">B</samp>. Notice that solution
                              <samp class="ph codeph">X</samp> overwrites right-hand-side matrix <samp class="ph codeph">B</samp> on exit.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the size of the linear system (must be ≥ 3).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of right-hand sides, columns of matrix <samp class="ph codeph">B</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dl</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the lower diagonal of the tri-diagonal linear system. The first element of each lower diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">d</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the main diagonal of the tri-diagonal linear system.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">du</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the upper diagonal of the tri-diagonal linear system. The last element of each upper diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense right-hand-side array of dimensions <samp class="ph codeph">(ldb, n)</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp> (that is ≥ 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo movablelimits="true">max</mo>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mtext>(1, m))</mtext>
                                                </mrow>
                                             </mrow>
                                          </math>
                                          							.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in the <samp class="ph codeph">gtsv2</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;3, n&lt;0</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-gtsv2"><a name="cusparse-lt-t-gt-gtsv2" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gtsv2" name="cusparse-lt-t-gt-gtsv2" shape="rect">10.3.4.&nbsp;cusparse&lt;t&gt;gtsv2()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t cusparseSgtsv2(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const float *dl,  
    const float  *d,    
    const float *du, 
    float *B,     
    int ldb,
    void *pBuffer)

cusparseStatus_t cusparseDgtsv2(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const double *dl,  
    const double  *d,    
    const double *du, 
    double *B,     
    int ldb,
    void *pBuffer)

cusparseStatus_t cusparseCgtsv2(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const cuComplex *dl,  
    const cuComplex  *d,    
    const cuComplex *du, 
    cuComplex *B,     
    int ldb,
    void *pBuffer)

cusparseStatus_t cusparseZgtsv2(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const cuDoubleComplex *dl,  
    const cuDoubleComplex  *d,    
    const cuDoubleComplex *du, 
    cuDoubleComplex *B,     
    int ldb,
    void *pBuffer)

</pre><p class="p">
                              This function computes the solution of a tridiagonal linear system with multiple
                              right-hand sides:
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>∗</mo>
                                             <mi>X</mi>
                                             <mo>=</mo>
                                             <mi>B</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The coefficient matrix <samp class="ph codeph">A</samp> of each of these tri-diagonal linear system is defined
                              with three vectors corresponding to its lower (<samp class="ph codeph">dl</samp>), main
                              (<samp class="ph codeph">d</samp>), and upper (<samp class="ph codeph">du</samp>) matrix diagonals; the
                              right-hand sides are stored in the dense matrix <samp class="ph codeph">B</samp>. Notice that solution
                              <samp class="ph codeph">X</samp> overwrites right-hand-side matrix <samp class="ph codeph">B</samp> on exit.
                              
                           </p>
                           <p class="p">
                              Assuming <samp class="ph codeph">A</samp> is of size <samp class="ph codeph">m</samp> and base-1,  
                              <samp class="ph codeph">dl</samp>, <samp class="ph codeph">d</samp> and <samp class="ph codeph">du</samp> are defined by the following formula:
                              
                           </p>
                           <p class="p"><samp class="ph codeph">dl(i) := A(i, i-1)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p">
                              The first element of dl is out-of-bound (<samp class="ph codeph">dl(1) := A(1,0)</samp>), so <samp class="ph codeph">dl(1) = 0</samp>.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">d(i) = A(i,i)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p"><samp class="ph codeph">du(i) = A(i,i+1)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p">
                              The last element of du is out-of-bound (<samp class="ph codeph">du(m) := A(m,m+1)</samp>), so <samp class="ph codeph">du(m) = 0</samp>.
                              
                           </p>
                           <p class="p">
                              The routine does perform pivoting, which usually results in more accurate and more stable results
                              than <samp class="ph codeph">cusparse&lt;t&gt;gtsv_nopivot()</samp> or
                              <samp class="ph codeph">cusparse&lt;t&gt;gtsv2_nopivot()</samp>
                              at the expense of some execution time.
                              
                           </p>
                           <p class="p">
                              This function requires a buffer size returned by <samp class="ph codeph">gtsv2_bufferSizeExt()</samp>. 
                              The address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is not,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the size of the linear system (must be ≥ 3).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of right-hand sides, columns of matrix <samp class="ph codeph">B</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dl</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the lower diagonal of the tri-diagonal linear system. The first element of each lower diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">d</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the main diagonal of the tri-diagonal linear system.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">du</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the upper diagonal of the tri-diagonal linear system. The last element of each upper diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense right-hand-side array of dimensions <samp class="ph codeph">(ldb, n)</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp> (that is ≥ 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo movablelimits="true">max</mo>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mtext>(1, m))</mtext>
                                                </mrow>
                                             </mrow>
                                          </math>
                                          							.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is return by <samp class="ph codeph">gtsv2_bufferSizeExt</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense solution array of dimensions <samp class="ph codeph">(ldb, n)</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;3, n&lt;0</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-gtsv2_nopivot_bufferSize"><a name="cusparse-lt-t-gt-gtsv2_nopivot_bufferSize" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gtsv2_nopivot_bufferSize" name="cusparse-lt-t-gt-gtsv2_nopivot_bufferSize" shape="rect">10.3.5.&nbsp;cusparse&lt;t&gt;gtsv2_nopivot_bufferSizeExt()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t cusparseSgtsv2_nopivot_bufferSizeExt(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const float *dl,  
    const float  *d,    
    const float *du, 
    const float *B,     
    int ldb,
    size_t *bufferSizeInBytes)

cusparseStatus_t cusparseDgtsv2_nopivot_bufferSizeExt(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const double *dl,  
    const double  *d,    
    const double *du, 
    const double *B,     
    int ldb,
    size_t *bufferSizeInBytes)

cusparseStatus_t cusparseCgtsv2_nopivot_bufferSizeExt(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const cuComplex *dl,  
    const cuComplex  *d,    
    const cuComplex *du, 
    const cuComplex *B,     
    int ldb,
    size_t *bufferSizeInBytes)

cusparseStatus_t cusparseZgtsv2_nopivot_bufferSizeExt(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const cuDoubleComplex *dl,  
    const cuDoubleComplex  *d,    
    const cuDoubleComplex *du, 
    const cuDoubleComplex *B,     
    int ldb,
    size_t *bufferSizeInBytes)

</pre><p class="p">
                              This function returns the size of the buffer used in <samp class="ph codeph">gtsv2_nopivot</samp>
                              which computes the solution of a tridiagonal linear system with multiple
                              right-hand sides.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>∗</mo>
                                             <mi>X</mi>
                                             <mo>=</mo>
                                             <mi>B</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The coefficient matrix <samp class="ph codeph">A</samp> of each of these tri-diagonal linear system is defined
                              with three vectors corresponding to its lower (<samp class="ph codeph">dl</samp>), main
                              (<samp class="ph codeph">d</samp>), and upper (<samp class="ph codeph">du</samp>) matrix diagonals; the
                              right-hand sides are stored in the dense matrix <samp class="ph codeph">B</samp>. Notice that solution
                              <samp class="ph codeph">X</samp> overwrites right-hand-side matrix <samp class="ph codeph">B</samp> on exit.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the size of the linear system (must be ≥ 3).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of right-hand sides, columns of matrix <samp class="ph codeph">B</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dl</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the lower diagonal of the tri-diagonal linear system. The first element of each lower diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">d</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the main diagonal of the tri-diagonal linear system.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">du</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the upper diagonal of the tri-diagonal linear system. The last element of each upper diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense right-hand-side array of dimensions <samp class="ph codeph">(ldb, n)</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp>. (that is ≥ 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo movablelimits="true">max</mo>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mtext>(1, m))</mtext>
                                                </mrow>
                                             </mrow>
                                          </math>
                                          							.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in the <samp class="ph codeph">gtsv2_nopivot</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;3, n&lt;0</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-gtsv2_nopivot"><a name="cusparse-lt-t-gt-gtsv2_nopivot" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gtsv2_nopivot" name="cusparse-lt-t-gt-gtsv2_nopivot" shape="rect">10.3.6.&nbsp;cusparse&lt;t&gt;gtsv2_nopivot()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t cusparseSgtsv2_nopivot(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const float *dl,  
    const float  *d,   
    const float *du, 
    float *B,     
    int ldb,
    void* pBuffer)

cusparseStatus_t cusparseDgtsv2_nopivot(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const double *dl,  
    const double  *d,    
    const double *du, 
    double *B,     
    int ldb,
    void* pBuffer)

cusparseStatus_t cusparseCgtsv2_nopivot(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const cuComplex *dl,  
    const cuComplex  *d,    
    const cuComplex *du, 
    cuComplex *B,     
    int ldb,
    void* pBuffer)

cusparseStatus_t cusparseZgtsv2_nopivot(
    cusparseHandle_t handle,
    int m,        
    int n,        
    const cuDoubleComplex *dl,  
    const cuDoubleComplex  *d,    
    const cuDoubleComplex *du, 
    cuDoubleComplex *B,     
    int ldb,
    void* pBuffer)

</pre><p class="p">This function computes the solution of a tridiagonal linear system with multiple right-hand
                              			sides:
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>∗</mo>
                                             <mi>X</mi>
                                             <mo>=</mo>
                                             <mi>B</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The coefficient matrix <samp class="ph codeph">A</samp> of each of these tri-diagonal linear system is defined
                              with three vectors corresponding to its lower (<samp class="ph codeph">dl</samp>), main
                              (<samp class="ph codeph">d</samp>), and upper (<samp class="ph codeph">du</samp>) matrix diagonals; the
                              right-hand sides are stored in the dense matrix <samp class="ph codeph">B</samp>. Notice that solution
                              <samp class="ph codeph">X</samp> overwrites right-hand-side matrix <samp class="ph codeph">B</samp> on exit.
                              
                           </p>
                           <p class="p">
                              The routine does not perform any pivoting and uses a combination of the Cyclic Reduction (CR) and
                              the Parallel Cyclic Reduction (PCR) algorithms to find the solution. It achieves better
                              performance when <samp class="ph codeph">m</samp> is a power of 2.
                              
                           </p>
                           <p class="p">
                              This function requires a buffer size returned by <samp class="ph codeph">gtsv2_nopivot_bufferSizeExt()</samp>.
                              The address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is not,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the size of the linear system (must be ≥ 3).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of right-hand sides, columns of matrix <samp class="ph codeph">B</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dl</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the lower diagonal of the tri-diagonal linear system. The first element of each lower diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">d</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the main diagonal of the tri-diagonal linear system.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">du</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the upper diagonal of the tri-diagonal linear system. The last element of each upper diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense right-hand-side array of dimensions <samp class="ph codeph">(ldb, n)</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">B</samp>. (that is ≥ 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo movablelimits="true">max</mo>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mtext>(1, m))</mtext>
                                                </mrow>
                                             </mrow>
                                          </math>
                                          							.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is return by <samp class="ph codeph">gtsv2_nopivot_bufferSizeExt</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense solution array of dimensions <samp class="ph codeph">(ldb, n)</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;3, n&lt;0</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="batch_gtsv"><a name="batch_gtsv" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#batch_gtsv" name="batch_gtsv" shape="rect">10.4.&nbsp;batched tridiagonal solve</a></h3>
                     <div class="body conbody">
                        <p class="p">Different algorithms for batched tridiagonal solve are discussed in this section.</p>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-gtsvstridedbatch"><a name="cusparse-lt-t-gt-gtsvstridedbatch" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gtsvstridedbatch" name="cusparse-lt-t-gt-gtsvstridedbatch" shape="rect">10.4.1.&nbsp;cusparse&lt;t&gt;gtsvStridedBatch()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSgtsvStridedBatch(cusparseHandle_t handle, int m,              
                          const float           *dl, 
                          const float            *d,   
                          const float           *du, float           *x,    
                          int batchCount, int batchStride)
cusparseStatus_t
cusparseDgtsvStridedBatch(cusparseHandle_t handle, int m,             
                          const double          *dl, 
                          const double           *d,   
                          const double          *du, double          *x,    
                          int batchCount, int batchStride)                                                                 
cusparseStatus_t 
cusparseCgtsvStridedBatch(cusparseHandle_t handle, int m,           
                          const cuComplex       *dl, 
                          const cuComplex        *d,  
                          const cuComplex       *du, cuComplex       *x,     
                          int batchCount, int batchStride)
cusparseStatus_t 
cusparseZgtsvStridedBatch(cusparseHandle_t handle, int m,         
                          const cuDoubleComplex *dl, 
                          const cuDoubleComplex  *d,  
                          const cuDoubleComplex *du, cuDoubleComplex *x,     
                          int batchCount, int batchStride)</pre><p class="p">This function computes the solution of multiple tridiagonal linear systems for
                              				<em class="ph i">i</em>=0,…,<samp class="ph codeph">batchCount</samp>:
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                             <mo>∗</mo>
                                             <msup>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mtext>y</mtext>
                                                   </mrow>
                                                </mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                             <mo>=</mo>
                                             <msup>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mtext>x</mtext>
                                                   </mrow>
                                                </mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">The coefficient matrix <samp class="ph codeph">A</samp> of each of these tri-diagonal linear system is defined
                              			with three vectors corresponding to its lower (<samp class="ph codeph">dl</samp>), main
                              				(<samp class="ph codeph">d</samp>), and upper (<samp class="ph codeph">du</samp>) matrix diagonals; the
                              			right-hand sides are stored in the dense matrix <samp class="ph codeph">X</samp>. Notice that solution
                              				<samp class="ph codeph">Y</samp> overwrites right-hand-side matrix <samp class="ph codeph">X</samp> on exit. The
                              			different matrices are assumed to be of the same size and are stored with a fixed
                              				<samp class="ph codeph">batchStride</samp> in memory.
                           </p>
                           <p class="p">The routine does not perform any pivoting and uses a combination of the Cyclic Reduction (CR) and
                              			the Parallel Cyclic Reduction (PCR) algorithms to find the solution. It achieves better
                              			performance when <samp class="ph codeph">m</samp> is a power of 2.
                           </p>
                           <p class="p">
                              This routine requires a significant amount of temporary extra storage
                              ((<samp class="ph codeph">batchCount×(4×m+2048)×sizeof(&lt;type&gt;)</samp>)).
                              The temporary storage is managed by <samp class="ph codeph">cudaMalloc</samp> and <samp class="ph codeph">cudaFree</samp>
                              which stop concurrency.
                              The user can call <samp class="ph codeph">cusparse&lt;t&gt;gtsv2StridedBatch()</samp> which
                              has no explicit <samp class="ph codeph">cudaMalloc</samp> and <samp class="ph codeph">cudaFree</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the size of the linear system (must be ≥ 3).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dl</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the lower diagonal of the tri-diagonal linear system.
                                          							The lower diagonal 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>d</mi>
                                             <msup>
                                                <mi>l</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">dl+batchStride×i</samp> in
                                          							memory. Also, the first element of each lower diagonal must be
                                          							zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">d</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the main diagonal of the tri-diagonal linear system. The
                                          							main diagonal 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>d</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">d+batchStride×i</samp> in
                                          							memory.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">du</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the upper diagonal of the tri-diagonal linear system.
                                          							The upper diagonal 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>d</mi>
                                             <msup>
                                                <mi>u</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">du+batchStride×i</samp> in
                                          							memory. Also, the last element of each upper diagonal must be
                                          							zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array that contains the right-hand-side of the tri-diagonal linear
                                          							system. The right-hand-side 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>x</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">x+batchStride×i</samp>in
                                          							memory.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">batchCount</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of systems to solve.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">batchStride</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">stride (number of elements) that separates the vectors of every system (must be at least <samp class="ph codeph">m</samp>).
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array that contains the solution of the tri-diagonal linear system. The
                                          							solution 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>x</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">x+batchStride×i</samp>in
                                          							memory.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;3, batchCount≤0, batchStride&lt;m</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-gtsv2stridedbatch_bufferSize"><a name="cusparse-lt-t-gt-gtsv2stridedbatch_bufferSize" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gtsv2stridedbatch_bufferSize" name="cusparse-lt-t-gt-gtsv2stridedbatch_bufferSize" shape="rect">10.4.2.&nbsp;cusparse&lt;t&gt;gtsv2StridedBatch_bufferSizeExt()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t cusparseSgtsv2StridedBatch_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    const float *dl,
    const float  *d,
    const float *du,
    const float *x,
    int batchCount,
    int batchStride,
    size_t *bufferSizeInBytes)

cusparseStatus_t cusparseDgtsv2StridedBatch_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    const double *dl,
    const double  *d,
    const double *du,
    const double *x,
    int batchCount,
    int batchStride,
    size_t *bufferSizeInBytes)

cusparseStatus_t cusparseCgtsv2StridedBatch_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    const cuComplex *dl,
    const cuComplex  *d,
    const cuComplex *du,
    const cuComplex *x,
    int batchCount,
    int batchStride,
    size_t *bufferSizeInBytes)

cusparseStatus_t cusparseZgtsv2StridedBatch_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    const cuDoubleComplex *dl,
    const cuDoubleComplex  *d,
    const cuDoubleComplex *du,
    const cuDoubleComplex *x,
    int batchCount,
    int batchStride,
    size_t *bufferSizeInBytes)

</pre><p class="p">
                              This function returns the size of the buffer used in <samp class="ph codeph">gtsv2StridedBatch</samp>
                              which computes the solution of multiple tridiagonal linear systems for
                              <em class="ph i">i</em>=0,…,<samp class="ph codeph">batchCount</samp>:
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                             <mo>∗</mo>
                                             <msup>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mtext>y</mtext>
                                                   </mrow>
                                                </mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                             <mo>=</mo>
                                             <msup>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mtext>x</mtext>
                                                   </mrow>
                                                </mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The coefficient matrix <samp class="ph codeph">A</samp> of each of these tri-diagonal linear system is defined
                              with three vectors corresponding to its lower (<samp class="ph codeph">dl</samp>), main
                              (<samp class="ph codeph">d</samp>), and upper (<samp class="ph codeph">du</samp>) matrix diagonals; the
                              right-hand sides are stored in the dense matrix <samp class="ph codeph">X</samp>. Notice that solution
                              <samp class="ph codeph">Y</samp> overwrites right-hand-side matrix <samp class="ph codeph">X</samp> on exit. The
                              different matrices are assumed to be of the same size and are stored with a fixed
                              <samp class="ph codeph">batchStride</samp> in memory.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the size of the linear system (must be ≥ 3).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dl</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the lower diagonal of the tri-diagonal linear system.
                                          							The lower diagonal 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>d</mi>
                                             <msup>
                                                <mi>l</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">dl+batchStride×i</samp> in
                                          							memory. Also, the first element of each lower diagonal must be
                                          							zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">d</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the main diagonal of the tri-diagonal linear system. The
                                          							main diagonal 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>d</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">d+batchStride×i</samp> in
                                          							memory.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">du</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the upper diagonal of the tri-diagonal linear system.
                                          							The upper diagonal 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>d</mi>
                                             <msup>
                                                <mi>u</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">du+batchStride×i</samp> in
                                          							memory. Also, the last element of each upper diagonal must be
                                          							zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array that contains the right-hand-side of the tri-diagonal linear
                                          							system. The right-hand-side 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>x</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">x+batchStride×i</samp>in
                                          							memory.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">batchCount</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of systems to solve.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">batchStride</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">stride (number of elements) that separates the vectors of every system (must be at least <samp class="ph codeph">m</samp>).
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer used in the <samp class="ph codeph">gtsv2StridedBatch</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;3, batchCount≤0, batchStride&lt;m</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-gtsv2stridedbatch"><a name="cusparse-lt-t-gt-gtsv2stridedbatch" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gtsv2stridedbatch" name="cusparse-lt-t-gt-gtsv2stridedbatch" shape="rect">10.4.3.&nbsp;cusparse&lt;t&gt;gtsv2StridedBatch()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t cusparseSgtsv2StridedBatch(
    cusparseHandle_t handle,
    int m,
    const float *dl,
    const float  *d,
    const float *du,
    float *x,
    int batchCount,
    int batchStride,
    void *pBuffer)

cusparseStatus_t cusparseDgtsv2StridedBatch(
    cusparseHandle_t handle,
    int m,
    const double *dl,
    const double  *d,
    const double *du,
    double *x,
    int batchCount,
    int batchStride,
    void *pBuffer)

cusparseStatus_t cusparseCgtsv2StridedBatch(
    cusparseHandle_t handle,
    int m,
    const cuComplex *dl,
    const cuComplex  *d,
    const cuComplex *du,
    cuComplex *x,
    int batchCount,
    int batchStride,
    void *pBuffer)

cusparseStatus_t cusparseZgtsv2StridedBatch(
    cusparseHandle_t handle,
    int m,
    const cuDoubleComplex *dl,
    const cuDoubleComplex  *d,
    const cuDoubleComplex *du,
    cuDoubleComplex *x,
    int batchCount,
    int batchStride,
    void *pBuffer)

</pre><p class="p">
                              This function computes the solution of multiple tridiagonal linear systems for
                              				<em class="ph i">i</em>=0,…,<samp class="ph codeph">batchCount</samp>:
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                             <mo>∗</mo>
                                             <msup>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mtext>y</mtext>
                                                   </mrow>
                                                </mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                             <mo>=</mo>
                                             <msup>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mtext>x</mtext>
                                                   </mrow>
                                                </mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The coefficient matrix <samp class="ph codeph">A</samp> of each of these tri-diagonal linear system is defined
                              with three vectors corresponding to its lower (<samp class="ph codeph">dl</samp>), main
                              (<samp class="ph codeph">d</samp>), and upper (<samp class="ph codeph">du</samp>) matrix diagonals; the
                              right-hand sides are stored in the dense matrix <samp class="ph codeph">X</samp>. Notice that solution
                              <samp class="ph codeph">Y</samp> overwrites right-hand-side matrix <samp class="ph codeph">X</samp> on exit. The
                              different matrices are assumed to be of the same size and are stored with a fixed
                              <samp class="ph codeph">batchStride</samp> in memory.
                              
                           </p>
                           <p class="p">
                              The routine does not perform any pivoting and uses a combination of the Cyclic Reduction (CR) and
                              the Parallel Cyclic Reduction (PCR) algorithms to find the solution. It achieves better
                              performance when <samp class="ph codeph">m</samp> is a power of 2.
                              
                           </p>
                           <p class="p">
                              This function requires a buffer size returned by <samp class="ph codeph">gtsv2StridedBatch_bufferSizeExt()</samp>.
                              The address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is not,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the size of the linear system (must be ≥ 3).</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dl</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the lower diagonal of the tri-diagonal linear system.
                                          							The lower diagonal 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>d</mi>
                                             <msup>
                                                <mi>l</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">dl+batchStride×i</samp> in
                                          							memory. Also, the first element of each lower diagonal must be
                                          							zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">d</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the main diagonal of the tri-diagonal linear system. The
                                          							main diagonal 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>d</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">d+batchStride×i</samp> in
                                          							memory.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">du</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the upper diagonal of the tri-diagonal linear system.
                                          							The upper diagonal 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>d</mi>
                                             <msup>
                                                <mi>u</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">du+batchStride×i</samp> in
                                          							memory. Also, the last element of each upper diagonal must be
                                          							zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array that contains the right-hand-side of the tri-diagonal linear
                                          							system. The right-hand-side 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>x</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">x+batchStride×i</samp>in
                                          							memory.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">batchCount</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of systems to solve.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">batchStride</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">stride (number of elements) that separates the vectors of every system (must be at least <samp class="ph codeph">n</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is return by <samp class="ph codeph">gtsv2StridedBatch_bufferSizeExt</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array that contains the solution of the tri-diagonal linear system. The
                                          							solution 
                                          								
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>x</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                          							 that corresponds to the <em class="ph i">i</em><sup class="ph sup">th</sup> linear
                                          							system starts at location <samp class="ph codeph">x+batchStride×i</samp>in
                                          							memory.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;3, batchCount≤0, batchStride&lt;m</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-gtsvInterleavedBatch"><a name="cusparse-lt-t-gt-gtsvInterleavedBatch" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gtsvInterleavedBatch" name="cusparse-lt-t-gt-gtsvInterleavedBatch" shape="rect">10.4.4.&nbsp;cusparse&lt;t&gt;gtsvInterleavedBatch()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseSgtsvInterleavedBatch_bufferSizeExt(
    cusparseHandle_t handle,
    int algo,
    int m,
    const float *dl,
    const float  *d,
    const float *du,
    const float *x,
    int batchCount,
    size_t *pBufferSizeInBytes)

cusparseStatus_t 
cusparseDgtsvInterleavedBatch_bufferSizeExt(
    cusparseHandle_t handle,
    int algo,
    int m,
    const double *dl,
    const double  *d,
    const double *du,
    const double *x,
    int batchCount,
    size_t *pBufferSizeInBytes)

cusparseStatus_t 
cusparseCgtsvInterleavedBatch_bufferSizeExt(
    cusparseHandle_t handle,
    int algo,
    int m,
    const cuComplex *dl,
    const cuComplex  *d,
    const cuComplex *du,
    const cuComplex *x,
    int batchCount,
    size_t *pBufferSizeInBytes)

cusparseStatus_t 
cusparseZgtsvInterleavedBatch_bufferSizeExt(
    cusparseHandle_t handle,
    int algo,
    int m,
    const cuDoubleComplex *dl,
    const cuDoubleComplex  *d,
    const cuDoubleComplex *du,
    const cuDoubleComplex *x,
    int batchCount,
    size_t *pBufferSizeInBytes)

cusparseStatus_t 
cusparseSgtsvInterleavedBatch(
    cusparseHandle_t handle,
    int algo,
    int m,
    float *dl,
    float  *d,
    float *du,
    float *x,
    int batchCount,
    void *pBuffer)

cusparseStatus_t 
cusparseDgtsvInterleavedBatch(
    cusparseHandle_t handle,
    int algo,
    int m,
    double *dl,
    double  *d,
    double *du,
    double *x,
    int batchCount,
    void *pBuffer)

cusparseStatus_t 
cusparseCgtsvInterleavedBatch(
    cusparseHandle_t handle,
    int algo,
    int m,
    cuComplex *dl,
    cuComplex  *d,
    cuComplex *du,
    cuComplex *x,
    int batchCount,
    void *pBuffer)

cusparseStatus_t 
cusparseZgtsvInterleavedBatch(
    cusparseHandle_t handle,
    int algo,
    int m,
    cuDoubleComplex *dl,
    cuDoubleComplex  *d,
    cuDoubleComplex *du,
    cuDoubleComplex *x,
    int batchCount,
    void *pBuffer)

</pre><p class="p">This function computes the solution of multiple tridiagonal linear systems for
                              <em class="ph i">i</em>=0,…,<samp class="ph codeph">batchCount</samp>:
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                             <mo>∗</mo>
                                             <msup>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mtext>x</mtext>
                                                   </mrow>
                                                </mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                             <mo>=</mo>
                                             <msup>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mtext>b</mtext>
                                                   </mrow>
                                                </mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The coefficient matrix <samp class="ph codeph">A</samp> of each of these tri-diagonal linear system is defined
                              with three vectors corresponding to its lower (<samp class="ph codeph">dl</samp>), main
                              (<samp class="ph codeph">d</samp>), and upper (<samp class="ph codeph">du</samp>) matrix diagonals; the
                              right-hand sides are stored in the dense matrix <samp class="ph codeph">B</samp>. Notice that solution
                              <samp class="ph codeph">X</samp> overwrites right-hand-side matrix <samp class="ph codeph">B</samp> on exit.
                              
                           </p>
                           <p class="p">
                              Assuming <samp class="ph codeph">A</samp> is of size <samp class="ph codeph">m</samp> and base-1,  
                              <samp class="ph codeph">dl</samp>, <samp class="ph codeph">d</samp> and <samp class="ph codeph">du</samp> are defined by the following formula:
                              
                           </p>
                           <p class="p"><samp class="ph codeph">dl(i) := A(i, i-1)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p">
                              The first element of dl is out-of-bound (<samp class="ph codeph">dl(1) := A(1,0)</samp>), so <samp class="ph codeph">dl(1) = 0</samp>.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">d(i) = A(i,i)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p"><samp class="ph codeph">du(i) = A(i,i+1)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p">
                              The last element of du is out-of-bound (<samp class="ph codeph">du(m) := A(m,m+1)</samp>), so <samp class="ph codeph">du(m) = 0</samp>.
                              
                           </p>
                           <p class="p">
                              The data layout is different from <samp class="ph codeph">gtsvStridedBatch</samp> which 
                              aggregates all matrices one after another. Instead, <samp class="ph codeph">gtsvInterleavedBatch</samp>
                              gathers different matrices of the same element in a continous manner. 
                              If <samp class="ph codeph">dl</samp> is regarded as a 2-D array of size <samp class="ph codeph">m-by-batchCount</samp>,
                              <samp class="ph codeph">dl(:,j)</samp> to store <samp class="ph codeph">j-th</samp> matrix.
                              <samp class="ph codeph">gtsvStridedBatch</samp> uses column-major while <samp class="ph codeph">gtsvInterleavedBatch</samp> uses row-major.
                              
                           </p>
                           <p class="p">
                              The routine provides three different algorithms, selected by parameter <samp class="ph codeph">algo</samp>.
                              The first algorithm is <samp class="ph codeph">cuThomas</samp> provided by <samp class="ph codeph">Barcelona Supercomputing Center</samp>.
                              The second algorithm is LU with partial pivoting and last algorithm is QR.
                              From stability perspective, cuThomas is not numerically stable because it does not have pivoting.
                              LU with partial pivoting and QR are stable.
                              From performance perspective, LU with partial pivoting and QR is about 10% to 20% slower than cuThomas. 
                              
                           </p>
                           <p class="p">
                              This function requires a buffer size returned by <samp class="ph codeph">gtsvInterleavedBatch_bufferSizeExt()</samp>. 
                              The address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is not,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                              
                           </p>
                           <p class="p">
                              Appendix F shows an example of <samp class="ph codeph">gtsvInterleavedBatch</samp>. 
                              If the user prepares aggregate format, one can use <samp class="ph codeph">cublasXgeam</samp> to get interleaved format. 
                              However such transformation takes time comparable to solver itself.
                              To reach best performance, the user must prepare interleaved format explicitly.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">algo</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algo = 0: cuThomas (unstable algorithm); 
                                          algo = 1: LU with pivoting (stable algorithm);
                                          algo = 2: QR (stable algorithm)
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the size of the linear system.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dl</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the lower diagonal of the tri-diagonal linear system. The first element of each lower diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">d</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the main diagonal of the tri-diagonal linear system.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">du</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the upper diagonal of the tri-diagonal linear system. The last element of each upper diagonal
                                          must be zero.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense right-hand-side array of dimensions <samp class="ph codeph">(batchCount, n)</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is return by <samp class="ph codeph">gtsvInterleavedBatch_bufferSizeExt</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense solution array of dimensions <samp class="ph codeph">(batchCount, n)</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;0, batchcount&lt;0</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="batch_gpsv"><a name="batch_gpsv" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#batch_gpsv" name="batch_gpsv" shape="rect">10.5.&nbsp;batched pentadiagonal solve</a></h3>
                     <div class="body conbody">
                        <p class="p">Different algorithms for batched pentadiagonal solve are discussed in this section.</p>
                     </div>
                     <div class="topic concept nested2" id="cusparse-lt-t-gt-gpsvInterleavedBatch"><a name="cusparse-lt-t-gt-gpsvInterleavedBatch" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gpsvInterleavedBatch" name="cusparse-lt-t-gt-gpsvInterleavedBatch" shape="rect">10.5.1.&nbsp;cusparse&lt;t&gt;gpsvInterleavedBatch()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseSgpsvInterleavedBatch_bufferSizeExt(
    cusparseHandle_t handle,
    int algo,
    int m,
    const float *ds,
    const float *dl,
    const float  *d,
    const float *du,
    const float *dw,
    const float *x,
    int batchCount,
    size_t *pBufferSizeInBytes)

cusparseStatus_t
cusparseDgpsvInterleavedBatch_bufferSizeExt(
    cusparseHandle_t handle,
    int algo,
    int m,
    const double *ds,
    const double *dl,
    const double  *d,
    const double *du,
    const double *dw,
    const double *x,
    int batchCount,
    size_t *pBufferSizeInBytes)

cusparseStatus_t 
cusparseCgpsvInterleavedBatch_bufferSizeExt(
    cusparseHandle_t handle,
    int algo,
    int m,
    const cuComplex *ds,
    const cuComplex *dl,
    const cuComplex  *d,
    const cuComplex *du,
    const cuComplex *dw,
    const cuComplex *x,
    int batchCount,
    size_t *pBufferSizeInBytes)

cusparseStatus_t 
cusparseZgpsvInterleavedBatch_bufferSizeExt(
    cusparseHandle_t handle,
    int algo,
    int m,
    const cuDoubleComplex *ds,
    const cuDoubleComplex *dl,
    const cuDoubleComplex  *d,
    const cuDoubleComplex *du,
    const cuDoubleComplex *dw,
    const cuDoubleComplex *x,
    int batchCount,
    size_t *pBufferSizeInBytes)

cusparseStatus_t 
cusparseSgpsvInterleavedBatch(
    cusparseHandle_t handle,
    int algo,
    int m,
    float *ds,
    float *dl,
    float  *d,
    float *du,
    float *dw,
    float *x,
    int batchCount,
    void *pBuffer)

cusparseStatus_t 
cusparseDgpsvInterleavedBatch(
    cusparseHandle_t handle,
    int algo,
    int m,
    double *ds,
    double *dl,
    double  *d,
    double *du,
    double *dw,
    double *x,
    int batchCount,
    void *pBuffer)

cusparseStatus_t 
cusparseCgpsvInterleavedBatch(
    cusparseHandle_t handle,
    int algo,
    int m,
    cuComplex *ds,
    cuComplex *dl,
    cuComplex  *d,
    cuComplex *du,
    cuComplex *dw,
    cuComplex *x,
    int batchCount,
    void *pBuffer)

cusparseStatus_t 
cusparseZgpsvInterleavedBatch(
    cusparseHandle_t handle,
    int algo,
    int m,
    cuDoubleComplex *ds,
    cuDoubleComplex *dl,
    cuDoubleComplex  *d,
    cuDoubleComplex *du,
    cuDoubleComplex *dw,
    cuDoubleComplex *x,
    int batchCount,
    void *pBuffer)

</pre><p class="p">This function computes the solution of multiple penta-diagonal linear systems for
                              <em class="ph i">i</em>=0,…,<samp class="ph codeph">batchCount</samp>:
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                             <mo>∗</mo>
                                             <msup>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mtext>x</mtext>
                                                   </mrow>
                                                </mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                             <mo>=</mo>
                                             <msup>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mtext>b</mtext>
                                                   </mrow>
                                                </mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mo stretchy="false">(</mo>
                                                   <mi>i</mi>
                                                   <mo stretchy="false">)</mo>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The coefficient matrix <samp class="ph codeph">A</samp> of each of these penta-diagonal linear system is defined
                              with five vectors corresponding to its lower (<samp class="ph codeph">ds, dl</samp>), main
                              (<samp class="ph codeph">d</samp>), and upper (<samp class="ph codeph">du, dw</samp>) matrix diagonals; the
                              right-hand sides are stored in the dense matrix <samp class="ph codeph">B</samp>. Notice that solution
                              <samp class="ph codeph">X</samp> overwrites right-hand-side matrix <samp class="ph codeph">B</samp> on exit.
                              
                           </p>
                           <p class="p">
                              Assuming <samp class="ph codeph">A</samp> is of size <samp class="ph codeph">m</samp> and base-1,  
                              <samp class="ph codeph">ds</samp>, <samp class="ph codeph">dl</samp>, <samp class="ph codeph">d</samp>, <samp class="ph codeph">du</samp> and 
                              <samp class="ph codeph">dw</samp> are defined by the following formula:
                              
                           </p>
                           <p class="p"><samp class="ph codeph">ds(i) := A(i, i-2)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p">
                              The first two elements of ds is out-of-bound (<samp class="ph codeph">ds(1) := A(1,-1)</samp>, <samp class="ph codeph">ds(2) := A(2,0)</samp>), 
                              so <samp class="ph codeph">ds(1) = 0</samp> and <samp class="ph codeph">ds(2) = 0</samp>.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">dl(i) := A(i, i-1)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p">
                              The first element of dl is out-of-bound (<samp class="ph codeph">dl(1) := A(1,0)</samp>), so <samp class="ph codeph">dl(1) = 0</samp>.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">d(i) = A(i,i)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p"><samp class="ph codeph">du(i) = A(i,i+1)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p">
                              The last element of du is out-of-bound (<samp class="ph codeph">du(m) := A(m,m+1)</samp>), so <samp class="ph codeph">du(m) = 0</samp>.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">dw(i) = A(i,i+2)</samp> for <samp class="ph codeph">i=1,2,...,m</samp></p>
                           <p class="p">
                              The last two elements of dw is out-of-bound (<samp class="ph codeph">dw(m-1) := A(m-1,m+1)</samp>, <samp class="ph codeph">dw(m) := A(m,m+2)</samp>), 
                              so <samp class="ph codeph">dw(m-1) = 0</samp> and <samp class="ph codeph">dw(m) = 0</samp>.
                              
                           </p>
                           <p class="p">
                              The data layout is the same as <samp class="ph codeph">gtsvStridedBatch</samp>.
                              
                           </p>
                           <p class="p">
                              The routine is numerically stable because it uses QR to solve the linear system.
                              
                           </p>
                           <p class="p">
                              This function requires a buffer size returned by <samp class="ph codeph">gpsvInterleavedBatch_bufferSizeExt()</samp>. 
                              The address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If it is not,
                              <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned. 
                              
                           </p>
                           <p class="p">
                              Appendix G shows an example of <samp class="ph codeph">gpsvInterleavedBatch</samp>. 
                              If the user prepares aggregate format, one can use <samp class="ph codeph">cublasXgeam</samp> to get interleaved format. 
                              However such transformation takes time comparable to solver itself.
                              To reach best performance, the user must prepare interleaved format explicitly.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">algo</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">only support algo = 0 (QR)</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the size of the linear system.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ds</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the lower diagonal (distance 2 to the diagonal) of 
                                          the penta-diagonal linear system.
                                          The first two elements must be zero.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dl</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the lower diagonal (distance 1 to the diagonal) of
                                          the penta-diagonal linear system. 
                                          The first element must be zero.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">d</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the main diagonal of the penta-diagonal linear system.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">du</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the upper diagonal (distance 1 to the diagonal) of 
                                          the penta-diagonal linear system. 
                                          The last element must be zero.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dw</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense array containing the upper diagonal (distance 2 to the diagonal) of 
                                          the penta-diagonal linear system.
                                          The last two elements must be zero.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense right-hand-side array of dimensions <samp class="ph codeph">(batchCount, n)</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is return by <samp class="ph codeph">gpsvInterleavedBatch_bufferSizeExt</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; dense solution array of dimensions <samp class="ph codeph">(batchCount, n)</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m&lt;0, batchcount&lt;0</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusparse-reorderings-reference"><a name="cusparse-reorderings-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusparse-reorderings-reference" name="cusparse-reorderings-reference" shape="rect">11.&nbsp;cuSPARSE Reorderings Reference</a></h2>
                  <div class="body conbody">
                     <p class="p">This chapter describes the reordering routines used to manipulate sparse matrices.</p>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrcolor"><a name="cusparse-lt-t-gt-csrcolor" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrcolor" name="cusparse-lt-t-gt-csrcolor" shape="rect">cusparse&lt;t&gt;csrcolor()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseScsrcolor(cusparseHandle_t handle, int m, int nnz, 
             const cusparseMatDescr_t descrA, const float *csrValA, 
             const int *csrRowPtrA, const int *csrColIndA,
             const float *fractionToColor, int *ncolors, int *coloring, 
             int *reordering,cusparseColorInfo_t info);

cusparseStatus_t 
cusparseDcsrcolor(cusparseHandle_t handle, int m, int nnz, 
             const cusparseMatDescr_t descrA, const double *csrValA, 
             const int *csrRowPtrA, const int *csrColIndA,
             const double *fractionToColor,int *ncolors, int *coloring, 
             int *reordering, cusparseColorInfo_t info);

cusparseStatus_t 
cusparseCcsrcolor(cusparseHandle_t handle, int m, int nnz, 
             const cusparseMatDescr_t descrA, const cuComplex *csrValA, 
             const int *csrRowPtrA, const int *csrColIndA,
             const float *fractionToColor, int *ncolors, int *coloring, 
             int *reordering, cusparseColorInfo_t info);

cusparseStatus_t 
cusparseZcsrcolor(cusparseHandle_t handle, int m, int nnz, 
       const cusparseMatDescr_t descrA, const cuDoubleComplex *csrValA, 
             const int *csrRowPtrA, const int *csrColIndA,
             const double *fractionToColor,int *ncolors, int *coloring, 
             int *reordering, cusparseColorInfo_t info);</pre><p class="p"> This function performs the coloring of the adjacency graph associated with the matrix A stored in CSR format. The coloring
                           is an assignment of colors (integer numbers) to nodes, such that neighboring nodes have distinct colors. An approximate coloring
                           algorithm is used in this routine, and is stopped when a certain percentage of nodes has been colored. The rest of the nodes
                           are assigned distinct colors (an increasing sequence of integers numbers, starting from the last integer used previously).
                           The last two auxiliary routines can be used to extract the resulting number of colors, their assignment and the associated
                           reordering. The reordering is such that nodes that have been assigned the same color are reordered to be next to each other.
                           
                        </p>
                        <p class="p"> The matrix A passed to this routine, must be stored as a general matrix and have a symmetric sparsity pattern. If the matrix
                           is nonsymmetric the user should pass A+A^T as a parameter to this routine. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                       								Also, the supported index bases are 
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">fractionToColor</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">fraction of nodes to be colored, which should  be in the interval [0.0,1.0], for example 0.8 implies that 80 percent of nodes
                                       will be colored.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">structure with information to be passed to the coloring.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ncolors</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"> The number of distinct colors used (at most the size of the matrix, but likely much smaller). </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">coloring</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"> The resulting coloring permutation </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">reordering</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"> The resulting reordering permutation (untouched if NULL) </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision (compute capability (c.c.) &gt;= 1.3 required).</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusparse-format-conversion-reference"><a name="cusparse-format-conversion-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusparse-format-conversion-reference" name="cusparse-format-conversion-reference" shape="rect">12.&nbsp;cuSPARSE Format Conversion Reference</a></h2>
                  <div class="body conbody">
                     <p class="p">
                        This chapter describes the conversion routines between different sparse and dense storage formats.
                        
                     </p>
                     <p class="p"><samp class="ph codeph">coosort</samp>, <samp class="ph codeph">csrsort</samp>, <samp class="ph codeph">cscsort</samp>,
                        <samp class="ph codeph">csru2csr</samp> and <samp class="ph codeph">csr2csc_indexOnly</samp> are sorting routines 
                        without malloc inside, the following table estimates the buffer size 
                        
                     </p>
                     <div class="tablenoborder">
                        <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"></span><tbody class="tbody">
                              <tr class="row">
                                 <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">routine</samp></td>
                                 <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">buffer size </samp></td>
                                 <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">maximum problem size if buffer is limited by 2GB</samp></td>
                              </tr>
                              <tr class="row">
                                 <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">coosort</samp></td>
                                 <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">&gt; 16*n bytes</samp></td>
                                 <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">125M</td>
                              </tr>
                              <tr class="row">
                                 <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">csrsort or cscsort</samp></td>
                                 <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">&gt; 20*n bytes</samp></td>
                                 <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">100M</td>
                              </tr>
                              <tr class="row">
                                 <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">csru2csr</samp></td>
                                 <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">'d' &gt; 28*n bytes ; 'z' &gt; 36*n bytes</samp></td>
                                 <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">71M for 'd' and 55M for 'z'</td>
                              </tr>
                              <tr class="row">
                                 <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">csr2csc_indexOnly</samp></td>
                                 <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">&gt; 16*n bytes</samp></td>
                                 <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">125M</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-bsr2csr"><a name="cusparse-lt-t-gt-bsr2csr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-bsr2csr" name="cusparse-lt-t-gt-bsr2csr" shape="rect">12.1.&nbsp;cusparse&lt;t&gt;bsr2csr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseSbsr2csr(cusparseHandle_t handle, 
    cusparseDirection_t dir,
    int mb, 
    int nb,
    const cusparseMatDescr_t descrA, 
    const float *bsrValA, 
    const int *bsrRowPtrA, 
    const int *bsrColIndA,
    int blockDim,
    const cusparseMatDescr_t descrC,
    float *csrValC, 
    int *csrRowPtrC, 
    int *csrColIndC)
cusparseStatus_t
cusparseDbsr2csr(cusparseHandle_t handle, 
    cusparseDirection_t dir,
    int mb, 
    int nb,
    const cusparseMatDescr_t descrA, 
    const double *bsrValA, 
    const int *bsrRowPtrA, 
    const int *bsrColIndA,
    int blockDim,
    const cusparseMatDescr_t descrC,
    double *csrValC, 
    int *csrRowPtrC, 
    int *csrColIndC)
cusparseStatus_t
cusparseCbsr2csr(cusparseHandle_t handle, 
    cusparseDirection_t dir,
    int mb, 
    int nb,
    const cusparseMatDescr_t descrA, 
    const cuComplex *bsrValA, 
    const int *bsrRowPtrA, 
    const int *bsrColIndA,
    int blockDim,
    const cusparseMatDescr_t descrC,
    cuComplex *csrValC, 
    int *csrRowPtrC, 
    int *csrColIndC)
cusparseStatus_t
cusparseZbsr2csr(cusparseHandle_t handle, 
    cusparseDirection_t dir,
    int mb, 
    int nb,
    const cusparseMatDescr_t descrA, 
    const cuDoubleComplex *bsrValA, 
    const int *bsrRowPtrA, 
    const int *bsrColIndA,
    int blockDim,
    const cusparseMatDescr_t descrC,
    cuDoubleComplex *csrValC, 
    int *csrRowPtrC, 
    int *csrColIndC)
</pre><p class="p">This function converts a sparse matrix in BSR format that is defined by the three arrays
                           <samp class="ph codeph">bsrValA</samp>, <samp class="ph codeph">bsrRowPtrA</samp>, and <samp class="ph codeph">bsrColIndA</samp>) into a
                           sparse matrix in CSR format that is defined by arrays <samp class="ph codeph">csrValC</samp>,
                           <samp class="ph codeph">csrRowPtrC</samp>, and <samp class="ph codeph">csrColIndC</samp>.
                        </p>
                        <p class="p">Let <samp class="ph codeph">m(=mb*blockDim)</samp> be the number of rows of <samp class="ph codeph">A</samp> and
                           <samp class="ph codeph">n(=nb*blockDim)</samp> be number of columns of <samp class="ph codeph">A</samp>, then <samp class="ph codeph">A</samp>
                           and <samp class="ph codeph">C</samp> are <samp class="ph codeph">m*n</samp> sparse matrices. The BSR format of
                           <samp class="ph codeph">A</samp> contains <samp class="ph codeph">nnzb(=bsrRowPtrA[mb] - bsrRowPtrA[0])</samp> nonzero blocks,
                           whereas the sparse matrix <samp class="ph codeph">A</samp> contains <samp class="ph codeph">nnz(=nnzb*blockDim*blockDim)</samp>
                           elements. The user must allocate enough space for arrays <samp class="ph codeph">csrRowPtrC</samp>,
                           <samp class="ph codeph">csrColIndC</samp>, and <samp class="ph codeph">csrValC</samp>. The requirements are as follows:
                        </p>
                        <p class="p"><samp class="ph codeph">csrRowPtrC</samp> of <samp class="ph codeph">m+1</samp> elements
                        </p>
                        <p class="p"><samp class="ph codeph">csrValC</samp> of <samp class="ph codeph">nnz</samp> elements
                        </p>
                        <p class="p"><samp class="ph codeph">csrColIndC</samp> of <samp class="ph codeph">nnz</samp> elements
                        </p>
                        <p class="p">The general procedure is as follows:</p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Given BSR format (bsrRowPtrA, bsrcolIndA, bsrValA) and </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// blocks of BSR format are stored in column-major order.</span>
cusparseDirection_t dir = CUSPARSE_DIRECTION_COLUMN;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = mb*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzb = bsrRowPtrA[mb] - bsrRowPtrA[0]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of blocks</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnz  = nnzb * <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span> * <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of elements</span>
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1));
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnz);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrValC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnz);
cusparseSbsr2csr(handle, dir, mb, nb,
        descrA, 
        bsrValA, bsrRowPtrA, bsrColIndA,
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>,
        descrC,
        csrValC, csrRowPtrC, csrColIndC);</pre><div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dir</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block columns of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzb*blockDim*blockDim</samp> nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb+1</samp> elements that contains the start of every block row and the end of the last block row plus one
                                       of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp> column indices of the nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz(=csrRowPtrC[m]-csrRowPtrC[0])</samp> nonzero elements of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one
                                       of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> column indices of the nonzero elements of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb,nb&lt;0</samp>, <samp class="ph codeph">IndexBase</samp> of
                                       <samp class="ph codeph">descrA, descrC</samp> is not base-0 or base-1, <samp class="ph codeph">dir</samp> is not row-major or
                                       column-major, or <samp class="ph codeph">blockDim</samp>&lt;1).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-gebsr2gebsc_bufferSize"><a name="cusparse-lt-t-gt-gebsr2gebsc_bufferSize" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gebsr2gebsc_bufferSize" name="cusparse-lt-t-gt-gebsr2gebsc_bufferSize" shape="rect">12.2.&nbsp;cusparse&lt;t&gt;gebsr2gebsc_bufferSize()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSgebsr2gebsc_bufferSize(cusparseHandle_t handle,
    int mb,
    int nb,
    int nnzb,
    const float *bsrVal,
    const int *bsrRowPtr,
    const int *bsrColInd,
    int rowBlockDim,
    int colBlockDim,
    int *pBufferSize)

cusparseStatus_t 
cusparseDgebsr2gebsc_bufferSize(cusparseHandle_t handle,
    int mb,
    int nb,
    int nnzb,
    const double *bsrVal,
    const int *bsrRowPtr,
    const int *bsrColInd,
    int rowBlockDim,
    int colBlockDim,
    int *pBufferSize)

cusparseStatus_t 
cusparseCgebsr2gebsc_bufferSize(cusparseHandle_t handle,
    int mb,
    int nb,
    int nnzb,
    const cuComplex *bsrVal,
    const int *bsrRowPtr,
    const int *bsrColInd,
    int rowBlockDim,
    int colBlockDim,
    int *pBufferSize)

cusparseStatus_t 
cusparseZgebsr2gebsc_bufferSize(cusparseHandle_t handle,
    int mb,
    int nb,
    int nnzb,
    const cuDoubleComplex *bsrVal,
    const int *bsrRowPtr,
    const int *bsrColInd,
    int rowBlockDim,
    int colBlockDim,
    int *pBufferSize)
</pre><p class="p">This function returns size of buffer used in computing <samp class="ph codeph">gebsr2gebsc()</samp>. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block columns of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzb*rowBlockDim*colBlockDim</samp>
                                       	non-zero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb+1</samp> elements that contains the start of every block row and the end of the last block row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp> column indices of the non-zero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rowBlockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows within a block of <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">colBlockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns within a block of <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSize</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">host pointer containing number of bytes of the buffer used in
                                       <samp class="ph codeph">gebsr2gebsc()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb, nb, nnzb&lt;0</samp>, or
                                       <samp class="ph codeph">rowBlockDim</samp>,
                                       <samp class="ph codeph">colBlockDim</samp>&lt;1).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-gebsr2gebsc"><a name="cusparse-lt-t-gt-gebsr2gebsc" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gebsr2gebsc" name="cusparse-lt-t-gt-gebsr2gebsc" shape="rect">12.3.&nbsp;cusparse&lt;t&gt;gebsr2gebsc()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseSgebsr2gebsc(cusparseHandle_t handle,
    int mb, 
    int nb, 
    int nnzb,
    const float *bsrVal, 
    const int *bsrRowPtr, 
    const int *bsrColInd,
    int rowBlockDim, 
    int colBlockDim,
    float *bscVal, 
    int *bscRowInd, 
    int *bscColPtr,
    cusparseAction_t copyValues, 
    cusparseIndexBase_t baseIdx,
    void *pBuffer)

cusparseStatus_t
cusparseDgebsr2gebsc(cusparseHandle_t handle,
    int mb, 
    int nb, 
    int nnzb,
    const double *bsrVal, 
    const int *bsrRowPtr, 
    const int *bsrColInd,
    int rowBlockDim, 
    int colBlockDim,
    double *bscVal, 
    int *bscRowInd, 
    int *bscColPtr,
    cusparseAction_t copyValues, 
    cusparseIndexBase_t baseIdx,
    void *pBuffer)

cusparseStatus_t
cusparseCgebsr2gebsc(cusparseHandle_t handle,
    int mb, 
    int nb, 
    int nnzb,
    const cuComplex *bsrVal, 
    const int *bsrRowPtr, 
    const int *bsrColInd,
    int rowBlockDim, 
    int colBlockDim,
    cuComplex *bscVal, 
    int *bscRowInd, 
    int *bscColPtr,
    cusparseAction_t copyValues,
    cusparseIndexBase_t baseIdx,
    void *pBuffer)

cusparseStatus_t
cusparseZgebsr2gebsc(cusparseHandle_t handle,
    int mb, 
    int nb, 
    int nnzb,
    const cuDoubleComplex *bsrVal, 
    const int *bsrRowPtr, 
    const int *bsrColInd,
    int rowBlockDim, 
    int colBlockDim,
    cuDoubleComplex *bscVal, 
    int *bscRowInd, 
    int *bscColPtr,
    cusparseAction_t copyValues, 
    cusparseIndexBase_t baseIdx,
    void *pBuffer)
</pre><p class="p">This function can be seen as the same as <samp class="ph codeph">csr2csc()</samp> when each block of size
                           <samp class="ph codeph">rowBlockDim*colBlockDim</samp> is regarded as a
                           scalar.
                        </p>
                        <p class="p">This sparsity pattern of the result matrix can also be seen as the transpose of the original
                           sparse matrix, but the memory layout of a block does not change. 
                        </p>
                        <p class="p">The user must call <samp class="ph codeph">gebsr2gebsc_bufferSize()</samp> to determine the size of the buffer
                           required by <samp class="ph codeph">gebsr2gebsc()</samp>, allocate the buffer, and pass
                           the buffer pointer to <samp class="ph codeph">gebsr2gebsc()</samp>. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block columns of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzb*rowBlockDim*colBlockDim</samp> nonzero elements of
                                       matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb+1</samp> elements that contains the start of every block row and the end of the last block row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp> column indices of the non-zero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rowBlockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows within a block of <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">colBlockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns within a block of <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">copyValues</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_ACTION_SYMBOLIC</samp> or <samp class="ph codeph">CUSPARSE_ACTION_NUMERIC</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">baseIdx</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user; the size is return by
                                       <samp class="ph codeph">gebsr2gebsc_bufferSize()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bscVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzb*rowBlockDim*colBlockDim</samp> non-zero elements of
                                       matrix <samp class="ph codeph">A</samp>. It is only filled-in if
                                       <samp class="ph codeph">copyValues</samp> is set to
                                       <samp class="ph codeph">CUSPARSE_ACTION_NUMERIC</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bscRowInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp> row indices of the non-zero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bscColPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nb+1</samp> elements that contains the start of every block column and the end of the last block column plus one.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb,nb,nnzb&lt;0</samp>, <samp class="ph codeph">baseIdx</samp>
                                       is not base-0 or base-1, or
                                       <samp class="ph codeph">rowBlockDim</samp>,
                                       <samp class="ph codeph">colBlockDim</samp>&lt;1).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-gebsr2gebsr_bufferSize"><a name="cusparse-lt-t-gt-gebsr2gebsr_bufferSize" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gebsr2gebsr_bufferSize" name="cusparse-lt-t-gt-gebsr2gebsr_bufferSize" shape="rect">12.4.&nbsp;cusparse&lt;t&gt;gebsr2gebsr_bufferSize()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseSgebsr2gebsr_bufferSize(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int mb,
    int nb,
    int nnzb,
    const cusparseMatDescr_t descrA,
    const float *bsrValA,
    const int *bsrRowPtrA,
    const int *bsrColIndA,
    int rowBlockDimA,
    int colBlockDimA,
    int rowBlockDimC,
    int colBlockDimC,
    int *pBufferSize )

cusparseStatus_t 
cusparseDgebsr2gebsr_bufferSize(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int mb,
    int nb,
    int nnzb,
    const cusparseMatDescr_t descrA,
    const double *bsrValA,
    const int *bsrRowPtrA,
    const int *bsrColIndA,
    int rowBlockDimA,
    int colBlockDimA,
    int rowBlockDimC,
    int colBlockDimC,
    int *pBufferSize )

cusparseStatus_t 
cusparseCgebsr2gebsr_bufferSize(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int mb,
    int nb,
    int nnzb,
    const cusparseMatDescr_t descrA,
    const cuComplex *bsrValA,
    const int *bsrRowPtrA,
    const int *bsrColIndA,
    int rowBlockDimA,
    int colBlockDimA,
    int rowBlockDimC,
    int colBlockDimC,
    int *pBufferSize )

cusparseStatus_t 
cusparseZgebsr2gebsr_bufferSize(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int mb,
    int nb,
    int nnzb,
    const cusparseMatDescr_t descrA,
    const cuDoubleComplex *bsrValA,
    const int *bsrRowPtrA,
    const int *bsrColIndA,
    int rowBlockDimA,
    int colBlockDimA,
    int rowBlockDimC,
    int colBlockDimC,
    int *pBufferSize )
</pre><p class="p">This function returns size of the buffer used in computing <samp class="ph codeph">gebsr2gebsrNnz()</samp> and
                           <samp class="ph codeph">gebsr2gebsr()</samp>. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dir</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block columns of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                                       Also, the supported index bases are
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzb*rowBlockDimA*colBlockDimA</samp>
                                       	non-zero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb+1</samp> elements that contains the start of every block row
                                       and the end of the last block row plus one of
                                       matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp> column indices of the nonzero blocks of matrix
                                       <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rowBlockDimA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows within a block of <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">colBlockDimA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns within a block of <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rowBlockDimC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows within a block of <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">colBlockDimC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns within a block of <samp class="ph codeph">C</samp></td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSize</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">host pointer containing number of bytes of the buffer used in
                                       <samp class="ph codeph">gebsr2gebsr()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb, nb, nnzb&lt;0</samp>; or
                                       <samp class="ph codeph">rowBlockDimA</samp>,
                                       <samp class="ph codeph">colBlockDimA</samp>,
                                       <samp class="ph codeph">rowBlockDimC</samp>,
                                       <samp class="ph codeph">colBlockDimC</samp>&lt;1).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-gebsr2gebsr"><a name="cusparse-lt-t-gt-gebsr2gebsr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gebsr2gebsr" name="cusparse-lt-t-gt-gebsr2gebsr" shape="rect">12.5.&nbsp;cusparse&lt;t&gt;gebsr2gebsr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseXgebsr2gebsrNnz(cusparseHandle_t handle, 
    cusparseDirection_t dir,
    int mb, 
    int nb, 
    int nnzb,
    const cusparseMatDescr_t descrA,
    const int *bsrRowPtrA,
    const int *bsrColIndA,
    int rowBlockDimA,
    int colBlockDimA,
    const cusparseMatDescr_t descrC,
    int *bsrRowPtrC,
    int rowBlockDimC,
    int colBlockDimC,
    int *nnzTotalDevHostPtr,
    void *pBuffer)

cusparseStatus_t
cusparseSgebsr2gebsr(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int mb,
    int nb,
    int nnzb,
    const cusparseMatDescr_t descrA,
    const float *bsrValA,
    const int *bsrRowPtrA,
    const int *bsrColIndA,
    int rowBlockDimA,
    int colBlockDimA,
    const cusparseMatDescr_t descrC,
    float *bsrValC,
    int *bsrRowPtrC,
    int *bsrColIndC,
    int rowBlockDimC,
    int colBlockDimC,
    void *pBuffer)

cusparseStatus_t
cusparseDgebsr2gebsr(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int mb,
    int nb,
    int nnzb,
    const cusparseMatDescr_t descrA,
    const double *bsrValA,
    const int *bsrRowPtrA,
    const int *bsrColIndA,
    int rowBlockDimA,
    int colBlockDimA,
    const cusparseMatDescr_t descrC,
    double *bsrValC,
    int *bsrRowPtrC,
    int *bsrColIndC,
    int rowBlockDimC,
    int colBlockDimC,
    void *pBuffer)

cusparseStatus_t
cusparseCgebsr2gebsr(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int mb,
    int nb,
    int nnzb,
    const cusparseMatDescr_t descrA,
    const cuComplex *bsrValA,
    const int *bsrRowPtrA,
    const int *bsrColIndA,
    int rowBlockDimA,
    int colBlockDimA,
    const cusparseMatDescr_t descrC,
    cuComplex *bsrValC,
    int *bsrRowPtrC,
    int *bsrColIndC,
    int rowBlockDimC,
    int colBlockDimC,
    void *pBuffer)

cusparseStatus_t
cusparseZgebsr2gebsr(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int mb,
    int nb,
    int nnzb,
    const cusparseMatDescr_t descrA,
    const cuDoubleComplex *bsrValA,
    const int *bsrRowPtrA,
    const int *bsrColIndA,
    int rowBlockDimA,
    int colBlockDimA,
    const cusparseMatDescr_t descrC,
    cuDoubleComplex *bsrValC,
    int *bsrRowPtrC,
    int *bsrColIndC,
    int rowBlockDimC,
    int colBlockDimC,
    void *pBuffer)
</pre><p class="p">This function converts a sparse matrix in general BSR format that is defined by the three arrays
                           <samp class="ph codeph">bsrValA</samp>, <samp class="ph codeph">bsrRowPtrA</samp>, and
                           <samp class="ph codeph">bsrColIndA</samp> into a sparse matrix in another general BSR format that
                           is defined by arrays <samp class="ph codeph">bsrValC</samp>, <samp class="ph codeph">bsrRowPtrC</samp>, and
                           <samp class="ph codeph">bsrColIndC</samp>. 
                        </p>
                        <p class="p">If <samp class="ph codeph">rowBlockDimA=1</samp> and <samp class="ph codeph">colBlockDimA=1</samp>,
                           <samp class="ph codeph">cusparse[S|D|C|Z]gebsr2gebsr()</samp> is the same as
                           <samp class="ph codeph">cusparse[S|D|C|Z]csr2gebsr()</samp>. 
                        </p>
                        <p class="p">If <samp class="ph codeph">rowBlockDimC=1</samp> and <samp class="ph codeph">colBlockDimC=1</samp>,
                           <samp class="ph codeph">cusparse[S|D|C|Z]gebsr2gebsr()</samp> is the same as
                           <samp class="ph codeph">cusparse[S|D|C|Z]gebsr2csr()</samp>. 
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m*n</samp> sparse matrix where
                           <samp class="ph codeph">m(=mb*rowBlockDim)</samp> is the number of rows of <samp class="ph codeph">A</samp>, and
                           <samp class="ph codeph">n(=nb*colBlockDim)</samp> is the number of columns of <samp class="ph codeph">A</samp>.
                           The general BSR format of <samp class="ph codeph">A</samp> contains <samp class="ph codeph">nnzb(=bsrRowPtrA[mb] -
                              bsrRowPtrA[0])</samp> nonzero blocks. The matrix <samp class="ph codeph">C</samp> is also
                           general BSR format with a different block size,
                           <samp class="ph codeph">rowBlockDimC*colBlockDimC</samp>. If <samp class="ph codeph">m</samp> is not a multiple
                           of <samp class="ph codeph">rowBlockDimC</samp>, or <samp class="ph codeph">n</samp> is not a multiple of
                           <samp class="ph codeph">colBlockDimC</samp>, zeros are filled in. The number of block rows of
                           <samp class="ph codeph">C</samp> is <samp class="ph codeph">mc(=(m+rowBlockDimC-1)/rowBlockDimC)</samp>. The
                           number of block rows of <samp class="ph codeph">C</samp> is
                           <samp class="ph codeph">nc(=(n+colBlockDimC-1)/colBlockDimC)</samp>. The number of nonzero blocks
                           of <samp class="ph codeph">C</samp> is <samp class="ph codeph">nnzc</samp>. 
                        </p>
                        <p class="p">The implementation adopts a two-step approach to do the conversion. First, the user allocates
                           <samp class="ph codeph">bsrRowPtrC</samp> of <samp class="ph codeph">mc+1</samp> elements and uses function
                           <samp class="ph codeph">cusparseXgebsr2gebsrNnz()</samp> to determine the number of nonzero block
                           columns per block row of matrix <samp class="ph codeph">C</samp>. Second, the user gathers
                           <samp class="ph codeph">nnzc</samp> (number of non-zero block columns of matrix
                           <samp class="ph codeph">C</samp>) from either <samp class="ph codeph">(nnzc=*nnzTotalDevHostPtr)</samp> or
                           <samp class="ph codeph">(nnzc=bsrRowPtrC[mc]-bsrRowPtrC[0])</samp> and allocates
                           <samp class="ph codeph">bsrValC</samp> of <samp class="ph codeph">nnzc*rowBlockDimC*colBlockDimC</samp> elements
                           and <samp class="ph codeph">bsrColIndC</samp> of <samp class="ph codeph">nnzc</samp> integers. Finally the function
                           <samp class="ph codeph">cusparse[S|D|C|Z]gebsr2gebsr()</samp> is called to complete the
                           conversion. 
                        </p>
                        <p class="p">The user must call <samp class="ph codeph">gebsr2gebsr_bufferSize()</samp> to know the size of the buffer
                           required by <samp class="ph codeph">gebsr2gebsr()</samp>, allocate the buffer, and pass the buffer
                           pointer to <samp class="ph codeph">gebsr2gebsr()</samp>. 
                        </p>
                        <p class="p">The general procedure is as follows:</p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Given general BSR format (bsrRowPtrA, bsrColIndA, bsrValA) and </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// blocks of BSR format are stored in column-major order.</span>
cusparseDirection_t dir = CUSPARSE_DIRECTION_COLUMN;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> base, nnzc;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = mb*rowBlockDimA;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = nb*colBlockDimA;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> mc = (m+rowBlockDimC-1)/rowBlockDimC;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nc = (n+colBlockDimC-1)/colBlockDimC;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> bufferSize;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *pBuffer;
cusparseSgebsr2gebsr_bufferSize(handle, dir, mb, nb, nnzb,
    descrA, bsrValA, bsrRowPtrA, bsrColIndA,
    rowBlockDimA, colBlockDimA,
    rowBlockDimC, colBlockDimC,
    &amp;bufferSize);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;pBuffer, bufferSize);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;bsrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(mc+1));
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// nnzTotalDevHostPtr points to host memory</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *nnzTotalDevHostPtr = &amp;nnzc;
cusparseXgebsr2gebsrNnz(handle, dir, mb, nb, nnzb,
    descrA, bsrRowPtrA, bsrColIndA,
    rowBlockDimA, colBlockDimA,
    descrC, bsrRowPtrC,
    rowBlockDimC, colBlockDimC,
    nnzTotalDevHostPtr, 
    pBuffer);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (NULL != nnzTotalDevHostPtr){
    nnzc = *nnzTotalDevHostPtr;
}<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
    cudaMemcpy(&amp;nnzc, bsrRowPtrC+mc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    cudaMemcpy(&amp;base, bsrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    nnzc -= base;
}
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;bsrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzc);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;bsrValC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*(rowBlockDimC*colBlockDimC)*nnzc);
cusparseSgebsr2gebsr(handle, dir, mb, nb, nnzb,
    descrA, bsrValA, bsrRowPtrA, bsrColIndA,
    rowBlockDimA, colBlockDimA,
    descrC, bsrValC, bsrRowPtrC, bsrColIndC,
    rowBlockDimC, colBlockDimC,
    pBuffer);
</pre><div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dir</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block columns of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported
                                       index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzb*rowBlockDimA*colBlockDimA</samp>
                                       	non-zero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb+1</samp> elements that contains the start of every block row
                                       and the end of the last block row plus one of matrix
                                       <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp> column indices of the non-zero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rowBlockDimA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows within a block of <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">colBlockDimA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns within a block of <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>. The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported
                                       index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rowBlockDimC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows within a block of <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">colBlockDimC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns within a block of <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user; the size is return by
                                       <samp class="ph codeph">gebsr2gebsr_bufferSize()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzc*rowBlockDimC*colBlockDimC</samp>
                                       	non-zero elements of matrix <samp class="ph codeph">C</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mc+1</samp> elements that contains the start of every block row
                                       and the end of the last block row plus one of matrix
                                       <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzc</samp> block column indices of the nonzero blocks of
                                       matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzTotalDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">total number of nonzero blocks of <samp class="ph codeph">C</samp>.
                                       <samp class="ph codeph">*nnzTotalDevHostPtr</samp> is the same as
                                       <samp class="ph codeph">bsrRowPtrC[mc]-bsrRowPtrC[0]</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb, nb, nnzb&lt;0</samp>, <samp class="ph codeph">baseIdx</samp>
                                       is not base-0 or base-1; or <samp class="ph codeph">rowBlockDimA</samp>,
                                       <samp class="ph codeph">colBlockDimA</samp>, <samp class="ph codeph">rowBlockDimC</samp>,
                                       <samp class="ph codeph">colBlockDimC</samp>&lt;1).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-gebsr2csr"><a name="cusparse-lt-t-gt-gebsr2csr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-gebsr2csr" name="cusparse-lt-t-gt-gebsr2csr" shape="rect">12.6.&nbsp;cusparse&lt;t&gt;gebsr2csr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseSgebsr2csr(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int mb,
    int nb,
    const cusparseMatDescr_t descrA,
    const float *bsrValA,
    const int    *bsrRowPtrA,
    const int    *bsrColIndA,
    int   rowBlockDim,
    int   colBlockDim,
    const cusparseMatDescr_t descrC,
    float  *csrValC,
    int    *csrRowPtrC,
    int    *csrColIndC )
cusparseStatus_t
cusparseDgebsr2csr(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int mb,
    int nb,
    const cusparseMatDescr_t descrA,
    const double *bsrValA,
    const int    *bsrRowPtrA,
    const int    *bsrColIndA,
    int   rowBlockDim,
    int   colBlockDim,
    const cusparseMatDescr_t descrC,
    double  *csrValC,
    int    *csrRowPtrC,
    int    *csrColIndC )
cusparseStatus_t
cusparseCgebsr2csr(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int mb,
    int nb,
    const cusparseMatDescr_t descrA,
    const cuComplex *bsrValA,
    const int    *bsrRowPtrA,
    const int    *bsrColIndA,
    int   rowBlockDim,
    int   colBlockDim,
    const cusparseMatDescr_t descrC,
    cuComplex  *csrValC,
    int    *csrRowPtrC,
    int    *csrColIndC )
cusparseStatus_t
cusparseZgebsr2csr(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int mb,
    int nb,
    const cusparseMatDescr_t descrA,
    const cuDoubleComplex *bsrValA,
    const int    *bsrRowPtrA,
    const int    *bsrColIndA,
    int   rowBlockDim,
    int   colBlockDim,
    const cusparseMatDescr_t descrC,
    cuDoubleComplex  *csrValC,
    int    *csrRowPtrC,
    int    *csrColIndC )
</pre><p class="p">This function converts a sparse matrix in general BSR format that is defined by the three arrays
                           <samp class="ph codeph">bsrValA</samp>, <samp class="ph codeph">bsrRowPtrA</samp>, and
                           <samp class="ph codeph">bsrColIndA</samp> into a sparse matrix in CSR format that
                           is defined by arrays <samp class="ph codeph">csrValC</samp>, <samp class="ph codeph">csrRowPtrC</samp>,
                           and <samp class="ph codeph">csrColIndC</samp>.
                        </p>
                        <p class="p">Let <samp class="ph codeph">m(=mb*rowBlockDim)</samp> be number of rows of <samp class="ph codeph">A</samp> and
                           <samp class="ph codeph">n(=nb*colBlockDim)</samp> be number of columns of
                           <samp class="ph codeph">A</samp>, then <samp class="ph codeph">A</samp> and <samp class="ph codeph">C</samp>
                           are <samp class="ph codeph">m*n</samp> sparse matrices. The general BSR format of
                           <samp class="ph codeph">A</samp> contains <samp class="ph codeph">nnzb(=bsrRowPtrA[mb] -
                              bsrRowPtrA[0])</samp> non-zero blocks, whereas sparse matrix
                           <samp class="ph codeph">A</samp> contains
                           <samp class="ph codeph">nnz(=nnzb*rowBlockDim*colBlockDim)</samp> elements. The
                           user must allocate enough space for arrays <samp class="ph codeph">csrRowPtrC</samp>,
                           <samp class="ph codeph">csrColIndC</samp>, and <samp class="ph codeph">csrValC</samp>. The
                           requirements are as follows:
                        </p>
                        <p class="p"><samp class="ph codeph">csrRowPtrC</samp> of <samp class="ph codeph">m+1</samp> elements
                        </p>
                        <p class="p"><samp class="ph codeph">csrValC</samp> of <samp class="ph codeph">nnz</samp> elements
                        </p>
                        <p class="p"><samp class="ph codeph">csrColIndC</samp> of <samp class="ph codeph">nnz</samp> elements
                        </p>
                        <p class="p">The general procedure is as follows:</p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Given general BSR format (bsrRowPtrA, bsrColIndA, bsrValA) and </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// blocks of BSR format are stored in column-major order.</span>
cusparseDirection_t dir = CUSPARSE_DIRECTION_COLUMN;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = mb*rowBlockDim;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = nb*colBlockDim;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzb = bsrRowPtrA[mb] - bsrRowPtrA[0]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of blocks</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnz  = nnzb * rowBlockDim * colBlockDim; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of elements</span>
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1));
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnz);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrValC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnz);
cusparseSgebsr2csr(handle, dir, mb, nb,
        descrA, 
        bsrValA, bsrRowPtrA, bsrColIndA,
        rowBlockDim, colBlockDim,
        descrC,
        csrValC, csrRowPtrC, csrColIndC);</pre><div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dir</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">mb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block rows of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nb</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of block columns of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                                       Also, the supported index bases are
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzb*rowBlockDim*colBlockDim</samp>
                                       	non-zero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb+1</samp> elements that contains the start of every block row
                                       and the end of the last block row plus one of
                                       matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp> column indices of the non-zero blocks of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rowBlockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows within a block of <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">colBlockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns within a block of <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>. The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                                       Also, the supported index bases are
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>. 
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp>
                                       	non-zero elements of matrix <samp class="ph codeph">C</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the
                                       end of the last row plus one of matrix
                                       <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> column indices of the non-zero elements of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">mb, nb&lt;0</samp> is not base-0 or base-1, or
                                       <samp class="ph codeph">rowBlockDim</samp>,
                                       <samp class="ph codeph">colBlockDim</samp>&lt;1).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csr2gebsr_bufferSize"><a name="cusparse-lt-t-gt-csr2gebsr_bufferSize" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csr2gebsr_bufferSize" name="cusparse-lt-t-gt-csr2gebsr_bufferSize" shape="rect">12.7.&nbsp;cusparse&lt;t&gt;csr2gebsr_bufferSize()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseScsr2gebsr_bufferSize(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int m,
    int n,
    const cusparseMatDescr_t descrA,
    const float *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    int rowBlockDim,
    int colBlockDim,
    int *pBufferSize)

cusparseStatus_t 
cusparseDcsr2gebsr_bufferSize(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int m,
    int n,
    const cusparseMatDescr_t descrA,
    const double *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    int rowBlockDim,
    int colBlockDim,
    int *pBufferSize)

cusparseStatus_t 
cusparseCcsr2gebsr_bufferSize(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int m,
    int n,
    const cusparseMatDescr_t descrA,
    const cuComplex *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    int rowBlockDim,
    int colBlockDim,
    int *pBufferSize)

cusparseStatus_t 
cusparseZcsr2gebsr_bufferSize(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int m,
    int n,
    const cusparseMatDescr_t descrA,
    const cuDoubleComplex *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    int rowBlockDim,
    int colBlockDim,
    int *pBufferSize)
</pre><p class="p">This function returns the size of the buffer used in computing <samp class="ph codeph">csr2gebsrNnz</samp> and
                           <samp class="ph codeph">csr2gebsr</samp>. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dir</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                                       Also, the supported index bases are
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp>
                                       	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the
                                       end of the last row plus one of matrix
                                       <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>. The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                                       Also, the supported index bases are
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rowBlockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows within a block of <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">colBlockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns within a block of <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSize</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">host pointer containing number of bytes of the buffer used in
                                       <samp class="ph codeph">csr2gebsrNnz()</samp> and
                                       <samp class="ph codeph">csr2gebsr()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp>, or <samp class="ph codeph">rowBlockDim</samp>,
                                       <samp class="ph codeph">colBlockDim&lt;1</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csr2gebsr"><a name="cusparse-lt-t-gt-csr2gebsr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csr2gebsr" name="cusparse-lt-t-gt-csr2gebsr" shape="rect">12.8.&nbsp;cusparse&lt;t&gt;csr2gebsr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseXcsr2gebsrNnz(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int m,
    int n,
    const cusparseMatDescr_t descrA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const cusparseMatDescr_t descrC,
    int *bsrRowPtrC,
    int rowBlockDim,
    int colBlockDim,
    int *nnzTotalDevHostPtr,
    void *pBuffer )

cusparseStatus_t
cusparseScsr2gebsr(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int m,
    int n,
    const cusparseMatDescr_t descrA,
    const float *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const cusparseMatDescr_t descrC,
    float *bsrValC,
    int *bsrRowPtrC,
    int *bsrColIndC,
    int rowBlockDim,
    int colBlockDim,
    void *pBuffer)

cusparseStatus_t
cusparseDcsr2gebsr(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int m,
    int n,
    const cusparseMatDescr_t descrA,
    const double *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const cusparseMatDescr_t descrC,
    double *bsrValC,
    int *bsrRowPtrC,
    int *bsrColIndC,
    int rowBlockDim,
    int colBlockDim,
    void *pBuffer)

cusparseStatus_t
cusparseCcsr2gebsr(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int m,
    int n,
    const cusparseMatDescr_t descrA,
    const cuComplex *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const cusparseMatDescr_t descrC,
    cuComplex *bsrValC,
    int *bsrRowPtrC,
    int *bsrColIndC,
    int rowBlockDim,
    int colBlockDim,
    void *pBuffer)

cusparseStatus_t
cusparseZcsr2gebsr(cusparseHandle_t handle,
    cusparseDirection_t dir,
    int m,
    int n,
    const cusparseMatDescr_t descrA,
    const cuDoubleComplex *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const cusparseMatDescr_t descrC,
    cuDoubleComplex *bsrValC,
    int *bsrRowPtrC,
    int *bsrColIndC,
    int rowBlockDim,
    int colBlockDim,
    void *pBuffer)
</pre><p class="p">This function converts a sparse matrix <samp class="ph codeph">A</samp> in CSR format (that is defined by
                           arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           <samp class="ph codeph">csrColIndA</samp>) into a sparse matrix <samp class="ph codeph">C</samp> in general BSR
                           format (that is defined by the three arrays <samp class="ph codeph">bsrValC</samp>,
                           <samp class="ph codeph">bsrRowPtrC</samp>, and <samp class="ph codeph">bsrColIndC</samp>).
                        </p>
                        <p class="p">The matrix A is a <samp class="ph codeph">m*n</samp> sparse matrix and matrix <samp class="ph codeph">C</samp> is a
                           <samp class="ph codeph">(mb*rowBlockDim)*(nb*colBlockDim)</samp> sparse matrix, where
                           <samp class="ph codeph">mb(=(m+rowBlockDim-1)/rowBlockDim)</samp> is the number of block rows of
                           <samp class="ph codeph">C</samp>, and <samp class="ph codeph">nb(=(n+colBlockDim-1)/colBlockDim)</samp> is the
                           number of block columns of <samp class="ph codeph">C</samp>. 
                        </p>
                        <p class="p">The block of <samp class="ph codeph">C</samp> is of size <samp class="ph codeph">rowBlockDim*colBlockDim</samp>. 
                           If <samp class="ph codeph">m</samp> is not multiple of <samp class="ph codeph">rowBlockDim</samp> or <samp class="ph codeph">n</samp> is not multiple of <samp class="ph codeph">colBlockDim</samp>, 
                           zeros are filled in. 
                           
                        </p>
                        <p class="p">The implementation adopts a two-step approach to do the conversion. First, the user allocates
                           <samp class="ph codeph">bsrRowPtrC</samp> of <samp class="ph codeph">mb+1</samp> elements and uses function
                           <samp class="ph codeph">cusparseXcsr2gebsrNnz()</samp> to determine the number of nonzero block
                           columns per block row. Second, the user gathers <samp class="ph codeph">nnzb</samp> (number of
                           nonzero block columns of matrix <samp class="ph codeph">C</samp>) from either
                           <samp class="ph codeph">(nnzb=*nnzTotalDevHostPtr)</samp> or
                           <samp class="ph codeph">(nnzb=bsrRowPtrC[mb]-bsrRowPtrC[0])</samp> and allocates
                           <samp class="ph codeph">bsrValC</samp> of <samp class="ph codeph">nnzb*rowBlockDim*colBlockDim</samp> elements
                           and <samp class="ph codeph">bsrColIndC</samp> of <samp class="ph codeph">nnzb</samp> integers. Finally function
                           <samp class="ph codeph">cusparse[S|D|C|Z]csr2gebsr()</samp> is called to complete the conversion. 
                        </p>
                        <p class="p">The user must obtain the size of the buffer required by <samp class="ph codeph">csr2gebsr()</samp> by calling
                           <samp class="ph codeph">csr2gebsr_bufferSize()</samp>, allocate the buffer, and pass the buffer
                           pointer to <samp class="ph codeph">csr2gebsr()</samp>. 
                        </p>
                        <p class="p">The general procedure is as follows:</p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Given CSR format (csrRowPtrA, csrColIndA, csrValA) and </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// blocks of BSR format are stored in column-major order.</span>
cusparseDirection_t dir = CUSPARSE_DIRECTION_COLUMN;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> base, nnzb;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> mb = (m + rowBlockDim-1)/rowBlockDim;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nb = (n + colBlockDim-1)/colBlockDim;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> bufferSize;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *pBuffer;
cusparseScsr2gebsr_bufferSize(handle, dir, m, n,
    descrA, csrValA, csrRowPtrA, csrColIndA,
    rowBlockDim, colBlockDim,
    &amp;bufferSize);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;pBuffer, bufferSize);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;bsrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) *(mb+1));
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// nnzTotalDevHostPtr points to host memory</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *nnzTotalDevHostPtr = &amp;nnzb;
cusparseXcsr2gebsrNnz(handle, dir, m, n,
    descrA, csrRowPtrA, csrColIndA,
    descrC, bsrRowPtrC, rowBlockDim, colBlockDim,
    nnzTotalDevHostPtr,
    pBuffer);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (NULL != nnzTotalDevHostPtr){
    nnzb = *nnzTotalDevHostPtr;
}<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
    cudaMemcpy(&amp;nnzb, bsrRowPtrC+mb, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    cudaMemcpy(&amp;base, bsrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    nnzb -= base;
}
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;bsrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzb);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;bsrValC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*(rowBlockDim*colBlockDim)*nnzb);
cusparseScsr2gebsr(handle, dir, m, n,
        descrA,
        csrValA, csrRowPtrA, csrColIndA,
        descrC,
        bsrValC, bsrRowPtrC, bsrColIndC,
        rowBlockDim, colBlockDim,
        pBuffer);</pre><div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dir</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported
                                       index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp>
                                       	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the
                                       end of the last row plus one of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>. The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported
                                       index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>. 
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rowBlockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows within a block of <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">colBlockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns within a block of <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is return by
                                       <samp class="ph codeph">csr2gebsr_bufferSize()</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzb*rowBlockDim*colBlockDim</samp>
                                       	nonzero elements of matrix <samp class="ph codeph">C</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb+1</samp> elements that contains the start of every block row
                                       and the end of the last block row plus one of matrix
                                       <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp> column indices of the nonzero blocks of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzTotalDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">total number of nonzero blocks of matrix <samp class="ph codeph">C</samp>. Pointer
                                       <samp class="ph codeph">nnzTotalDevHostPtr</samp> can point to a device memory or
                                       host memory. 
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp>, <samp class="ph codeph">baseIdx</samp> is not
                                       base-0 or base-1, or <samp class="ph codeph">rowBlockDim</samp>,
                                       <samp class="ph codeph">colBlockDim&lt;1</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-coo2csr"><a name="cusparse-lt-t-gt-coo2csr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-coo2csr" name="cusparse-lt-t-gt-coo2csr" shape="rect">12.9.&nbsp;cusparse&lt;t&gt;coo2csr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseXcoo2csr(cusparseHandle_t handle, const int *cooRowInd,
                 int nnz, int m, int *csrRowPtr, cusparseIndexBase_t idxBase)</pre><p class="p">This function converts the array containing the uncompressed row indices (corresponding to COO format) into an array of compressed
                           row pointers (corresponding to CSR format).
                        </p>
                        <p class="p">It can also be used to convert the array containing the uncompressed column indices (corresponding to COO format) into an
                           array of column pointers (corresponding to CSC format).
                        </p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host
                           			and may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cooRowInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> uncompressed row indices.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of non-zeros of the sparse matrix (that is also the length of array <samp class="ph codeph">cooRowInd</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp> is neither <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> nor
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csc2dense"><a name="cusparse-lt-t-gt-csc2dense" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csc2dense" name="cusparse-lt-t-gt-csc2dense" shape="rect">12.10.&nbsp;cusparse&lt;t&gt;csc2dense()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseScsc2dense(cusparseHandle_t handle, int m, int n, 
                   const cusparseMatDescr_t descrA, 
                   const float           *cscValA, 
                   const int *cscRowIndA, const int *cscColPtrA,
                   float           *A, int lda)
cusparseStatus_t 
cusparseDcsc2dense(cusparseHandle_t handle, int m, int n, 
                   const cusparseMatDescr_t descrA, 
                   const double          *cscValA, 
                   const int *cscRowIndA, const int *cscColPtrA,
                  double          *A, int lda)
cusparseStatus_t 
cusparseCcsc2dense(cusparseHandle_t handle, int m, int n, 
                   const cusparseMatDescr_t descrA, 
                   const cuComplex       *cscValA, 
                   const int *cscRowIndA, const int *cscColPtrA,
                   cuComplex       *A, int lda)
cusparseStatus_t 
cusparseZcsc2dense(cusparseHandle_t handle, int m, int n, 
                   const cusparseMatDescr_t descrA, 
                   const cuDoubleComplex *cscValA, 
                   const int *cscRowIndA, const int *cscColPtrA,
                   cuDoubleComplex *A, int lda)</pre><p class="p">This function converts the sparse matrix in CSC format that is defined by the three arrays
                           				<samp class="ph codeph">cscValA</samp>, <samp class="ph codeph">cscColPtrA</samp>, and
                           				<samp class="ph codeph">cscRowIndA</samp> into the matrix <samp class="ph codeph">A</samp> in dense format. The
                           			dense matrix <samp class="ph codeph">A</samp> is filled in with the values of the sparse matrix and
                           			with zeros elsewhere.
                        </p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host
                           			and may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported
                                       							index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">cscColPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">cscColPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscRowIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">cscColPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">cscColPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 row indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscColPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">n+1</samp> elements that contains the start of every row and the end of the last column plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of dense array <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(lda, n)</samp> that is filled in with the values of the sparse matrix.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csc2hyb"><a name="cusparse-lt-t-gt-csc2hyb" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csc2hyb" name="cusparse-lt-t-gt-csc2hyb" shape="rect">12.11.&nbsp;cusparse&lt;t&gt;csc2hyb()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseScsc2hyb(cusparseHandle_t handle, int m, int n, 
            const cusparseMatDescr_t descrA, 
            const float           *cscValA,
            const int *cscRowIndA, const int *cscColPtrA, 
            cusparseHybMat_t hybA, int userEllWidth, 
            cusparseHybPartition_t partitionType)
cusparseStatus_t 
cusparseDcsc2hyb(cusparseHandle_t handle, int m, int n,
            const cusparseMatDescr_t descrA, 
            const double          *cscValA,
            const int *cscRowIndA, const int *cscColPtrA, 
            cusparseHybMat_t hybA, int userEllWidth, 
            cusparseHybPartition_t partitionType)
cusparseStatus_t 
cusparseCcsc2hyb(cusparseHandle_t handle, int m, int n, 
            const cusparseMatDescr_t descrA, 
            const cuComplex       *cscValA, 
            const int *cscRowIndA, const int *cscColPtrA, 
            cusparseHybMat_t hybA, int userEllWidth, 
            cusparseHybPartition_t partitionType)
cusparseStatus_t 
cusparseZcsc2hyb(cusparseHandle_t handle, int m, int n, 
            const cusparseMatDescr_t descrA, 
            const cuDoubleComplex *cscValA, 
            const int *cscRowIndA, const int *cscColPtrA, 
            cusparseHybMat_t hybA, int userEllWidth, 
            cusparseHybPartition_t partitionType)</pre><p class="p">This function converts a sparse matrix in CSC format into a sparse matrix in HYB format. It
                           			assumes that the <samp class="ph codeph">hybA</samp> parameter has been initialized with the
                           				<samp class="ph codeph">cusparseCreateHybMat()</samp> routine before calling this function.
                        </p>
                        <p class="p">This function requires some amount of temporary storage and a significant amount of storage for
                           			the matrix in HYB format. It is executed asynchronously with respect to the host and may
                           			return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported
                                       							index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">cscColPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">cscColPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscRowIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">cscColPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">cscColPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscColPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">userEllWidth</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">width of the regular (ELL) part of the matrix in HYB format, which should be less than the
                                       							maximum number of nonzeros per row and is only required if
                                       								<samp class="ph codeph">partitionType</samp> ==
                                       								<samp class="ph codeph">CUSPARSE_HYB_PARTITION_USER</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">partitionType</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">partitioning method to be used in the conversion (please refer to
                                       								<samp class="ph codeph">cusparseHybPartition_t</samp> for details).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">hybA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix <samp class="ph codeph">A</samp> in HYB storage format.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csr2bsr"><a name="cusparse-lt-t-gt-csr2bsr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csr2bsr" name="cusparse-lt-t-gt-csr2bsr" shape="rect">12.12.&nbsp;cusparse&lt;t&gt;csr2bsr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseXcsr2bsrNnz(cusparseHandle_t handle, 
      cusparseDirection_t dir,
      int m, 
      int n,
      const cusparseMatDescr_t descrA,
      const int *csrRowPtrA, 
      const int *csrColIndA,
      int blockDim,
      const cusparseMatDescr_t descrC,
      int *bsrRowPtrC,
      int *nnzTotalDevHostPtr)
cusparseStatus_t
cusparseScsr2bsr(cusparseHandle_t handle, 
      cusparseDirection_t dir,
      int m, 
      int n,
      const cusparseMatDescr_t descrA, 
      const float *csrValA, 
      const int *csrRowPtrA, 
      const int *csrColIndA,
      int blockDim,
      const cusparseMatDescr_t descrC,
      float *bsrValC, 
      int *bsrRowPtrC, 
      int *bsrColIndC)
cusparseStatus_t
cusparseDcsr2bsr(cusparseHandle_t handle, 
      cusparseDirection_t dir,
      int m, 
      int n,
      const cusparseMatDescr_t descrA, 
      const double *csrValA, 
      const int *csrRowPtrA, 
      const int *csrColIndA,
      int blockDim,
      const cusparseMatDescr_t descrC,
      double *bsrValC, 
      int *bsrRowPtrC, 
      int *bsrColIndC)
cusparseStatus_t
cusparseCcsr2bsr(cusparseHandle_t handle, 
      cusparseDirection_t dir,
      int m, 
      int n,
      const cusparseMatDescr_t descrA, 
      const cuComplex *csrValA, 
      const int *csrRowPtrA, 
      const int *csrColIndA,
      int blockDim,
      const cusparseMatDescr_t descrC,
      cuComplex *bsrValC, 
      int *bsrRowPtrC, 
      int *bsrColIndC)
cusparseStatus_t
cusparseZcsr2bsr(cusparseHandle_t handle, 
      cusparseDirection_t dir,
      int m, 
      int n,
      const cusparseMatDescr_t descrA, 
      const cuDoubleComplex *csrValA, 
      const int *csrRowPtrA, 
      const int *csrColIndA,
      int blockDim,
      const cusparseMatDescr_t descrC,
      cuDoubleComplex *bsrValC, 
      int *bsrRowPtrC, 
      int *bsrColIndC)
</pre><p class="p">This function converts a sparse matrix in CSR format that is defined by the three arrays
                           <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and <samp class="ph codeph">csrColIndA</samp> into a sparse
                           matrix in BSR format that is defined by arrays <samp class="ph codeph">bsrValC</samp>,
                           <samp class="ph codeph">bsrRowPtrC</samp>, and <samp class="ph codeph">bsrColIndC</samp>.
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m*n</samp> sparse matrix. The BSR format of <samp class="ph codeph">A</samp>
                           has <samp class="ph codeph">mb</samp> block rows, <samp class="ph codeph">nb</samp> block columns, and <samp class="ph codeph">nnzb</samp>
                           nonzero blocks, where <samp class="ph codeph">mb=((m+blockDim-1)/blockDim)</samp> and
                           <samp class="ph codeph">nb=(n+blockDim-1)/blockDim</samp>. 
                        </p>
                        <p class="p">If <samp class="ph codeph">m</samp> or <samp class="ph codeph">n</samp> is not multiple of <samp class="ph codeph">blockDim</samp>, zeros are filled in.
                           
                        </p>
                        <p class="p">The conversion in cuSPARSE entails a two-step approach. First, the user allocates
                           <samp class="ph codeph">bsrRowPtrC</samp> of <samp class="ph codeph">mb+1</samp> elements and uses function
                           <samp class="ph codeph">cusparseXcsr2bsrNnz()</samp> to determine the number of nonzero block columns per block
                           row. Second, the user gathers <samp class="ph codeph">nnzb</samp> (number of non-zero block columns of matrix
                           <samp class="ph codeph">C</samp>) from either <samp class="ph codeph">(nnzb=*nnzTotalDevHostPtr)</samp> or
                           <samp class="ph codeph">(nnzb=bsrRowPtrC[mb]-bsrRowPtrC[0])</samp> and allocates <samp class="ph codeph">bsrValC</samp> of
                           <samp class="ph codeph">nnzb*blockDim*blockDim</samp> elements and <samp class="ph codeph">bsrColIndC</samp> of
                           <samp class="ph codeph">nnzb</samp> elements. Finally function <samp class="ph codeph">cusparse[S|D|C|Z]csr2bsr90</samp> is
                           called to complete the conversion. 
                        </p>
                        <p class="p">The general procedure is as follows:</p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Given CSR format (csrRowPtrA, csrcolIndA, csrValA) and </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// blocks of BSR format are stored in column-major order.</span>
cusparseDirection_t dir = CUSPARSE_DIRECTION_COLUMN;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> base, nnzb;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> mb = (m + <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>-1)/<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>;
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;bsrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) *(mb+1));
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// nnzTotalDevHostPtr points to host memory</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *nnzTotalDevHostPtr = &amp;nnzb;
cusparseXcsr2bsrNnz(handle, dir, m, n,
        descrA, csrRowPtrA, csrColIndA,
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>,
        descrC, bsrRowPtrC,
        nnzTotalDevHostPtr);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (NULL != nnzTotalDevHostPtr){
    nnzb = *nnzTotalDevHostPtr;
}<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
    cudaMemcpy(&amp;nnzb, bsrRowPtrC+mb, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    cudaMemcpy(&amp;base, bsrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    nnzb -= base;
}
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;bsrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzb);
cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;bsrValC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>)*nnzb);
cusparseScsr2bsr(handle, dir, m, n,
        descrA, 
        csrValA, csrRowPtrA, csrColIndA,
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-attribute">blockDim</span>,
        descrC,
        bsrValC, bsrRowPtrC, bsrColIndC);
</pre><p class="p">If <samp class="ph codeph">blockDim</samp> is large (typically, a block cannot fit into shared memory),
                           <samp class="ph codeph">cusparse[S|D|C|Z]csr2bsr()</samp> allocates a temporary integer array of size
                           <samp class="ph codeph">mb*blockDim</samp> integers. If device memory is not available,
                           <samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp> is returned. 
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dir</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of blocks, either <samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or <samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of sparse matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz(=csrRowPtrA[m]-csrRowPtr[0])</samp> non-zero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> column indices of the non-zero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">blockDim</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">block dimension of sparse matrix <samp class="ph codeph">A</samp>. 
                                       The range of <samp class="ph codeph">blockDim</samp> is between 1 and <samp class="ph codeph">min(m,n)</samp>.
                                       	
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrValC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzb*blockDim*blockDim</samp> nonzero elements of matrix
                                       <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrRowPtrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">mb+1</samp> elements that contains the start of every block row and the end of the last block row plus one of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bsrColIndC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzb</samp> column indices of the non-zero blocks of matrix <samp class="ph codeph">C</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzTotalDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">total number of nonzero elements in device or host memory. It is equal to <samp class="ph codeph">(bsrRowPtrC[mb]-bsrRowPtrC[0])</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n&lt;0</samp>). <samp class="ph codeph">IndexBase</samp>
                                       field of <samp class="ph codeph">descrA, descrC</samp> is not base-0 or base-1, <samp class="ph codeph">dir</samp> is not
                                       row-major or column-major, or <samp class="ph codeph">blockDim</samp> is not between 1 and
                                       <samp class="ph codeph">min(m,n)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csr2coo"><a name="cusparse-lt-t-gt-csr2coo" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csr2coo" name="cusparse-lt-t-gt-csr2coo" shape="rect">12.13.&nbsp;cusparse&lt;t&gt;csr2coo()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseXcsr2coo(cusparseHandle_t handle, const int *csrRowPtr,
                 int nnz, int m, int *cooRowInd, 
                 cusparseIndexBase_t idxBase)</pre><p class="p">This function converts the array containing the compressed row pointers (corresponding to CSR format) into an array of uncompressed
                           row indices (corresponding to COO format).
                        </p>
                        <p class="p">It can also be used to convert the array containing the compressed column indices (corresponding to CSC format) into an array
                           of uncompressed column indices (corresponding to COO format).
                        </p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host
                           			and may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of the sparse matrix (that is also the length of array <samp class="ph codeph">cooRowInd</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cooRowInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> uncompressed row indices.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp> is neither <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> nor
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csr2csc"><a name="cusparse-lt-t-gt-csr2csc" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csr2csc" name="cusparse-lt-t-gt-csr2csc" shape="rect">12.14.&nbsp;cusparse&lt;t&gt;csr2csc()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseScsr2csc(cusparseHandle_t handle, int m, int n, int nnz,
                 const float *csrVal, const int *csrRowPtr, 
                 const int *csrColInd, float           *cscVal,
                 int *cscRowInd, int *cscColPtr, 
                 cusparseAction_t copyValues, 
                 cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseDcsr2csc(cusparseHandle_t handle, int m, int n, int nnz,
                 const double *csrVal, const int *csrRowPtr, 
                 const int *csrColInd, double          *cscVal,
                 int *cscRowInd, int *cscColPtr, 
                 cusparseAction_t copyValues, 
                 cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseCcsr2csc(cusparseHandle_t handle, int m, int n, int nnz,
                 const cuComplex *csrVal, const int *csrRowPtr, 
                 const int *csrColInd, cuComplex       *cscVal,
                 int *cscRowInd, int *cscColPtr, 
                 cusparseAction_t copyValues, 
                 cusparseIndexBase_t idxBase)
cusparseStatus_t 
cusparseZcsr2csc(cusparseHandle_t handle, int m, int n, int nnz,
                 const cuDoubleComplex *csrVal, const int *csrRowPtr, 
                 const int *csrColInd, cuDoubleComplex *cscVal, 
                 int *cscRowInd, int *cscColPtr, 
                 cusparseAction_t copyValues, 
                 cusparseIndexBase_t idxBase)</pre><p class="p">This function converts a sparse matrix in CSR format (that is defined by the three arrays
                           				<samp class="ph codeph">csrVal</samp>, <samp class="ph codeph">csrRowPtr</samp>, and <samp class="ph codeph">csrColInd</samp>)
                           			into a sparse matrix in CSC format (that is defined by arrays <samp class="ph codeph">cscVal</samp>,
                           				<samp class="ph codeph">cscRowInd</samp>, and <samp class="ph codeph">cscColPtr</samp>). The resulting matrix
                           			can also be seen as the transpose of the original sparse matrix. Notice that this
                           			routine can also be used to convert a matrix in CSC format into a matrix in CSR
                           			format.
                        </p>
                        <p class="p">This function requires a significant amount of extra storage that is proportional to the matrix
                           			size. It is executed asynchronously with respect to the host, and it may return control
                           			to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtr(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtr(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	nonzero elements of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtr(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtr(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the nonzero elements of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">copyValues</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_ACTION_SYMBOLIC</samp> or <samp class="ph codeph">CUSPARSE_ACTION_NUMERIC</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscVal</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">cscColPtr(n)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">cscColPtr(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix 
                                       								
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>
                                       							. It is only filled in if <samp class="ph codeph">copyValues</samp> is
                                       							set to <samp class="ph codeph">CUSPARSE_ACTION_NUMERIC</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscRowInd</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">cscColPtr(n)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">cscColPtr(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math> column indices of the nonzero elements of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscColPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">n+1</samp> elements that contains the start of every column and the end of the last column plus one.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnz&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-csr2cscEx"><a name="cusparse-csr2cscEx" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-csr2cscEx" name="cusparse-csr2cscEx" shape="rect">12.15.&nbsp;cusparseCsr2cscEx()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t cusparseCsr2cscEx(cusparseHandle_t handle,
                                   int m, int n, int nnz,
                                   const void  *csrSortedVal, cudaDataType csrSortedValtype,
                                   const int *csrSortedRowPtr, 
                                   const int *csrSortedColInd, 
                                   void *cscSortedVal, cudaDataType cscSortedValtype,
                                   int *cscSortedRowInd, 
                                   int *cscSortedColPtr, 
                                   cusparseAction_t copyValues, 
                                   cusparseIndexBase_t idxBase,
                                   cudaDataType executiontype);
</pre><p class="p">This function is an extended version of <samp class="ph codeph">cusparse&lt;t&gt;csr2csc()</samp>. For detailed description of the functionality, see <samp class="ph codeph">cusparse&lt;t&gt;csr2csc()</samp>.
                        </p>
                        <p class="p">This function does not support half-precision execution type, but it supports half-precision IO with single precision execution.</p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input specifically required by <samp class="ph codeph">cusparseCsr2cscEx</samp></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrSortedValAtype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">csrSortedValA</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscSortedValAtype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type of <samp class="ph codeph">cscSortedValA</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">executiontype</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Data type used for computation.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csr2dense"><a name="cusparse-lt-t-gt-csr2dense" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csr2dense" name="cusparse-lt-t-gt-csr2dense" shape="rect">12.16.&nbsp;cusparse&lt;t&gt;csr2dense()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve"> 
cusparseStatus_t cusparseScsr2dense(cusparseHandle_t handle,
                                    int m, 
                                    int n, 
                                    const cusparseMatDescr_t descrA,  
                                    const float *csrValA, 
                                    const int *csrRowPtrA, 
                                    const int *csrColIndA,
                                    float *A, 
                                    int lda)
    
cusparseStatus_t cusparseDcsr2dense(cusparseHandle_t handle, 
                                    int m, 
                                    int n, 
                                    const cusparseMatDescr_t descrA, 
                                    const double *csrValA, 
                                    const int *csrRowPtrA, 
                                    const int *csrColIndA,
                                    double *A, 
                                    int lda)
    
cusparseStatus_t cusparseCcsr2dense(cusparseHandle_t handle, 
                                    int m, 
                                    int n, 
                                    const cusparseMatDescr_t descrA, 
                                    const cuComplex *csrValA, 
                                    const int *csrRowPtrA, 
                                    const int *csrColIndA,
                                    cuComplex *A, 
                                    int lda)
    
cusparseStatus_t cusparseZcsr2dense(cusparseHandle_t handle,
                                    int m, 
                                    int n, 
                                    const cusparseMatDescr_t descrA, 
                                    const cuDoubleComplex *csrValA, 
                                    const int *csrRowPtrA, 
                                    const int *csrColIndA,
                                    cuDoubleComplex *A, 
                                    int lda)</pre><p class="p">This function converts the sparse matrix in CSR format (that is defined by the three arrays
                           				<samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                           				<samp class="ph codeph">csrColIndA</samp>) into the matrix <samp class="ph codeph">A</samp> in dense format. The
                           			dense matrix <samp class="ph codeph">A</samp> is filled in with the values of the sparse matrix and
                           			with zeros elsewhere.
                        </p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host,
                           			and it may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	nonzero elements of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the nonzero elements of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of array matrix<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(lda,n)</samp> that is filled in with the values of the sparse matrix.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csr2csr_compress"><a name="cusparse-lt-t-gt-csr2csr_compress" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csr2csr_compress" name="cusparse-lt-t-gt-csr2csr_compress" shape="rect">12.17.&nbsp;cusparse&lt;t&gt;csr2csr_compress()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve"> 
cusparseStatus_t cusparseScsr2csr_compress(cusparseHandle_t handle,
                                    int m, 
                                    int n, 
                                    const cusparseMatDescr_t descrA,  
                                    const float *csrValA, 
                                    const int *csrColIndA,
                                    const int *csrRowPtrA, 
                                    int nnzA,
                                    const int *nnzPerRow,
                                    float *csrValC,
                                    int *csrColIndC,
                                    int *csrRowPtrC,
                                    float tol);
    
cusparseStatus_t cusparseDcsr2csr_compress(cusparseHandle_t handle, 
                                    int m, 
                                    int n, 
                                    const cusparseMatDescr_t descrA, 
                                    const double *csrValA, 
                                    const int *csrColIndA,
                                    const int *csrRowPtrA, 
                                    int nnzA,
                                    const int *nnzPerRow, 
                                    double *csrValC,
                                    int *csrColIndC,
                                    int *csrRowPtrC,
                                    double tol);
    
cusparseStatus_t cusparseCcsr2csr_compress(cusparseHandle_t handle, 
                                    int m, 
                                    int n, 
                                    const cusparseMatDescr_t descrA, 
                                    const cuComplex *csrValA, 
                                    const int *csrColIndA,
                                    const int *csrRowPtrA, 
                                    int nnzA,
                                    const int *nnzPerRow, 
                                    cuComplex *csrValC,
                                    int *csrColIndC,
                                    int *csrRowPtrC,
                                    cuComplex tol);
    
cusparseStatus_t cusparseZcsr2csr_compress(cusparseHandle_t handle,
                                    int m, 
                                    int n, 
                                    const cusparseMatDescr_t descrA, 
                                    const cuDoubleComplex *csrValA, 
                                    const int *csrColIndA,
                                    const int *csrRowPtrA, 
                                    int nnzA,
                                    const int *nnzPerRow, 
                                    cuDoubleComplex *csrValC,
                                    int *csrColIndC,
                                    int *csrRowPtrC,
                                    cuDoubleComplex tol);

</pre><p class="p"> 
                           This function compresses the sparse matrix in CSR format into compressed CSR format. Given a sparse matrix A and a non-negative
                           value threshold(in the case of complex values, only the magnitude of the real part is used in the check), the function returns
                           a sparse matrix C, defined by                                   
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                             <mtr>
                                                <mtd>
                                                   <mi>C(i,j)</mi>
                                                   <mo>=</mo>
                                                   <mi>A(i,j)</mi>
                                                </mtd>
                                                <mtd>
                                                   <mtext> if |A(i,j)| &gt; threshold </mtext>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The implementation adopts a two-step approach to do the conversion. First, the user allocates csrRowPtrC of m+1 elements and
                           uses function cusparse&lt;t&gt;nnz_compress() to determine nnzPerRow(the number of nonzeros columns per row) and nnzC(the total
                           number of nonzeros). Second, the user allocates csrValC of nnzC elements and csrColIndC of nnzC integers. Finally function
                           cusparse&lt;t&gt;csr2csr_compress() is called to complete the conversion.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	elements of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of
                                       		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       	column indices of the elements of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements in matrix  
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzPerRow</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">this array contains the number of elements kept in the compressed matrix, by row.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">tol</td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">on input, this contains the non-negative tolerance value used for compression. Any values in matrix A less than or equal to
                                       this value will be dropped during compression.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">on output, this array contains the typed values of elements kept in the compressed matrix. Size = nnzC. </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndC </samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">on output, this integer array contains the column indices of elements kept in the compressed matrix. Size = nnzC.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">on output, this integer array contains the row pointers for elements kept in the compressed matrix. Size = m+1</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="p">
                           The following is a sample code to show how to use this API.
                           <pre xml:space="preserve">
#include &lt;stdio.h&gt;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;sys/time.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusparse.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#define ERR_NE(X,Y) do { if ((X) != (Y)) { \
                             fprintf(stderr,"Error in %s at %s:%d\n",__func__,__FILE__,__LINE__); \
                             exit(-1);}} while(0)</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#define CUDA_CALL(X) ERR_NE((X),cudaSuccess)</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#define CUSPARSE_CALL(X) ERR_NE((X),CUSPARSE_STATUS_SUCCESS)</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(){
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 6, n = 5;
    cusparseHandle_t  handle;
    CUSPARSE_CALL( cusparseCreate(&amp;handle) );
    cusparseMatDescr_t descrX;
    CUSPARSE_CALL(cusparseCreateMatDescr(&amp;descrX));
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Initialize sparse matrix</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *X;
    CUDA_CALL(cudaMallocManaged( &amp;X, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>) * m * n ));
    memset( X, 0, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>) * m * n );
    X[0 + 0*m] = 1.0;  X[0 + 1*m] = 3.0;
    X[1 + 1*m] = -4.0; X[1 + 2*m] = 5.0;
    X[2 + 0*m] = 2.0;  X[2 + 3*m] = 7.0;  X[2 + 4*m] = 8.0;
    X[3 + 2*m] = 6.0;  X[3 + 4*m] = 9.0;
    X[4 + 3*m] = 3.5;  X[4 + 4*m] = 5.5;
    X[5 + 0*m] = 6.5;  X[5 + 2*m] = -9.9;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Initialize total_nnz, and  nnzPerRowX for cusparseSdense2csr()</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> total_nnz = 13;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *nnzPerRowX;
    CUDA_CALL( cudaMallocManaged( &amp;nnzPerRowX, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * m ));
    nnzPerRowX[0] = 2;  nnzPerRowX[1] = 2;  nnzPerRowX[2] = 3;
    nnzPerRowX[3] = 2;  nnzPerRowX[4] = 2;  nnzPerRowX[5] = 2;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *csrValX;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrRowPtrX;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrColIndX;
    CUDA_CALL( cudaMallocManaged( &amp;csrValX, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>) * total_nnz) );
    CUDA_CALL( cudaMallocManaged( &amp;csrRowPtrX, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * (m+1))) ;
    CUDA_CALL( cudaMallocManaged( &amp;csrColIndX, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * total_nnz)) ;

</pre></div>
                        <div class="p">
                           Before calling this API, call two APIs to prepare the input. 
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-doccomment">/** Call cusparseSdense2csr to generate CSR format as the inputs for
    cusparseScsr2csr_compress  **/</span>
    CUSPARSE_CALL( cusparseSdense2csr( handle, m, n, descrX, X,
                                       m, nnzPerRowX, csrValX,
                                       csrRowPtrX, csrColIndX )) ;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> tol = 3.5;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *nnzPerRowY;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *testNNZTotal;
    CUDA_CALL (cudaMallocManaged( &amp;nnzPerRowY, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * m ));
    CUDA_CALL (cudaMallocManaged( &amp;testNNZTotal, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)));
    memset( nnzPerRowY, 0, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * m );
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// cusparseSnnz_compress generates nnzPerRowY and testNNZTotal</span>
    CUSPARSE_CALL( cusparseSnnz_compress(handle, m, descrX, csrValX,
                                         csrRowPtrX, nnzPerRowY,
                                         testNNZTotal, tol));

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *csrValY;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrRowPtrY;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrColIndY;
    CUDA_CALL( cudaMallocManaged( &amp;csrValY, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>) * (*testNNZTotal)));
    CUDA_CALL( cudaMallocManaged( &amp;csrRowPtrY, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * (m+1)));
    CUDA_CALL( cudaMallocManaged( &amp;csrColIndY, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * (*testNNZTotal)));

    CUSPARSE_CALL( cusparseScsr2csr_compress( handle, m, n, descrX, csrValX,
                                              csrColIndX, csrRowPtrX,
                                              total_nnz,  nnzPerRowY,
                                              csrValY, csrColIndY,
                                              csrRowPtrY, tol));
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Expect results
    nnzPerRowY:  0 2 2 2 1 2
    csrValY:     -4 5 7 8 6 9 5.5 6.5 -9.9
    csrColIndY:  1 2 3 4 2 4 4 0 2
    csrRowPtrY:  0 0 2 4 6 7 9
    */</span>
    cudaFree(X);
    cusparseDestroy(handle);
    cudaFree(nnzPerRowX);
    cudaFree(csrValX);
    cudaFree(csrRowPtrX);
    cudaFree(csrColIndX);
    cudaFree(csrValY);
    cudaFree(nnzPerRowY);
    cudaFree(testNNZTotal);
    cudaFree(csrRowPtrY);
    cudaFree(csrColIndY);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}

</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csr2hyb"><a name="cusparse-lt-t-gt-csr2hyb" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csr2hyb" name="cusparse-lt-t-gt-csr2hyb" shape="rect">12.18.&nbsp;cusparse&lt;t&gt;csr2hyb()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseScsr2hyb(cusparseHandle_t handle, int m, int n, 
            const cusparseMatDescr_t descrA, 
            const float           *csrValA,
            const int *csrRowPtrA, const int *csrColIndA, 
            cusparseHybMat_t hybA, int userEllWidth, 
            cusparseHybPartition_t partitionType)
cusparseStatus_t 
cusparseDcsr2hyb(cusparseHandle_t handle, int m, int n,
            const cusparseMatDescr_t descrA, 
            const double          *csrValA,
            const int *csrRowPtrA, const int *csrColIndA, 
            cusparseHybMat_t hybA, int userEllWidth, 
            cusparseHybPartition_t partitionType)
cusparseStatus_t 
cusparseCcsr2hyb(cusparseHandle_t handle, int m, int n, 
            const cusparseMatDescr_t descrA, 
            const cuComplex       *csrValA, 
            const int *csrRowPtrA, const int *csrColIndA, 
            cusparseHybMat_t hybA, int userEllWidth, 
            cusparseHybPartition_t partitionType)
cusparseStatus_t 
cusparseZcsr2hyb(cusparseHandle_t handle, int m, int n, 
            const cusparseMatDescr_t descrA, 
            const cuDoubleComplex *csrValA, 
            const int *csrRowPtrA, const int *csrColIndA, 
            cusparseHybMat_t hybA, int userEllWidth, 
            cusparseHybPartition_t partitionType)</pre><p class="p">This function converts a sparse matrix in CSR format into a sparse matrix in HYB format. It
                           			assumes that the <samp class="ph codeph">hybA</samp> parameter has been initialized with
                           				<samp class="ph codeph">cusparseCreateHybMat()</samp> routine before calling this function.
                        </p>
                        <p class="p">This function requires some amount of temporary storage and a significant amount of storage for
                           			the matrix in HYB format. It is executed asynchronously with respect to the host and may
                           			return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported
                                       							index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">userEllWidth</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">width of the regular (ELL) part of the matrix in HYB format, which should be less than maximum number of nonzeros per row
                                       and is only required if <samp class="ph codeph">partitionType</samp> == <samp class="ph codeph">CUSPARSE_HYB_PARTITION_USER</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">partitionType</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">partitioning method to be used in the conversion (please refer to
                                       								<samp class="ph codeph">cusparseHybPartition_t</samp> for details).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">hybA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix <samp class="ph codeph">A</samp> in HYB storage format.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-dense2csc"><a name="cusparse-lt-t-gt-dense2csc" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-dense2csc" name="cusparse-lt-t-gt-dense2csc" shape="rect">12.19.&nbsp;cusparse&lt;t&gt;dense2csc()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSdense2csc(cusparseHandle_t handle, int m, int n, 
                const cusparseMatDescr_t descrA, 
                const float           *A, 
                int lda, const int *nnzPerCol, 
                float           *cscValA, 
                int *cscRowIndA, int *cscColPtrA)
cusparseStatus_t 
cusparseDdense2csc(cusparseHandle_t handle, int m, int n, 
                const cusparseMatDescr_t descrA, 
                const double          *A, 
                int lda, const int *nnzPerCol, 
                double          *cscValA, 
                int *cscRowIndA, int *cscColPtrA)
cusparseStatus_t 
cusparseCdense2csc(cusparseHandle_t handle, int m, int n, 
                const cusparseMatDescr_t descrA, 
                const cuComplex       *A, 
                int lda, const int *nnzPerCol, 
                cuComplex       *cscValA, 
                int *cscRowIndA, int *cscColPtrA)
cusparseStatus_t 
cusparseZdense2csc(cusparseHandle_t handle, int m, int n, 
                const cusparseMatDescr_t descrA, 
                const cuDoubleComplex *A, 
                int lda, const int *nnzPerCol, 
                cuDoubleComplex *cscValA, 
                int *cscRowIndA, int *cscColPtrA)</pre><p class="p">This function converts the matrix <samp class="ph codeph">A</samp> in dense format into a sparse matrix in CSC
                           			format. All the parameters are assumed to have been pre-allocated by the user, and the
                           			arrays are filled in based on <samp class="ph codeph">nnzPerCol</samp>, which can be precomputed with
                           				<samp class="ph codeph">cusparse&lt;t&gt;nnz()</samp>.
                        </p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host
                           			and may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported
                                       							index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(lda, n)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of dense array <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzPerCol</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of size <samp class="ph codeph">n</samp> containing the number of nonzero elements per
                                       							column.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">cscRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">cscRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>. It is only
                                       							filled in if <samp class="ph codeph">copyValues</samp> is set to
                                       								<samp class="ph codeph">CUSPARSE_ACTION_NUMERIC</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscRowIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">cscRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">cscRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 row indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscColPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">n+1</samp> elements that contains the start of every column and the end of the last column plus one.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-dense2csr"><a name="cusparse-lt-t-gt-dense2csr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-dense2csr" name="cusparse-lt-t-gt-dense2csr" shape="rect">12.20.&nbsp;cusparse&lt;t&gt;dense2csr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSdense2csr(cusparseHandle_t handle, int m, int n, 
                const cusparseMatDescr_t descrA, 
                const float           *A, 
                int lda, const int *nnzPerRow, 
                float           *csrValA, 
                int *csrRowPtrA, int *csrColIndA) 
cusparseStatus_t 
cusparseDdense2csr(cusparseHandle_t handle, int m, int n, 
                const cusparseMatDescr_t descrA, 
                const double          *A, 
                int lda, const int *nnzPerRow, 
                double          *csrValA, 
                int *csrRowPtrA, int *csrColIndA) 
cusparseStatus_t 
cusparseCdense2csr(cusparseHandle_t handle, int m, int n, 
                const cusparseMatDescr_t descrA, 
                const cuComplex       *A, 
                int lda, const int *nnzPerRow, 
                cuComplex       *csrValA, 
                int *csrRowPtrA, int *csrColIndA) 
cusparseStatus_t 
cusparseZdense2csr(cusparseHandle_t handle, int m, int n, 
                const cusparseMatDescr_t descrA, 
                const cuDoubleComplex *A, 
                int lda, const int *nnzPerRow, 
                cuDoubleComplex *csrValA, 
                int *csrRowPtrA, int *csrColIndA) </pre><p class="p">This function converts the matrix <samp class="ph codeph">A</samp> in dense format into a sparse matrix in CSR
                           			format. All the parameters are assumed to have been pre-allocated by the user and the
                           			arrays are filled in based on <samp class="ph codeph">nnzPerRow</samp>, which can be pre-computed with
                           				<samp class="ph codeph">cusparse&lt;t&gt;nnz()</samp>.
                        </p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host
                           			and may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported
                                       							index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(lda, n)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of dense array <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzPerRow</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of size <samp class="ph codeph">n</samp> containing the number of non-zero elements per row.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every column and the end of the last column plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the non-zero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-dense2hyb"><a name="cusparse-lt-t-gt-dense2hyb" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-dense2hyb" name="cusparse-lt-t-gt-dense2hyb" shape="rect">12.21.&nbsp;cusparse&lt;t&gt;dense2hyb()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseSdense2hyb(cusparseHandle_t handle, int m, int n,
                   const cusparseMatDescr_t descrA, 
                   const float           *A,
                   int lda, const int *nnzPerRow, cusparseHybMat_t hybA,
                   int userEllWidth, 
                   cusparseHybPartition_t partitionType)
cusparseStatus_t
cusparseDdense2hyb(cusparseHandle_t handle, int m, int n,
                   const cusparseMatDescr_t descrA, 
                   const double          *A,
                   int lda, const int *nnzPerRow, cusparseHybMat_t hybA, 
                   int userEllWidth, 
                   cusparseHybPartition_t partitionType)
cusparseStatus_t
cusparseCdense2hyb(cusparseHandle_t handle, int m, int n,
                   const cusparseMatDescr_t descrA, 
                   const cuComplex       *A,
                   int lda, const int *nnzPerRow, cusparseHybMat_t hybA,
                   int userEllWidth, 
                   cusparseHybPartition_t partitionType)
cusparseStatus_t
cusparseZdense2hyb(cusparseHandle_t handle, int m, int n,
                   const cusparseMatDescr_t descrA, 
                   const cuDoubleComplex *A,
                   int lda, const int *nnzPerRow, cusparseHybMat_t hybA,
                   int userEllWidth, 
                   cusparseHybPartition_t partitionType)</pre><p class="p">This function converts matrix <samp class="ph codeph">A</samp> in dense format into a sparse matrix in HYB
                           			format. It assumes that the routine <samp class="ph codeph">cusparseCreateHybMat()</samp> was used to
                           			initialize the opaque structure <samp class="ph codeph">hybA</samp> and that the array
                           				<samp class="ph codeph">nnzPerRow</samp> was pre-computed with
                           				<samp class="ph codeph">cusparse&lt;t&gt;nnz()</samp>.
                        </p>
                        <p class="p">This function requires some amount of temporary storage and a significant amount of storage for
                           			the matrix in HYB format. It is executed asynchronously with respect to the host and may
                           			return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix 
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                       </math>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(lda, n)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of dense array <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzPerRow</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of size <samp class="ph codeph">m</samp> containing the number of nonzero elements per row.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">userEllWidth</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">width of the regular (ELL) part of the matrix in HYB format, which should be less than
                                       							maximum number of nonzeros per row and is only required if
                                       								<samp class="ph codeph">partitionType</samp> ==
                                       								<samp class="ph codeph">CUSPARSE_HYB_PARTITION_USER</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">partitionType</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">partitioning method to be used in the conversion (please refer to
                                       								<samp class="ph codeph">cusparseHybPartition_t</samp> for details).
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">hybA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix <samp class="ph codeph">A</samp> in HYB storage format.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-hyb2csc"><a name="cusparse-lt-t-gt-hyb2csc" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-hyb2csc" name="cusparse-lt-t-gt-hyb2csc" shape="rect">12.22.&nbsp;cusparse&lt;t&gt;hyb2csc()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseShyb2csc(cusparseHandle_t handle, 
                 const cusparseMatDescr_t descrA, 
                 const cusparseHybMat_t hybA,
                 float       *cscValA, int *cscRowIndA, int *cscColPtrA)
cusparseStatus_t 
cusparseDhyb2csc(cusparseHandle_t handle,
                 const cusparseMatDescr_t descrA, 
                 const cusparseHybMat_t hybA,
                 double      *cscValA, int *cscRowIndA, int *cscColPtrA)              
cusparseStatus_t 
cusparseChyb2csc(cusparseHandle_t handle,
                 const cusparseMatDescr_t descrA, 
                 const cusparseHybMat_t hybA,
                 cuComplex   *cscValA, int *cscRowIndA, int *cscColPtrA)
cusparseStatus_t 
cusparseZhyb2csc(cusparseHandle_t handle,
                 const cusparseMatDescr_t descrA, 
                 const cusparseHybMat_t hybA,
                 cuDoubleComplex *cscValA, int *cscRowIndA, int *cscColPtrA)</pre><p class="p">This function converts a sparse matrix in HYB format into a sparse matrix in CSC format.</p>
                        <p class="p">This function requires some amount of temporary storage. It is executed asynchronously with
                           			respect to the host and may return control to the application on the host before the
                           			result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp> in Hyb format. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">hybA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix <samp class="ph codeph">A</samp> in HYB storage format.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">cscColPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">cscColPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscRowIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">cscColPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">cscColPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the non-zero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cscColPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every column and the end of the last row plus one.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-hyb2csr"><a name="cusparse-lt-t-gt-hyb2csr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-hyb2csr" name="cusparse-lt-t-gt-hyb2csr" shape="rect">12.23.&nbsp;cusparse&lt;t&gt;hyb2csr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseShyb2csr(cusparseHandle_t handle, 
                 const cusparseMatDescr_t descrA, 
                 const cusparseHybMat_t hybA,
                 float       *csrValA, int *csrRowPtrA, int *csrColIndA)
cusparseStatus_t 
cusparseDhyb2csr(cusparseHandle_t handle,
                 const cusparseMatDescr_t descrA, 
                 const cusparseHybMat_t hybA,
                 double      *csrValA, int *csrRowPtrA, int *csrColIndA)              
cusparseStatus_t 
cusparseChyb2csr(cusparseHandle_t handle,
                 const cusparseMatDescr_t descrA, 
                 const cusparseHybMat_t hybA,
                 cuComplex   *csrValA, int *csrRowPtrA, int *csrColIndA)
cusparseStatus_t 
cusparseZhyb2csr(cusparseHandle_t handle,
                 const cusparseMatDescr_t descrA, 
                 const cusparseHybMat_t hybA,
                 cuDoubleComplex *csrValA, int *csrRowPtrA, int *csrColIndA)</pre><p class="p">This function converts a sparse matrix in HYB format into a sparse matrix in CSR format.</p>
                        <p class="p">This function requires some amount of temporary storage. It is executed asynchronously with
                           			respect to the host and may return control to the application on the host before the
                           			result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp> in Hyb format. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">hybA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix <samp class="ph codeph">A</samp> in HYB storage format.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every column and the end of the last row plus one.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">(</mo>
                                          <mo>=</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo>-</mo>
                                       </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mo stretchy="false">)</mo>
                                       </math>
                                       							 column indices of the nonzero elements of matrix
                                       								<samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-hyb2dense"><a name="cusparse-lt-t-gt-hyb2dense" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-hyb2dense" name="cusparse-lt-t-gt-hyb2dense" shape="rect">12.24.&nbsp;cusparse&lt;t&gt;hyb2dense()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseShyb2dense(cusparseHandle_t handle,
                   const cusparseMatDescr_t descrA,
                   const cusparseHybMat_t hybA,
                   float *A,
                   int lda)
cusparseStatus_t 
cusparseDhyb2dense(cusparseHandle_t handle,
                   const cusparseMatDescr_t descrA,
                   const cusparseHybMat_t hybA,
                   double *A,
                   int lda)
cusparseStatus_t 
cusparseChyb2dense(cusparseHandle_t handle,
                   const cusparseMatDescr_t descrA,
                   const cusparseHybMat_t hybA,
                   cuComplex *A,
                   int lda)
cusparseStatus_t 
cusparseZhyb2dense(cusparseHandle_t handle,
                   const cusparseMatDescr_t descrA,
                   const cusparseHybMat_t hybA,
                   cuDoubleComplex *A,
                   int lda)
</pre><p class="p">This function converts a sparse matrix in HYB format (contained in the opaque structure ) into
                           			matrix <samp class="ph codeph">A</samp> in dense format. The dense matrix <samp class="ph codeph">A</samp> is filled
                           			in with the values of the sparse matrix and with zeros elsewhere.
                        </p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host
                           			and may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp> in Hyb format. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">hybA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix <samp class="ph codeph">A</samp> in HYB storage format.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of dense array <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(lda, n)</samp> that is filled in with the values of the sparse matrix.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the internally stored hyb format parameters are invalid.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-nnz"><a name="cusparse-lt-t-gt-nnz" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-nnz" name="cusparse-lt-t-gt-nnz" shape="rect">12.25.&nbsp;cusparse&lt;t&gt;nnz()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSnnz(cusparseHandle_t handle, cusparseDirection_t dirA, int m, 
             int n, const cusparseMatDescr_t descrA, 
             const float           *A, 
             int lda, int *nnzPerRowColumn, int *nnzTotalDevHostPtr)
cusparseStatus_t 
cusparseDnnz(cusparseHandle_t handle, cusparseDirection_t dirA, int m, 
             int n, const cusparseMatDescr_t descrA, 
             const double          *A, 
             int lda, int *nnzPerRowColumn, int *nnzTotalDevHostPtr)
cusparseStatus_t 
cusparseCnnz(cusparseHandle_t handle, cusparseDirection_t dirA, int m, 
             int n, const cusparseMatDescr_t descrA, 
             const cuComplex       *A, 
             int lda, int *nnzPerRowColumn, int *nnzTotalDevHostPtr)
cusparseStatus_t 
cusparseZnnz(cusparseHandle_t handle, cusparseDirection_t dirA, int m, 
             int n, const cusparseMatDescr_t descrA, 
             const cuDoubleComplex *A, 
             int lda, int *nnzPerRowColumn, int *nnzTotalDevHostPtr)</pre><p class="p">This function computes the number of nonzero elements per row or column and the total number of
                           			nonzero elements in a dense matrix.
                        </p>
                        <p class="p">This function requires no extra storage. It is executed asynchronously with respect to the host
                           			and may return control to the application on the host before the result is ready.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dirA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">direction that specifies whether to count nonzero elements by
                                       								<samp class="ph codeph">CUSPARSE_DIRECTION_ROW</samp> or by
                                       								<samp class="ph codeph">CUSPARSE_DIRECTION_COLUMN</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported
                                       							index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of dimensions <samp class="ph codeph">(lda, n)</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of dense array <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzPerRowColumn</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">array of size <samp class="ph codeph">m</samp> or <samp class="ph codeph">n</samp> containing the number of nonzero
                                       							elements per row or column, respectively.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzTotalDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">total number of nonzero elements in device or host memory.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-identity"><a name="cusparse-lt-t-gt-identity" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-identity" name="cusparse-lt-t-gt-identity" shape="rect">12.26.&nbsp;cusparseCreateIdentityPermutation()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseCreateIdentityPermutation(cusparseHandle_t handle,
                                  int n,
                                  int *p);
</pre><p class="p">
                           This function creates an identity map. 
                           The output parameter <samp class="ph codeph">p</samp> represents such map by 
                           <samp class="ph codeph">p = 0:1:(n-1)</samp>.
                           
                        </p>
                        <p class="p">
                           This function is typically used with <samp class="ph codeph">coosort</samp>, <samp class="ph codeph">csrsort</samp>,
                           <samp class="ph codeph">cscsort</samp>, <samp class="ph codeph">csr2csc_indexOnly</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">size of the map.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">p</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of dimensions <samp class="ph codeph">n</samp>.
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-coosort"><a name="cusparse-lt-t-gt-coosort" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-coosort" name="cusparse-lt-t-gt-coosort" shape="rect">12.27.&nbsp;cusparseXcoosort()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseXcoosort_bufferSizeExt(
                      cusparseHandle_t handle,
                      int m,
                      int n,
                      int nnz,
                      const int *cooRows,
                      const int *cooCols,
                      size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseXcoosortByRow(cusparseHandle_t handle,
                      int m,
                      int n,
                      int nnz,
                      int *cooRows,
                      int *cooCols,
                      int *P,
                      void *pBuffer);

cusparseStatus_t 
cusparseXcoosortByColumn(cusparseHandle_t handle,
                         int m,
                         int n,
                         int nnz,
                         int *cooRows,
                         int *cooCols,
                         int *P,
                         void *pBuffer);

</pre><p class="p">
                           This function sorts COO format. The sorting is in-place.  
                           Also the user can sort by row or sort by column.
                           
                        </p>
                        <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×n</samp> sparse matrix that is defined in COO storage
                           format by the three arrays <samp class="ph codeph">cooVals</samp>, <samp class="ph codeph">cooRows</samp>, and
                           <samp class="ph codeph">cooCols</samp>.
                           
                        </p>
                        <p class="p">
                           There is no assumption for the base index of the matrix.
                           <samp class="ph codeph">coosort</samp> uses stable sort on signed integer, so the value of <samp class="ph codeph">cooRows</samp>
                           or <samp class="ph codeph">cooCols</samp> can be negative.
                           
                        </p>
                        <p class="p">
                           This function <samp class="ph codeph">coosort()</samp> requires buffer size returned by
                           <samp class="ph codeph">coosort_bufferSizeExt()</samp>.
                           The address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If not,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned.
                           
                        </p>
                        <p class="p">
                           The parameter <samp class="ph codeph">P</samp> is both input and output.
                           If the user wants to compute sorted <samp class="ph codeph">cooVal</samp>, <samp class="ph codeph">P</samp> must be set as
                           0:1:(nnz-1) before <samp class="ph codeph">coosort()</samp>, and
                           after <samp class="ph codeph">coosort()</samp>, new sorted value array satisfies <samp class="ph codeph">cooVal_sorted = cooVal(P)</samp>.
                           
                        </p>
                        <p class="p">
                           Remark: the dimension <samp class="ph codeph">m</samp> and <samp class="ph codeph">n</samp> are not used.
                           If the user does not know the value of <samp class="ph codeph">m</samp> or <samp class="ph codeph">n</samp>, just passes a value positive.
                           This usually happens if the user only reads a COO array first and needs to decide the dimension 
                           <samp class="ph codeph">m</samp> or <samp class="ph codeph">n</samp> later.
                           
                        </p>
                        <p class="p">
                           Appendix D provides a simple example of <samp class="ph codeph">coosort()</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">cooRows</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> unsorted row indices of <samp class="ph codeph">A</samp>. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">cooCols</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> unsorted column indices of <samp class="ph codeph">A</samp>. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">P</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> unsorted map indices.
                                       To construct <samp class="ph codeph">cooVal</samp>, the user has to set <samp class="ph codeph">P=0:1:(nnz-1)</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                       <samp class="ph codeph">coosort_bufferSizeExt()</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">cooRows</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> sorted row indices of <samp class="ph codeph">A</samp>. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">cooCols</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> sorted column indices of <samp class="ph codeph">A</samp>. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">P</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> sorted map indices.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of bytes of the buffer.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csrsort"><a name="cusparse-lt-t-gt-csrsort" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csrsort" name="cusparse-lt-t-gt-csrsort" shape="rect">12.28.&nbsp;cusparseXcsrsort()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseXcsrsort_bufferSizeExt(
                 cusparseHandle_t handle,
                 int m,
                 int n,
                 int nnz,
                 const int *csrRowPtr,
                 const int *csrColInd,
                 size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseXcsrsort(cusparseHandle_t handle,
                 int m,
                 int n,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 const int *csrRowPtr,
                 int *csrColInd,
                 int *P,
                 void *pBuffer);

</pre><p class="p">
                           This function sorts CSR format. The stable sorting is in-place.  
                           
                        </p>
                        <p class="p">
                           The matrix type is regarded as <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> implicitly.
                           In other words, any symmetric property is ignored.
                           
                        </p>
                        <p class="p">
                           This function <samp class="ph codeph">csrsort()</samp> requires buffer size returned by
                           <samp class="ph codeph">csrsort_bufferSizeExt()</samp>.
                           The address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If not,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned.
                           
                        </p>
                        <p class="p">
                           The parameter <samp class="ph codeph">P</samp> is both input and output.
                           If the user wants to compute sorted <samp class="ph codeph">csrVal</samp>, <samp class="ph codeph">P</samp> must be set as
                           0:1:(nnz-1) before <samp class="ph codeph">csrsort()</samp>, and
                           after <samp class="ph codeph">csrsort()</samp>, new sorted value array satisfies <samp class="ph codeph">csrVal_sorted = csrVal(P)</samp>.
                           
                        </p>
                        <p class="p">
                           The general procedure is as follows:
                           
                        </p><pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// A is a 3x3 sparse matrix, base-0</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//     | 1 2 3 |</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// A = | 4 5 6 |</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//     | 7 8 9 |</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 3;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnz = 9;
csrRowPtr[m+1] = { 0, 3, 6, 9}; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// on device</span>
csrColInd[nnz] = { 2, 1, 0, 0, 2,1, 1, 2, 0}; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// on device</span>
csrVal[nnz] = { 3, 2, 1, 4, 6, 5, 8, 9, 7}; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// on device</span>
size_t pBufferSizeInBytes = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *pBuffer = NULL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *P = NULL;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: allocate buffer</span>
cusparseXcsrsort_bufferSizeExt(handle, m, n, nnz, csrRowPtr, csrColInd, &amp;pBufferSizeInBytes);
cudaMalloc( &amp;pBuffer, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>)* pBufferSizeInBytes);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: setup permutation vector P to identity</span>
cudaMalloc( (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;P, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnz);
cusparseCreateIdentityPermutation(handle, nnz, P);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: sort CSR format</span>
cusparseXcsrsort(handle, m, n, nnz, descrA, csrRowPtr, csrColInd, P, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: gather sorted csrVal</span>
cusparseDgthr(handle, nnz, csrVal, csrVal_sorted, P, CUSPARSE_INDEX_BASE_ZERO);

</pre><div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowsPtr</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row 
                                       and the end of the last row plus one.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrColInd</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> unsorted column indices of <samp class="ph codeph">A</samp>. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">P</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> unsorted map indices.
                                       To construct <samp class="ph codeph">csrVal</samp>, the user has to set <samp class="ph codeph">P=0:1:(nnz-1)</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                       <samp class="ph codeph">csrsort_bufferSizeExt()</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrColInd</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> sorted column indices of <samp class="ph codeph">A</samp>. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">P</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> sorted map indices.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of bytes of the buffer.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnz&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-cscsort"><a name="cusparse-lt-t-gt-cscsort" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-cscsort" name="cusparse-lt-t-gt-cscsort" shape="rect">12.29.&nbsp;cusparseXcscsort()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseXcscsort_bufferSizeExt(
                 cusparseHandle_t handle,
                 int m,
                 int n,
                 int nnz,
                 const int *cscColPtr,
                 const int *cscRowInd,
                 size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseXcscsort(cusparseHandle_t handle,
                 int m,
                 int n,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 const int *cscColPtr,
                 int *cscRowInd,
                 int *P,
                 void *pBuffer);

</pre><p class="p">
                           This function sorts CSC format. The stable sorting is in-place.  
                           
                        </p>
                        <p class="p">
                           The matrix type is regarded as <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> implicitly.
                           In other words, any symmetric property is ignored.
                           
                        </p>
                        <p class="p">
                           This function <samp class="ph codeph">cscsort()</samp> requires buffer size returned by
                           <samp class="ph codeph">cscsort_bufferSizeExt()</samp>.
                           The address of <samp class="ph codeph">pBuffer</samp> must be multiple of 128 bytes. If not,
                           <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned.
                           
                        </p>
                        <p class="p">
                           The parameter <samp class="ph codeph">P</samp> is both input and output.
                           If the user wants to compute sorted <samp class="ph codeph">cscVal</samp>, <samp class="ph codeph">P</samp> must be set as
                           0:1:(nnz-1) before <samp class="ph codeph">cscsort()</samp>, and
                           after <samp class="ph codeph">cscsort()</samp>, new sorted value array satisfies <samp class="ph codeph">cscVal_sorted = cscVal(P)</samp>.
                           
                        </p>
                        <p class="p">
                           The general procedure is as follows: 
                           
                        </p><pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// A is a 3x3 sparse matrix, base-0</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//     | 1 2  |</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// A = | 4 0  |</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//     | 0 8  |</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 2;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnz = 4;
cscColPtr[n+1] = { 0, 2, 4}; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// on device</span>
cscRowInd[nnz] = { 1, 0, 2, 0}; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// on device</span>
cscVal[nnz]    = { 4.0, 1.0, 8.0, 2.0 }; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// on device</span>
size_t pBufferSizeInBytes = 0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *pBuffer = NULL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *P = NULL;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: allocate buffer</span>
cusparseXcscsort_bufferSizeExt(handle, m, n, nnz, cscColPtr, cscRowInd, &amp;pBufferSizeInBytes);
cudaMalloc( &amp;pBuffer, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>)* pBufferSizeInBytes);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: setup permutation vector P to identity</span>
cudaMalloc( (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;P, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnz);
cusparseCreateIdentityPermutation(handle, nnz, P);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: sort CSC format</span>
cusparseXcscsort(handle, m, n, nnz, descrA, cscColPtr, cscRowInd, P, pBuffer);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: gather sorted cscVal</span>
cusparseDgthr(handle, nnz, cscVal, cscVal_sorted, P, CUSPARSE_INDEX_BASE_ZERO);

</pre><div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">cscColPtr</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">n+1</samp> elements that contains the start of every column 
                                       and the end of the last column plus one.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">cscRowInd</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> unsorted row indices of <samp class="ph codeph">A</samp>. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">P</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> unsorted map indices.
                                       To construct <samp class="ph codeph">cscVal</samp>, the user has to set <samp class="ph codeph">P=0:1:(nnz-1)</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                       <samp class="ph codeph">cscsort_bufferSizeExt()</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">cscRowInd</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> sorted row indices of <samp class="ph codeph">A</samp>. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">P</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> sorted map indices.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of bytes of the buffer.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnz&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-csru2csr"><a name="cusparse-lt-t-gt-csru2csr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-csru2csr" name="cusparse-lt-t-gt-csru2csr" shape="rect">12.30.&nbsp;cusparseXcsru2csr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t cusparseCreateCsru2csrInfo(csru2csrInfo_t *info);

cusparseStatus_t cusparseDestroyCsru2csrInfo(csru2csrInfo_t info);

cusparseStatus_t 
cusparseScsru2csr_bufferSizeExt(
                          cusparseHandle_t handle,
                          int m,
                          int n,
                          int nnz,
                          float *csrVal,
                          const int *csrRowPtr,
                          int *csrColInd,
                          csru2csrInfo_t  info,
                          size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseDcsru2csr_bufferSizeExt(
                          cusparseHandle_t handle,
                          int m,
                          int n,
                          int nnz,
                          double *csrVal,
                          const int *csrRowPtr,
                          int *csrColInd,
                          csru2csrInfo_t  info,
                          size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseCcsru2csr_bufferSizeExt(
                          cusparseHandle_t handle,
                          int m,
                          int n,
                          int nnz,
                          cuComplex *csrVal,
                          const int *csrRowPtr,
                          int *csrColInd,
                          csru2csrInfo_t  info,
                          size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseZcsru2csr_bufferSizeExt(
                          cusparseHandle_t handle,
                          int m,
                          int n,
                          int nnz,
                          cuDoubleComplex *csrVal,
                          const int *csrRowPtr,
                          int *csrColInd,
                          csru2csrInfo_t  info,
                          size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseScsru2csr(cusparseHandle_t handle,
                  int m,
                  int n,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  float *csrVal,
                  const int *csrRowPtr,
                  int *csrColInd,
                  csru2csrInfo_t  info,
                  void *pBuffer);

cusparseStatus_t 
cusparseDcsru2csr(cusparseHandle_t handle,
                  int m,
                  int n,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  double *csrVal,
                  const int *csrRowPtr,
                  int *csrColInd,
                  csru2csrInfo_t  info,
                  void *pBuffer);

cusparseStatus_t
cusparseCcsru2csr(cusparseHandle_t handle,
                  int m,
                  int n,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  cuComplex *csrVal,
                  const int *csrRowPtr,
                  int *csrColInd,
                  csru2csrInfo_t  info,
                  void *pBuffer);

cusparseStatus_t 
cusparseZcsru2csr(cusparseHandle_t handle,
                  int m,
                  int n,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  cuDoubleComplex *csrVal,
                  const int *csrRowPtr,
                  int *csrColInd,
                  csru2csrInfo_t  info,
                  void *pBuffer);

cusparseStatus_t 
cusparseScsr2csru(cusparseHandle_t handle,
                  int m,
                  int n,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  float *csrVal,
                  const int *csrRowPtr,
                  int *csrColInd,
                  csru2csrInfo_t  info,
                  void *pBuffer);

cusparseStatus_t 
cusparseDcsr2csru(cusparseHandle_t handle,
                  int m,
                  int n,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  double *csrVal,
                  const int *csrRowPtr,
                  int *csrColInd,
                  csru2csrInfo_t  info,
                  void *pBuffer);

cusparseStatus_t 
cusparseCcsr2csru(cusparseHandle_t handle,
                  int m,
                  int n,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  cuComplex *csrVal,
                  const int *csrRowPtr,
                  int *csrColInd,
                  csru2csrInfo_t  info,
                  void *pBuffer);

cusparseStatus_t 
cusparseZcsr2csru(cusparseHandle_t handle,
                  int m,
                  int n,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  cuDoubleComplex *csrVal,
                  const int *csrRowPtr,
                  int *csrColInd,
                  csru2csrInfo_t  info,
                  void *pBuffer);

</pre><p class="p">
                           This function transfers unsorted CSR format to CSR format, and vice versa.
                           The operation is in-place.  
                           
                        </p>
                        <p class="p">
                           This function is a wrapper of <samp class="ph codeph">csrsort</samp> and <samp class="ph codeph">gthr</samp>.
                           The usecase is the following scenario.
                           
                        </p>
                        <p class="p">
                           If the user has a matrix <samp class="ph codeph">A</samp> of CSR format which is unsorted, 
                           and implements his own code (which can be CPU or GPU kernel) based on this special order 
                           (for example, diagonal first, then lower triangle, then upper triangle), 
                           and wants to convert it to CSR format when calling CUSPARSE library, 
                           and then convert it back when doing something else on his/her kernel.
                           For example, suppose the user wants to solve a linear system <samp class="ph codeph">Ax=b</samp> 
                           by the following iterative scheme
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msup>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>(k+1)</mi>
                                             </mrow>
                                          </msup>
                                          <mo>=</mo>
                                          <msup>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>(k)</mi>
                                             </mrow>
                                          </msup>
                                          <mo>+</mo>
                                          <msup>
                                             <mi>L</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>(-1)</mi>
                                             </mrow>
                                          </msup>
                                          <mo>*</mo>
                                          <mi>(</mi>
                                          <mi>b</mi>
                                          <mo>-</mo>
                                          <mi>A</mi>
                                          <msup>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>(k)</mi>
                                             </mrow>
                                          </msup>
                                          <mi>)</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The code heavily uses SpMv and triangular solve. 
                           Assume that the user has an in-house design of SpMV (Sparse Matrix-Vector multiplication) 
                           based on special order of <samp class="ph codeph">A</samp>. 
                           However the user wants to use CUSAPRSE library for triangular solver. 
                           Then the following code can work.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all"><span class="desc tabledesc"></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="left" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mtable rowspacing="4pt" columnspacing="1em">
                                                <mtr>
                                                   <mi>do</mi>
                                                </mtr>
                                                <mtr>
                                                   <mi> </mi>
                                                   <mi> </mi>
                                                   <mi>step 1: compute residual vector </mi>
                                                   <mi>r</mi>
                                                   <mo>=</mo>
                                                   <mi>b</mi>
                                                   <mo>-</mo>
                                                   <mi>A</mi>
                                                   <msup>
                                                      <mi>x</mi>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mi>(k)</mi>
                                                      </mrow>
                                                   </msup>
                                                   <mi>by in-house SpMV </mi>
                                                </mtr>
                                                <mtr>
                                                   <mi> </mi>
                                                   <mi> </mi>
                                                   <mi>step 2: B := sort(A), and L is lower triangular part of B</mi>
                                                </mtr>
                                                <mtr>
                                                   <mi> </mi>
                                                   <mi> </mi>
                                                   <mi>(only sort A once and keep the permutation vector)</mi>
                                                </mtr>
                                                <mtr>
                                                   <mi> </mi>
                                                   <mi> </mi>
                                                   <mi>step 3: solve</mi>
                                                   <mi>z</mi>
                                                   <mo>=</mo>
                                                   <msup>
                                                      <mi>L</mi>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mi>(-1)</mi>
                                                      </mrow>
                                                   </msup>
                                                   <mo>*</mo>
                                                   <mi>(</mi>
                                                   <mi>b</mi>
                                                   <mo>-</mo>
                                                   <mi>A</mi>
                                                   <msup>
                                                      <mi>x</mi>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mi>(k)</mi>
                                                      </mrow>
                                                   </msup>
                                                   <mi>)</mi>
                                                   <mi>by cusparseXcsrsv</mi>
                                                </mtr>
                                                <mtr>
                                                   <mi> </mi>
                                                   <mi> </mi>
                                                   <mi>step 4: add correction</mi>
                                                   <msup>
                                                      <mi>x</mi>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mi>(k+1)</mi>
                                                      </mrow>
                                                   </msup>
                                                   <mo>=</mo>
                                                   <msup>
                                                      <mi>x</mi>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mi>(k)</mi>
                                                      </mrow>
                                                   </msup>
                                                   <mo>+</mo>
                                                   <mi>z</mi>
                                                </mtr>
                                                <mtr>
                                                   <mi> </mi>
                                                   <mi> </mi>
                                                   <mi>step 5: A := unsort(B)</mi>
                                                </mtr>
                                                <mtr>
                                                   <mi> </mi>
                                                   <mi> </mi>
                                                   <mi>(use permutation vector to get back the unsorted CSR)</mi>
                                                </mtr>
                                                <mtr>
                                                   <mi>until convergence</mi>
                                                </mtr>
                                             </mtable>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"></p>
                        <p class="p">
                           The requirements of step 2 and step 5 are
                           
                        </p>
                        <p class="p">
                           1. In-place operation.
                           
                        </p>
                        <p class="p">
                           2. The permutation vector <samp class="ph codeph">P</samp> is hidden in an opaque structure.
                           
                        </p>
                        <p class="p">
                           3. No <samp class="ph codeph">cudaMalloc</samp> inside the conversion routine. 
                           Instead, the user has to provide the buffer explicitly.
                           
                        </p>
                        <p class="p">
                           4. The conversion between unsorted CSR and sorted CSR may needs several times, 
                           but the function only generates the permutation vector <samp class="ph codeph">P</samp> once.
                           
                        </p>
                        <p class="p">
                           5. The function is based on <samp class="ph codeph">csrsort</samp>, <samp class="ph codeph">gather</samp> 
                           and <samp class="ph codeph">scatter</samp> operations.
                           
                        </p>
                        <p class="p">
                           The operation is called <samp class="ph codeph">csru2csr</samp>, which means unsorted CSR to sorted CSR. 
                           Also we provide the inverse operation, called <samp class="ph codeph">csr2csru</samp>.
                           
                        </p>
                        <p class="p">
                           In order to keep the permutation vector invisible, we need an opaque structure called 
                           <samp class="ph codeph">csru2csrInfo</samp>.
                           Then two functions (<samp class="ph codeph">cusparseCreateCsru2csrInfo</samp>, 
                           <samp class="ph codeph">cusparseDestroyCsru2csrInfo</samp>) are used
                           to initialize and to destroy the opaque structure.
                           
                        </p>
                        <p class="p"><samp class="ph codeph">cusparse[S|D|C|Z]csru2csr_bufferSizeExt</samp> returns the size of the buffer. 
                           The permutation vector <samp class="ph codeph">P</samp> is also allcated inside <samp class="ph codeph">csru2csrInfo</samp>. 
                           The lifetime of the permutation vector is the same as the lifetime of <samp class="ph codeph">csru2csrInfo</samp>.
                           
                        </p>
                        <p class="p"><samp class="ph codeph">cusparse[S|D|C|Z]csru2csr</samp> performs forward transformation from unsorted CSR to sorted CSR.
                           First call uses csrsort to generate the permutation vector <samp class="ph codeph">P</samp>, 
                           and subsequent call uses <samp class="ph codeph">P</samp> to do transformation.
                           
                        </p>
                        <p class="p"><samp class="ph codeph">cusparse[S|D|C|Z]csr2csru</samp> performs backward transformation from sorted CSR to unsorted CSR.
                           <samp class="ph codeph">P</samp> is used to get unsorted form back.
                           
                        </p>
                        <p class="p">
                           The following tables describe parameters of <samp class="ph codeph">csr2csru_bufferSizeExt</samp> 
                           and <samp class="ph codeph">csr2csru</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. 
                                       The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>,
                                       Also, the supported
                                       index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrVal</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">&lt;type&gt; array of nnz unsorted nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowsPtr</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row 
                                       and the end of the last row plus one.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrColInd</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> unsorted column indices of <samp class="ph codeph">A</samp>. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">opaque structure initialized using <samp class="ph codeph">cusparseCreateCsru2csrInfo()</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                       <samp class="ph codeph">csru2csr_bufferSizeExt()</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrVal</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">&lt;type&gt; array of nnz sorted nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrColInd</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> sorted column indices of <samp class="ph codeph">A</samp>. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of bytes of the buffer.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnz&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-pruneDense2csr"><a name="cusparse-lt-t-gt-pruneDense2csr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-pruneDense2csr" name="cusparse-lt-t-gt-pruneDense2csr" shape="rect">12.31.&nbsp;cusparseXpruneDense2csr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseHpruneDense2csr_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    const __half *A,
    int lda,
    const __half *threshold,
    const cusparseMatDescr_t descrC,
    const __half *csrValC,
    const int *csrRowPtrC,
    const int *csrColIndC,
    size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseSpruneDense2csr_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    const float *A,
    int lda,
    const float *threshold,
    const cusparseMatDescr_t descrC,
    const float *csrValC,
    const int *csrRowPtrC,
    const int *csrColIndC,
    size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseDpruneDense2csr_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    const double *A,
    int lda,
    const double *threshold,
    const cusparseMatDescr_t descrC,
    const double *csrValC,
    const int *csrRowPtrC,
    const int *csrColIndC,
    size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseHpruneDense2csrNnz(
    cusparseHandle_t handle,
    int m,
    int n,
    const __half *A,
    int lda,
    const __half *threshold,
    const cusparseMatDescr_t descrC,
    int *csrRowPtrC,
    int *nnzTotalDevHostPtr,
    void *pBuffer);

cusparseStatus_t 
cusparseSpruneDense2csrNnz(
    cusparseHandle_t handle,
    int m,
    int n,
    const float *A,
    int lda,
    const float *threshold,
    const cusparseMatDescr_t descrC,
    int *csrRowPtrC,
    int *nnzTotalDevHostPtr,
    void *pBuffer);

cusparseStatus_t
cusparseDpruneDense2csrNnz(
    cusparseHandle_t handle,
    int m,
    int n,
    const double *A,
    int lda,
    const double *threshold,
    const cusparseMatDescr_t descrC,
    int *csrRowPtrC,
    int *nnzTotalDevHostPtr,
    void *pBuffer);

cusparseStatus_t 
cusparseHpruneDense2csr(
    cusparseHandle_t handle,
    int m,
    int n,
    const __half *A,
    int lda,
    const __half *threshold,
    const cusparseMatDescr_t descrC,
    __half *csrValC,
    const int *csrRowPtrC,
    int *csrColIndC,
    void *pBuffer);

cusparseStatus_t 
cusparseSpruneDense2csr(
    cusparseHandle_t handle,
    int m,
    int n,
    const float *A,
    int lda,
    const float *threshold,
    const cusparseMatDescr_t descrC,
    float *csrValC,
    const int *csrRowPtrC,
    int *csrColIndC,
    void *pBuffer);

cusparseStatus_t 
cusparseDpruneDense2csr(
    cusparseHandle_t handle,
    int m,
    int n,
    const double *A,
    int lda,
    const double *threshold,
    const cusparseMatDescr_t descrC,
    double *csrValC,
    const int *csrRowPtrC,
    int *csrColIndC,
    void *pBuffer);

</pre><p class="p">
                           This function prunes a dense matrix to a sparse matrix with CSR format.
                           
                        </p>
                        <p class="p">
                           Given a dense matrix <samp class="ph codeph">A</samp> and a non-negative value <samp class="ph codeph">threshold</samp>, 
                           the function returns a sparse matrix <samp class="ph codeph">C</samp>, defined by 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                             <mtr>
                                                <mtd>
                                                   <mi>C(i,j)</mi>
                                                   <mo>=</mo>
                                                   <mi>A(i,j)</mi>
                                                </mtd>
                                                <mtd>
                                                   <mtext> if |A(i,j)| &gt; threshold </mtext>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">The implementation adopts a two-step approach to do the conversion. 
                           First, the user allocates <samp class="ph codeph">csrRowPtrC</samp> of <samp class="ph codeph">m+1</samp> elements 
                           and uses function <samp class="ph codeph">pruneDense2csrNnz()</samp> to determine the number of nonzeros 
                           columns per row. 
                           Second, the user gathers <samp class="ph codeph">nnzC</samp> (number of nonzeros of matrix <samp class="ph codeph">C</samp>) 
                           from either <samp class="ph codeph">(nnzC=*nnzTotalDevHostPtr)</samp> or
                           <samp class="ph codeph">(nnzC=csrRowPtrC[m]-csrRowPtrC[0])</samp> 
                           and allocates <samp class="ph codeph">csrValC</samp> of <samp class="ph codeph">nnzC</samp> elements
                           and <samp class="ph codeph">csrColIndC</samp> of <samp class="ph codeph">nnzC</samp> integers. 
                           Finally function <samp class="ph codeph">pruneDense2csr()</samp> is called to complete the conversion. 
                           
                        </p>
                        <p class="p">The user must obtain the size of the buffer required by <samp class="ph codeph">pruneDense2csr()</samp> by calling
                           <samp class="ph codeph">pruneDense2csr_bufferSizeExt()</samp>, allocate the buffer, and pass the buffer
                           pointer to <samp class="ph codeph">pruneDense2csr()</samp>. 
                           
                        </p>
                        <p class="p">
                           Appendix E.1 provides a simple example of <samp class="ph codeph">pruneDense2csr()</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">array of dimension (lda, n).</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">A</samp>.
                                       It must be at least max(1, m).
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">threshold</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host or device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">a value to drop the entries of A.
                                       <samp class="ph codeph">threshold</samp> can point to a device memory or host memory. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>. 
                                       The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>,
                                       Also, the supported index bases are 
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                       <samp class="ph codeph">pruneDense2csr_bufferSizeExt()</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">nnzTotalDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">total number of nonzero of matrix <samp class="ph codeph">C</samp>. 
                                       <samp class="ph codeph">nnzTotalDevHostPtr</samp> can point to a device memory or
                                       host memory. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrValC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzC</samp> nonzero elements of matrix 
                                       <samp class="ph codeph">C</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowsPtrC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row
                                       and the end of the last row plus one.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzC</samp> column indices of <samp class="ph codeph">C</samp>.         
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of bytes of the buffer.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n &lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-pruneCsr2csr"><a name="cusparse-lt-t-gt-pruneCsr2csr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-pruneCsr2csr" name="cusparse-lt-t-gt-pruneCsr2csr" shape="rect">12.32.&nbsp;cusparseXpruneCsr2csr()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseHpruneCsr2csr_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const __half *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const __half *threshold,
    const cusparseMatDescr_t descrC,
    const __half *csrValC,
    const int *csrRowPtrC,
    const int *csrColIndC,
    size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseSpruneCsr2csr_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const float *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const float *threshold,
    const cusparseMatDescr_t descrC,
    const float *csrValC,
    const int *csrRowPtrC,
    const int *csrColIndC,
    size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseDpruneCsr2csr_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const double *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const double *threshold,
    const cusparseMatDescr_t descrC,
    const double *csrValC,
    const int *csrRowPtrC,
    const int *csrColIndC,
    size_t *pBufferSizeInBytes);

cusparseStatus_t
cusparseHpruneCsr2csrNnz(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const __half *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const __half *threshold,
    const cusparseMatDescr_t descrC,
    int *csrRowPtrC,
    int *nnzTotalDevHostPtr, /* can be on host or device */
    void *pBuffer);

cusparseStatus_t 
cusparseSpruneCsr2csrNnz(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const float *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const float *threshold,
    const cusparseMatDescr_t descrC,
    int *csrRowPtrC,
    int *nnzTotalDevHostPtr, /* can be on host or device */
    void *pBuffer);

cusparseStatus_t
cusparseDpruneCsr2csrNnz(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const double *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const double *threshold,
    const cusparseMatDescr_t descrC,
    int *csrRowPtrC,
    int *nnzTotalDevHostPtr, /* can be on host or device */
    void *pBuffer);

cusparseStatus_t 
cusparseHpruneCsr2csr(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const __half *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const __half *threshold,
    const cusparseMatDescr_t descrC,
    __half *csrValC,
    const int *csrRowPtrC,
    int *csrColIndC,
    void *pBuffer);

cusparseStatus_t 
cusparseSpruneCsr2csr(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const float *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const float *threshold,
    const cusparseMatDescr_t descrC,
    float *csrValC,
    const int *csrRowPtrC,
    int *csrColIndC,
    void *pBuffer);

cusparseStatus_t 
cusparseDpruneCsr2csr(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const double *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const double *threshold,
    const cusparseMatDescr_t descrC,
    double *csrValC,
    const int *csrRowPtrC,
    int *csrColIndC,
    void *pBuffer);

</pre><p class="p">
                           This function prunes a sparse matrix to a sparse matrix with CSR format.
                           
                        </p>
                        <p class="p">
                           Given a sparse matrix <samp class="ph codeph">A</samp> and a non-negative value <samp class="ph codeph">threshold</samp>, 
                           the function returns a sparse matrix <samp class="ph codeph">C</samp>, defined by 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                             <mtr>
                                                <mtd>
                                                   <mi>C(i,j)</mi>
                                                   <mo>=</mo>
                                                   <mi>A(i,j)</mi>
                                                </mtd>
                                                <mtd>
                                                   <mtext> if |A(i,j)| &gt; threshold </mtext>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">The implementation adopts a two-step approach to do the conversion. 
                           First, the user allocates <samp class="ph codeph">csrRowPtrC</samp> of <samp class="ph codeph">m+1</samp> elements 
                           and uses function <samp class="ph codeph">pruneCsr2csrNnz()</samp> to determine the number of nonzeros 
                           columns per row. 
                           Second, the user gathers <samp class="ph codeph">nnzC</samp> (number of nonzeros of matrix <samp class="ph codeph">C</samp>) 
                           from either <samp class="ph codeph">(nnzC=*nnzTotalDevHostPtr)</samp> or
                           <samp class="ph codeph">(nnzC=csrRowPtrC[m]-csrRowPtrC[0])</samp> 
                           and allocates <samp class="ph codeph">csrValC</samp> of <samp class="ph codeph">nnzC</samp> elements
                           and <samp class="ph codeph">csrColIndC</samp> of <samp class="ph codeph">nnzC</samp> integers. 
                           Finally function <samp class="ph codeph">pruneCsr2csr()</samp> is called to complete the conversion. 
                           
                        </p>
                        <p class="p">The user must obtain the size of the buffer required by <samp class="ph codeph">pruneCsr2csr()</samp> by calling
                           <samp class="ph codeph">pruneCsr2csr_bufferSizeExt()</samp>, allocate the buffer, and pass the buffer
                           pointer to <samp class="ph codeph">pruneCsr2csr()</samp>. 
                           
                        </p>
                        <p class="p">
                           Appendix E.2 provides a simple example of <samp class="ph codeph">pruneCsr2csr()</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>.
                                       The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>,
                                       Also, the supported index bases are
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzA</samp> nonzero elements of matrix
                                       <samp class="ph codeph">A</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowsPtrA</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row
                                       and the end of the last row plus one.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp> column indices of <samp class="ph codeph">A</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">threshold</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host or device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">a value to drop the entries of A.
                                       <samp class="ph codeph">threshold</samp> can point to a device memory or host memory. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>. 
                                       The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>,
                                       Also, the supported index bases are 
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                       <samp class="ph codeph">pruneCsr2csr_bufferSizeExt()</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">nnzTotalDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">total number of nonzero of matrix <samp class="ph codeph">C</samp>. 
                                       <samp class="ph codeph">nnzTotalDevHostPtr</samp> can point to a device memory or
                                       host memory. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrValC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzC</samp> nonzero elements of matrix 
                                       <samp class="ph codeph">C</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowsPtrC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row
                                       and the end of the last row plus one.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzC</samp> column indices of <samp class="ph codeph">C</samp>.         
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of bytes of the buffer.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n &lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-pruneDense2csrByP"><a name="cusparse-lt-t-gt-pruneDense2csrByP" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-pruneDense2csrByP" name="cusparse-lt-t-gt-pruneDense2csrByP" shape="rect">12.33.&nbsp;cusparseXpruneDense2csrPercentage()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseHpruneDense2csrByPercentage_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    const __half *A,
    int lda,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    const __half *csrValC,
    const int *csrRowPtrC,
    const int *csrColIndC,
    pruneInfo_t info,
    size_t *pBufferSizeInBytes);

cusparseStatus_t
cusparseSpruneDense2csrByPercentage_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    const float *A,
    int lda,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    const float *csrValC,
    const int *csrRowPtrC,
    const int *csrColIndC,
    pruneInfo_t info,
    size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseDpruneDense2csrByPercentage_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    const double *A,
    int lda,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    const double *csrValC,
    const int *csrRowPtrC,
    const int *csrColIndC,
    pruneInfo_t info,
    size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseHpruneDense2csrNnzByPercentage(
    cusparseHandle_t handle,
    int m,
    int n,
    const __half *A,
    int lda,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    int *csrRowPtrC,
    int *nnzTotalDevHostPtr, /* can be on host or device */
    pruneInfo_t info,
    void *pBuffer);

cusparseStatus_t 
cusparseSpruneDense2csrNnzByPercentage(
    cusparseHandle_t handle,
    int m,
    int n,
    const float *A,
    int lda,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    int *csrRowPtrC,
    int *nnzTotalDevHostPtr, /* can be on host or device */
    pruneInfo_t info,
    void *pBuffer);

cusparseStatus_t 
cusparseDpruneDense2csrNnzByPercentage(
    cusparseHandle_t handle,
    int m,
    int n,
    const double *A,
    int lda,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    int *csrRowPtrC,
    int *nnzTotalDevHostPtr, /* can be on host or device */
    pruneInfo_t info,
    void *pBuffer);

cusparseStatus_t 
cusparseHpruneDense2csrByPercentage(
    cusparseHandle_t handle,
    int m,
    int n,
    const __half *A,
    int lda,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    __half *csrValC,
    const int *csrRowPtrC,
    int *csrColIndC,
    pruneInfo_t info,
    void *pBuffer);

cusparseStatus_t 
cusparseSpruneDense2csrByPercentage(
    cusparseHandle_t handle,
    int m,
    int n,
    const float *A,
    int lda,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    float *csrValC,
    const int *csrRowPtrC,
    int *csrColIndC,
    pruneInfo_t info,
    void *pBuffer);

cusparseStatus_t 
cusparseDpruneDense2csrByPercentage(
    cusparseHandle_t handle,
    int m,
    int n,
    const double *A,
    int lda,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    double *csrValC,
    const int *csrRowPtrC,
    int *csrColIndC,
    pruneInfo_t info,
    void *pBuffer);


</pre><p class="p">
                           This function prunes a dense matrix to a sparse matrix by percentage.
                           
                        </p>
                        <p class="p">
                           Given a dense matrix <samp class="ph codeph">A</samp> and a non-negative value <samp class="ph codeph">percentage</samp>, 
                           the function computes sparse matrix <samp class="ph codeph">C</samp> by the following three steps:
                           
                        </p>
                        <p class="p">
                           Step 1: sort absolute value of <samp class="ph codeph">A</samp> in ascending order. 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                             <mtr>
                                                <mtd>
                                                   <mi>key := sort( |A| ) </mi>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           Step 2: choose threshold by the parameter <samp class="ph codeph">percentage</samp></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                             <mtr>
                                                <mtd>
                                                   <mi>pos = ceil(m*n*(percentage/100)) - 1 </mi>
                                                </mtd>
                                             </mtr>
                                             <mtr>
                                                <mtd>
                                                   <mi>pos = min(pos, m*n-1) </mi>
                                                </mtd>
                                             </mtr>
                                             <mtr>
                                                <mtd>
                                                   <mi>pos = max(pos, 0) </mi>
                                                </mtd>
                                             </mtr>
                                             <mtr>
                                                <mtd>
                                                   <mi>threshold = key[pos] </mi>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           Step 3: call <samp class="ph codeph">pruneDense2csr()</samp> by with the parameter
                           <samp class="ph codeph">threshold</samp>.
                           
                        </p>
                        <p class="p">The implementation adopts a two-step approach to do the conversion. 
                           First, the user allocates <samp class="ph codeph">csrRowPtrC</samp> of <samp class="ph codeph">m+1</samp> elements 
                           and uses function <samp class="ph codeph">pruneDense2csrNnzByPercentage()</samp> to determine the number of nonzeros 
                           columns per row. 
                           Second, the user gathers <samp class="ph codeph">nnzC</samp> (number of nonzeros of matrix <samp class="ph codeph">C</samp>) 
                           from either <samp class="ph codeph">(nnzC=*nnzTotalDevHostPtr)</samp> or
                           <samp class="ph codeph">(nnzC=csrRowPtrC[m]-csrRowPtrC[0])</samp> 
                           and allocates <samp class="ph codeph">csrValC</samp> of <samp class="ph codeph">nnzC</samp> elements
                           and <samp class="ph codeph">csrColIndC</samp> of <samp class="ph codeph">nnzC</samp> integers. 
                           Finally function <samp class="ph codeph">pruneDense2csrByPercentage()</samp> is called to complete the conversion. 
                           
                        </p>
                        <p class="p">The user must obtain the size of the buffer required by <samp class="ph codeph">pruneDense2csrByPercentage()</samp> 
                           by calling
                           <samp class="ph codeph">pruneDense2csrByPercentage_bufferSizeExt()</samp>, allocate the buffer, and pass the buffer
                           pointer to <samp class="ph codeph">pruneDense2csrByPercentage()</samp>. 
                           
                        </p>
                        <p class="p">
                           Remark 1: the value of <samp class="ph codeph">percentage</samp> must be not greater than 100.
                           Otherwise, <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned.
                           
                        </p>
                        <p class="p">
                           Remark 2: the zeros of <samp class="ph codeph">A</samp> are not ignored.
                           All entries are sorted, including zeros.
                           This is different from <samp class="ph codeph">pruneCsr2csrByPercentage()</samp></p>
                        <p class="p">
                           Appendix E.3 provides a simple example of <samp class="ph codeph">pruneDense2csrByPercentage()</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">array of dimension (lda, n).</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">leading dimension of <samp class="ph codeph">A</samp>.
                                       It must be at least max(1, m).
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">percentage</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">percentage &lt;=100 and percentage &gt;= 0
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>. 
                                       The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>,
                                       Also, the supported index bases are 
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                       <samp class="ph codeph">pruneDense2csrByPercentage_bufferSizeExt()</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">nnzTotalDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">total number of nonzero of matrix <samp class="ph codeph">C</samp>. 
                                       <samp class="ph codeph">nnzTotalDevHostPtr</samp> can point to a device memory or
                                       host memory. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrValC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzC</samp> nonzero elements of matrix 
                                       <samp class="ph codeph">C</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowsPtrC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row
                                       and the end of the last row plus one.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzC</samp> column indices of <samp class="ph codeph">C</samp>.         
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of bytes of the buffer.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n &lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-pruneCsr2csrByP"><a name="cusparse-lt-t-gt-pruneCsr2csrByP" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-pruneCsr2csrByP" name="cusparse-lt-t-gt-pruneCsr2csrByP" shape="rect">12.34.&nbsp;cusparseXpruneCsr2csrByPercentage()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">

cusparseStatus_t 
cusparseHpruneCsr2csrByPercentage_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const __half *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    const __half *csrValC,
    const int *csrRowPtrC,
    const int *csrColIndC,
    pruneInfo_t info,
    size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseSpruneCsr2csrByPercentage_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const float *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    const float *csrValC,
    const int *csrRowPtrC,
    const int *csrColIndC,
    pruneInfo_t info,
    size_t *pBufferSizeInBytes);

cusparseStatus_t
cusparseDpruneCsr2csrByPercentage_bufferSizeExt(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const double *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    const double *csrValC,
    const int *csrRowPtrC,
    const int *csrColIndC,
    pruneInfo_t info,
    size_t *pBufferSizeInBytes);

cusparseStatus_t 
cusparseHpruneCsr2csrNnzByPercentage(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const __half *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    int *csrRowPtrC,
    int *nnzTotalDevHostPtr, /* can be on host or device */
    pruneInfo_t info,
    void *pBuffer);

cusparseStatus_t 
cusparseSpruneCsr2csrNnzByPercentage(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const float *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    int *csrRowPtrC,
    int *nnzTotalDevHostPtr, /* can be on host or device */
    pruneInfo_t info,
    void *pBuffer);

cusparseStatus_t 
cusparseDpruneCsr2csrNnzByPercentage(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const double *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    int *csrRowPtrC,
    int *nnzTotalDevHostPtr, /* can be on host or device */
    pruneInfo_t info,
    void *pBuffer);

cusparseStatus_t 
cusparseHpruneCsr2csrByPercentage(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const __half *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    __half *csrValC,
    const int *csrRowPtrC,
    int *csrColIndC,
    pruneInfo_t info,
    void *pBuffer);

cusparseStatus_t 
cusparseSpruneCsr2csrByPercentage(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const float *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    float *csrValC,
    const int *csrRowPtrC,
    int *csrColIndC,
    pruneInfo_t info,
    void *pBuffer);

cusparseStatus_t 
cusparseDpruneCsr2csrByPercentage(
    cusparseHandle_t handle,
    int m,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const double *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    float percentage, /* between 0 to 100 */
    const cusparseMatDescr_t descrC,
    double *csrValC,
    const int *csrRowPtrC,
    int *csrColIndC,
    pruneInfo_t info,
    void *pBuffer);

</pre><p class="p">
                           This function prunes a sparse matrix to a sparse matrix by percentage.
                           
                        </p>
                        <p class="p">
                           Given a sparse matrix <samp class="ph codeph">A</samp> and a non-negative value <samp class="ph codeph">percentage</samp>,
                           the function computes sparse matrix <samp class="ph codeph">C</samp> by the following three steps:
                           
                        </p>
                        <p class="p">
                           Step 1: sort absolute value of <samp class="ph codeph">A</samp> in ascending order.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                             <mtr>
                                                <mtd>
                                                   <mi>key := sort( |csrValA| ) </mi>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           Step 2: choose threshold by the parameter <samp class="ph codeph">percentage</samp></p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                             <mtr>
                                                <mtd>
                                                   <mi>pos = ceil(nnzA*(percentage/100)) - 1 </mi>
                                                </mtd>
                                             </mtr>
                                             <mtr>
                                                <mtd>
                                                   <mi>pos = min(pos, nnzA-1) </mi>
                                                </mtd>
                                             </mtr>
                                             <mtr>
                                                <mtd>
                                                   <mi>pos = max(pos, 0) </mi>
                                                </mtd>
                                             </mtr>
                                             <mtr>
                                                <mtd>
                                                   <mi>threshold = key[pos] </mi>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           Step 3: call <samp class="ph codeph">pruneCsr2csr()</samp> by with the parameter
                           <samp class="ph codeph">threshold</samp>.
                           
                        </p>
                        <p class="p">The implementation adopts a two-step approach to do the conversion. 
                           First, the user allocates <samp class="ph codeph">csrRowPtrC</samp> of <samp class="ph codeph">m+1</samp> elements 
                           and uses function <samp class="ph codeph">pruneCsr2csrNnzByPercentage()</samp> to determine the number of nonzeros 
                           columns per row. 
                           Second, the user gathers <samp class="ph codeph">nnzC</samp> (number of nonzeros of matrix <samp class="ph codeph">C</samp>) 
                           from either <samp class="ph codeph">(nnzC=*nnzTotalDevHostPtr)</samp> or
                           <samp class="ph codeph">(nnzC=csrRowPtrC[m]-csrRowPtrC[0])</samp> 
                           and allocates <samp class="ph codeph">csrValC</samp> of <samp class="ph codeph">nnzC</samp> elements
                           and <samp class="ph codeph">csrColIndC</samp> of <samp class="ph codeph">nnzC</samp> integers. 
                           Finally function <samp class="ph codeph">pruneCsr2csrByPercentage()</samp> is called to complete the conversion. 
                           
                        </p>
                        <p class="p">The user must obtain the size of the buffer required by <samp class="ph codeph">pruneCsr2csrByPercentage()</samp> by calling
                           <samp class="ph codeph">pruneCsr2csrByPercentage_bufferSizeExt()</samp>, allocate the buffer, and pass the buffer
                           pointer to <samp class="ph codeph">pruneCsr2csrByPercentage()</samp>. 
                           
                        </p>
                        <p class="p">
                           Remark 1: the value of <samp class="ph codeph">percentage</samp> must be not greater than 100.
                           Otherwise, <samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp> is returned.
                           
                        </p>
                        <p class="p">
                           Appendix E.4 provides a simple example of <samp class="ph codeph">pruneCsr2csrByPercentage()</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>.
                                       The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>,
                                       Also, the supported index bases are
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzA</samp> nonzero elements of matrix
                                       <samp class="ph codeph">A</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowsPtrA</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row
                                       and the end of the last row plus one.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp> column indices of <samp class="ph codeph">A</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">percentage</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">percentage &lt;=100 and percentage &gt;= 0
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">descrC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">C</samp>. 
                                       The supported matrix type is
                                       <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>,
                                       Also, the supported index bases are 
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">buffer allocated by the user; the size is returned by
                                       <samp class="ph codeph">pruneCsr2csrByPercentage_bufferSizeExt()</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">nnzTotalDevHostPtr</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device or host </samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">total number of nonzero of matrix <samp class="ph codeph">C</samp>. 
                                       <samp class="ph codeph">nnzTotalDevHostPtr</samp> can point to a device memory or
                                       host memory. 
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrValC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzC</samp> nonzero elements of matrix 
                                       <samp class="ph codeph">C</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowsPtrC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row
                                       and the end of the last row plus one.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndC</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzC</samp> column indices of <samp class="ph codeph">C</samp>.         
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                    <td class="entry" valign="top" width="22.22222222222222%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="55.55555555555556%" rowspan="1" colspan="1">number of bytes of the buffer.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n &lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-lt-t-gt-nnz_compress"><a name="cusparse-lt-t-gt-nnz_compress" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-lt-t-gt-nnz_compress" name="cusparse-lt-t-gt-nnz_compress" shape="rect">12.35.&nbsp;cusparse&lt;t&gt;nnz_compress()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t 
cusparseSnnz_compress(cusparseHandle_t handle,
                      int m,
                      const cusparseMatDescr_t descr,
                      const float *csrValA,
                      const int * csrRowPtrA,
                      int *nnzPerRow,
                      int *nnzC,
                      float tol)
cusparseStatus_t 
cusparseDnnz_compress(cusparseHandle_t handle,
                      int m,
                      const cusparseMatDescr_t descr,
                      const double *csrValA,
                      const int * csrRowPtrA,
                      int *nnzPerRow,
                      int *nnzC,
                      double tol)
cusparseStatus_t 
cusparseCnnz_compress(cusparseHandle_t handle,
                      int m,
                      const cusparseMatDescr_t descr,
                      const cuComplex *csrValA,
                      const int * csrRowPtrA,
                      int *nnzPerRow,
                      int *nnzC,
                      cuComplex tol)
cusparseStatus_t 
cusparseZnnz_compress(cusparseHandle_t handle,
                      int m,
                      const cusparseMatDescr_t descr,
                      const cuDoubleComplex *csrValA,
                      const int * csrRowPtrA,
                      int *nnzPerRow,
                      int *nnzC,
                      cuDoubleComplex tol)
</pre><p class="p">This function is the step one to convert from csr format to compressed csr format.</p>
                        <p class="p">
                           Given a sparse matrix A and a non-negative value threshold, the function returns nnzPerRow(the number of nonzeros columns
                           per row) and nnzC(the total number of nonzeros) of a sparse matrix C, defined by
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                             <mtr>
                                                <mtd>
                                                   <mi>C(i,j)</mi>
                                                   <mo>=</mo>
                                                   <mi>A(i,j)</mi>
                                                </mtd>
                                                <mtd>
                                                   <mtext> if |A(i,j)| &gt; threshold </mtext>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">A key assumption for the cuComplex and cuDoubleComplex case is that this tolerance is given as the real part. For example
                           tol = 1e-8 + 0*i and we extract cureal, that is the x component of this struct.
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is
                                       								<samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. Also, the supported
                                       							index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and
                                       								<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">csr noncompressed values array</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the corresponding input noncompressed row pointer.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">tol</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">non-negative tolerance to determine if a number less than or equal to it.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzPerRow</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">this array contains the number of elements whose absolute values are greater than tol per row.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnzC</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">host/device pointer of the total number of elements whose absolute values are greater than tol.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m, n&lt;0</samp>).
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_ARCH_MISMATCH</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device does not support double precision.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the function failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSPARSE_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusparse-generic-api-reference"><a name="cusparse-generic-api-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusparse-generic-api-reference" name="cusparse-generic-api-reference" shape="rect">13.&nbsp;cuSPARSE Generic API Reference</a></h2>
                  <div class="body conbody">
                     <p class="p">Starting with CUDA 10.1, the cuSPARSE Library provides a new set of API to compute sparse
                        			matrix-matrix multiplication (SpMM), in addition to the existing legacy API. All following
                        			functions and types operate on matrix problems of the form:
                     </p>
                     <div class="p">
                        <div class="tablenoborder"><a name="cusparse-generic-api-reference__table_svw_pgr_2gb" shape="rect">
                              <!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="cusparse-generic-api-reference__table_svw_pgr_2gb" class="table" width="100%" frame="void" border="0" rules="none">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" width="100%" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mrow>
                                             <mi>C</mi>
                                             <mo>=</mo>
                                             <mi>α</mi>
                                             <mi>A</mi>
                                             <mi>B</mi>
                                             <mo>+</mo>
                                             <mi>β</mi>
                                             <mi>C</mi>
                                          </mrow>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                     <p class="p">where A is sparse matrix, B and C are dense matrices. They are considered a <em class="ph i">preview
                           				feature</em> i.e. the data structures and APIs for them are subject to change and may not be
                        			compatible with future releases. 
                     </p>
                  </div>
                  <div class="topic concept nested1" id="cusparse-generic-sparse-type-ref"><a name="cusparse-generic-sparse-type-ref" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-sparse-type-ref" name="cusparse-generic-sparse-type-ref" shape="rect">13.1.&nbsp;Generic Types Reference</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The cuSPARSE generic type references are described in this section.
                           
                        </p>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-enum-data-types"><a name="cusparse-generic-enum-data-types" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-enum-data-types" name="cusparse-generic-enum-data-types" shape="rect">13.1.1.&nbsp;cudaDataType_t</a></h3>
                        <div class="body conbody">
                           <p class="p">The section describes types shared by multiple CUDA Libraries and defined in the header file <samp class="ph codeph">library_types.h</samp>.
                              
                              The <samp class="ph codeph">cudaDataType_t</samp> type is an enumerant to specify the data precision. It is used when the data reference does not carry the type itself (e.g
                              void *) 
                              
                              For example, it is used in the routine <samp class="ph codeph">cusparseSpMM()</samp></p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <thead class="thead" align="left">
                                    <tr class="row">
                                       <th class="entry" valign="top" width="50%" id="d54e73554" rowspan="1" colspan="1">
                                          		Value
                                          	
                                       </th>
                                       <th class="entry" valign="top" width="50%" id="d54e73557" rowspan="1" colspan="1">
                                          		Meaning
                                          	
                                       </th>
                                    </tr>
                                 </thead>
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73554" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUDA_R_16F</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73557" rowspan="1" colspan="1">
                                          <p class="p">the data type is 16-bit floating-point (<samp class="ph codeph">__half</samp>)
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73554" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUDA_C_16F</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73557" rowspan="1" colspan="1">
                                          <p class="p">the data type is 16-bit complex floating-point (<samp class="ph codeph">__half2</samp>)
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73554" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUDA_R_32F</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73557" rowspan="1" colspan="1">
                                          <p class="p">the data type is 32-bit floating-point (<samp class="ph codeph">float</samp>)
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73554" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUDA_C_32F</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73557" rowspan="1" colspan="1">
                                          <p class="p">the data type is 32-bit complex floating-point (<samp class="ph codeph">cuComplex</samp>)
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73554" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUDA_R_64F</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73557" rowspan="1" colspan="1">
                                          <p class="p">the data type is 64-bit floating-point (<samp class="ph codeph">double</samp>)
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73554" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUDA_C_64F</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73557" rowspan="1" colspan="1">
                                          <p class="p">the data type is 64-bit complex floating-point (<samp class="ph codeph">cuDoubleComplex</samp>)
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73554" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUDA_R_8I</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73557" rowspan="1" colspan="1">
                                          <p class="p">the data type is 8-bit signed integer (<samp class="ph codeph">int8_t</samp>)
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-enum-formats"><a name="cusparse-generic-enum-formats" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-enum-formats" name="cusparse-generic-enum-formats" shape="rect">13.1.2.&nbsp;cusparseFormat_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              This type indicates the format of the sparse matrix. Currently, only COO format is supported.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <thead class="thead" align="left">
                                    <tr class="row">
                                       <th class="entry" valign="top" width="50%" id="d54e73725" rowspan="1" colspan="1">
                                          		Value
                                          	
                                       </th>
                                       <th class="entry" valign="top" width="50%" id="d54e73728" rowspan="1" colspan="1">
                                          		Meaning
                                          	
                                       </th>
                                    </tr>
                                 </thead>
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73725" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_FORMAT_COO</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73728" rowspan="1" colspan="1">
                                          <p class="p">the matrix is stored in Coordinate (COO) format.</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-enum-layout"><a name="cusparse-generic-enum-layout" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-enum-layout" name="cusparse-generic-enum-layout" shape="rect">13.1.3.&nbsp;cusparseOrder_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              This type indicates the memory layout of a dense matrix. Currently, only column-major layout is supported.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <thead class="thead" align="left">
                                    <tr class="row">
                                       <th class="entry" valign="top" width="50%" id="d54e73778" rowspan="1" colspan="1">
                                          		Value
                                          	
                                       </th>
                                       <th class="entry" valign="top" width="50%" id="d54e73781" rowspan="1" colspan="1">
                                          		Meaning
                                          	
                                       </th>
                                    </tr>
                                 </thead>
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73778" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_ORDER_COL</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73781" rowspan="1" colspan="1">
                                          <p class="p">the matrix is stored in column-major.</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-enum-alg"><a name="cusparse-generic-enum-alg" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-enum-alg" name="cusparse-generic-enum-alg" shape="rect">13.1.4.&nbsp;cusparseSpMMAlg_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              This type indicates the algorithm parameter used for <samp class="ph codeph">cusparseSpMM()</samp> and <samp class="ph codeph">cusparseSpMM_bufferSize()</samp> sparse matrix-matrix multiplication. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <thead class="thead" align="left">
                                    <tr class="row">
                                       <th class="entry" valign="top" width="50%" id="d54e73838" rowspan="1" colspan="1">
                                          		Value
                                          	
                                       </th>
                                       <th class="entry" valign="top" width="50%" id="d54e73841" rowspan="1" colspan="1">
                                          		Meaning
                                          	
                                       </th>
                                    </tr>
                                 </thead>
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73838" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_COOMM_ALG1</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73841" rowspan="1" colspan="1">
                                          <p class="p">COO matrix-matrix multiplication specialized for small matrices. The algorithm provides non-deterministic results (different
                                             execution could provide slighlty different output). It supports batched matrix computation
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73838" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_COOMM_ALG2</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73841" rowspan="1" colspan="1">
                                          <p class="p">COO matrix-matrix multiplication specialized for small matrices. The algorithm provides deterministic results (generate the
                                             same bit-wise output). It supports only op(A) CUSPARSE_OPERATION_NON_TRANSPOSE
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73838" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_COOMM_ALG3</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73841" rowspan="1" colspan="1">
                                          <p class="p">COO matrix-matrix multiplication specialized for large matrices. The algorithm provides non-deterministic results (different
                                             execution could provide slighlty different output). It does not support cuDoubleComplex data type
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-enum-index"><a name="cusparse-generic-enum-index" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-enum-index" name="cusparse-generic-enum-index" shape="rect">13.1.5.&nbsp;cusparseIndexType_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              This type indicates the index type for rappresenting the sparse matrix indices. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <thead class="thead" align="left">
                                    <tr class="row">
                                       <th class="entry" valign="top" width="50%" id="d54e73923" rowspan="1" colspan="1">
                                          		Value
                                          	
                                       </th>
                                       <th class="entry" valign="top" width="50%" id="d54e73926" rowspan="1" colspan="1">
                                          		Meaning
                                          	
                                       </th>
                                    </tr>
                                 </thead>
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73923" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_INDEX_16U</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73926" rowspan="1" colspan="1">
                                          <p class="p"> 16-bit unsigned integer for both row and column COO indices [1, 65535]</p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" headers="d54e73923" rowspan="1" colspan="1">
                                          <p class="p"><samp class="ph codeph">CUSPARSE_INDEX_32I</samp></p>
                                       </td>
                                       <td class="entry" valign="top" width="50%" headers="d54e73926" rowspan="1" colspan="1">
                                          <p class="p">32-bit signed integer for  for both row and column COO indices [1, 2147483647]</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-generic-sparse-ref"><a name="cusparse-generic-sparse-ref" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-sparse-ref" name="cusparse-generic-sparse-ref" shape="rect">13.2.&nbsp;Generic Sparse API helper functions</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The cuSPARSE helper functions for sparse matrix descriptor are described in this section.
                           
                        </p>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-sparse-create-coo"><a name="cusparse-generic-sparse-create-coo" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-sparse-create-coo" name="cusparse-generic-sparse-create-coo" shape="rect">13.2.1.&nbsp;cusparseCreateCoo()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseCreateCoo(cusparseSpMatDescr_t* spMatDescr,
                  int                   rows,
                  int                   cols,
                  int                   nnz,
                  void*                 cooRowInd,
                  void*                 cooColInd,
                  void*                 cooValues,
                  cusparseIndexType_t   cooIdxType,
                  cusparseIndexBase_t   idxBase,
                  cudaDataType          valueType)</pre><p class="p">
                              This function initializes the sparse matrix descriptor <samp class="ph codeph">spMatDescr</samp> in the COO format.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rows</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of the sparse matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cols</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of cols of sparse matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of the sparse matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cooRowInd</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> uncompressed row indices.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cooColInd</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnz</samp> uncompressed column indices.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cooValues</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">value array of size <samp class="ph codeph">nnz</samp> of the sparse matrix.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cooIdxType</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Index base <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or
                                          							<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Index data type <samp class="ph codeph">CUSPARSE_INDEX_16U</samp> or
                                          							<samp class="ph codeph">CUSPARSE_INDEX_32I</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">valueType</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">value type.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">spMatDescr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">sparse matrix descriptor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-sparse-destroy"><a name="cusparse-generic-sparse-destroy" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-sparse-destroy" name="cusparse-generic-sparse-destroy" shape="rect">13.2.2.&nbsp;cusparseDestroySpMat()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseDestroySpMat(cusparseSpMatDescr_t spMatDescr)
</pre><p class="p">
                              This function releases the memory allocated for the sparse matrix descriptor <samp class="ph codeph">spMatDescr</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">spMatDescr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">sparse matrix descriptor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-sparse-get-batches"><a name="cusparse-generic-sparse-get-batches" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-sparse-get-batches" name="cusparse-generic-sparse-get-batches" shape="rect">13.2.3.&nbsp;cusparseSpMatGetNumBatches()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseSpMatGetNumBatches(const cusparseSpMatDescr_t spMatDescr,
                           int*                       batchCount)
</pre><p class="p">
                              This function returns the number of batches of the sparse matrix descriptor <samp class="ph codeph">spMatDescr</samp>. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">spMatDescr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">sparse matrix descriptor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">batchCount</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of batches of the sparse matrix.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-sparse-get-coo"><a name="cusparse-generic-sparse-get-coo" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-sparse-get-coo" name="cusparse-generic-sparse-get-coo" shape="rect">13.2.4.&nbsp;cusparseCooGet()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseCooGet(const cusparseSpMatDescr_t spMatDescr,
               int*                       rows,
               int*                       cols,
               int*                       nnz,
               void**                     cooRowInd,
               void**                     cooColInd,
               void**                     cooValues,
               cusparseIndexType_t*       idxType,
               cusparseIndexBase_t*       idxBase,
               cudaDataType*              valueType)
</pre><p class="p">
                              This function returns the <samp class="ph codeph">spMatDescr</samp> fields of the sparse matrix descriptor. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">spMatDescr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">sparse matrix descriptor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rows</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of the sparse matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cols</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of cols of sparse matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzero elements of the sparse matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cooRowInd</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of nnz uncompressed row indices.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cooColInd</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of nnz uncompressed column indices.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cooIdxType</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Index base <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> or
                                          							<samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Index data type <samp class="ph codeph">CUSPARSE_INDEX_16U</samp> or
                                          							<samp class="ph codeph">CUSPARSE_INDEX_32I</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-sparse-get-format"><a name="cusparse-generic-sparse-get-format" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-sparse-get-format" name="cusparse-generic-sparse-get-format" shape="rect">13.2.5.&nbsp;cusparseCooGet()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseSpMatGetFormat(const cusparseSpMatDescr_t spMatDescr,
                       cusparseFormat_t*          format)
</pre><p class="p">
                              This function returns the format of the sparse matrix descriptor <samp class="ph codeph">spMatDescr</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">spMatDescr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">sparse matrix descriptor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">format</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">storage format of the sparse matrix.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-sparse-get-index-base"><a name="cusparse-generic-sparse-get-index-base" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-sparse-get-index-base" name="cusparse-generic-sparse-get-index-base" shape="rect">13.2.6.&nbsp;cusparseSpMatGetIndexBase()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseSpMatGetIndexBase(const cusparseSpMatDescr_t spMatDescr,
                          cusparseIndexBase_t*       idxBase)
</pre><p class="p">
                              This function returns the index base of the sparse matrix descriptor spMatDescr. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">spMatDescr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">sparse matrix descriptor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">idxBase</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">index base of the sparse matrix.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-sparse-set-batches"><a name="cusparse-generic-sparse-set-batches" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-sparse-set-batches" name="cusparse-generic-sparse-set-batches" shape="rect">13.2.7.&nbsp;cusparseSpMatSetNumBatches()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseSpMatSetNumBatches(cusparseSpMatDescr_t spMatDescr,
                           int                  batchCount)
</pre><p class="p">
                              This function sets the number of batches of the sparse matrix descriptor <samp class="ph codeph">spMatDescr</samp>. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">spMatDescr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">sparse matrix descriptor.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">batchCount</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of batches for the sparse matrix descriptor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-generic-dense-ref"><a name="cusparse-generic-dense-ref" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-dense-ref" name="cusparse-generic-dense-ref" shape="rect">13.3.&nbsp;Generic Dense API helper functions</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The cuSPARSE helper functions for dense matrix descriptor are described in this section.
                           
                        </p>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-dense-create"><a name="cusparse-generic-dense-create" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-dense-create" name="cusparse-generic-dense-create" shape="rect">13.3.1.&nbsp;cusparseCreateDnMat()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseCreateDnMat(cusparseDnMatDescr_t* dnMatDescr,
                    size_t                rows,
                    size_t                cols,
                    int64_t               ld,
                    void*                 valuesPtr,
                    cudaDataType          type,
                    cusparseOrder_t       order)
</pre><p class="p">
                              This function initializes the dense matrix descriptor <samp class="ph codeph">dnMatDescr</samp>. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rows</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of the dense matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cols</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of cols of the dense matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ld</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of the dense matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">valuesPtr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">value array of dimensions <samp class="ph codeph">(ld x cols)</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">type</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">datatype of the dense matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">order</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">memory layout <samp class="ph codeph">CUSPARSE_ORDER_COL</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dnMatDescr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">dense matrix descriptor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-dense-destro"><a name="cusparse-generic-dense-destro" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-dense-destro" name="cusparse-generic-dense-destro" shape="rect">cusparseDestroyDnMat()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseDestroySpMat(cusparseDnMatDescr_t dnMatDescr)
</pre><p class="p">
                              This function releases the memory allocated for the sparse matrix descriptor <samp class="ph codeph">dnMatDescr</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dnMatDescr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">dense matrix descriptor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-dense-get"><a name="cusparse-generic-dense-get" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-dense-get" name="cusparse-generic-dense-get" shape="rect">13.3.3.&nbsp;cusparseDnMatGet()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseDnMatGet(const cusparseDnMatDescr_t dnMatDescr,
                 size_t*                    rows,
                 size_t*                    cols,
                 int64_t*                   ld,
                 void**                     valuesPtr,
                 cudaDataType*              type,
                 cusparseOrder_t*           order)
</pre><p class="p">
                              This function returns the <samp class="ph codeph">dnMatDescr</samp> fields of the dense matrix descriptor. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dnMatDescr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">dense matrix descriptor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">rows</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of the dense matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">cols</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of cols of dense matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">ld</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">leading dimension of the dense matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">valuesPtr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">value array of dimensions <samp class="ph codeph">(ld x cols)</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">type</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">datatype of the dense matrix.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">order</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">memory layout <samp class="ph codeph">CUSPARSE_ORDER_COL</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-dense-get-batches"><a name="cusparse-generic-dense-get-batches" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-dense-get-batches" name="cusparse-generic-dense-get-batches" shape="rect">13.3.4.&nbsp;cusparseDnMatGetStridedBatch()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t 
cusparseDnMatGetStridedBatch(const cusparseDnMatDescr_t dnMatDescr,
                             int*                       batchCount,
                             size_t*                    batchStride)
</pre><p class="p">
                              This function returns the number of batches of the dense matrix descriptor <samp class="ph codeph">dnMatDescr</samp>. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dnMatDescr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">dense matrix descriptor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">batchCount</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of batches of the dense matrix.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-dense-set-batches"><a name="cusparse-generic-dense-set-batches" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-dense-set-batches" name="cusparse-generic-dense-set-batches" shape="rect">13.3.5.&nbsp;cusparseDnMatSetNumBatches()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseDnMatSetStridedBatch(cusparseDnMatDescr_t dnMatDescr,
                             int                  batchCount,
                             size_t               batchStride)
</pre><p class="p">
                              This function sets the number of batches of the dense matrix descriptor <samp class="ph codeph">dnMatDescr</samp>. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">dnMatDescr</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">dense matrix descriptor.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">batchCount</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of batches for the dense matrix descriptor.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">batchStride</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">address offset between a matrix and the next one.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusparse-generic-function-ref"><a name="cusparse-generic-function-ref" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-function-ref" name="cusparse-generic-function-ref" shape="rect">13.4.&nbsp;Generic SpMM API functions</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The sparse matrix-matrix multiplication functions are described in this section.
                           
                        </p>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-function-spmm"><a name="cusparse-generic-function-spmm" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-function-spmm" name="cusparse-generic-function-spmm" shape="rect">13.4.1.&nbsp;cusparseSpMM()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">cusparseStatus_t
cusparseSpMM(cusparseHandle_t           handle,
             cusparseOperation_t        transA,
             cusparseOperation_t        transB,
             const void*                alpha,
             const cusparseSpMatDescr_t matA,
             const cusparseDnMatDescr_t matB,
             const void*                beta,
             cusparseDnMatDescr_t       matC,
             cudaDataType               computeType,
             cusparseSpMMAlg_t          alg,
             void*                      externalBuffer)</pre><p class="p">This function performs one of the following sparse matrix-matrix operations:</p>
                           <div class="tablenoborder"><a name="cusparse-generic-function-spmm__table_svw_pgr_2gb" shape="rect">
                                 <!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="cusparse-generic-function-spmm__table_svw_pgr_2gb" class="table" width="100%" frame="void" border="0" rules="none">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" width="100%" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mrow>
                                                   <mi>C</mi>
                                                   <mo>=</mo>
                                                   <mi>α</mi>
                                                   <mi>o</mi>
                                                   <mi>p</mi>
                                                   <mrow>
                                                      <mo>(</mo>
                                                      <mi>A</mi>
                                                      <mo>)</mo>
                                                   </mrow>
                                                   <mi>o</mi>
                                                   <mi>p</mi>
                                                   <mrow>
                                                      <mo>(</mo>
                                                      <mi>B</mi>
                                                      <mo>)</mo>
                                                   </mrow>
                                                   <mo>+</mo>
                                                   <mi>β</mi>
                                                   <mi>C</mi>
                                                </mrow>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">where op(A) is a sparse matrix with dimensions 
                              			
                              
                              			
                              				
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>m</mi>
                                 <mo>×</mo>
                                 <mi>k</mi>
                              </math>
                              			 and B and C are matrices stored in column-major format with dimensions of op(B): 
                              				
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>k</mi>
                                 <mo>×</mo>
                                 <mi>n</mi>
                              </math>
                              			 and the dimensions of C: 
                              				
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>m</mi>
                                 <mo>×</mo>
                                 <mi>n</mi>
                              </math>
                              			.
                           </p>
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mrow class="MJX-TeXAtom-ORD">
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mtext>op</mtext>
                                 </mrow>
                              </mrow>
                              <mo stretchy="false">(</mo>
                              <mi>A</mi>
                              <mo stretchy="false">)</mo>
                              <mo>=</mo>
                              <mfenced open="{" close="">
                                 <mtable columnalign="left left" rowspacing=".1em" columnspacing="1em">
                                    <mtr>
                                       <mtd>
                                          <mi>A</mi>
                                       </mtd>
                                       <mtd>
                                          <mtext>if transA == CUSPARSE_OPERATION_NON_TRANSPOSE</mtext>
                                       </mtd>
                                    </mtr>
                                    <mtr>
                                       <mtd>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>T</mi>
                                          </msup>
                                       </mtd>
                                       <mtd>
                                          <mtext>if transA == CUSPARSE_OPERATION_TRANSPOSE</mtext>
                                       </mtd>
                                    </mtr>
                                    <mtr>
                                       <mtd>
                                          <msup>
                                             <mi>A</mi>
                                             <mi>H</mi>
                                          </msup>
                                       </mtd>
                                       <mtd>
                                          <mtext>if transA == CUSPARSE_OPERATION_CONJUGATE_TRANSPOSE</mtext>
                                       </mtd>
                                    </mtr>
                                 </mtable>
                              </mfenced>
                           </math>
                           <p class="p">It is executed asynchronously with respect to the host and may return control to the
                              			application on the host before the result is ready.
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSPARSE library context..</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation of op(<samp class="ph codeph">A</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">transB</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation of op(<samp class="ph codeph">B</samp>).
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alpha</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">scaling factor for A*B; of same type as computeType.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">matA</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">sparse matrix descriptor of the matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">matB</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">dense matrix descriptor of the matrix <samp class="ph codeph">B</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">beta</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">scaling factor for <samp class="ph codeph">C</samp>; of same type as computeType.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">matC</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">dense matrix descriptor of the matrix <samp class="ph codeph">C</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">computeType</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">computation type.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">alg</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algorithm implementation for SpMM. see cusparseSpMMAlg_t for possible values.
                                          						
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">externalBuffer</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">pointer to workspace buffer.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">matC</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">updated dense matrix descriptor of the matrix <samp class="ph codeph">C</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparse-generic-function-spmm-buffer"><a name="cusparse-generic-function-spmm-buffer" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparse-generic-function-spmm-buffer" name="cusparse-generic-function-spmm-buffer" shape="rect">13.4.2.&nbsp;cusparseSpMM_bufferSize()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusparseStatus_t
cusparseSpMM_bufferSize(cusparseHandle_t           handle,
                        cusparseOperation_t        transA,
                        cusparseOperation_t        transB,
                        const void*                alpha,
                        const cusparseSpMatDescr_t matA,
                        const cusparseDnMatDescr_t matB,
                        const void*                beta,
                        cusparseDnMatDescr_t       matC,
                        cudaDataType               computeType,
                        cusparseSpMMAlg_t          alg,
                        size_t*                    bufferSize)
</pre><p class="p">This function returns the size of the workspace needed by <samp class="ph codeph">cusparseSpMM()</samp>. User needs to allocate a buffer of this size and give that buffer to <samp class="ph codeph">cusparseSpMM()</samp> as an argument. All the arguments are similar to <samp class="ph codeph">cusparseSpMM()</samp> except the following output argument. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">bufferSize</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of workspace needed by <samp class="ph codeph">cusparseSpMM()</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="appendix-b-cusparse-library-c---example"><a name="appendix-b-cusparse-library-c---example" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#appendix-b-cusparse-library-c---example" name="appendix-b-cusparse-library-c---example" shape="rect">Appendix A: cuSPARSE Library C++ Example</a></h2>
                  <div class="body conbody">
                     <p class="p">For sample code reference please see the example code below. It shows an application written in C++ using the cuSPARSE library
                        API. The code performs the following actions:
                     </p>
                     <p class="p">1. Creates a sparse test matrix in COO format.</p>
                     <p class="p">2. Creates a sparse and dense vector.</p>
                     <p class="p">3. Allocates GPU memory and copies the matrix and vectors into it.</p>
                     <p class="p">4. Initializes the cuSPARSE library.</p>
                     <p class="p">5. Creates and sets up the matrix descriptor.</p>
                     <p class="p">6. Converts the matrix from COO to CSR format.</p>
                     <p class="p">7. Exercises Level 1 routines.</p>
                     <p class="p">8. Exercises Level 2 routines.</p>
                     <p class="p">9. Exercises Level 3 routines.</p>
                     <p class="p">10. Destroys the matrix descriptor.</p>
                     <p class="p">11. Releases resources allocated for the cuSPARSE library.</p><pre xml:space="preserve"><span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//Example: Application using C++ and the CUSPARSE library </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//-------------------------------------------------------</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include "cusparse.h"</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#define CLEANUP(s)                                   \
do {                                                 \
    printf ("%s\n", s);                              \
    if (yHostPtr)           free(yHostPtr);          \
    if (zHostPtr)           free(zHostPtr);          \
    if (xIndHostPtr)        free(xIndHostPtr);       \
    if (xValHostPtr)        free(xValHostPtr);       \
    if (cooRowIndexHostPtr) free(cooRowIndexHostPtr);\
    if (cooColIndexHostPtr) free(cooColIndexHostPtr);\
    if (cooValHostPtr)      free(cooValHostPtr);     \
    if (y)                  cudaFree(y);             \
    if (z)                  cudaFree(z);             \
    if (xInd)               cudaFree(xInd);          \
    if (xVal)               cudaFree(xVal);          \
    if (csrRowPtr)          cudaFree(csrRowPtr);     \
    if (cooRowIndex)        cudaFree(cooRowIndex);   \
    if (cooColIndex)        cudaFree(cooColIndex);   \
    if (cooVal)             cudaFree(cooVal);        \
    if (descr)              cusparseDestroyMatDescr(descr);\
    if (handle)             cusparseDestroy(handle); \
    cudaDeviceReset();          \
    fflush (stdout);                                 \
} while (0)</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(){     
    cudaError_t cudaStat1,cudaStat2,cudaStat3,cudaStat4,cudaStat5,cudaStat6;
    cusparseStatus_t status;
    cusparseHandle_t handle=0;
    cusparseMatDescr_t descr=0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *    cooRowIndexHostPtr=0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *    cooColIndexHostPtr=0;    
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> * cooValHostPtr=0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *    cooRowIndex=0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *    cooColIndex=0;    
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> * cooVal=0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *    xIndHostPtr=0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> * xValHostPtr=0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> * yHostPtr=0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *    xInd=0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> * xVal=0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> * y=0;  
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *    csrRowPtr=0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> * zHostPtr=0; 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> * z=0; 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>      n, nnz, nnz_vector;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> dzero =0.0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> dtwo  =2.0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> dthree=3.0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> dfive =5.0;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"testing example\n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* create the following sparse test matrix in COO format */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* |1.0     2.0 3.0|
       |    4.0        |
       |5.0     6.0 7.0|
       |    8.0     9.0| */</span>
    n=4; nnz=9; 
    cooRowIndexHostPtr = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *)   malloc(nnz*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(cooRowIndexHostPtr[0])); 
    cooColIndexHostPtr = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *)   malloc(nnz*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(cooColIndexHostPtr[0])); 
    cooValHostPtr      = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *)malloc(nnz*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(cooValHostPtr[0])); 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ((!cooRowIndexHostPtr) || (!cooColIndexHostPtr) || (!cooValHostPtr)){
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Host malloc failed (matrix)"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1; 
    }
    cooRowIndexHostPtr[0]=0; cooColIndexHostPtr[0]=0; cooValHostPtr[0]=1.0;  
    cooRowIndexHostPtr[1]=0; cooColIndexHostPtr[1]=2; cooValHostPtr[1]=2.0;  
    cooRowIndexHostPtr[2]=0; cooColIndexHostPtr[2]=3; cooValHostPtr[2]=3.0;  
    cooRowIndexHostPtr[3]=1; cooColIndexHostPtr[3]=1; cooValHostPtr[3]=4.0;  
    cooRowIndexHostPtr[4]=2; cooColIndexHostPtr[4]=0; cooValHostPtr[4]=5.0;  
    cooRowIndexHostPtr[5]=2; cooColIndexHostPtr[5]=2; cooValHostPtr[5]=6.0;
    cooRowIndexHostPtr[6]=2; cooColIndexHostPtr[6]=3; cooValHostPtr[6]=7.0;  
    cooRowIndexHostPtr[7]=3; cooColIndexHostPtr[7]=1; cooValHostPtr[7]=8.0;  
    cooRowIndexHostPtr[8]=3; cooColIndexHostPtr[8]=3; cooValHostPtr[8]=9.0;  
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
    //print the matrix
    printf("Input data:\n");
    for (int i=0; i&lt;nnz; i++){        
        printf("cooRowIndexHostPtr[%d]=%d  ",i,cooRowIndexHostPtr[i]);
        printf("cooColIndexHostPtr[%d]=%d  ",i,cooColIndexHostPtr[i]);
        printf("cooValHostPtr[%d]=%f     \n",i,cooValHostPtr[i]);
    }
    */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* create a sparse and dense vector */</span> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* xVal= [100.0 200.0 400.0]   (sparse)
       xInd= [0     1     3    ]
       y   = [10.0 20.0 30.0 40.0 | 50.0 60.0 70.0 80.0] (dense) */</span>
    nnz_vector = 3;
    xIndHostPtr = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *)   malloc(nnz_vector*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(xIndHostPtr[0])); 
    xValHostPtr = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *)malloc(nnz_vector*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(xValHostPtr[0])); 
    yHostPtr    = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *)malloc(2*n       *<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(yHostPtr[0]));
    zHostPtr    = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *)malloc(2*(n+1)   *<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(zHostPtr[0]));
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span>((!xIndHostPtr) || (!xValHostPtr) || (!yHostPtr) || (!zHostPtr)){
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Host malloc failed (vectors)"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1; 
    }
    yHostPtr[0] = 10.0;  xIndHostPtr[0]=0; xValHostPtr[0]=100.0; 
    yHostPtr[1] = 20.0;  xIndHostPtr[1]=1; xValHostPtr[1]=200.0;  
    yHostPtr[2] = 30.0;
    yHostPtr[3] = 40.0;  xIndHostPtr[2]=3; xValHostPtr[2]=400.0;  
    yHostPtr[4] = 50.0;
    yHostPtr[5] = 60.0;
    yHostPtr[6] = 70.0;
    yHostPtr[7] = 80.0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
    //print the vectors
    for (int j=0; j&lt;2; j++){
        for (int i=0; i&lt;n; i++){        
            printf("yHostPtr[%d,%d]=%f\n",i,j,yHostPtr[i+n*j]);
        }
    }
    for (int i=0; i&lt;nnz_vector; i++){        
        printf("xIndHostPtr[%d]=%d  ",i,xIndHostPtr[i]);
        printf("xValHostPtr[%d]=%f\n",i,xValHostPtr[i]);
    }
    */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* allocate GPU memory and copy the matrix and vectors into it */</span>
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;cooRowIndex,nnz*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(cooRowIndex[0])); 
    cudaStat2 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;cooColIndex,nnz*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(cooColIndex[0]));
    cudaStat3 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;cooVal,     nnz*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(cooVal[0])); 
    cudaStat4 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;y,          2*n*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(y[0]));   
    cudaStat5 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;xInd,nnz_vector*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(xInd[0])); 
    cudaStat6 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;xVal,nnz_vector*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(xVal[0])); 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ((cudaStat1 != cudaSuccess) ||
        (cudaStat2 != cudaSuccess) ||
        (cudaStat3 != cudaSuccess) ||
        (cudaStat4 != cudaSuccess) ||
        (cudaStat5 != cudaSuccess) ||
        (cudaStat6 != cudaSuccess)) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Device malloc failed"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1; 
    }    
    cudaStat1 = cudaMemcpy(cooRowIndex, cooRowIndexHostPtr, 
                           (size_t)(nnz*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(cooRowIndex[0])), 
                           cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(cooColIndex, cooColIndexHostPtr, 
                           (size_t)(nnz*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(cooColIndex[0])), 
                           cudaMemcpyHostToDevice);
    cudaStat3 = cudaMemcpy(cooVal,      cooValHostPtr,      
                           (size_t)(nnz*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(cooVal[0])),      
                           cudaMemcpyHostToDevice);
    cudaStat4 = cudaMemcpy(y,           yHostPtr,           
                           (size_t)(2*n*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(y[0])),           
                           cudaMemcpyHostToDevice);
    cudaStat5 = cudaMemcpy(xInd,        xIndHostPtr,        
                           (size_t)(nnz_vector*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(xInd[0])), 
                           cudaMemcpyHostToDevice);
    cudaStat6 = cudaMemcpy(xVal,        xValHostPtr,        
                           (size_t)(nnz_vector*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(xVal[0])), 
                           cudaMemcpyHostToDevice);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ((cudaStat1 != cudaSuccess) ||
        (cudaStat2 != cudaSuccess) ||
        (cudaStat3 != cudaSuccess) ||
        (cudaStat4 != cudaSuccess) ||
        (cudaStat5 != cudaSuccess) ||
        (cudaStat6 != cudaSuccess)) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Memcpy from Host to Device failed"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }
    
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* initialize cusparse library */</span>
    status= cusparseCreate(&amp;handle);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status != CUSPARSE_STATUS_SUCCESS) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"CUSPARSE Library initialization failed"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* create and setup matrix descriptor */</span> 
    status= cusparseCreateMatDescr(&amp;descr); 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status != CUSPARSE_STATUS_SUCCESS) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Matrix descriptor initialization failed"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }       
    cusparseSetMatType(descr,CUSPARSE_MATRIX_TYPE_GENERAL);
    cusparseSetMatIndexBase(descr,CUSPARSE_INDEX_BASE_ZERO);  
    
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* exercise conversion routines (convert matrix from COO 2 CSR format) */</span>
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;csrRowPtr,(n+1)*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(csrRowPtr[0]));
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cudaStat1 != cudaSuccess) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Device malloc failed (csrRowPtr)"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }
    status= cusparseXcoo2csr(handle,cooRowIndex,nnz,n,
                             csrRowPtr,CUSPARSE_INDEX_BASE_ZERO); 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status != CUSPARSE_STATUS_SUCCESS) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Conversion from COO to CSR format failed"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }  
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//csrRowPtr = [0 3 4 7 9] </span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// The following test only works for compute capability 1.3 and above </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// because it needs double precision.</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> devId;
    cudaDeviceProp prop;
    cudaError_t cudaStat;
    cudaStat = cudaGetDevice(&amp;devId);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cudaSuccess != cudaStat){
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaGetDevice failed"</span>);
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Error: cudaStat %d, %s\n"</span>, cudaStat, cudaGetErrorString(cudaStat));
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }
    cudaStat = cudaGetDeviceProperties( &amp;prop, devId) ;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cudaSuccess != cudaStat){
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaGetDeviceProperties failed"</span>);
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Error: cudaStat %d, %s\n"</span>, cudaStat, cudaGetErrorString(cudaStat));
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> cc = 100*prop.major + 10*prop.minor;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cc &lt; 130){
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"waive the test because only sm13 and above are supported\n"</span>);
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"the device has compute capability %d\n"</span>, cc);
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example test WAIVED"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 2;
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* exercise Level 1 routines (scatter vector elements) */</span>
    status= cusparseDsctr(handle, nnz_vector, xVal, xInd, 
                          &amp;y[n], CUSPARSE_INDEX_BASE_ZERO);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status != CUSPARSE_STATUS_SUCCESS) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Scatter from sparse to dense vector failed"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }  
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//y = [10 20 30 40 | 100 200 70 400]</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* exercise Level 2 routines (csrmv) */</span>
    status= cusparseDcsrmv(handle,CUSPARSE_OPERATION_NON_TRANSPOSE, n, n, nnz,
                           &amp;dtwo, descr, cooVal, csrRowPtr, cooColIndex, 
                           &amp;y[0], &amp;dthree, &amp;y[n]);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status != CUSPARSE_STATUS_SUCCESS) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Matrix-vector multiplication failed"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }    
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//y = [10 20 30 40 | 680 760 1230 2240]</span>
    cudaMemcpy(yHostPtr, y, (size_t)(2*n*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(y[0])), cudaMemcpyDeviceToHost);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
    printf("Intermediate results:\n");
    for (int j=0; j&lt;2; j++){
        for (int i=0; i&lt;n; i++){        
            printf("yHostPtr[%d,%d]=%f\n",i,j,yHostPtr[i+n*j]);
        }
    }
    */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* exercise Level 3 routines (csrmm) */</span>
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;z, 2*(n+1)*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(z[0]));   
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cudaStat1 != cudaSuccess) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Device malloc failed (z)"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }
    cudaStat1 = cudaMemset((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *)z,0, 2*(n+1)*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(z[0]));    
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cudaStat1 != cudaSuccess) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Memset on Device failed"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }
    status= cusparseDcsrmm(handle, CUSPARSE_OPERATION_NON_TRANSPOSE, n, 2, n, 
                           nnz, &amp;dfive, descr, cooVal, csrRowPtr, cooColIndex, 
                           y, n, &amp;dzero, z, n+1);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status != CUSPARSE_STATUS_SUCCESS) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Matrix-matrix multiplication failed"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }  

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* print final results (z) */</span>
    cudaStat1 = cudaMemcpy(zHostPtr, z, 
                           (size_t)(2*(n+1)*<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(z[0])), 
                           cudaMemcpyDeviceToHost);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cudaStat1 != cudaSuccess)  {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Memcpy from Device to Host failed"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    } 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//z = [950 400 2550 2600 0 | 49300 15200 132300 131200 0]</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
    printf("Final results:\n");
    for (int j=0; j&lt;2; j++){
        for (int i=0; i&lt;n+1; i++){
            printf("z[%d,%d]=%f\n",i,j,zHostPtr[i+(n+1)*j]);
        }
    }
    */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* destroy matrix descriptor */</span> 
    status = cusparseDestroyMatDescr(descr); 
    descr = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status != CUSPARSE_STATUS_SUCCESS) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Matrix descriptor destruction failed"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }    

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* destroy handle */</span>
    status = cusparseDestroy(handle);
    handle = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status != CUSPARSE_STATUS_SUCCESS) {
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"CUSPARSE Library release of resources failed"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }   

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* check the results */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Notice that CLEANUP() contains a call to cusparseDestroy(handle) */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ((zHostPtr[0] != 950.0)    || 
        (zHostPtr[1] != 400.0)    || 
        (zHostPtr[2] != 2550.0)   || 
        (zHostPtr[3] != 2600.0)   || 
        (zHostPtr[4] != 0.0)      || 
        (zHostPtr[5] != 49300.0)  || 
        (zHostPtr[6] != 15200.0)  || 
        (zHostPtr[7] != 132300.0) || 
        (zHostPtr[8] != 131200.0) || 
        (zHostPtr[9] != 0.0)      ||
        (yHostPtr[0] != 10.0)     || 
        (yHostPtr[1] != 20.0)     || 
        (yHostPtr[2] != 30.0)     || 
        (yHostPtr[3] != 40.0)     || 
        (yHostPtr[4] != 680.0)    || 
        (yHostPtr[5] != 760.0)    || 
        (yHostPtr[6] != 1230.0)   || 
        (yHostPtr[7] != 2240.0)){ 
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example test FAILED"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 1;
    }
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
        CLEANUP(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example test PASSED"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
    }      
}
</pre></div>
               </div>
               <div class="topic concept nested0" id="appendix-c-cusparse-fortran-bindings"><a name="appendix-c-cusparse-fortran-bindings" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#appendix-c-cusparse-fortran-bindings" name="appendix-c-cusparse-fortran-bindings" shape="rect">Appendix B: cuSPARSE Fortran Bindings</a></h2>
                  <div class="body conbody">
                     <p class="p">The cuSPARSE library is implemented using the C-based CUDA toolchain, and it thus provides a C-style API that makes interfacing
                        to applications written in C or C++ trivial. There are also many applications implemented in Fortran that would benefit from
                        using cuSPARSE, and therefore a cuSPARSE Fortran interface has been developed.
                     </p>
                     <p class="p">Unfortunately, Fortran-to-C calling conventions are not standardized and differ by platform and toolchain. In particular,
                        differences may exist in the following areas:
                     </p>
                     <p class="p">Symbol names (capitalization, name decoration)</p>
                     <p class="p">Argument passing (by value or reference)</p>
                     <p class="p">Passing of pointer arguments (size of the pointer)</p>
                     <p class="p">To provide maximum flexibility in addressing those differences, the cuSPARSE Fortran interface is provided in the form of
                        wrapper functions, which are written in C and are located in the file <samp class="ph codeph">cusparse_fortran.c</samp>. This file also contains a few additional wrapper functions (for <samp class="ph codeph">cudaMalloc()</samp>, <samp class="ph codeph">cudaMemset</samp>, and so on) that can be used to allocate memory on the GPU.
                     </p>
                     <p class="p">The cuSPARSE Fortran wrapper code is provided as an example only and needs to be compiled into an application for it to call
                        the cuSPARSE API functions. Providing this source code allows users to make any changes necessary for a particular platform
                        and toolchain.
                     </p>
                     <p class="p">The cuSPARSE Fortran wrapper code has been used to demonstrate interoperability with the compilers g95 0.91 (on 32-bit and
                        64-bit Linux) and g95 0.92 (on 32-bit and 64-bit Mac OS X). In order to use other compilers, users have to make any changes
                        to the wrapper code that may be required.
                     </p>
                     <p class="p">The direct wrappers, intended for production code, substitute device pointers for vector and matrix arguments in all cuSPARSE
                        functions. To use these interfaces, existing applications need to be modified slightly to allocate and deallocate data structures
                        in GPU memory space (using <samp class="ph codeph">CUDA_MALLOC()</samp> and <samp class="ph codeph">CUDA_FREE()</samp>) and to copy data between GPU and CPU memory spaces (using the <samp class="ph codeph">CUDA_MEMCPY()</samp> routines). The sample wrappers provided in <samp class="ph codeph">cusparse_fortran.c</samp> map device pointers to the OS-dependent type <samp class="ph codeph">size_t</samp>, which is 32 bits wide on 32-bit platforms and 64 bits wide on a 64-bit platforms.
                     </p>
                     <p class="p">One approach to dealing with index arithmetic on device pointers in Fortran code is to use C-style macros and to use the C
                        preprocessor to expand them. On Linux and Mac OS X, preprocessing can be done by using the option <samp class="ph codeph">'-cpp'</samp> with g95 or gfortran. The function <samp class="ph codeph">GET_SHIFTED_ADDRESS()</samp>, provided with the cuSPARSE Fortran wrappers, can also be used, as shown in example B.
                     </p>
                     <p class="p">Example B shows the the C++ of example A implemented in Fortran 77 on the host. This example should be compiled with <samp class="ph codeph">ARCH_64</samp> defined as 1 on a 64-bit OS system and as undefined on a 32-bit OS system. For example, on g95 or gfortran, it can be done
                        directly on the command line using the option <samp class="ph codeph">-cpp -DARCH_64=1</samp>.
                     </p>
                  </div>
                  <div class="topic concept nested1" id="example-b"><a name="example-b" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#example-b" name="example-b" shape="rect">15.1.&nbsp;Example B, Fortran Application</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">c     #define ARCH_64 0
c     #define ARCH_64 1

      program cusparse_fortran_example
      implicit none
      integer cuda_malloc
      external cuda_free
      integer cuda_memcpy_c2fort_int
      integer cuda_memcpy_c2fort_real
      integer cuda_memcpy_fort2c_int
      integer cuda_memcpy_fort2c_real
      integer cuda_memset
      integer cusparse_create 
      external cusparse_destroy
      integer cusparse_get_version 
      integer cusparse_create_mat_descr
      external cusparse_destroy_mat_descr
      integer cusparse_set_mat_type 
      integer cusparse_get_mat_type
      integer cusparse_get_mat_fill_mode
      integer cusparse_get_mat_diag_type
      integer cusparse_set_mat_index_base
      integer cusparse_get_mat_index_base
      integer cusparse_xcoo2csr
      integer cusparse_dsctr
      integer cusparse_dcsrmv
      integer cusparse_dcsrmm
      external get_shifted_address
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#if ARCH_64      </span>
      integer*8 handle
      integer*8 descrA      
      integer*8 cooRowIndex
      integer*8 cooColIndex    
      integer*8 cooVal
      integer*8 xInd
      integer*8 xVal
      integer*8 y  
      integer*8 z 
      integer*8 csrRowPtr
      integer*8 ynp1  
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#else</span>
      integer*4 handle
      integer*4 descrA
      integer*4 cooRowIndex
      integer*4 cooColIndex    
      integer*4 cooVal
      integer*4 xInd
      integer*4 xVal
      integer*4 y  
      integer*4 z 
      integer*4 csrRowPtr
      integer*4 ynp1  
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#endif      </span>
      integer status
      integer cudaStat1,cudaStat2,cudaStat3
      integer cudaStat4,cudaStat5,cudaStat6
      integer n, nnz, nnz_vector
      parameter (n=4, nnz=9, nnz_vector=3)
      integer cooRowIndexHostPtr(nnz)
      integer cooColIndexHostPtr(nnz)    
      real*8  cooValHostPtr(nnz)
      integer xIndHostPtr(nnz_vector)
      real*8  xValHostPtr(nnz_vector)
      real*8  yHostPtr(2*n)
      real*8  zHostPtr(2*(n+1)) 
      integer i, j
      integer version, mtype, fmode, dtype, ibase
      real*8  dzero,dtwo,dthree,dfive
      real*8  epsilon


      write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"testing fortran example"</span>

c     predefined constants (need to be careful with them)
      dzero = 0.0
      dtwo  = 2.0
      dthree= 3.0
      dfive = 5.0
c     create the following sparse test matrix in COO format 
c     (notice one-based indexing)
c     |1.0     2.0 3.0|
c     |    4.0        |
c     |5.0     6.0 7.0|
c     |    8.0     9.0| 
      cooRowIndexHostPtr(1)=1 
      cooColIndexHostPtr(1)=1 
      cooValHostPtr(1)     =1.0  
      cooRowIndexHostPtr(2)=1 
      cooColIndexHostPtr(2)=3 
      cooValHostPtr(2)     =2.0  
      cooRowIndexHostPtr(3)=1 
      cooColIndexHostPtr(3)=4 
      cooValHostPtr(3)     =3.0  
      cooRowIndexHostPtr(4)=2 
      cooColIndexHostPtr(4)=2 
      cooValHostPtr(4)     =4.0  
      cooRowIndexHostPtr(5)=3 
      cooColIndexHostPtr(5)=1 
      cooValHostPtr(5)     =5.0  
      cooRowIndexHostPtr(6)=3 
      cooColIndexHostPtr(6)=3 
      cooValHostPtr(6)     =6.0
      cooRowIndexHostPtr(7)=3 
      cooColIndexHostPtr(7)=4 
      cooValHostPtr(7)     =7.0  
      cooRowIndexHostPtr(8)=4 
      cooColIndexHostPtr(8)=2 
      cooValHostPtr(8)     =8.0  
      cooRowIndexHostPtr(9)=4 
      cooColIndexHostPtr(9)=4 
      cooValHostPtr(9)     =9.0  
c     print the matrix
      write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Input data:"</span>
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">do</span> i=1,nnz        
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cooRowIndexHostPtr["</span>,i,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"]="</span>,cooRowIndexHostPtr(i)
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cooColIndexHostPtr["</span>,i,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"]="</span>,cooColIndexHostPtr(i)
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cooValHostPtr["</span>,     i,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"]="</span>,cooValHostPtr(i)
      enddo
  
c     create a sparse and dense vector  
c     xVal= [100.0 200.0 400.0]   (sparse)
c     xInd= [0     1     3    ]
c     y   = [10.0 20.0 30.0 40.0 | 50.0 60.0 70.0 80.0] (dense) 
c     (notice one-based indexing)
      yHostPtr(1) = 10.0  
      yHostPtr(2) = 20.0  
      yHostPtr(3) = 30.0
      yHostPtr(4) = 40.0  
      yHostPtr(5) = 50.0
      yHostPtr(6) = 60.0
      yHostPtr(7) = 70.0
      yHostPtr(8) = 80.0
      xIndHostPtr(1)=1 
      xValHostPtr(1)=100.0 
      xIndHostPtr(2)=2 
      xValHostPtr(2)=200.0
      xIndHostPtr(3)=4 
      xValHostPtr(3)=400.0    
c     print the vectors
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">do</span> j=1,2
         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">do</span> i=1,n        
            write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"yHostPtr["</span>,i,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">","</span>,j,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"]="</span>,yHostPtr(i+n*(j-1))
         enddo
      enddo
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">do</span> i=1,nnz_vector        
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"xIndHostPtr["</span>,i,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"]="</span>,xIndHostPtr(i)
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"xValHostPtr["</span>,i,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"]="</span>,xValHostPtr(i)
      enddo

c     allocate GPU memory and copy the matrix and vectors into it 
c     cudaSuccess=0
c     cudaMemcpyHostToDevice=1
      cudaStat1 = cuda_malloc(cooRowIndex,nnz*4) 
      cudaStat2 = cuda_malloc(cooColIndex,nnz*4)
      cudaStat3 = cuda_malloc(cooVal,     nnz*8) 
      cudaStat4 = cuda_malloc(y,          2*n*8)   
      cudaStat5 = cuda_malloc(xInd,nnz_vector*4) 
      cudaStat6 = cuda_malloc(xVal,nnz_vector*8) 
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ((cudaStat1 /= 0) .OR. 
     $    (cudaStat2 /= 0) .OR. 
     $    (cudaStat3 /= 0) .OR. 
     $    (cudaStat4 /= 0) .OR. 
     $    (cudaStat5 /= 0) .OR. 
     $    (cudaStat6 /= 0)) then 
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Device malloc failed"</span>
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaStat1="</span>,cudaStat1
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaStat2="</span>,cudaStat2
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaStat3="</span>,cudaStat3
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaStat4="</span>,cudaStat4
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaStat5="</span>,cudaStat5
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaStat6="</span>,cudaStat6
         stop 2 
      endif    
      cudaStat1 = cuda_memcpy_fort2c_int(cooRowIndex,cooRowIndexHostPtr, 
     $                                   nnz*4,1)        
      cudaStat2 = cuda_memcpy_fort2c_int(cooColIndex,cooColIndexHostPtr, 
     $                                   nnz*4,1)       
      cudaStat3 = cuda_memcpy_fort2c_real(cooVal,    cooValHostPtr,      
     $                                    nnz*8,1)       
      cudaStat4 = cuda_memcpy_fort2c_real(y,      yHostPtr,           
     $                                    2*n*8,1)       
      cudaStat5 = cuda_memcpy_fort2c_int(xInd,       xIndHostPtr,        
     $                                   nnz_vector*4,1) 
      cudaStat6 = cuda_memcpy_fort2c_real(xVal,      xValHostPtr,        
     $                                    nnz_vector*8,1)
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ((cudaStat1 /= 0) .OR. 
     $    (cudaStat2 /= 0) .OR. 
     $    (cudaStat3 /= 0) .OR. 
     $    (cudaStat4 /= 0) .OR. 
     $    (cudaStat5 /= 0) .OR. 
     $    (cudaStat6 /= 0)) then 
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Memcpy from Host to Device failed"</span>
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaStat1="</span>,cudaStat1
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaStat2="</span>,cudaStat2
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaStat3="</span>,cudaStat3
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaStat4="</span>,cudaStat4
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaStat5="</span>,cudaStat5
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cudaStat6="</span>,cudaStat6
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)  
         stop 1
      endif
    
c     initialize cusparse library
c     CUSPARSE_STATUS_SUCCESS=0 
      status = cusparse_create(handle)
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status /= 0) then 
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"CUSPARSE Library initialization failed"</span>
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)  
         stop 1
      endif
c     get version
c     CUSPARSE_STATUS_SUCCESS=0
      status = cusparse_get_version(handle,version)
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status /= 0) then 
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"CUSPARSE Library initialization failed"</span>
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)   
         call cusparse_destroy(handle)
         stop 1
      endif
      write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"CUSPARSE Library version"</span>,version

c     create and setup the matrix descriptor
c     CUSPARSE_STATUS_SUCCESS=0 
c     CUSPARSE_MATRIX_TYPE_GENERAL=0
c     CUSPARSE_INDEX_BASE_ONE=1  
      status= cusparse_create_mat_descr(descrA) 
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status /= 0) then 
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Creating matrix descriptor failed"</span>
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)  
         call cusparse_destroy(handle)
         stop 1
      endif  
      status = cusparse_set_mat_type(descrA,0)       
      status = cusparse_set_mat_index_base(descrA,1) 
c     print the matrix descriptor
      mtype = cusparse_get_mat_type(descrA)
      fmode = cusparse_get_mat_fill_mode(descrA) 
      dtype = cusparse_get_mat_diag_type(descrA) 
      ibase = cusparse_get_mat_index_base(descrA) 
      write (*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"matrix descriptor:"</span>
      write (*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"t="</span>,mtype,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"m="</span>,fmode,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"d="</span>,dtype,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"b="</span>,ibase

c     exercise conversion routines (convert matrix from COO 2 CSR format) 
c     cudaSuccess=0
c     CUSPARSE_STATUS_SUCCESS=0 
c     CUSPARSE_INDEX_BASE_ONE=1
      cudaStat1 = cuda_malloc(csrRowPtr,(n+1)*4)
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cudaStat1 /= 0) then  
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)  
         call cusparse_destroy_mat_descr(descrA)
         call cusparse_destroy(handle)
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Device malloc failed (csrRowPtr)"</span>
         stop 2
      endif
      status= cusparse_xcoo2csr(handle,cooRowIndex,nnz,n,
     $                          csrRowPtr,1)         
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status /= 0) then 
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)  
         call cuda_free(csrRowPtr)
         call cusparse_destroy_mat_descr(descrA)
         call cusparse_destroy(handle)
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Conversion from COO to CSR format failed"</span>
         stop 1
      endif  
c     csrRowPtr = [0 3 4 7 9] 

c     exercise Level 1 routines (scatter vector elements)
c     CUSPARSE_STATUS_SUCCESS=0  
c     CUSPARSE_INDEX_BASE_ONE=1
      call get_shifted_address(y,n*8,ynp1)
      status= cusparse_dsctr(handle, nnz_vector, xVal, xInd, 
     $                       ynp1, 1)
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status /= 0) then 
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)  
         call cuda_free(csrRowPtr)
         call cusparse_destroy_mat_descr(descrA)
         call cusparse_destroy(handle)
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Scatter from sparse to dense vector failed"</span>
         stop 1
      endif  
c     y = [10 20 30 40 | 100 200 70 400]

c     exercise Level 2 routines (csrmv) 
c     CUSPARSE_STATUS_SUCCESS=0
c     CUSPARSE_OPERATION_NON_TRANSPOSE=0
      status= cusparse_dcsrmv(handle, 0, n, n, nnz, dtwo,
     $                       descrA, cooVal, csrRowPtr, cooColIndex, 
     $                       y, dthree, ynp1)        
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status /= 0) then 
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)  
         call cuda_free(csrRowPtr)
         call cusparse_destroy_mat_descr(descrA)
         call cusparse_destroy(handle)
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Matrix-vector multiplication failed"</span>
         stop 1
      endif    
    
c     print intermediate results (y) 
c     y = [10 20 30 40 | 680 760 1230 2240]
c     cudaSuccess=0
c     cudaMemcpyDeviceToHost=2
      cudaStat1 = cuda_memcpy_c2fort_real(yHostPtr, y, 2*n*8, 2) 
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cudaStat1 /= 0) then  
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)  
         call cuda_free(csrRowPtr)
         call cusparse_destroy_mat_descr(descrA)
         call cusparse_destroy(handle)
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Memcpy from Device to Host failed"</span>
         stop 1
      endif
      write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Intermediate results:"</span>
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">do</span> j=1,2
         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">do</span> i=1,n        
             write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"yHostPtr["</span>,i,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">","</span>,j,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"]="</span>,yHostPtr(i+n*(j-1))
         enddo
      enddo 

c     exercise Level 3 routines (csrmm)
c     cudaSuccess=0 
c     CUSPARSE_STATUS_SUCCESS=0
c     CUSPARSE_OPERATION_NON_TRANSPOSE=0
      cudaStat1 = cuda_malloc(z, 2*(n+1)*8)   
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cudaStat1 /= 0) then  
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)  
         call cuda_free(csrRowPtr)
         call cusparse_destroy_mat_descr(descrA)
         call cusparse_destroy(handle)
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Device malloc failed (z)"</span>
         stop 2
      endif
      cudaStat1 = cuda_memset(z, 0, 2*(n+1)*8)    
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cudaStat1 /= 0) then  
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)  
         call cuda_free(z) 
         call cuda_free(csrRowPtr)
         call cusparse_destroy_mat_descr(descrA)
         call cusparse_destroy(handle)
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Memset on Device failed"</span>
         stop 1
      endif
      status= cusparse_dcsrmm(handle, 0, n, 2, n, nnz, dfive, 
     $                        descrA, cooVal, csrRowPtr, cooColIndex, 
     $                        y, n, dzero, z, n+1) 
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status /= 0) then     
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)  
         call cuda_free(z) 
         call cuda_free(csrRowPtr)
         call cusparse_destroy_mat_descr(descrA)
         call cusparse_destroy(handle)
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Matrix-matrix multiplication failed"</span>
         stop 1
      endif  

c     print final results (z) 
c     cudaSuccess=0
c     cudaMemcpyDeviceToHost=2
      cudaStat1 = cuda_memcpy_c2fort_real(zHostPtr, z, 2*(n+1)*8, 2) 
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cudaStat1 /= 0) then 
         call cuda_free(cooRowIndex)
         call cuda_free(cooColIndex)    
         call cuda_free(cooVal)
         call cuda_free(xInd)
         call cuda_free(xVal)
         call cuda_free(y)  
         call cuda_free(z) 
         call cuda_free(csrRowPtr)
         call cusparse_destroy_mat_descr(descrA)
         call cusparse_destroy(handle)
         write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Memcpy from Device to Host failed"</span>
         stop 1
      endif 
c     z = [950 400 2550 2600 0 | 49300 15200 132300 131200 0]
      write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Final results:"</span>
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">do</span> j=1,2
         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">do</span> i=1,n+1
            write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"z["</span>,i,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">","</span>,j,<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"]="</span>,zHostPtr(i+(n+1)*(j-1))
         enddo
      enddo
    
c     check the results 
      epsilon = 0.00000000000001
      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ((DABS(zHostPtr(1) - 950.0)   .GT. epsilon)  .OR. 
     $    (DABS(zHostPtr(2) - 400.0)   .GT. epsilon)  .OR.  
     $    (DABS(zHostPtr(3) - 2550.0)  .GT. epsilon)  .OR.  
     $    (DABS(zHostPtr(4) - 2600.0)  .GT. epsilon)  .OR.  
     $    (DABS(zHostPtr(5) - 0.0)     .GT. epsilon)  .OR.  
     $    (DABS(zHostPtr(6) - 49300.0) .GT. epsilon)  .OR.  
     $    (DABS(zHostPtr(7) - 15200.0) .GT. epsilon)  .OR.  
     $    (DABS(zHostPtr(8) - 132300.0).GT. epsilon)  .OR.  
     $    (DABS(zHostPtr(9) - 131200.0).GT. epsilon)  .OR.  
     $    (DABS(zHostPtr(10) - 0.0)    .GT. epsilon)  .OR. 
     $    (DABS(yHostPtr(1) - 10.0)    .GT. epsilon)  .OR.  
     $    (DABS(yHostPtr(2) - 20.0)    .GT. epsilon)  .OR.  
     $    (DABS(yHostPtr(3) - 30.0)    .GT. epsilon)  .OR.  
     $    (DABS(yHostPtr(4) - 40.0)    .GT. epsilon)  .OR.  
     $    (DABS(yHostPtr(5) - 680.0)   .GT. epsilon)  .OR.  
     $    (DABS(yHostPtr(6) - 760.0)   .GT. epsilon)  .OR.  
     $    (DABS(yHostPtr(7) - 1230.0)  .GT. epsilon)  .OR.  
     $    (DABS(yHostPtr(8) - 2240.0)  .GT. epsilon)) then 
          write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"fortran example test FAILED"</span>
       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>
          write(*,*) <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"fortran example test PASSED"</span>
       endif   
       
c      deallocate GPU memory and exit      
       call cuda_free(cooRowIndex)
       call cuda_free(cooColIndex)    
       call cuda_free(cooVal)
       call cuda_free(xInd)
       call cuda_free(xVal)
       call cuda_free(y)  
       call cuda_free(z) 
       call cuda_free(csrRowPtr)
       call cusparse_destroy_mat_descr(descrA)
       call cusparse_destroy(handle)

       stop 0
       end
</pre></div>
                  </div>
               </div>
               <div class="topic concept nested0" id="csrmv_examples"><a name="csrmv_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#csrmv_examples" name="csrmv_examples" shape="rect">16.&nbsp;Appendix C: Examples of sparse matrix vector multiplication</a></h2>
                  <div class="body conbody"></div>
                  <div class="topic concept nested1" id="csrmvmp-example1"><a name="csrmvmp-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#csrmvmp-example1" name="csrmvmp-example1" shape="rect">16.1.&nbsp;power method</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           eigenvalue problem
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mo>*</mo>
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>λ</mi>
                                          <mo>*</mo>
                                          <mi>x</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           A is a 4x4 sparse matrix,
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>6.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>7.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>8.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>9.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The goal is to find the largest eigen-pair by power method.
                           The following code uses <samp class="ph codeph">csrmv_mp</samp> inside the loop of power method.
                           
                        </p>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include csrmvmp_example.cpp 
 *   g++ -fopenmp -o csrmvmp_example csrmvmp_example.o -L/usr/local/cuda/lib64 -lcublas -lcusparse -lcudart
 *
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cublas_v2.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusparse.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cublasHandle_t cublasH = NULL;
    cusparseHandle_t cusparseH = NULL;
    cudaStream_t stream = NULL;
    cusparseMatDescr_t descrA = NULL;

    cublasStatus_t cublasStat = CUBLAS_STATUS_SUCCESS;
    cusparseStatus_t cusparseStat = CUSPARSE_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    cudaError_t cudaStat5 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 4;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzA = 9;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* 
 *      |    1     0     2     3   |
 *      |    0     4     0     0   |
 *  A = |    5     0     6     7   |
 *      |    0     8     0     9   |
 *
 * eigevales are { -0.5311, 7.5311, 9.0000, 4.0000 }
 *
 * The largest eigenvaluse is 9 and corresponding eigenvector is
 *
 *      | 0.3029  |
 * v =  |     0   |
 *      | 0.9350  |
 *      | 0.1844  |
 */</span>


</pre></div>
                        <div class="p">
                           prepare matrix A
                           <pre xml:space="preserve"> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> csrRowPtrA[n+1] = { 0, 3, 4, 7, 9 };
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> csrColIndA[nnzA] = {0, 2, 3, 1, 0, 2, 3, 1, 3 };
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> csrValA[nnzA] = {1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0 };
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda_exact[n] = { 9.0000, 7.5311, 4.0000, -0.5311 };
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> x0[n] = {1.0, 2.0, 3.0, 4.0 }; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* initial guess */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> x[n]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* numerical eigenvector */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrRowPtrA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrColIndA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_csrValA = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_x = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* eigenvector */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_y = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* workspace */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> tol = 1.e-6;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> max_ites = 30;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> h_one  = 1.0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> h_zero = 0.0;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of csrmv_mp \n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"tol = %E \n"</span>, tol);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"max. iterations = %d \n"</span>, max_ites);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"1st eigenvaluse is %f\n"</span>, lambda_exact[0] );
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"2nd eigenvaluse is %f\n"</span>, lambda_exact[1] );

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> alpha = lambda_exact[1]/lambda_exact[0] ;
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"convergence rate is %f\n"</span>, alpha );

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> est_iterations = log(tol)/log(alpha);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"# of iterations required is %d\n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)ceil(est_iterations)  );

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cublas/cusparse handle, bind a stream */</span>
    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    cublasStat = cublasCreate(&amp;cublasH);
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);

    cublasStat = cublasSetStream(cublasH, stream);
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);

    cusparseStat = cusparseCreate(&amp;cusparseH);
    assert(CUSPARSE_STATUS_SUCCESS == cusparseStat);

    cusparseStat = cusparseSetStream(cusparseH, stream);
    assert(CUSPARSE_STATUS_SUCCESS == cusparseStat);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: configuration of matrix A */</span>
    cusparseStat = cusparseCreateMatDescr(&amp;descrA);
    assert(CUSPARSE_STATUS_SUCCESS == cusparseStat);

    cusparseSetMatIndexBase(descrA,CUSPARSE_INDEX_BASE_ZERO);
    cusparseSetMatType(descrA, CUSPARSE_MATRIX_TYPE_GENERAL );

</pre></div>
                        <div class="p">
                           power method
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: copy A and x0 to device */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrRowPtrA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * (n+1) );
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * nnzA );
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrValA   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * nnzA );
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_x         , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * n );
    cudaStat5 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_y         , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * n );
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);
    assert(cudaSuccess == cudaStat5);

    cudaStat1 = cudaMemcpy(d_csrRowPtrA, csrRowPtrA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * (n+1)   , cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(d_csrColIndA, csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * nnzA    , cudaMemcpyHostToDevice);
    cudaStat3 = cudaMemcpy(d_csrValA   , csrValA   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * nnzA , cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);


<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * step 4: power method
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda = 0.0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda_next = 0.0;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *  4.1: initial guess x0
 */</span>
    cudaStat1 = cudaMemcpy(d_x, x0, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * n, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ite = 0 ; ite &lt; max_ites ; ite++ ){
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *  4.2: normalize vector x
 *      x = x / |x|
 */</span>
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> nrm2_x;
        cublasStat = cublasDnrm2_v2(cublasH,
                                    n,
                                    d_x,
                                    1, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// incx,</span>
                                    &amp;nrm2_x  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host pointer */</span>
                                   );
        assert(CUBLAS_STATUS_SUCCESS == cublasStat);

        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> one_over_nrm2_x = 1.0 / nrm2_x;
        cublasStat = cublasDscal_v2( cublasH,
                                     n,
                                     &amp;one_over_nrm2_x,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host pointer */</span>
                                     d_x,
                                     1 <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// incx</span>
                                    );
        assert(CUBLAS_STATUS_SUCCESS == cublasStat);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *  4.3: y = A*x
 */</span>
        cusparseStat = cusparseDcsrmv_mp(cusparseH,
                                         CUSPARSE_OPERATION_NON_TRANSPOSE,
                                         n,
                                         n,
                                         nnzA,
                                         &amp;h_one,
                                         descrA,
                                         d_csrValA,
                                         d_csrRowPtrA,
                                         d_csrColIndA,
                                         d_x,
                                         &amp;h_zero,
                                         d_y);
        assert(CUSPARSE_STATUS_SUCCESS == cusparseStat);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *  4.4: lambda = y**T*x
 */</span>
        cublasStat = cublasDdot_v2 ( cublasH,
                                     n,
                                     d_x,
                                     1, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// incx,</span>
                                     d_y,
                                     1, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// incy,</span>
                                     &amp;lambda_next  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host pointer */</span>
                                   );
        assert(CUBLAS_STATUS_SUCCESS == cublasStat);

        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda_err = fabs( lambda_next - lambda_exact[0] );
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"ite %d: lambda = %f, error = %E\n"</span>, ite, lambda_next, lambda_err );
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *  4.5: check if converges
 */</span>
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( (ite &gt; 0) &amp;&amp;
             fabs( lambda - lambda_next ) &lt; tol
        ){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">break</span>; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// converges</span>
        }

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *  4.6: x := y
 *       lambda = lambda_next
 *
 *  so new approximation is (lambda, x), x is not normalized.
 */</span>
        cudaStat1 = cudaMemcpy(d_x, d_y, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * n , cudaMemcpyDeviceToDevice);
        assert(cudaSuccess == cudaStat1);

        lambda = lambda_next;
    }


</pre></div>
                        <div class="p">
                           report largest eigenvalue and eigenvector.
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * step 5: report eigen-pair
 */</span>
    cudaStat1 = cudaMemcpy(x, d_x, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * n, cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"largest eigenvalue is %E\n"</span>, lambda );

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"eigenvector = (matlab base-1)\n"</span>);
    printMatrix(n, 1, x, n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);


<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrRowPtrA  ) cudaFree(d_csrRowPtrA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrColIndA  ) cudaFree(d_csrColIndA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrValA     ) cudaFree(d_csrValA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_x           ) cudaFree(d_x);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_y           ) cudaFree(d_y);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cublasH       ) cublasDestroy(cublasH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusparseH     ) cusparseDestroy(cusparseH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream        ) cudaStreamDestroy(stream);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (descrA        ) cusparseDestroyMatDescr(descrA);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="coosort_examples"><a name="coosort_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#coosort_examples" name="coosort_examples" shape="rect">17.&nbsp;Appendix D: Examples of sorting</a></h2>
                  <div class="body conbody"></div>
                  <div class="topic concept nested1" id="coosort-example1"><a name="coosort-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#coosort-example1" name="coosort-example1" shape="rect">17.1.&nbsp;COO sort</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           sorting of COO format.
                           
                        </p>
                        <p class="p">
                           A is a 3x3 sparse matrix,
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>8.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include coosort.cpp 
 *   g++ -o coosort.cpp coosort.o -L/usr/local/cuda/lib64 -lcusparse -lcudart
 *
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusparse.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusparseHandle_t handle = NULL;
    cudaStream_t stream = NULL;

    cusparseStatus_t status = CUSPARSE_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    cudaError_t cudaStat5 = cudaSuccess;
    cudaError_t cudaStat6 = cudaSuccess;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * A is a 3x3 sparse matrix 
 *     | 1 2 0 | 
 * A = | 0 5 0 | 
 *     | 0 8 0 | 
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnz = 4;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#if 0</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* index starts at 0 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> h_cooRows[nnz] = {2, 1, 0, 0 };
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> h_cooCols[nnz] = {1, 1, 0, 1 }; 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#else</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* index starts at -2 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> h_cooRows[nnz] = {0, -1, -2, -2 };
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> h_cooCols[nnz] = {-1, -1, -2, -1 };
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#endif</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> h_cooVals[nnz] = {8.0, 5.0, 1.0, 2.0 };
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> h_P[nnz];

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_cooRows = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_cooCols = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_P       = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_cooVals = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_cooVals_sorted = NULL;
    size_t pBufferSizeInBytes = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *pBuffer = NULL;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"m = %d, n = %d, nnz=%d \n"</span>, m, n, nnz );

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusparse handle, bind a stream */</span>
    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusparseCreate(&amp;handle);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    status = cusparseSetStream(handle, stream);
    assert(CUSPARSE_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: allocate buffer */</span> 
    status = cusparseXcoosort_bufferSizeExt(
        handle,
        m,
        n,
        nnz,
        d_cooRows,
        d_cooCols,
        &amp;pBufferSizeInBytes
    );
    assert( CUSPARSE_STATUS_SUCCESS == status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"pBufferSizeInBytes = %lld bytes \n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span>)pBufferSizeInBytes);

    cudaStat1 = cudaMalloc( &amp;d_cooRows, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnz);
    cudaStat2 = cudaMalloc( &amp;d_cooCols, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnz);
    cudaStat3 = cudaMalloc( &amp;d_P      , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnz);
    cudaStat4 = cudaMalloc( &amp;d_cooVals, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*nnz);
    cudaStat5 = cudaMalloc( &amp;d_cooVals_sorted, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*nnz);
    cudaStat6 = cudaMalloc( &amp;pBuffer, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>)* pBufferSizeInBytes);

    assert( cudaSuccess == cudaStat1 );
    assert( cudaSuccess == cudaStat2 );
    assert( cudaSuccess == cudaStat3 );
    assert( cudaSuccess == cudaStat4 );
    assert( cudaSuccess == cudaStat5 );
    assert( cudaSuccess == cudaStat6 );

    cudaStat1 = cudaMemcpy(d_cooRows, h_cooRows, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnz   , cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(d_cooCols, h_cooCols, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnz   , cudaMemcpyHostToDevice);
    cudaStat3 = cudaMemcpy(d_cooVals, h_cooVals, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*nnz, cudaMemcpyHostToDevice);
    cudaStat4 = cudaDeviceSynchronize();
    assert( cudaSuccess == cudaStat1 );
    assert( cudaSuccess == cudaStat2 );
    assert( cudaSuccess == cudaStat3 );
    assert( cudaSuccess == cudaStat4 );

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: setup permutation vector P to identity */</span>
    status = cusparseCreateIdentityPermutation(
        handle,
        nnz,
        d_P);
    assert( CUSPARSE_STATUS_SUCCESS == status);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: sort COO format by Row */</span>
    status = cusparseXcoosortByRow(
        handle, 
        m, 
        n, 
        nnz, 
        d_cooRows, 
        d_cooCols, 
        d_P, 
        pBuffer
    ); 
    assert( CUSPARSE_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: gather sorted cooVals */</span>
    status = cusparseDgthr(
        handle, 
        nnz, 
        d_cooVals, 
        d_cooVals_sorted, 
        d_P, 
        CUSPARSE_INDEX_BASE_ZERO
    ); 
    assert( CUSPARSE_STATUS_SUCCESS == status);

    cudaStat1 = cudaDeviceSynchronize(); <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* wait until the computation is done */</span>
    cudaStat2 = cudaMemcpy(h_cooRows, d_cooRows, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnz   , cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(h_cooCols, d_cooCols, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnz   , cudaMemcpyDeviceToHost);
    cudaStat4 = cudaMemcpy(h_P,       d_P      , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnz   , cudaMemcpyDeviceToHost);
    cudaStat5 = cudaMemcpy(h_cooVals, d_cooVals_sorted, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*nnz, cudaMemcpyDeviceToHost);
    cudaStat6 = cudaDeviceSynchronize();
    assert( cudaSuccess == cudaStat1 );
    assert( cudaSuccess == cudaStat2 );
    assert( cudaSuccess == cudaStat3 );
    assert( cudaSuccess == cudaStat4 );
    assert( cudaSuccess == cudaStat5 );
    assert( cudaSuccess == cudaStat6 );

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"sorted coo: \n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; nnz; j++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"(%d, %d, %f) \n"</span>, h_cooRows[j], h_cooCols[j], h_cooVals[j] );
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; nnz; j++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"P[%d] = %d \n"</span>, j, h_P[j] );
    }

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_cooRows     ) cudaFree(d_cooRows);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_cooCols     ) cudaFree(d_cooCols);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_P           ) cudaFree(d_P);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_cooVals     ) cudaFree(d_cooVals);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_cooVals_sorted ) cudaFree(d_cooVals_sorted);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (pBuffer       ) cudaFree(pBuffer);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (handle        ) cusparseDestroy(handle);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream        ) cudaStreamDestroy(stream);
    cudaDeviceReset();
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}

</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="prune_examples"><a name="prune_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#prune_examples" name="prune_examples" shape="rect">18.&nbsp;Appendix E: Examples of prune</a></h2>
                  <div class="body conbody"></div>
                  <div class="topic concept nested1" id="prune-example1"><a name="prune-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#prune-example1" name="prune-example1" shape="rect">18.1.&nbsp;prune dense to sparse</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This section provides a simple example in the C programming language of 
                           pruning a dense matrix to a sparse matrix of CSR format.
                           
                        </p>
                        <p class="p">
                           A is a 4x4 dense matrix,
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>-3.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>6.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>7.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>8.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>9.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include prunedense_example.cpp 
 *   g++ -o prunedense_example.cpp prunedense_example.o -L/usr/local/cuda/lib64 -lcusparse -lcudart
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusparse.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printCsr(
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnz,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseMatDescr_t descrA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *csrValA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrRowPtrA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrColIndA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> base = (cusparseGetMatIndexBase(descrA) != CUSPARSE_INDEX_BASE_ONE)? 0:1 ;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"matrix %s is %d-by-%d, nnz=%d, base=%d\n"</span>, name, m, n, nnz, base);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> start = csrRowPtrA[row  ] - base;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> end   = csrRowPtrA[row+1] - base;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> colidx = start ; colidx &lt; end ; colidx++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = csrColIndA[colidx] - base;
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> Areg = csrValA[colidx];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusparseHandle_t handle = NULL;
    cudaStream_t stream = NULL;
    cusparseMatDescr_t descrC = NULL;


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    cusparseStatus_t status = CUSPARSE_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    cudaError_t cudaStat5 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 4;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 4;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* 
 *      |    1     0     2     -3  |
 *      |    0     4     0     0   |
 *  A = |    5     0     6     7   |
 *      |    0     8     0     9   |
 *
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> A[lda*n] = {1, 0, 5, 0, 0, 4, 0, 8, 2, 0, 6, 0, -3, 0, 7, 9};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>* csrRowPtrC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>* csrColIndC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>* csrValC  = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_A = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrRowPtrC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrColIndC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_csrValC = NULL;

    size_t lworkInBytes = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span> *d_work = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzC = 0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> threshold = 4.1; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* remove Aij &lt;= 4.1 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//    float threshold = 0; /* remove zeros */</span>

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of pruneDense2csr \n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"prune |A(i,j)| &lt;= threshold \n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"threshold = %E \n"</span>, threshold);

    printMatrix(m, n, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusparse handle, bind a stream */</span>
    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusparseCreate(&amp;handle);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    status = cusparseSetStream(handle, stream);
    assert(CUSPARSE_STATUS_SUCCESS == status);




</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: configuration of matrix C */</span>
    status = cusparseCreateMatDescr(&amp;descrC);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    cusparseSetMatIndexBase(descrC,CUSPARSE_INDEX_BASE_ZERO);
    cusparseSetMatType(descrC, CUSPARSE_MATRIX_TYPE_GENERAL );

    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A         , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*lda*n );
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1) );
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: query workspace */</span>
    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*lda*n, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);

    status = cusparseSpruneDense2csr_bufferSizeExt(
        handle,
        m,
        n,
        d_A,
        lda,
        &amp;threshold,
        descrC,
        d_csrValC,
        d_csrRowPtrC,
        d_csrColIndC,
        &amp;lworkInBytes);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"lworkInBytes (prune) = %lld \n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span>)lworkInBytes);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (NULL != d_work) { cudaFree(d_work); }
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, lworkInBytes);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: compute csrRowPtrC and nnzC */</span>
    status = cusparseSpruneDense2csrNnz(
        handle,
        m,
        n,
        d_A,
        lda,
        &amp;threshold,
        descrC,
        d_csrRowPtrC,
        &amp;nnzC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host */</span>
        d_work);
    assert(CUSPARSE_STATUS_SUCCESS == status);
    cudaStat1 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"nnzC = %d\n"</span>, nnzC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (0 == nnzC ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"C is empty \n"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
    }

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: compute csrColIndC and csrValC */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  ) * nnzC );
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrValC   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>) * nnzC );
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

    status = cusparseSpruneDense2csr(
        handle,
        m,
        n,
        d_A,
        lda,
        &amp;threshold,
        descrC,
        d_csrValC,
        d_csrRowPtrC,
        d_csrColIndC,
        d_work);
    assert(CUSPARSE_STATUS_SUCCESS == status);
    cudaStat1 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 6: output C */</span>
    csrRowPtrC = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>*  )malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*(m+1));
    csrColIndC = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>*  )malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*nnzC);
    csrValC    = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>*)malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzC);
    assert( NULL != csrRowPtrC);
    assert( NULL != csrColIndC);
    assert( NULL != csrValC);

    cudaStat1 = cudaMemcpy(csrRowPtrC, d_csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*(m+1), cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(csrColIndC, d_csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*nnzC , cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(csrValC   , d_csrValC   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzC , cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);

    printCsr(m, n, nnzC, descrC, csrValC, csrRowPtrC, csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"C"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A           ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrRowPtrC  ) cudaFree(d_csrRowPtrC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrColIndC  ) cudaFree(d_csrColIndC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrValC     ) cudaFree(d_csrValC);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (csrRowPtrC  ) free(csrRowPtrC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (csrColIndC  ) free(csrColIndC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (csrValC     ) free(csrValC);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (handle        ) cusparseDestroy(handle);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream        ) cudaStreamDestroy(stream);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (descrC        ) cusparseDestroyMatDescr(descrC);

    cudaDeviceReset();
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}

</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="prune-example2"><a name="prune-example2" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#prune-example2" name="prune-example2" shape="rect">18.2.&nbsp;prune sparse to sparse</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This section provides a simple example in the C programming language of 
                           pruning a sparse matrix to a sparse matrix of CSR format.
                           
                        </p>
                        <p class="p">
                           A is a 4x4 sparse matrix,
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>-3.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>6.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>7.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>8.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>9.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include prunecsr_example.cpp 
 *   g++ -o prunecsr_example.cpp prunecsr_example.o -L/usr/local/cuda/lib64 -lcusparse -lcudart
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusparse.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printCsr(
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnz,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseMatDescr_t descrA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *csrValA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrRowPtrA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrColIndA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> base = (cusparseGetMatIndexBase(descrA) != CUSPARSE_INDEX_BASE_ONE)? 0:1 ;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"matrix %s is %d-by-%d, nnz=%d, base=%d, output base-1\n"</span>, name, m, n, nnz, base);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> start = csrRowPtrA[row  ] - base;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> end   = csrRowPtrA[row+1] - base;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> colidx = start ; colidx &lt; end ; colidx++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = csrColIndA[colidx] - base;
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> Areg = csrValA[colidx];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusparseHandle_t handle = NULL;
    cudaStream_t stream = NULL;
    cusparseMatDescr_t descrA = NULL;
    cusparseMatDescr_t descrC = NULL;

    cusparseStatus_t status = CUSPARSE_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 4;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 4;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzA = 9;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* 
 *      |    1     0     2     -3  |
 *      |    0     4     0     0   |
 *  A = |    5     0     6     7   |
 *      |    0     8     0     9   |
 *
 */</span>

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> csrRowPtrA[m+1] = { 1, 4, 5, 8, 10};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> csrColIndA[nnzA] = { 1, 3, 4, 2, 1, 3, 4, 2, 4};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> csrValA[nnzA] = {1, 2, -3, 4, 5, 6, 7, 8, 9};

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>* csrRowPtrC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>* csrColIndC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>* csrValC  = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrRowPtrA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrColIndA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_csrValA = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrRowPtrC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrColIndC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_csrValC = NULL;

    size_t lworkInBytes = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span> *d_work = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzC = 0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> threshold = 4.1; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* remove Aij &lt;= 4.1 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//    float threshold = 0; /* remove zeros */</span>

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of pruneCsr2csr \n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"prune |A(i,j)| &lt;= threshold \n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"threshold = %E \n"</span>, threshold);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusparse handle, bind a stream */</span>
    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusparseCreate(&amp;handle);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    status = cusparseSetStream(handle, stream);
    assert(CUSPARSE_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: configuration of matrix A and C */</span>
    status = cusparseCreateMatDescr(&amp;descrA);
    assert(CUSPARSE_STATUS_SUCCESS == status);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* A is base-1*/</span>
    cusparseSetMatIndexBase(descrA,CUSPARSE_INDEX_BASE_ONE);
    cusparseSetMatType(descrA, CUSPARSE_MATRIX_TYPE_GENERAL );

    status = cusparseCreateMatDescr(&amp;descrC);
    assert(CUSPARSE_STATUS_SUCCESS == status);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* C is base-0 */</span>
    cusparseSetMatIndexBase(descrC,CUSPARSE_INDEX_BASE_ZERO);
    cusparseSetMatType(descrC, CUSPARSE_MATRIX_TYPE_GENERAL );

    printCsr(m, n, nnzA, descrA, csrValA, csrRowPtrA, csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);



</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrRowPtrA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1) );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzA );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrValA   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzA );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1) );
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(d_csrRowPtrA, csrRowPtrA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1), cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_csrColIndA, csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzA, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_csrValA   , csrValA   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzA, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: query workspace */</span>
    status = cusparseSpruneCsr2csr_bufferSizeExt(
        handle,
        m,
        n,
        nnzA,
        descrA,
        d_csrValA,
        d_csrRowPtrA,
        d_csrColIndA,
        &amp;threshold,
        descrC,
        d_csrValC,
        d_csrRowPtrC,
        d_csrColIndC,
        &amp;lworkInBytes);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"lworkInBytes (prune) = %lld \n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span>)lworkInBytes);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (NULL != d_work) { cudaFree(d_work); }
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, lworkInBytes);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: compute csrRowPtrC and nnzC */</span>
    status = cusparseSpruneCsr2csrNnz(
        handle,
        m,
        n,
        nnzA,
        descrA,
        d_csrValA,
        d_csrRowPtrA,
        d_csrColIndA,
        &amp;threshold,
        descrC,
        d_csrRowPtrC,
        &amp;nnzC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host */</span>
        d_work);
    assert(CUSPARSE_STATUS_SUCCESS == status);
    cudaStat1 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"nnzC = %d\n"</span>, nnzC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (0 == nnzC ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"C is empty \n"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
    }
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: compute csrColIndC and csrValC */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  ) * nnzC );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrValC   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>) * nnzC );
    assert(cudaSuccess == cudaStat1);

    status = cusparseSpruneCsr2csr(
        handle,
        m,
        n,
        nnzA,
        descrA,
        d_csrValA,
        d_csrRowPtrA,
        d_csrColIndA,
        &amp;threshold,
        descrC,
        d_csrValC,
        d_csrRowPtrC,
        d_csrColIndC,
        d_work);
    assert(CUSPARSE_STATUS_SUCCESS == status);
    cudaStat1 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 6: output C */</span>
    csrRowPtrC = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>*  )malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*(m+1));
    csrColIndC = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>*  )malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*nnzC);
    csrValC    = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>*)malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzC);
    assert( NULL != csrRowPtrC);
    assert( NULL != csrColIndC);
    assert( NULL != csrValC);
    cudaStat1 = cudaMemcpy(csrRowPtrC, d_csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*(m+1), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(csrColIndC, d_csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*nnzC , cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(csrValC   , d_csrValC   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzC , cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    printCsr(m, n, nnzC, descrC, csrValC, csrRowPtrC, csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"C"</span>);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrRowPtrA  ) cudaFree(d_csrRowPtrA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrColIndA  ) cudaFree(d_csrColIndA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrValA     ) cudaFree(d_csrValA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrRowPtrC  ) cudaFree(d_csrRowPtrC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrColIndC  ) cudaFree(d_csrColIndC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrValC     ) cudaFree(d_csrValC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (csrRowPtrC  ) free(csrRowPtrC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (csrColIndC  ) free(csrColIndC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (csrValC     ) free(csrValC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (handle        ) cusparseDestroy(handle);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream        ) cudaStreamDestroy(stream);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (descrA        ) cusparseDestroyMatDescr(descrA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (descrC        ) cusparseDestroyMatDescr(descrC);
    cudaDeviceReset();
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}

</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="prune-example3"><a name="prune-example3" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#prune-example3" name="prune-example3" shape="rect">18.3.&nbsp;prune dense to sparse by percentage</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This section provides a simple example in the C programming language of 
                           pruning a dense matrix to a sparse matrix by percentage.
                           
                        </p>
                        <p class="p">
                           A is a 4x4 dense matrix,
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>-3.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>6.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>7.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>8.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>9.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The percentage is 50, which means to prune 50 percent of the dense matrix. 
                           The matrix has 16 elements, so 8 out of 16 must be pruned out.
                           Therefore 7 zeros are pruned out, and value 1.0 is also out because it is 
                           the smallest among 9 nonzero elements.
                           
                        </p>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include prunedense2csrbyP.cpp
 *   g++ -o prunedense2csrbyP.cpp prunedense2csrbyP.o -L/usr/local/cuda/lib64 -lcusparse -lcudart
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusparse.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printCsr(
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnz,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseMatDescr_t descrA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *csrValA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrRowPtrA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrColIndA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> base = (cusparseGetMatIndexBase(descrA) != CUSPARSE_INDEX_BASE_ONE)? 0:1 ;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"matrix %s is %d-by-%d, nnz=%d, base=%d, output base-1\n"</span>, name, m, n, nnz, base);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> start = csrRowPtrA[row  ] - base;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> end   = csrRowPtrA[row+1] - base;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> colidx = start ; colidx &lt; end ; colidx++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = csrColIndA[colidx] - base;
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> Areg = csrValA[colidx];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusparseHandle_t handle = NULL;
    cudaStream_t stream = NULL;
    cusparseMatDescr_t descrC = NULL;
    pruneInfo_t info = NULL;

    cusparseStatus_t status = CUSPARSE_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    cudaError_t cudaStat5 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 4;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 4;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* 
 *      |    1     0     2     -3  |
 *      |    0     4     0     0   |
 *  A = |    5     0     6     7   |
 *      |    0     8     0     9   |
 *
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> A[lda*n] = {1, 0, 5, 0, 0, 4, 0, 8, 2, 0, 6, 0, -3, 0, 7, 9};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>* csrRowPtrC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>* csrColIndC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>* csrValC  = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_A = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrRowPtrC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrColIndC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_csrValC = NULL;

    size_t lworkInBytes = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span> *d_work = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzC = 0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> percentage = 50; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* 50% of nnz */</span>

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of pruneDense2csrByPercentage \n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"prune out %.1f percentage of A \n"</span>, percentage);

    printMatrix(m, n, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusparse handle, bind a stream */</span>
    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusparseCreate(&amp;handle);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    status = cusparseSetStream(handle, stream);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    status = cusparseCreatePruneInfo(&amp;info);
    assert(CUSPARSE_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: configuration of matrix C */</span>
    status = cusparseCreateMatDescr(&amp;descrC);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    cusparseSetMatIndexBase(descrC,CUSPARSE_INDEX_BASE_ZERO);
    cusparseSetMatType(descrC, CUSPARSE_MATRIX_TYPE_GENERAL );

    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A         , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*lda*n );
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1) );
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*lda*n, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: query workspace */</span>
    status = cusparseSpruneDense2csrByPercentage_bufferSizeExt(
        handle,
        m,
        n,
        d_A,
        lda,
        percentage,
        descrC,
        d_csrValC,
        d_csrRowPtrC,
        d_csrColIndC,
        info,
        &amp;lworkInBytes);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"lworkInBytes = %lld \n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span>)lworkInBytes);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (NULL != d_work) { cudaFree(d_work); }
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, lworkInBytes);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: compute csrRowPtrC and nnzC */</span>
    status = cusparseSpruneDense2csrNnzByPercentage(
        handle,
        m,
        n,
        d_A,
        lda,
        percentage,
        descrC,
        d_csrRowPtrC,
        &amp;nnzC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host */</span>
        info,
        d_work);
    assert(CUSPARSE_STATUS_SUCCESS == status);
    cudaStat1 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"nnzC = %d\n"</span>, nnzC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (0 == nnzC ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"C is empty \n"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
    }

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: compute csrColIndC and csrValC */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  ) * nnzC );
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrValC   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>) * nnzC );
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
    status = cusparseSpruneDense2csrByPercentage(
        handle,
        m,
        n,
        d_A,
        lda,
        percentage,
        descrC,
        d_csrValC,
        d_csrRowPtrC,
        d_csrColIndC,
        info,
        d_work);
    assert(CUSPARSE_STATUS_SUCCESS == status);
    cudaStat1 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 7: output C */</span>
    csrRowPtrC = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>*  )malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*(m+1));
    csrColIndC = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>*  )malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*nnzC);
    csrValC    = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>*)malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzC);
    assert( NULL != csrRowPtrC);
    assert( NULL != csrColIndC);
    assert( NULL != csrValC);

    cudaStat1 = cudaMemcpy(csrRowPtrC, d_csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*(m+1), cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(csrColIndC, d_csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*nnzC , cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(csrValC   , d_csrValC   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzC , cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);

    printCsr(m, n, nnzC, descrC, csrValC, csrRowPtrC, csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"C"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A         ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrRowPtrC) cudaFree(d_csrRowPtrC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrColIndC) cudaFree(d_csrColIndC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrValC   ) cudaFree(d_csrValC);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (csrRowPtrC  ) free(csrRowPtrC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (csrColIndC  ) free(csrColIndC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (csrValC     ) free(csrValC);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (handle      ) cusparseDestroy(handle);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream      ) cudaStreamDestroy(stream);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (descrC      ) cusparseDestroyMatDescr(descrC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (info        ) cusparseDestroyPruneInfo(info);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="prune-example4"><a name="prune-example4" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#prune-example4" name="prune-example4" shape="rect">18.4.&nbsp;prune sparse to sparse by percentage</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This section provides a simple example in the C programming language of 
                           pruning a sparse matrix to a sparse matrix by percentage.
                           
                        </p>
                        <p class="p">
                           A is a 4x4 sparse matrix,
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>-3.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>6.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>7.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>8.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>9.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The percentage is 20, which means to prune 20 percent of the nonzeros.
                           The sparse matrix has 9 nonzero elements, so 1.4 elements must be pruned out.
                           The function removes 1.0 and 2.0 which are first two smallest numbers of nonzeros.  
                           
                        </p>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include prunecsr2csrByP.cpp 
 *   g++ -o prunecsr2csrByP.cpp prunecsr2csrByP.o -L/usr/local/cuda/lib64 -lcusparse -lcudart
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusparse.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printCsr(
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnz,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseMatDescr_t descrA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *csrValA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrRowPtrA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrColIndA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> base = (cusparseGetMatIndexBase(descrA) != CUSPARSE_INDEX_BASE_ONE)? 0:1 ;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"matrix %s is %d-by-%d, nnz=%d, base=%d, output base-1\n"</span>, name, m, n, nnz, base);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> start = csrRowPtrA[row  ] - base;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> end   = csrRowPtrA[row+1] - base;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> colidx = start ; colidx &lt; end ; colidx++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = csrColIndA[colidx] - base;
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> Areg = csrValA[colidx];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusparseHandle_t handle = NULL;
    cudaStream_t stream = NULL;
    cusparseMatDescr_t descrA = NULL;
    cusparseMatDescr_t descrC = NULL;
    pruneInfo_t info = NULL;

    cusparseStatus_t status = CUSPARSE_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 4;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 4;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzA = 9;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* 
 *      |    1     0     2     -3  |
 *      |    0     4     0     0   |
 *  A = |    5     0     6     7   |
 *      |    0     8     0     9   |
 *
 */</span>


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> csrRowPtrA[m+1] = { 1, 4, 5, 8, 10};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> csrColIndA[nnzA] = { 1, 3, 4, 2, 1, 3, 4, 2, 4};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> csrValA[nnzA] = {1, 2, -3, 4, 5, 6, 7, 8, 9};

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>* csrRowPtrC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>* csrColIndC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>* csrValC  = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrRowPtrA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrColIndA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_csrValA = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrRowPtrC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrColIndC = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_csrValC = NULL;

    size_t lworkInBytes = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span> *d_work = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzC = 0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> percentage = 20; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* remove 20% of nonzeros */</span>

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of pruneCsr2csrByPercentage \n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"prune %.1f percent of nonzeros \n"</span>, percentage);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusparse handle, bind a stream */</span>
    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusparseCreate(&amp;handle);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    status = cusparseSetStream(handle, stream);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    status = cusparseCreatePruneInfo(&amp;info);
    assert(CUSPARSE_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: configuration of matrix C */</span>
    status = cusparseCreateMatDescr(&amp;descrA);
    assert(CUSPARSE_STATUS_SUCCESS == status);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* A is base-1*/</span>
    cusparseSetMatIndexBase(descrA,CUSPARSE_INDEX_BASE_ONE);
    cusparseSetMatType(descrA, CUSPARSE_MATRIX_TYPE_GENERAL );

    status = cusparseCreateMatDescr(&amp;descrC);
    assert(CUSPARSE_STATUS_SUCCESS == status);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* C is base-0 */</span>
    cusparseSetMatIndexBase(descrC,CUSPARSE_INDEX_BASE_ZERO);
    cusparseSetMatType(descrC, CUSPARSE_MATRIX_TYPE_GENERAL );

    printCsr(m, n, nnzA, descrA, csrValA, csrRowPtrA, csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrRowPtrA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1) );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzA );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrValA   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzA );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1) );
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(d_csrRowPtrA, csrRowPtrA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(m+1), cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_csrColIndA, csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzA, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_csrValA   , csrValA   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzA, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: query workspace */</span>
    status = cusparseSpruneCsr2csrByPercentage_bufferSizeExt(
        handle,
        m,
        n,
        nnzA,
        descrA,
        d_csrValA,
        d_csrRowPtrA,
        d_csrColIndA,
        percentage,
        descrC,
        d_csrValC,
        d_csrRowPtrC,
        d_csrColIndC,
        info,
        &amp;lworkInBytes);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"lworkInBytes = %lld \n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span>)lworkInBytes);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (NULL != d_work) { cudaFree(d_work); }
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, lworkInBytes);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: compute csrRowPtrC and nnzC */</span>
    status = cusparseSpruneCsr2csrNnzByPercentage(
        handle,
        m,
        n,
        nnzA,
        descrA,
        d_csrValA,
        d_csrRowPtrA,
        d_csrColIndA,
        percentage,
        descrC,
        d_csrRowPtrC,
        &amp;nnzC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host */</span>
        info,
        d_work);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
    assert(CUSPARSE_STATUS_SUCCESS == status);
    cudaStat1 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"nnzC = %d\n"</span>, nnzC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (0 == nnzC ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"C is empty \n"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
    }

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: compute csrColIndC and csrValC */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  ) * nnzC );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrValC   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>) * nnzC );
    assert(cudaSuccess == cudaStat1);

    status = cusparseSpruneCsr2csrByPercentage(
        handle,
        m,
        n,
        nnzA,
        descrA,
        d_csrValA,
        d_csrRowPtrA,
        d_csrColIndA,
        percentage,
        descrC,
        d_csrValC,
        d_csrRowPtrC,
        d_csrColIndC,
        info,
        d_work);
    assert(CUSPARSE_STATUS_SUCCESS == status);
    cudaStat1 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 6: output C */</span>
    csrRowPtrC = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>*  )malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*(m+1));
    csrColIndC = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>*  )malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*nnzC);
    csrValC    = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>*)malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzC);
    assert( NULL != csrRowPtrC);
    assert( NULL != csrColIndC);
    assert( NULL != csrValC);

    cudaStat1 = cudaMemcpy(csrRowPtrC, d_csrRowPtrC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*(m+1), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(csrColIndC, d_csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  )*nnzC , cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(csrValC   , d_csrValC   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzC , cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);

    printCsr(m, n, nnzC, descrC, csrValC, csrRowPtrC, csrColIndC, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"C"</span>);



</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrRowPtrA) cudaFree(d_csrRowPtrA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrColIndA) cudaFree(d_csrColIndA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrValA   ) cudaFree(d_csrValA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrRowPtrC) cudaFree(d_csrRowPtrC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrColIndC) cudaFree(d_csrColIndC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrValC   ) cudaFree(d_csrValC);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (csrRowPtrC  ) free(csrRowPtrC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (csrColIndC  ) free(csrColIndC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (csrValC     ) free(csrValC);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (handle      ) cusparseDestroy(handle);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream      ) cudaStreamDestroy(stream);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (descrA      ) cusparseDestroyMatDescr(descrA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (descrC      ) cusparseDestroyMatDescr(descrC);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (info        ) cusparseDestroyPruneInfo(info);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="gtsv_examples"><a name="gtsv_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#gtsv_examples" name="gtsv_examples" shape="rect">19.&nbsp;Appendix F: Examples of gtsv</a></h2>
                  <div class="body conbody"></div>
                  <div class="topic concept nested1" id="gtsv-example1"><a name="gtsv-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#gtsv-example1" name="gtsv-example1" shape="rect">19.1.&nbsp;batched tridiagonal solver</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This section provides a simple example in the C programming language of 
                           gtsvInterleavedBatch .
                           
                        </p>
                        <p class="p">
                           The example solves two linear systems and assumes data layout is NOT interleaved format.
                           Before calling gtsvInterleavedBatch, cublasXgeam is used to transform the data layout,
                           from aggregate format to interleaved format.
                           If the user can prepare interleaved format, no need to transpose the data. 
                           
                        </p>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include gtsv.cpp 
 *   g++ -o gtsv gtsv.o -L/usr/local/cuda/lib64 -lcusparse -lcublas -lcudart
 *
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusparse.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cublas_v2.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * compute | b - A*x|_inf
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> residaul_eval(
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *dl,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *du,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *b,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *x,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *r_nrminf_ptr)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> r_nrminf = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; n ; i++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> dot = 0;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (i &gt; 0 ){
            dot += dl[i]*x[i-1];
        }
        dot += d[i]*x[i];
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (i &lt; (n-1) ){
            dot += du[i]*x[i+1];
        }
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> ri = b[i] - dot;
        r_nrminf = (r_nrminf &gt; fabs(ri))? r_nrminf : fabs(ri);
    }

    *r_nrminf_ptr = r_nrminf;
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusparseHandle_t cusparseH = NULL;
    cublasHandle_t cublasH = NULL;
    cudaStream_t stream = NULL;


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    cusparseStatus_t status = CUSPARSE_STATUS_SUCCESS;
    cublasStatus_t cublasStat = CUBLAS_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchSize = 2;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* 
 *      |    1     6     0  |       | 1 |       | -0.603960 |
 *  A1 =|    4     2     7  |, b1 = | 2 |, x1 = |  0.267327 |
 *      |    0     5     3  |       | 3 |       |  0.554455 |
 *
 *      |    8    13     0  |       | 4 |       | -0.063291 |
 *  A2 =|   11     9    14  |, b2 = | 5 |, x2 = |  0.346641 |
 *      |    0    12    10  |       | 6 |       |  0.184031 |
 */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * A = (dl, d, du), B and X are in aggregate format
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> dl[n * batchSize] = {0, 4, 5,  0, 11, 12};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>  d[n * batchSize] = {1, 2, 3,  8,  9, 10};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> du[n * batchSize] = {6, 7, 0, 13, 14,  0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>  B[n * batchSize] = {1, 2, 3,  4,  5,  6};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> X[n * batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Xj = Aj \ Bj */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device memory 
 * (d_dl0, d_d0, d_du0) is aggregate format
 * (d_dl, d_d, d_du) is interleaved format
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_dl0 = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_d0  = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_du0 = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_dl  = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_d   = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_du  = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_B   = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_X   = NULL;

    size_t lworkInBytes = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span> *d_work = NULL;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * algo = 0: cuThomas (unstable)
 * algo = 1: LU with pivoting (stable)
 * algo = 2: QR (stable)
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> algo = 2;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> h_one = 1;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> h_zero = 0;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of gtsv (interleaved format) \n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"choose algo = 0,1,2 to select different algorithms \n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"n = %d, batchSize = %d, algo = %d \n"</span>, n, batchSize, algo);



</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusparse/cublas handle, bind a stream */</span>
    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);
    status = cusparseCreate(&amp;cusparseH);
    assert(CUSPARSE_STATUS_SUCCESS == status);
    status = cusparseSetStream(cusparseH, stream);
    assert(CUSPARSE_STATUS_SUCCESS == status);
    cublasStat = cublasCreate(&amp;cublasH);
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);
    cublasStat = cublasSetStream(cublasH, stream);
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: allocate device memory */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_dl0 , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_d0  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_du0 , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_dl  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_d   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_du  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_B   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_X   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: prepare data in device, interleaved format */</span>
    cudaStat1 = cudaMemcpy(d_dl0, dl, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_d0 , d , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_du0, du, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_B  ,  B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);

    cudaDeviceSynchronize();
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* convert dl to interleaved format 
     *  dl = transpose(dl0)
     */</span>
    cublasStat = cublasSgeam(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transa */</span>
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transb, don't care */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of rows of dl */</span>
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of dl */</span>
        &amp;h_one,
        d_dl0,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* dl0 is n-by-batchSize */</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of dl0 */</span>
        &amp;h_zero,
        NULL,
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't cae */</span>
        d_dl,      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* dl is batchSize-by-n */</span>
        batchSize  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of dl */</span>
    );
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* convert d to interleaved format
     *  d = transpose(d0)
     */</span>
    cublasStat = cublasSgeam(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transa */</span>
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transb, don't care */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of rows of d */</span>
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of d */</span>
        &amp;h_one,
        d_d0, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* d0 is n-by-batchSize */</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of d0 */</span>
        &amp;h_zero,
        NULL,
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't cae */</span>
        d_d,       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* d is batchSize-by-n */</span>
        batchSize  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of d */</span>
    );
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* convert du to interleaved format
     *  du = transpose(du0)
     */</span>
    cublasStat = cublasSgeam(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transa */</span>
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transb, don't care */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of rows of du */</span>
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of du */</span>
        &amp;h_one,
        d_du0, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* du0 is n-by-batchSize */</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of du0 */</span>
        &amp;h_zero,
        NULL,
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't cae */</span>
        d_du,      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* du is batchSize-by-n */</span>
        batchSize  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of du */</span>
    );
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* convert B to interleaved format
     *  X = transpose(B)
     */</span>
    cublasStat = cublasSgeam(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transa */</span>
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transb, don't care */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of rows of X */</span>
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of X */</span>
        &amp;h_one,
        d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* B is n-by-batchSize */</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of B */</span>
        &amp;h_zero,
        NULL,
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't cae */</span>
        d_X,       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* X is batchSize-by-n */</span>
        batchSize  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of X */</span>
    );
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: prepare workspace */</span>
    status = cusparseSgtsvInterleavedBatch_bufferSizeExt(
        cusparseH,
        algo,
        n,
        d_dl,
        d_d,
        d_du,
        d_X,
        batchSize,
        &amp;lworkInBytes);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"lworkInBytes = %lld \n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span>)lworkInBytes);

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, lworkInBytes);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: solve Aj*xj = bj */</span>
    status = cusparseSgtsvInterleavedBatch(
        cusparseH,
        algo,
        n,
        d_dl,
        d_d,
        d_du,
        d_X,
        batchSize,
        d_work);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSPARSE_STATUS_SUCCESS == status);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 6: convert X back to aggregate format  */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* B = transpose(X) */</span>
    cublasStat = cublasSgeam(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transa */</span>
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transb, don't care */</span>
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of rows of B */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of B */</span>
        &amp;h_one,
        d_X,       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* X is batchSize-by-n */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of X */</span>
        &amp;h_zero,
        NULL,
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't cae */</span>
        d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* B is n-by-batchSize */</span>
        n  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of B */</span>
    );
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);

    cudaDeviceSynchronize();

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 7: residual evaluation */</span>
    cudaStat1 = cudaMemcpy(X,  d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize, cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);

    cudaDeviceSynchronize();

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"==== x1 = inv(A1)*b1 \n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; n; j++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"x1[%d] = %f\n"</span>, j, X[j]);
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> r1_nrminf;
    residaul_eval(
        n,
        dl,
        d,
        du,
        B,
        X,
        &amp;r1_nrminf
    );
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|b1 - A1*x1| = %E\n"</span>, r1_nrminf);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"\n==== x2 = inv(A2)*b2 \n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; n; j++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"x2[%d] = %f\n"</span>, j, X[n+j]);
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> r2_nrminf;
    residaul_eval(
        n,
        dl + n,
        d + n,
        du + n,
        B + n,
        X + n,
        &amp;r2_nrminf
    );
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|b2 - A2*x2| = %E\n"</span>, r2_nrminf);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_dl0       ) cudaFree(d_dl0);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_d0        ) cudaFree(d_d0);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_du0       ) cudaFree(d_du0);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_dl        ) cudaFree(d_dl);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_d         ) cudaFree(d_d);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_du        ) cudaFree(d_du);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_B         ) cudaFree(d_B);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_X         ) cudaFree(d_X);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusparseH   ) cusparseDestroy(cusparseH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cublasH     ) cublasDestroy(cublasH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream      ) cudaStreamDestroy(stream);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="gpsv_examples"><a name="gpsv_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#gpsv_examples" name="gpsv_examples" shape="rect">20.&nbsp;Appendix G: Examples of gpsv</a></h2>
                  <div class="body conbody"></div>
                  <div class="topic concept nested1" id="gpsv-example1"><a name="gpsv-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#gpsv-example1" name="gpsv-example1" shape="rect">20.1.&nbsp;batched penta-diagonal solver</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This section provides a simple example in the C programming language of 
                           gpsvInterleavedBatch .
                           
                        </p>
                        <p class="p">
                           The example solves two penta-diagonal systems and assumes data layout is NOT interleaved format.
                           Before calling gpsvInterleavedBatch, cublasXgeam is used to transform the data layout,
                           from aggregate format to interleaved format.
                           If the user can prepare interleaved format, no need to transpose the data. 
                           
                        </p>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include gpsv.cpp 
 *   g++ -o gpsv gpsv.o -L/usr/local/cuda/lib64 -lcusparse -lcublas -lcudart
 *
 */
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusparse.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cublas_v2.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * compute | b - A*x|_inf
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> residaul_eval(
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *ds,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *dl,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *du,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *dw,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *b,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *x,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *r_nrminf_ptr)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> r_nrminf = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; n ; i++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> dot = 0;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (i &gt; 1 ){
            dot += ds[i]*x[i-2];
        }
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (i &gt; 0 ){
            dot += dl[i]*x[i-1];
        }
        dot += d[i]*x[i];
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (i &lt; (n-1) ){
            dot += du[i]*x[i+1];
        }
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (i &lt; (n-2) ){
            dot += dw[i]*x[i+2];
        }
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> ri = b[i] - dot;
        r_nrminf = (r_nrminf &gt; fabs(ri))? r_nrminf : fabs(ri);
    }

    *r_nrminf_ptr = r_nrminf;
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusparseHandle_t cusparseH = NULL;
    cublasHandle_t cublasH = NULL;
    cudaStream_t stream = NULL;


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    cusparseStatus_t status = CUSPARSE_STATUS_SUCCESS;
    cublasStatus_t cublasStat = CUBLAS_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 4;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchSize = 2;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* 
 *      |  1    8   13   0  |       | 1 |       | -0.0592 |
 *  A1 =|  5    2    9  14  |, b1 = | 2 |, x1 = |  0.3428 |
 *      | 11    6    3  10  |       | 3 |       | -0.1295 |
 *      |  0   12    7   4  |       | 4 |       |  0.1982 |
 *
 *      | 15   22   27   0  |       | 5 |       | -0.0012 |
 *  A2 =| 19   16   23  28  |, b2 = | 6 |, x2 = |  0.2792 |
 *      | 25   20   17  24  |       | 7 |       | -0.0416 |
 *      |  0   26   21  18  |       | 8 |       |  0.0898 |
 */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * A = (ds, dl, d, du, dw), B and X are in aggregate format
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> ds[n * batchSize] = { 0, 0, 11, 12,  0,  0, 25, 26};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> dl[n * batchSize] = { 0, 5,  6,  7,  0, 19, 20, 21};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>  d[n * batchSize] = { 1, 2,  3,  4, 15, 16, 17, 18};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> du[n * batchSize] = { 8, 9, 10,  0, 22, 23, 24,  0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> dw[n * batchSize] = {13,14,  0,  0, 27, 28,  0,  0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>  B[n * batchSize] = { 1, 2,  3,  4,  5,  6,  7,  8};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> X[n * batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Xj = Aj \ Bj */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device memory 
 * (d_ds0, d_dl0, d_d0, d_du0, d_dw0) is aggregate format
 * (d_ds, d_dl, d_d, d_du, d_dw) is interleaved format
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_ds0 = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_dl0 = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_d0  = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_du0 = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_dw0 = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_ds  = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_dl  = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_d   = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_du  = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_dw  = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_B   = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_X   = NULL;

    size_t lworkInBytes = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span> *d_work = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> h_one = 1;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> h_zero = 0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> algo = 0 ; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* QR factorization */</span>

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of gpsv (interleaved format) \n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"n = %d, batchSize = %d\n"</span>, n, batchSize);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusparse/cublas handle, bind a stream */</span>
    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusparseCreate(&amp;cusparseH);
    assert(CUSPARSE_STATUS_SUCCESS == status);

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    status = cusparseSetStream(cusparseH, stream);
    assert(CUSPARSE_STATUS_SUCCESS == status);
    cublasStat = cublasCreate(&amp;cublasH);
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);
    cublasStat = cublasSetStream(cublasH, stream);
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: allocate device memory */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_ds0 , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_dl0 , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_d0  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_du0 , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_dw0 , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_ds  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_dl  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_d   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_du  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_dw  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_B   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_X   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize );
    assert(cudaSuccess == cudaStat1);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: prepare data in device, interleaved format */</span>
    cudaStat1 = cudaMemcpy(d_ds0, ds, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_dl0, dl, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_d0 , d , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_du0, du, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_dw0, dw, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_B  ,  B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaDeviceSynchronize();
   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* convert ds to interleaved format
    *  ds = transpose(ds0) */</span>
    cublasStat = cublasSgeam(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transa */</span>
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transb, don't care */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of rows of ds */</span>
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of ds */</span>
        &amp;h_one,
        d_ds0,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ds0 is n-by-batchSize */</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of ds0 */</span>
        &amp;h_zero,
        NULL,
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't cae */</span>
        d_ds,      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ds is batchSize-by-n */</span>
        batchSize);  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of ds */</span>
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* convert dl to interleaved format 
    *  dl = transpose(dl0)
    */</span>
    cublasStat = cublasSgeam(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transa */</span>
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transb, don't care */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of rows of dl */</span>
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of dl */</span>
        &amp;h_one,
        d_dl0,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* dl0 is n-by-batchSize */</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of dl0 */</span>
        &amp;h_zero,
        NULL,
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't cae */</span>
        d_dl,      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* dl is batchSize-by-n */</span>
        batchSize  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of dl */</span>
    );
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* convert d to interleaved format
     *  d = transpose(d0)
     */</span>
    cublasStat = cublasSgeam(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transa */</span>
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transb, don't care */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of rows of d */</span>
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of d */</span>
        &amp;h_one,
        d_d0, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* d0 is n-by-batchSize */</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of d0 */</span>
        &amp;h_zero,
        NULL,
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't cae */</span>
        d_d,       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* d is batchSize-by-n */</span>
        batchSize  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of d */</span>
    );
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);

   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* convert du to interleaved format
     *  du = transpose(du0)
     */</span>
    cublasStat = cublasSgeam(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transa */</span>
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transb, don't care */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of rows of du */</span>
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of du */</span>
        &amp;h_one,
        d_du0, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* du0 is n-by-batchSize */</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of du0 */</span>
        &amp;h_zero,
        NULL,
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't cae */</span>
        d_du,      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* du is batchSize-by-n */</span>
        batchSize  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of du */</span>
    );
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* convert dw to interleaved format
     *  dw = transpose(dw0)
     */</span>
    cublasStat = cublasSgeam(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transa */</span>
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transb, don't care */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of rows of dw */</span>
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of dw */</span>
        &amp;h_one,
        d_dw0, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* dw0 is n-by-batchSize */</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of dw0 */</span>
        &amp;h_zero,
        NULL,
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't cae */</span>
        d_dw,      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* dw is batchSize-by-n */</span>
        batchSize  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of dw */</span>
    );
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* convert B to interleaved format
     *  X = transpose(B)
     */</span>
    cublasStat = cublasSgeam(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transa */</span>
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transb, don't care */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of rows of X */</span>
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of X */</span>
        &amp;h_one,
        d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* B is n-by-batchSize */</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of B */</span>
        &amp;h_zero,
        NULL,
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't cae */</span>
        d_X,       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* X is batchSize-by-n */</span>
        batchSize  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of X */</span>
    );
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: prepare workspace */</span>
    status = cusparseSgpsvInterleavedBatch_bufferSizeExt(
        cusparseH,
        algo,
        n,
        d_ds,
        d_dl,
        d_d,
        d_du,
        d_dw,
        d_X,
        batchSize,
        &amp;lworkInBytes);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"lworkInBytes = %lld \n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span>)lworkInBytes);

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, lworkInBytes);
    assert(cudaSuccess == cudaStat1);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: solve Aj*xj = bj */</span>
    status = cusparseSgpsvInterleavedBatch(
        cusparseH,
        algo,
        n,
        d_ds,
        d_dl,
        d_d,
        d_du,
        d_dw,
        d_X,
        batchSize,
        d_work);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSPARSE_STATUS_SUCCESS == status);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 6: convert X back to aggregate format  */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* B = transpose(X) */</span>
    cublasStat = cublasSgeam(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transa */</span>
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transb, don't care */</span>
        n,         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of rows of B */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of B */</span>
        &amp;h_one,
        d_X,       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* X is batchSize-by-n */</span>
        batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of X */</span>
        &amp;h_zero,
        NULL,
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't cae */</span>
        d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* B is n-by-batchSize */</span>
        n  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of B */</span>
    );
    assert(CUBLAS_STATUS_SUCCESS == cublasStat);
    cudaDeviceSynchronize();

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 7: residual evaluation */</span>
    cudaStat1 = cudaMemcpy(X,  d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*batchSize, cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    cudaDeviceSynchronize();

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"==== x1 = inv(A1)*b1 \n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; n; j++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"x1[%d] = %f\n"</span>, j, X[j]);
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> r1_nrminf;
    residaul_eval(
        n,
        ds,
        dl,
        d,
        du,
        dw,
        B,
        X,
        &amp;r1_nrminf
    );
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|b1 - A1*x1| = %E\n"</span>, r1_nrminf);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"\n==== x2 = inv(A2)*b2 \n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; n; j++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"x2[%d] = %f\n"</span>, j, X[n+j]);
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> r2_nrminf;
    residaul_eval(
        n,
        ds + n,
        dl + n,
        d + n,
        du + n,
        dw + n,
        B + n,
        X + n,
        &amp;r2_nrminf
    );
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|b2 - A2*x2| = %E\n"</span>, r2_nrminf);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_ds0       ) cudaFree(d_ds0);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_dl0       ) cudaFree(d_dl0);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_d0        ) cudaFree(d_d0);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_du0       ) cudaFree(d_du0);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_dw0       ) cudaFree(d_dw0);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_ds        ) cudaFree(d_ds);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_dl        ) cudaFree(d_dl);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_d         ) cudaFree(d_d);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_du        ) cudaFree(d_du);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_dw        ) cudaFree(d_dw);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_B         ) cudaFree(d_B);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_X         ) cudaFree(d_X);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusparseH   ) cusparseDestroy(cusparseH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cublasH     ) cublasDestroy(cublasH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream      ) cudaStreamDestroy(stream);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="csrsm2_examples"><a name="csrsm2_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#csrsm2_examples" name="csrsm2_examples" shape="rect">21.&nbsp;Appendix H: Examples of csrsm2</a></h2>
                  <div class="body conbody"></div>
                  <div class="topic concept nested1" id="csrsm2-example1"><a name="csrsm2-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#csrsm2-example1" name="csrsm2-example1" shape="rect">21.1.&nbsp;forward triangular solver</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This section provides a simple example in the C programming language of 
                           csrsm2.
                           
                        </p>
                        <p class="p">
                           The example solves a lower triangular system with 2 right hand side vectors.
                           
                        </p>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include csrms2.cpp 
 *   g++ -o csrm2 csrsm2.o -L/usr/local/cuda/lib64 -lcusparse -lcudart
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusparse.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* compute | b - A*x|_inf */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> residaul_eval(
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseMatDescr_t descrA,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *csrVal,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrRowPtr,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrColInd,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *b,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *x,
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *r_nrminf_ptr)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> base = (cusparseGetMatIndexBase(descrA) != CUSPARSE_INDEX_BASE_ONE)? 0:1 ;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lower = (CUSPARSE_FILL_MODE_LOWER == cusparseGetMatFillMode(descrA))? 1:0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> unit  = (CUSPARSE_DIAG_TYPE_UNIT == cusparseGetMatDiagType(descrA))? 1:0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> r_nrminf = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; n ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> start = csrRowPtr[row]   - base;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> end   = csrRowPtr[row+1] - base;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> dot = 0;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> colidx = start ; colidx &lt; end; colidx++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = csrColInd[colidx] - base;
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> Aij = csrVal[colidx];
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> xj  = x[col];
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( (row == col) &amp;&amp; unit ){
                Aij = 1.0;
            }
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> valid = (row &gt;= col) &amp;&amp; lower ||
                        (row &lt;= col) &amp;&amp; !lower ;
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( valid ){
                dot += Aij*xj;
            }
        }
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> ri = b[row] - dot;
        r_nrminf = (r_nrminf &gt; fabs(ri))? r_nrminf : fabs(ri);
    }
    *r_nrminf_ptr = r_nrminf;
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusparseHandle_t handle = NULL;
    cudaStream_t stream = NULL;
    cusparseMatDescr_t descrA = NULL;
    csrsm2Info_t info = NULL;


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    cusparseStatus_t status = CUSPARSE_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nrhs = 2;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 4;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzA = 9;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusparseSolvePolicy_t policy = CUSPARSE_SOLVE_POLICY_NO_LEVEL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> h_one = 1.0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* 
 *      |    1     0     2     -3  |
 *      |    0     4     0     0   |
 *  A = |    5     0     6     7   |
 *      |    0     8     0     9   |
 *
 *  Regard A as a lower triangle matrix L with non-unit diagonal.
 *             | 1  5 |              | 1          5      |
 *  Given  B = | 2  6 |, X = L \ B = | 0.5       1.5     |
 *             | 3  7 |              | -0.3333   -3      |
 *             | 4  8 |              |  0        -0.4444 |
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> csrRowPtrA[n+1] = { 1, 4, 5, 8, 10};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> csrColIndA[nnzA] = { 1, 3, 4, 2, 1, 3, 4, 2, 4};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> csrValA[nnzA] = {1, 2, -3, 4, 5, 6, 7, 8, 9};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> B[n*nrhs] = {1,2,3,4,5,6,7,8};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> X[n*nrhs];

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrRowPtrA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrColIndA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_csrValA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_B = NULL;

    size_t lworkInBytes = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span> *d_work = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> algo = 0; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* non-block version */</span>

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of csrsm2 \n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusparse handle, bind a stream */</span>
    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusparseCreate(&amp;handle);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    status = cusparseSetStream(handle, stream);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    status = cusparseCreateCsrsm2Info(&amp;info);
    assert(CUSPARSE_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: configuration of matrix A */</span>
    status = cusparseCreateMatDescr(&amp;descrA);
    assert(CUSPARSE_STATUS_SUCCESS == status);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* A is base-1*/</span>
    cusparseSetMatIndexBase(descrA,CUSPARSE_INDEX_BASE_ONE);

    cusparseSetMatType(descrA, CUSPARSE_MATRIX_TYPE_GENERAL);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* A is lower triangle */</span>
    cusparseSetMatFillMode(descrA, CUSPARSE_FILL_MODE_LOWER);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* A has non unit diagonal */</span>
    cusparseSetMatDiagType(descrA, CUSPARSE_DIAG_TYPE_NON_UNIT);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrRowPtrA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(n+1) );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzA );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrValA   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzA );
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_B         , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*nrhs );
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(d_csrRowPtrA, csrRowPtrA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*(n+1), cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_csrColIndA, csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*nnzA, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_csrValA   , csrValA   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*nnzA, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaStat1 = cudaMemcpy(d_B         , B         , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*nrhs, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: query workspace */</span>
    status = cusparseScsrsm2_bufferSizeExt(
        handle,
        algo,
        CUSPARSE_OPERATION_NON_TRANSPOSE, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transA */</span>
        CUSPARSE_OPERATION_NON_TRANSPOSE, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transB */</span>
        n,
        nrhs,
        nnzA,
        &amp;h_one,
        descrA,
        d_csrValA,
        d_csrRowPtrA,
        d_csrColIndA,
        d_B,
        n,   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ldb */</span>
        info,
        policy,
        &amp;lworkInBytes);
    assert(CUSPARSE_STATUS_SUCCESS == status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"lworkInBytes  = %lld \n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span>)lworkInBytes);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (NULL != d_work) { cudaFree(d_work); }
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, lworkInBytes);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: analysis */</span>
    status = cusparseScsrsm2_analysis(
        handle,
        algo,
        CUSPARSE_OPERATION_NON_TRANSPOSE, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transA */</span>
        CUSPARSE_OPERATION_NON_TRANSPOSE, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transB */</span>
        n,
        nrhs,
        nnzA,
        &amp;h_one,
        descrA,
        d_csrValA,
        d_csrRowPtrA,
        d_csrColIndA,
        d_B,
        n,   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ldb */</span>
        info,
        policy,
        d_work);
    assert(CUSPARSE_STATUS_SUCCESS == status);

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: solve L * X = B */</span>
    status = cusparseScsrsm2_solve(
        handle,
        algo,
        CUSPARSE_OPERATION_NON_TRANSPOSE, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transA */</span>
        CUSPARSE_OPERATION_NON_TRANSPOSE, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* transB */</span>
        n,
        nrhs,
        nnzA,
        &amp;h_one,
        descrA,
        d_csrValA,
        d_csrRowPtrA,
        d_csrColIndA,
        d_B,
        n,   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ldb */</span>
        info,
        policy,
        d_work);
    assert(CUSPARSE_STATUS_SUCCESS == status);
    cudaStat1 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 6:measure residual B - A*X */</span>
    cudaStat1 = cudaMemcpy(X, d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*n*nrhs, cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    cudaDeviceSynchronize();

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"==== x1 = inv(A)*b1 \n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; n; j++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"x1[%d] = %f\n"</span>, j, X[j]);
    }
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> r1_nrminf;
    residaul_eval(
        n,
        descrA,
        csrValA,
        csrRowPtrA,
        csrColIndA,
        B,
        X,
        &amp;r1_nrminf
    );
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|b1 - A*x1| = %E\n"</span>, r1_nrminf);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"==== x2 = inv(A)*b2 \n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; n; j++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"x2[%d] = %f\n"</span>, j, X[n+j]);
    }
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> r2_nrminf;
    residaul_eval(
        n,
        descrA,
        csrValA,
        csrRowPtrA,
        csrColIndA,
        B+n,
        X+n,
        &amp;r2_nrminf
    );
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|b2 - A*x2| = %E\n"</span>, r2_nrminf);

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrRowPtrA  ) cudaFree(d_csrRowPtrA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrColIndA  ) cudaFree(d_csrColIndA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_csrValA     ) cudaFree(d_csrValA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_B           ) cudaFree(d_B);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (handle        ) cusparseDestroy(handle);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream        ) cudaStreamDestroy(stream);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (descrA        ) cusparseDestroyMatDescr(descrA);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (info          ) cusparseDestroyCsrsm2Info(info);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="appendix-acknowledgements"><a name="appendix-acknowledgements" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#appendix-acknowledgements" name="appendix-acknowledgements" shape="rect">Appendix I: Acknowledgements</a></h2>
                  <div class="body conbody">
                     <p class="p">
                        NVIDIA would like to thank the following individuals and
                        institutions for their contributions:
                        
                     </p>
                     <ul class="ul">
                        <li class="li">
                           The cusparse&lt;t&gt;gtsv implementation is derived from a version developed by Li-Wen Chang from the University of Illinois.
                           
                        </li>
                        <li class="li">
                           the cusparse&lt;t&gt;gtsvInterleavedBatch adopts cuThomasBatch developed by Pedro Valero-Lara and Ivan Martínez-Pérez from Barcelona
                           Supercomputing Center and BSC/UPC NVIDIA GPU Center of Excellence.
                           
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="topic concept nested0" id="bibliography"><a name="bibliography" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#bibliography" name="bibliography" shape="rect">23.&nbsp;Bibliography</a></h2>
                  <div class="body conbody">
                     <p class="p">[1] N. Bell and M. Garland, <a class="xref" href="http://www.nvidia.com/object/nvidia_research_pub_013.html" target="_blank" shape="rect">“Implementing Sparse Matrix-Vector Multiplication on Throughput-Oriented Processors”</a>, Supercomputing, 2009.
                     </p>
                     <p class="p">[2] R. Grimes, D. Kincaid, and D. Young, “ITPACK 2.0 User’s Guide”, Technical Report CNA-150, Center for Numerical Analysis,
                        University of Texas, 1979.
                     </p>
                     <p class="p">[3] M. Naumov, <a class="xref" href="http://developer.nvidia.com/content/accelerated-solution-sparse-linear-systems" target="_blank" shape="rect">“Incomplete-LU and Cholesky Preconditioned Iterative Methods Using cuSPARSE and cuBLAS”</a>, Technical Report and White Paper, 2011.
                     </p>
                     <p class="p">
                        [4] Pedro Valero-Lara, Ivan Martínez-Pérez, Raül Sirvent, Xavier Martorell, and Antonio J. Peña. NVIDIA GPUs Scalability to
                        Solve Multiple (Batch) Tridiagonal Systems. Implementation of cuThomasBatch. In Parallel Processing and Applied Mathematics
                        - 12th International Conference (PPAM), 2017.
                        
                        
                     </p>
                  </div>
               </div>
               <div class="topic concept nested0" id="notices-header"><a name="notices-header" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#notices-header" name="notices-header" shape="rect">Notices</a></h2>
                  <div class="topic reference nested1" id="notice"><a name="notice" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#notice" name="notice" shape="rect"></a></h3>
                     <div class="body refbody">
                        <div class="section">
                           <h3 class="title sectiontitle">Notice</h3>
                           <p class="p">ALL NVIDIA DESIGN SPECIFICATIONS, REFERENCE BOARDS, FILES, DRAWINGS, DIAGNOSTICS, LISTS, AND OTHER DOCUMENTS (TOGETHER AND
                              SEPARATELY, "MATERIALS") ARE BEING PROVIDED "AS IS." NVIDIA MAKES NO WARRANTIES, EXPRESSED, IMPLIED, STATUTORY, OR OTHERWISE
                              WITH RESPECT TO THE MATERIALS, AND EXPRESSLY DISCLAIMS ALL IMPLIED WARRANTIES OF NONINFRINGEMENT, MERCHANTABILITY, AND FITNESS
                              FOR A PARTICULAR PURPOSE. 
                           </p>
                           <p class="p">Information furnished is believed to be accurate and reliable. However, NVIDIA Corporation assumes no responsibility for the
                              consequences of use of such information or for any infringement of patents or other rights of third parties that may result
                              from its use. No license is granted by implication of otherwise under any patent rights of NVIDIA Corporation. Specifications
                              mentioned in this publication are subject to change without notice. This publication supersedes and replaces all other information
                              previously supplied. NVIDIA Corporation products are not authorized as critical components in life support devices or systems
                              without express written approval of NVIDIA Corporation.
                           </p>
                        </div>
                     </div>
                  </div>
                  <div class="topic reference nested1" id="trademarks"><a name="trademarks" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#trademarks" name="trademarks" shape="rect"></a></h3>
                     <div class="body refbody">
                        <div class="section">
                           <h3 class="title sectiontitle">Trademarks</h3>
                           <p class="p">NVIDIA and the NVIDIA logo are trademarks or registered trademarks of NVIDIA Corporation
                              in the U.S. and other countries.  Other company and product names may be trademarks of
                              the respective companies with which they are associated.
                           </p>
                        </div>
                     </div>
                  </div>
                  <div class="topic reference nested1" id="copyright-past-to-present"><a name="copyright-past-to-present" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#copyright-past-to-present" name="copyright-past-to-present" shape="rect"></a></h3>
                     <div class="body refbody">
                        <div class="section">
                           <h3 class="title sectiontitle">Copyright</h3>
                           <p class="p">© <span class="ph">2007</span>-<span class="ph">2019</span> NVIDIA
                              Corporation. All rights reserved.
                           </p>
                           <p class="p">This product includes software developed by the Syncro Soft SRL (http://www.sync.ro/).</p>
                        </div>
                     </div>
                  </div>
               </div>
               
               <hr id="contents-end"></hr>
               
            </article>
         </div>
      </div>
      <script language="JavaScript" type="text/javascript" charset="utf-8" src="../common/formatting/common.min.js"></script>
      <script language="JavaScript" type="text/javascript" charset="utf-8" src="../common/scripts/google-analytics/google-analytics-write.js"></script>
      <script language="JavaScript" type="text/javascript" charset="utf-8" src="../common/scripts/google-analytics/google-analytics-tracker.js"></script>
      <script type="text/javascript">var switchTo5x=true;</script><script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script><script type="text/javascript">stLight.options({publisher: "998dc202-a267-4d8e-bce9-14debadb8d92", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script><script type="text/javascript">_satellite.pageBottom();</script></body>
</html>