<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
      <meta name="copyright" content="(C) Copyright 2005"></meta>
      <meta name="DC.rights.owner" content="(C) Copyright 2005"></meta>
      <meta name="DC.Type" content="concept"></meta>
      <meta name="DC.Title" content="cuSOLVER"></meta>
      <meta name="abstract" content="The API reference guide for cuSolver, the CUDA sparse matix library."></meta>
      <meta name="description" content="The API reference guide for cuSolver, the CUDA sparse matix library."></meta>
      <meta name="DC.Coverage" content="CUDA API References"></meta>
      <meta name="DC.subject" content="CUDA cuSOLVER, CUDA cuSolver asynchronous execution, CUDA cuSolver type, CUDA cuSolver helper function, CUDA cuSolver high level function"></meta>
      <meta name="keywords" content="CUDA cuSOLVER, CUDA cuSolver asynchronous execution, CUDA cuSolver type, CUDA cuSolver helper function, CUDA cuSolver high level function"></meta>
      <meta name="DC.Format" content="XHTML"></meta>
      <meta name="DC.Identifier" content="abstract"></meta>
      <link rel="stylesheet" type="text/css" href="../common/formatting/commonltr.css"></link>
      <link rel="stylesheet" type="text/css" href="../common/formatting/site.css"></link>
      <title>cuSOLVER :: CUDA Toolkit Documentation</title>
      <!--[if lt IE 9]>
      <script src="../common/formatting/html5shiv-printshiv.min.js"></script>
      <![endif]-->
      <script type="text/javascript" charset="utf-8" src="//assets.adobedtm.com/b92787824f2e0e9b68dc2e993f9bd995339fe417/satelliteLib-7ba51e58dc61bcb0e9311aadd02a0108ab24cc6c.js"></script>
      <script type="text/javascript" charset="utf-8" src="../common/formatting/jquery.min.js"></script>
      <script type="text/javascript" charset="utf-8" src="../common/formatting/jquery.ba-hashchange.min.js"></script>
      <script type="text/javascript" charset="utf-8" src="../common/formatting/jquery.scrollintoview.min.js"></script>
      <script type="text/javascript" src="../search/htmlFileList.js"></script>
      <script type="text/javascript" src="../search/htmlFileInfoList.js"></script>
      <script type="text/javascript" src="../search/nwSearchFnt.min.js"></script>
      <script type="text/javascript" src="../search/stemmers/en_stemmer.min.js"></script>
      <script type="text/javascript" src="../search/index-1.js"></script>
      <script type="text/javascript" src="../search/index-2.js"></script>
      <script type="text/javascript" src="../search/index-3.js"></script>
      <link rel="canonical" href="http://docs.nvidia.com/cuda/cusolver/index.html"></link>
      <link rel="stylesheet" type="text/css" href="../common/formatting/qwcode.highlight.css"></link>
   </head>
   <body>
      
      <header id="header"><span id="company">NVIDIA</span><span id="site-title">CUDA Toolkit Documentation</span><form id="search" method="get" action="search">
            <input type="text" name="search-text"></input><fieldset id="search-location">
               <legend>Search In:</legend>
               <label><input type="radio" name="search-type" value="site"></input>Entire Site</label>
               <label><input type="radio" name="search-type" value="document"></input>Just This Document</label></fieldset>
            <button type="reset">clear search</button>
            <button id="submit" type="submit">search</button></form>
      </header>
      <div id="site-content">
         <nav id="site-nav">
            <div class="category closed"><a href="../index.html" title="The root of the site.">CUDA Toolkit 
                  
                  
                  v10.1.168</a></div>
            <div class="category"><a href="index.html" title="cuSOLVER">cuSOLVER</a></div>
            <ul>
               <li>
                  <div class="section-link"><a href="#introduction">1.&nbsp;Introduction</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cuds-intro">1.1.&nbsp;cuSolverDN: Dense LAPACK</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusolver-intro">1.2.&nbsp;cuSolverSP: Sparse LAPACK</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-intro">1.3.&nbsp;cuSolverRF: Refactorization</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#naming-convention">1.4.&nbsp;Naming Conventions</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#asynchronous-execution">1.5.&nbsp;Asynchronous Execution</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#library-property">1.6.&nbsp;Library Property</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#link-qd">1.7.&nbsp;high precision package</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#api">2.&nbsp;Using the cuSolver API</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#thread-safety">2.1.&nbsp;Thread Safety</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#scalar-parameters2">2.2.&nbsp;Scalar Parameters</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#parallelism-with-streams">2.3.&nbsp;Parallelism with Streams</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#static-link-lapack">2.4.&nbsp;Link Third-party LAPACK Library</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#notion-info">2.5.&nbsp;convention of info</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusolver-types-reference">3.&nbsp;cuSolver Types Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cuSolverDN-types">3.1.&nbsp;cuSolverDN Types</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cuSolverDNhandle">3.1.1.&nbsp;cusolverDnHandle_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cublasFillMode">3.1.2.&nbsp;cublasFillMode_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cublasOperation">3.1.3.&nbsp;cublasOperation_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverEigType">3.1.4.&nbsp;cusolverEigType_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverEigMode">3.1.5.&nbsp;cusolverEigMode_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuSolverDNstatus">3.1.6.&nbsp;cusolverStatus_t</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cuSolverSP-types">3.2.&nbsp;cuSolverSP Types </a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cuSolverSPhandle">3.2.1.&nbsp;cusolverSpHandle_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparsematdescr">3.2.2.&nbsp;cusparseMatDescr_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuSolverSPstatus">3.2.3.&nbsp;cusolverStatus_t</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cuSolverRF-types">3.3.&nbsp;cuSolverRF Types </a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusolverRfHandle">3.3.1.&nbsp;cusolverRfHandle_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverRfMatrixFormat">3.3.2.&nbsp;cusolverRfMatrixFormat_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverRfNumericBoostReport">3.3.3.&nbsp;cusolverRfNumericBoostReport_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverRfResetValuesFastMode">3.3.4.&nbsp;cusolverRfResetValuesFastMode_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverRfFactorization">3.3.5.&nbsp;cusolverRfFactorization_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverRfTriangularSolve">3.3.6.&nbsp;cusolverRfTriangularSolve_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverRfUnitDiagonal">3.3.7.&nbsp;cusolverRfUnitDiagonal_t</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverRfStatus">3.3.8.&nbsp;cusolverStatus_t</a></div>
                           </li>
                        </ul>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#formats">4.&nbsp;cuSolver Formats Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#indexbase">4.1.&nbsp;Index Base Format</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#format-dense-vector">4.2.&nbsp;Vector (Dense) Format</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#format-dense-matrix">4.3.&nbsp;Matrix (Dense) Format</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#format-csr">4.4.&nbsp;Matrix (CSR) Format</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#format-csc">4.5.&nbsp;Matrix (CSC) Format</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cuds-function-reference">5.&nbsp;cuSolverDN: dense LAPACK Function Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cuds-helper-function-reference">5.1.&nbsp;cuSolverDN Helper Function Reference</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cuSolverDNcreate">5.1.1.&nbsp;cusolverDnCreate()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuSolverDNdestroy">5.1.2.&nbsp;cusolverDnDestroy()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cudssetstream">5.1.3.&nbsp;cusolverDnSetStream()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cudsgetstream">5.1.4.&nbsp;cusolverDnGetStream()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnCreateSyevjInfo">5.1.5.&nbsp;cusolverDnCreateSyevjInfo()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnDestroySyevjInfo">5.1.6.&nbsp;cusolverDnDestroySyevjInfo()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnXsyevjSetTolerance">5.1.7.&nbsp;cusolverDnXsyevjSetTolerance()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnXsyevjSetMaxSweeps">5.1.8.&nbsp;cusolverDnXsyevjSetMaxSweeps()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnXsyevjSetSortEig">5.1.9.&nbsp;cusolverDnXsyevjSetSortEig()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnXsyevjGetResidual">5.1.10.&nbsp;cusolverDnXsyevjGetResidual()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnXsyevjGetSweeps">5.1.11.&nbsp;cusolverDnXsyevjGetSweeps()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnCreateGesvdjInfo">5.1.12.&nbsp;cusolverDnCreateGesvdjInfo()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnDestroyGesvdjInfo">5.1.13.&nbsp;cusolverDnDestroyGesvdjInfo()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnXgesvdjSetTolerance">5.1.14.&nbsp;cusolverDnXgesvdjSetTolerance()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnXgesvdjSetMaxSweeps">5.1.15.&nbsp;cusolverDnXgesvdjSetMaxSweeps()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnXgesvdjSetSortEig">5.1.16.&nbsp;cusolverDnXgesvdjSetSortEig()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnXgesvdjGetResidual">5.1.17.&nbsp;cusolverDnXgesvdjGetResidual()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDnXgesvdjGetSweeps">5.1.18.&nbsp;cusolverDnXgesvdjGetSweeps()</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cuds-linearsolver-reference">5.2.&nbsp;Dense Linear Solver Reference</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-potrf">5.2.1.&nbsp;cusolverDn&lt;t&gt;potrf()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-potrs">5.2.2.&nbsp;cusolverDn&lt;t&gt;potrs()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-potri">5.2.3.&nbsp;cusolverDn&lt;t&gt;potri()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-getrf">5.2.4.&nbsp;cusolverDn&lt;t&gt;getrf()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-getrs">5.2.5.&nbsp;cusolverDn&lt;t&gt;getrs()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-geqrf">5.2.6.&nbsp;cusolverDn&lt;t&gt;geqrf()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-ormqr">5.2.7.&nbsp;cusolverDn&lt;t&gt;ormqr()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-orgqr">5.2.8.&nbsp;cusolverDn&lt;t&gt;orgqr()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-sytrf">5.2.9.&nbsp;cusolverDn&lt;t&gt;sytrf()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-potrfBatched">5.2.10.&nbsp;cusolverDn&lt;t&gt;potrfBatched()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-potrsBatched">5.2.11.&nbsp;cusolverDn&lt;t&gt;potrsBatched()</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cuds-eigensolver-reference">5.3.&nbsp;Dense Eigenvalue Solver Reference</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusolverDn-lt-t-gt-gebrd">5.3.1.&nbsp;cusolverDn&lt;t&gt;gebrd()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-orgbr">5.3.2.&nbsp;cusolverDn&lt;t&gt;orgbr()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolverDn-lt-t-gt-sytrd">5.3.3.&nbsp;cusolverDn&lt;t&gt;sytrd()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-ormtr">5.3.4.&nbsp;cusolverDn&lt;t&gt;ormtr()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-orgtr">5.3.5.&nbsp;cusolverDn&lt;t&gt;orgtr()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-gesvd">5.3.6.&nbsp;cusolverDn&lt;t&gt;gesvd()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-gesvdj">5.3.7.&nbsp;cusolverDn&lt;t&gt;gesvdj()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-gesvdjbatch">5.3.8.&nbsp;cusolverDn&lt;t&gt;gesvdjBatched()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-gesvda">5.3.9.&nbsp;cusolverDn&lt;t&gt;gesvdaStridedBatched()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-syevd">5.3.10.&nbsp;cusolverDn&lt;t&gt;syevd()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-syevdx">5.3.11.&nbsp;cusolverDn&lt;t&gt;syevdx()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-sygvd">5.3.12.&nbsp;cusolverDn&lt;t&gt;sygvd()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-sygvdx">5.3.13.&nbsp;cusolverDn&lt;t&gt;sygvdx()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-syevj">5.3.14.&nbsp;cusolverDn&lt;t&gt;syevj()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-sygvj">5.3.15.&nbsp;cusolverDn&lt;t&gt;sygvj()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cuds-lt-t-gt-syevjbatch">5.3.16.&nbsp;cusolverDn&lt;t&gt;syevjBatched()</a></div>
                           </li>
                        </ul>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cusolver-function-reference">6.&nbsp;cuSolverSP: sparse LAPACK Function Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cusolver-helper-function-reference">6.1.&nbsp;Helper Function Reference</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusolverecreate">6.1.1.&nbsp;cusolverSpCreate()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparsedestroy">6.1.2.&nbsp;cusolverSpDestroy()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusparsesetstream">6.1.3.&nbsp;cusolverSpSetStream()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csrissym">6.1.4.&nbsp;cusolverSpXcsrissym()</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusolver-high-level-function-reference">6.2.&nbsp;High Level Function Reference</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csrlsvlu">6.2.1.&nbsp;cusolverSp&lt;t&gt;csrlsvlu()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csrlsvqr">6.2.2.&nbsp;cusolverSp&lt;t&gt;csrlsvqr()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csrlsvchol">6.2.3.&nbsp;cusolverSp&lt;t&gt;csrlsvchol()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csrlsqvqr">6.2.4.&nbsp;cusolverSp&lt;t&gt;csrlsqvqr()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csreigsi">6.2.5.&nbsp;cusolverSp&lt;t&gt;csreigvsi()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csreigs">6.2.6.&nbsp;cusolverSp&lt;t&gt;csreigs()</a></div>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cusolver-low-level-function-reference">6.3.&nbsp;Low Level Function Reference</a></div>
                        <ul>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csrsymrcm">6.3.1.&nbsp;cusolverSpXcsrsymrcm()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csrsymmdq">6.3.2.&nbsp;cusolverSpXcsrsymmdq()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csrsymamd">6.3.3.&nbsp;cusolverSpXcsrsymamd()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csrmetis">6.3.4.&nbsp;cusolverSpXcsrmetisnd()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csrzfd">6.3.5.&nbsp;cusolverSpXcsrzfd()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csrperm">6.3.6.&nbsp;cusolverSpXcsrperm()</a></div>
                           </li>
                           <li>
                              <div class="section-link"><a href="#cusolver-lt-t-gt-csrqrbatched">6.3.7.&nbsp;cusolverSpXcsrqrBatched()</a></div>
                           </li>
                        </ul>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#glu-reference">7.&nbsp;cuSolverRF: Refactorization Reference</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-access-bundled-factors-device">7.1.&nbsp;cusolverRfAccessBundledFactors()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-analyze">7.2.&nbsp;cusolverRfAnalyze()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-assemble-device">7.3.&nbsp;cusolverRfSetupDevice()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-assemble-host">7.4.&nbsp;cusolverRfSetupHost()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-create">7.5.&nbsp;cusolverRfCreate()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-extract-bundled-factors-host">7.6.&nbsp;cusolverRfExtractBundledFactorsHost()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-extract-split-factors-host">7.7.&nbsp;cusolverRfExtractSplitFactorsHost()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-destroy">7.8.&nbsp;cusolverRfDestroy()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-get-matrix-format">7.9.&nbsp;cusolverRfGetMatrixFormat()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-get-numeric-properties">7.10.&nbsp;cusolverRfGetNumericProperties()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-get-numeric-boost-report">7.11.&nbsp;cusolverRfGetNumericBoostReport()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-get-reset-values-fast-mode">7.12.&nbsp;cusolverRfGetResetValuesFastMode()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-get-algs">7.13.&nbsp;cusolverRfGet_Algs()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-refactor">7.14.&nbsp;cusolverRfRefactor()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-reset-values">7.15.&nbsp;cusolverRfResetValues()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-set-matrix-format">7.16.&nbsp;cusolverRfSetMatrixFormat()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#unique_752983775">7.17.&nbsp;cusolverRfSetNumericProperties()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-set-reset-values-fast-mode">7.18.&nbsp;cusolverRfSetResetValuesFastMode()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-set-algs">7.19.&nbsp;cusolverRfSetAlgs()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glu-lt-t-gt-solve">7.20.&nbsp;cusolverRfSolve()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glubatch-lt-t-gt-assemble-host">7.21.&nbsp;cusolverRfBatchSetupHost()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glubatch-lt-t-gt-analyze">7.22.&nbsp;cusolverRfBatchAnalyze()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glubatch-lt-t-gt-reset-values">7.23.&nbsp;cusolverRfBatchResetValues()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glubatch-lt-t-gt-refactor">7.24.&nbsp;cusolverRfBatchRefactor()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glubatch-lt-t-gt-solve">7.25.&nbsp;cusolverRfBatchSolve()</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#glubatch-lt-t-gt-zero_pivot">7.26.&nbsp;cusolverRfBatchZeroPivot()</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#cuSolverRF_examples">A.&nbsp;cuSolverRF Examples</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#cuSolverRF-example1">A.1.&nbsp;cuSolverRF In-memory Example</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#cuSolverRFbatch-example1">A.2.&nbsp;cuSolverRF-batch Example</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#csrqr_batch_examples">B.&nbsp;CSR QR Batch Examples</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#csrqrbatch-example1">B.1.&nbsp;Batched Sparse QR example 1</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#csrqrbatch-example2">B.2.&nbsp;Batched Sparse QR example 2</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#qr_examples">C.&nbsp;QR Examples</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#ormqr-example1">C.1.&nbsp;QR Factorization Dense Linear Solver</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#orgqr-example1">C.2.&nbsp;orthogonalization</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#lu_examples">D.&nbsp;LU Examples</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#getrf-example1">D.1.&nbsp;LU Factorization</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#chol_examples">E.&nbsp;Cholesky Examples</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#batchol-example1">E.1.&nbsp;batched Cholesky Factorization</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#eig_examples">F.&nbsp;Examples of Dense Eigenvalue Solver</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#syevd-example1">F.1.&nbsp;Standard Symmetric Dense Eigenvalue Solver</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#unique_1002090728">F.2.&nbsp;Standard Symmetric Dense Eigenvalue Solver</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#sygvd-example1">F.3.&nbsp;Generalized Symmetric-Definite Dense Eigenvalue Solver</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#unique_505535727">F.4.&nbsp;Generalized Symmetric-Definite Dense Eigenvalue Solver</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#syevj-example1">F.5.&nbsp;Standard Symmetric Dense Eigenvalue Solver (via Jacobi method)</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#sygvj-example1">F.6.&nbsp;Generalized Symmetric-Definite Dense Eigenvalue Solver (via Jacobi method) </a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#batchsyevj-example1">F.7.&nbsp;batch eigenvalue solver for dense symmetric matrix</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#svd_examples">G.&nbsp;Examples of Singular Value Decomposition</a></div>
                  <ul>
                     <li>
                        <div class="section-link"><a href="#svd-example1">G.1.&nbsp;SVD with singular vectors</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#gesvdj-example1">G.2.&nbsp;SVD with singular vectors (via Jacobi method)</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#batchgesvdj-example1">G.3.&nbsp;batch dense SVD solver</a></div>
                     </li>
                     <li>
                        <div class="section-link"><a href="#gesvda-example1">G.4.&nbsp;SVD approximation</a></div>
                     </li>
                  </ul>
               </li>
               <li>
                  <div class="section-link"><a href="#appendix-acknowledgements">H.&nbsp;Acknowledgements</a></div>
               </li>
               <li>
                  <div class="section-link"><a href="#bibliography">I.&nbsp;Bibliography</a></div>
               </li>
            </ul>
         </nav>
         <div id="resize-nav"></div>
         <nav id="search-results">
            <h2>Search Results</h2>
            <ol></ol>
         </nav>
         
         <div id="contents-container">
            <div id="breadcrumbs-container">
               <div id="eqn-warning">This document includes math equations
                  (highlighted in red) which are best viewed with <a target="_blank" href="https://www.mozilla.org/firefox">Firefox</a> version 4.0
                  or higher, or another <a target="_blank" href="http://www.w3.org/Math/Software/mathml_software_cat_browsers.html">MathML-aware
                     browser</a>. There is also a <a href="../../pdf/CUSOLVER_Library.pdf">PDF version of this document</a>.
                  
               </div>
               <div id="release-info">cuSOLVER
                  (<a href="../../pdf/CUSOLVER_Library.pdf">PDF</a>)
                  -
                   
                  
                  
                  v10.1.168
                  (<a href="https://developer.nvidia.com/cuda-toolkit-archive">older</a>)
                  -
                  Last updated April 24, 2019
                  -
                  <a href="mailto:CUDAIssues@nvidia.com?subject=CUDA Toolkit Documentation Feedback: cuSOLVER">Send Feedback</a></div>
            </div>
            <article id="contents">
               <div class="topic nested0" id="abstract"><a name="abstract" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#abstract" name="abstract" shape="rect">cuSOLVER</a></h2>
                  <div class="body conbody">
                     <p class="shortdesc">The API reference guide for cuSolver, the CUDA sparse matix library.</p>
                  </div>
               </div>
               <div class="topic concept nested0" id="introduction"><a name="introduction" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#introduction" name="introduction" shape="rect">1.&nbsp;Introduction</a></h2>
                  <div class="body conbody">
                     <p class="p">
                        The cuSolver library is a high-level package based on the cuBLAS and cuSPARSE libraries. 
                        It combines three separate libraries under a single umbrella, each of which can be used
                        independently or in   concert with other toolkit libraries.
                        
                     </p>
                     <p class="p">
                        The intent of cuSolver is to provide useful LAPACK-like features, such as common matrix factorization 
                        and triangular solve routines for dense matrices, a sparse least-squares solver and an eigenvalue solver. 
                        In addition cuSolver provides a new refactorization library useful for solving sequences of matrices with
                        a shared sparsity pattern.
                        
                     </p>
                     <p class="p">
                        The first part of cuSolver is called cuSolverDN, and deals with dense matrix factorization and solve
                        routines such as LU, QR, SVD and LDLT, as well as useful utilities such as matrix and vector permutations.  
                        
                     </p>
                     <p class="p">
                        Next, cuSolverSP provides a new set of sparse routines based on a sparse QR factorization.
                        Not all matrices have a good sparsity pattern for parallelism in factorization, so
                        the cuSolverSP library also provides a CPU path to handle those sequential-like matrices. 
                        For those matrices with abundant parallelism, the GPU path will deliver higher performance.
                        The library is designed to be called from C and C++. 
                        
                     </p>
                     <p class="p">
                        The final part is cuSolverRF, a sparse re-factorization package that can provide very good
                        performance when solving a sequence of matrices where only the coefficients are changed but
                        the sparsity pattern remains the same.
                        
                     </p>
                     <p class="p">
                        The GPU path of the cuSolver library assumes data is already in the device memory. 
                        It is the responsibility of the developer to allocate memory and to copy data between GPU memory
                        and CPU memory using standard CUDA runtime API routines, such as <samp class="ph codeph">cudaMalloc()</samp>,
                        <samp class="ph codeph">cudaFree()</samp>, <samp class="ph codeph">cudaMemcpy()</samp>, and
                        <samp class="ph codeph">cudaMemcpyAsync()</samp>.
                        
                     </p>
                     <div class="p">
                        <div class="note note"><span class="notetitle">Note:</span> The cuSolver library requires hardware with a CUDA compute capability (CC) of at least 2.0 or higher.
                           Please see the <em class="ph i">NVIDIA CUDA C Programming Guide, Appendix A</em> for a list of the compute
                           capabilities corresponding to all NVIDIA GPUs.
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cuds-intro"><a name="cuds-intro" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cuds-intro" name="cuds-intro" shape="rect">cuSolverDN: Dense LAPACK</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The cuSolverDN library was designed to solve dense linear systems of the form
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>b</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where the coefficient matrix 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>A</mi>
                              <mi>∈</mi>
                              <msup>
                                 <mi>R</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>nxn</mi>
                                 </mrow>
                              </msup>
                           </math>
                           
                           , right-hand-side vector
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>b</mi>
                              <mi>∈</mi>
                              <msup>
                                 <mi>R</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                 </mrow>
                              </msup>
                           </math>
                           
                           and solution vector
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>x</mi>
                              <mi>∈</mi>
                              <msup>
                                 <mi>R</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                 </mrow>
                              </msup>
                           </math>
                        </p>
                        <p class="p">
                           The cuSolverDN library provides QR factorization and LU with partial pivoting
                           to handle a general matrix <samp class="ph codeph">A</samp>, which may be non-symmetric. 
                           Cholesky factorization is also provided for symmetric/Hermitian matrices. 
                           For symmetric indefinite matrices, we provide Bunch-Kaufman  (LDL) factorization.
                           
                        </p>
                        <p class="p">
                           The cuSolverDN library also provides a helpful bidiagonalization routine and 
                           singular value decomposition (SVD).
                           
                        </p>
                        <p class="p">
                           The cuSolverDN library targets computationally-intensive and popular routines in LAPACK,
                           and provides an API compatible with LAPACK.
                           The user can accelerate these time-consuming routines with cuSolverDN and keep others 
                           in LAPACK without a major change to existing code.
                           
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusolver-intro"><a name="cusolver-intro" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-intro" name="cusolver-intro" shape="rect">cuSolverSP: Sparse LAPACK</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The cuSolverSP library was mainly designed to a solve sparse linear system
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>b</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"> 
                           and the least-squares problem
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>argmin</mi>
                                          <mi>||</mi>
                                          <mi>A</mi>
                                          <mo>*</mo>
                                          <mi>z</mi>
                                          <mo>-</mo>
                                          <mi>b</mi>
                                          <mi>||</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where sparse matrix 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>A</mi>
                              <mi>∈</mi>
                              <msup>
                                 <mi>R</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>mxn</mi>
                                 </mrow>
                              </msup>
                           </math>
                           
                           , right-hand-side vector  
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>b</mi>
                              <mi>∈</mi>
                              <msup>
                                 <mi>R</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>m</mi>
                                 </mrow>
                              </msup>
                           </math>
                           
                           and solution vector
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>x</mi>
                              <mi>∈</mi>
                              <msup>
                                 <mi>R</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                 </mrow>
                              </msup>
                           </math>
                           
                           . For a linear system, we require <samp class="ph codeph">m=n</samp>.
                           
                        </p>
                        <p class="p">
                           The core algorithm is based on sparse QR factorization. 
                           The matrix <samp class="ph codeph">A</samp> is accepted in CSR format.
                           If matrix <samp class="ph codeph">A</samp> is symmetric/Hermitian, the user 
                           has to provide a full matrix, ie fill missing lower or upper part.
                           
                        </p>
                        <p class="p">
                           If matrix <samp class="ph codeph">A</samp> is symmetric positive definite and the user only 
                           needs to solve 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>A</mi>
                              <mi>x</mi>
                              <mo>=</mo>
                              <mi>b</mi>
                           </math>
                           
                           , Cholesky factorization can work and the user only needs to provide 
                           the lower triangular part of <samp class="ph codeph">A</samp>. 
                           
                        </p>
                        <p class="p">
                           On top of the linear and least-squares solvers, the <samp class="ph codeph">cuSolverSP</samp> library provides a simple
                           eigenvalue solver based on shift-inverse power method, and a function to count the 
                           number of eigenvalues contained in a box in the complex plane.
                           
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-intro"><a name="glu-intro" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-intro" name="glu-intro" shape="rect">cuSolverRF: Refactorization</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The cuSolverRF library was designed to accelerate solution of sets of linear systems by fast re-factorization when given new
                           coefficients in the same sparsity pattern
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where a sequence of coefficient matrices 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>i</mi>
                                 </mrow>
                              </msub>
                              <mi>∈</mi>
                              <msup>
                                 <mi>R</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>nxn</mi>
                                 </mrow>
                              </msup>
                           </math>
                           
                           , right-hand-sides  
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>f</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>i</mi>
                                 </mrow>
                              </msub>
                              <mi>∈</mi>
                              <msup>
                                 <mi>R</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                 </mrow>
                              </msup>
                           </math>
                           
                           and solutions  
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>x</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>i</mi>
                                 </mrow>
                              </msub>
                              <mi>∈</mi>
                              <msup>
                                 <mi>R</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                 </mrow>
                              </msup>
                           </math>
                           
                           are given for <samp class="ph codeph">i=1,...,k</samp>.
                           
                        </p>
                        <p class="p">
                           The cuSolverRF library is applicable when the sparsity pattern of the coefficient matrices 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>i</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           as well as the reordering to minimize fill-in and the pivoting used 
                           during the LU factorization remain the same across these linear systems. 
                           In that case, the first linear system (<samp class="ph codeph">i=1</samp>) requires 
                           a full LU factorization, while the subsequent linear systems 
                           (<samp class="ph codeph">i=2,...,k</samp>) require only the LU re-factorization. 
                           The later can be performed using the cuSolverRF library.
                           
                        </p>
                        <p class="p">
                           Notice that because the sparsity pattern of the coefficient matrices, 
                           the reordering and pivoting remain the same, the sparsity pattern of the
                           resulting triangular factors 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>L</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>i</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           and  
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>U</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>i</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           also remains the same. Therefore, the real difference between 
                           the full LU factorization and LU re-factorization is that 
                           the required memory is known ahead of time.
                           
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="naming-convention"><a name="naming-convention" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#naming-convention" name="naming-convention" shape="rect">1.4.&nbsp;Naming Conventions</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The cuSolverDN library functions are available for data types <samp class="ph codeph">float</samp>,
                           <samp class="ph codeph">double</samp>, <samp class="ph codeph">cuComplex</samp>, and <samp class="ph codeph">cuDoubleComplex</samp>.
                           The naming convention is as follows:
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1"><samp class="ph codeph">cusolverDn</samp>&lt;<samp class="ph codeph">t</samp>&gt;&lt;<samp class="ph codeph">operation</samp>&gt;
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where &lt;<samp class="ph codeph">t</samp>&gt; can be <samp class="ph codeph">S</samp>, <samp class="ph codeph">D</samp>,
                           <samp class="ph codeph">C</samp>, <samp class="ph codeph">Z</samp>, or <samp class="ph codeph">X</samp>, corresponding to the data
                           types <samp class="ph codeph">float</samp>, <samp class="ph codeph">double</samp>, <samp class="ph codeph">cuComplex</samp>,
                           <samp class="ph codeph">cuDoubleComplex</samp>, and the generic type, respectively.
                           &lt;<samp class="ph codeph">operation</samp>&gt; can be
                           Cholesky factorization (<samp class="ph codeph">potrf</samp>), 
                           LU with partial pivoting (<samp class="ph codeph">getrf</samp>),
                           QR factorization (<samp class="ph codeph">geqrf</samp>) and 
                           Bunch-Kaufman factorization (<samp class="ph codeph">sytrf</samp>).
                           
                        </p>
                        <p class="p">
                           The cuSolverSP library functions are available for data types <samp class="ph codeph">float</samp>,
                           <samp class="ph codeph">double</samp>, <samp class="ph codeph">cuComplex</samp>, and <samp class="ph codeph">cuDoubleComplex</samp>.
                           The naming convention is as follows:
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp[Host]</samp>&lt;<samp class="ph codeph">t</samp>&gt;[&lt;<samp class="ph codeph">matrix data
                                          format</samp>&gt;]&lt;<samp class="ph codeph">operation</samp>&gt;[&lt;<samp class="ph codeph">output matrix
                                          data format</samp>&gt;]&lt;<samp class="ph codeph">based on</samp>&gt;
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where <samp class="ph codeph">cuSolverSp</samp> is the GPU path and <samp class="ph codeph">cusolverSpHost</samp> is the corresponding CPU path.
                           &lt;<samp class="ph codeph">t</samp>&gt; can be <samp class="ph codeph">S</samp>, <samp class="ph codeph">D</samp>,
                           <samp class="ph codeph">C</samp>, <samp class="ph codeph">Z</samp>, or <samp class="ph codeph">X</samp>, corresponding to the data
                           types <samp class="ph codeph">float</samp>, <samp class="ph codeph">double</samp>, <samp class="ph codeph">cuComplex</samp>,
                           <samp class="ph codeph">cuDoubleComplex</samp>, and the generic type, respectively.
                           
                        </p>
                        <p class="p">
                           The &lt;<samp class="ph codeph">matrix data format</samp>&gt; is <samp class="ph codeph">csr</samp>, compressed sparse row format.
                           
                        </p>
                        <p class="p">
                           The &lt;<samp class="ph codeph">operation</samp>&gt; can be <samp class="ph codeph">ls</samp>,
                           <samp class="ph codeph">lsq</samp>, <samp class="ph codeph">eig</samp>, <samp class="ph codeph">eigs</samp>, corresponding to 
                           linear solver, least-square solver, eigenvalue solver and number of eigenvalues in a box, respectively.
                           
                        </p>
                        <p class="p">
                           The &lt;<samp class="ph codeph">output matrix data format</samp>&gt; can be <samp class="ph codeph">v</samp> or <samp class="ph codeph">m</samp>,
                           corresponding to a vector or a matrix.
                           
                        </p>
                        <p class="p">
                           &lt;<samp class="ph codeph">based on</samp>&gt; describes which algorithm is used.
                           For example, <samp class="ph codeph">qr</samp> (sparse QR factorization) is used in linear solver and least-square solver.
                           
                        </p>
                        <p class="p">
                           All of the functions have the return type <samp class="ph codeph">cusolverStatus_t</samp> and are explained in
                           more detail in the chapters that follow.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">cuSolverSP API</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="21.428571428571427%" rowspan="1" colspan="1"><samp class="ph codeph">routine</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">data format </samp></td>
                                    <td class="entry" valign="top" width="35.714285714285715%" rowspan="1" colspan="1"><samp class="ph codeph">operation  </samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">output format</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">based on</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="21.428571428571427%" rowspan="1" colspan="1"><samp class="ph codeph">csrlsvlu</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">csr </samp></td>
                                    <td class="entry" valign="top" width="35.714285714285715%" rowspan="1" colspan="1"><samp class="ph codeph">linear solver (ls)</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">vector (v)</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">LU (lu) with partial pivoting</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="21.428571428571427%" rowspan="1" colspan="1"><samp class="ph codeph">csrlsvqr</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">csr </samp></td>
                                    <td class="entry" valign="top" width="35.714285714285715%" rowspan="1" colspan="1"><samp class="ph codeph">linear solver (ls)</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">vector (v)</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">QR factorization (qr)</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="21.428571428571427%" rowspan="1" colspan="1"><samp class="ph codeph">csrlsvchol</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">csr </samp></td>
                                    <td class="entry" valign="top" width="35.714285714285715%" rowspan="1" colspan="1"><samp class="ph codeph">linear solver (ls)</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">vector (v)</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">Cholesky factorization (chol)</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="21.428571428571427%" rowspan="1" colspan="1"><samp class="ph codeph">csrlsqvqr</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">csr </samp></td>
                                    <td class="entry" valign="top" width="35.714285714285715%" rowspan="1" colspan="1"><samp class="ph codeph">least-square solver (lsq)</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">vector (v)</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">QR factorization (qr)</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="21.428571428571427%" rowspan="1" colspan="1"><samp class="ph codeph">csreigvsi</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">csr </samp></td>
                                    <td class="entry" valign="top" width="35.714285714285715%" rowspan="1" colspan="1"><samp class="ph codeph">eigenvalue solver (eig)</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">vector (v)</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">shift-inverse</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="21.428571428571427%" rowspan="1" colspan="1"><samp class="ph codeph">csreigs</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">csr </samp></td>
                                    <td class="entry" valign="top" width="35.714285714285715%" rowspan="1" colspan="1"><samp class="ph codeph">number of eigenvalues in a box (eigs)</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph"></samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph"></samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="21.428571428571427%" rowspan="1" colspan="1"><samp class="ph codeph">csrsymrcm</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph">csr </samp></td>
                                    <td class="entry" valign="top" width="35.714285714285715%" rowspan="1" colspan="1"><samp class="ph codeph">Symmetric Reverse Cuthill-McKee (symrcm)</samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph"></samp></td>
                                    <td class="entry" valign="top" width="14.285714285714285%" rowspan="1" colspan="1"><samp class="ph codeph"></samp></td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The cuSolverRF library routines are available for data type <samp class="ph codeph">double</samp>.
                           Most of the routines follow the naming convention:
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1"><samp class="ph codeph">cusolverRf</samp>_&lt;<samp class="ph codeph">operation</samp>&gt;_[<samp class="ph codeph">[Host]</samp>](...)
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where the trailing optional Host qualifier indicates the data is accessed on the host versus on the device, which is the default.
                           The &lt;<samp class="ph codeph">operation</samp>&gt; can be
                           <samp class="ph codeph">Setup</samp>, <samp class="ph codeph">Analyze</samp>,
                           <samp class="ph codeph">Refactor</samp>, <samp class="ph codeph">Solve</samp>,
                           <samp class="ph codeph">ResetValues</samp>, <samp class="ph codeph">AccessBundledFactors</samp> and
                           <samp class="ph codeph">ExtractSplitFactors</samp>.
                           
                        </p>
                        <p class="p">
                           Finally, the return type of the cuSolverRF library routines is <samp class="ph codeph">cusolverStatus_t</samp>.
                           
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="asynchronous-execution"><a name="asynchronous-execution" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#asynchronous-execution" name="asynchronous-execution" shape="rect">1.5.&nbsp;Asynchronous Execution</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The cuSolver library functions prefer to keep asynchronous execution as much as possible.
                           Developers can always use the <samp class="ph codeph">cudaDeviceSynchronize()</samp> function to ensure that the execution of a
                           particular cuSolver library routine has completed.
                           
                        </p>
                        <p class="p">
                           A developer can also use the <samp class="ph codeph">cudaMemcpy()</samp> routine to copy data from the device
                           to the host and vice versa, using the <samp class="ph codeph">cudaMemcpyDeviceToHost</samp> and
                           <samp class="ph codeph">cudaMemcpyHostToDevice</samp> parameters, respectively. In this case there is no
                           need to add a call to <samp class="ph codeph">cudaDeviceSynchronize()</samp> because the call to
                           <samp class="ph codeph">cudaMemcpy()</samp> with the above parameters is blocking and completes only when
                           the results are ready on the host.
                           
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="library-property"><a name="library-property" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#library-property" name="library-property" shape="rect">1.6.&nbsp;Library Property</a></h3>
                     <div class="body conbody">
                        <p class="p">The <samp class="ph codeph">libraryPropertyType</samp> data type is an enumeration
                           of library property types. (ie. CUDA version X.Y.Z would yield
                           <samp class="ph codeph">MAJOR_VERSION=X</samp>,
                           <samp class="ph codeph">MINOR_VERSION=Y</samp>,
                           <samp class="ph codeph">PATCH_LEVEL=Z</samp>)
                        </p><pre xml:space="preserve">
typedef enum libraryPropertyType_t
{
        MAJOR_VERSION,
        MINOR_VERSION,
        PATCH_LEVEL
} libraryPropertyType;
</pre><p class="p">
                           The following code can show the version of cusolver library.
                           
                        </p><pre xml:space="preserve">
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> major=-1,minor=-1,patch=-1;
    cusolverGetProperty(MAJOR_VERSION, &amp;major);
    cusolverGetProperty(MINOR_VERSION, &amp;minor);
    cusolverGetProperty(PATCH_LEVEL, &amp;patch);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"CUSOLVER Version (Major,Minor,PatchLevel): %d.%d.%d\n"</span>, major,minor,patch);
</pre></div>
                  </div>
                  <div class="topic concept nested1" id="link-qd"><a name="link-qd" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#link-qd" name="link-qd" shape="rect">1.7.&nbsp;high precision package</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The <samp class="ph codeph">cusolver</samp> library uses high precision for iterative refinement when necessary.
                           
                        </p>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" xml:lang="en-us" id="api"><a name="api" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#api" name="api" shape="rect">2.&nbsp;Using the cuSolver API</a></h2>
                  <div class="body conbody">
                     <p class="p"> This chapter describes how to use the cuSolver library API. It is not a reference
                        				for the cuSolver API data types and functions; that is provided in subsequent
                        				chapters. 
                     </p>
                  </div>
                  <div class="topic concept nested1" xml:lang="en-us" id="thread-safety"><a name="thread-safety" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#thread-safety" name="thread-safety" shape="rect">2.1.&nbsp;Thread Safety</a></h3>
                     <div class="body conbody">
                        <p class="p">The library is thread-safe, and its functions can be called from multiple host
                           				threads.
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" xml:lang="en-us" id="scalar-parameters2"><a name="scalar-parameters2" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#scalar-parameters2" name="scalar-parameters2" shape="rect">2.2.&nbsp;Scalar Parameters</a></h3>
                     <div class="body conbody">
                        <p class="p"> In the cuSolver API, the scalar parameters can be passed by reference on the host. </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" xml:lang="en-us" id="parallelism-with-streams"><a name="parallelism-with-streams" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#parallelism-with-streams" name="parallelism-with-streams" shape="rect">2.3.&nbsp;Parallelism with Streams</a></h3>
                     <div class="body conbody">
                        <p class="p"> If the application performs several small independent computations, or if it makes
                           				data transfers in parallel with the computation, then CUDA streams can be used to
                           				overlap these tasks. 
                        </p>
                        <div class="p"> The application can conceptually associate a stream with each task. To achieve the
                           				overlap of computation between the tasks, the developer should:
                           <ol class="ol">
                              <li class="li">Create CUDA streams using the function <samp class="ph codeph">cudaStreamCreate()</samp>,
                                 						and 
                              </li>
                              <li class="li">Set the stream to be used by each individual cuSolver library routine by
                                 						calling, for example, <samp class="ph codeph">cusolverDnSetStream()</samp>, just prior to
                                 						calling the actual cuSolverDN routine. 
                              </li>
                           </ol>
                        </div>
                        <p class="p">The computations performed in separate streams would then be overlapped automatically
                           				on the GPU, when possible. This approach is especially useful when the computation
                           				performed by a single task is relatively small, and is not enough to fill the GPU
                           				with work, or when there is a data transfer that can be performed in parallel with
                           				the computation. 
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" xml:lang="en-us" id="static-link-lapack"><a name="static-link-lapack" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#static-link-lapack" name="static-link-lapack" shape="rect">2.4.&nbsp;Link Third-party LAPACK Library</a></h3>
                     <div class="body conbody">
                        <div class="p">Starting with CUDA 10.0, you can link your application with
                           					<samp class="ph codeph">libcusolver_static.a</samp>, and choose to use a LAPACK library of
                           				your choice. You can use a third-party LAPACK library, for example, MKL, or you can
                           				use NVIDIA LAPACK library <samp class="ph codeph">liblapack_static.a</samp>. 
                           <div class="note note"><span class="notetitle">Note:</span> The<samp class="ph codeph">
                                 						liblapack_static.a</samp> library, which is the binary of CLAPACK-3.2.1,
                              					is a new feature of CUDA 10.0.
                           </div>
                        </div>
                        <div class="p"><a name="static-link-lapack__ul_fm4_cnr_t2b" shape="rect">
                              <!-- --></a><ul class="ul" id="static-link-lapack__ul_fm4_cnr_t2b">
                              <li class="li">If you use <samp class="ph codeph">libcusolver_static.a</samp>, then you must link with a
                                 					LAPACK library, otherwise the linker will report missing symbols. If you use
                                 					a third-party LAPACK library, you may take the advantage of the third-party
                                 					LAPACK library routines to accelerate symmetric eigenvalue solver and
                                 					singular value decomposition. 
                              </li>
                              <li class="li">The <samp class="ph codeph">liblapack_static.a</samp> is built inside
                                 					<samp class="ph codeph">libcusolver.so</samp>. Hence, if you use
                                 					<samp class="ph codeph">libcusolver.so</samp>, then you don't need to specify a LAPACK
                                 					library. The <samp class="ph codeph">libcusolver.so</samp> will not pick up any routines
                                 					from the third-party LAPACK library even you link the application with it.
                                 				
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" xml:lang="en-us" id="notion-info"><a name="notion-info" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#notion-info" name="notion-info" shape="rect">2.5.&nbsp;convention of info</a></h3>
                     <div class="body conbody">
                        <p class="p">Each LAPACK routine returns an <samp class="ph codeph">info</samp> which indicates the position of 
                           invalid parameter.
                           If <samp class="ph codeph">info = -i</samp>, then i-th parameter is invalid.
                           To be consistent with base-1 in LAPACK, <samp class="ph codeph">cusolver</samp> does not 
                           report invalid <samp class="ph codeph">handle</samp> into <samp class="ph codeph">info</samp>.
                           Instead, <samp class="ph codeph">cusolver</samp> returns <samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp>
                           for invalid <samp class="ph codeph">handle</samp>. 
                           
                        </p>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusolver-types-reference"><a name="cusolver-types-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusolver-types-reference" name="cusolver-types-reference" shape="rect">3.&nbsp;cuSolver Types Reference</a></h2>
                  <div class="topic concept nested1" xml:lang="en-us" id="cuSolverDN-types"><a name="cuSolverDN-types" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cuSolverDN-types" name="cuSolverDN-types" shape="rect">3.1.&nbsp;cuSolverDN Types</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The <samp class="ph codeph">float</samp>, <samp class="ph codeph">double</samp>, <samp class="ph codeph">cuComplex</samp>, and <samp class="ph codeph">cuDoubleComplex</samp> data types are supported. The first two are standard C data types, while the last two are exported from <samp class="ph codeph">cuComplex.h</samp>. In addition, cuSolverDN uses some familiar types from cuBlas.
                           
                        </p>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cuSolverDNhandle"><a name="cuSolverDNhandle" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuSolverDNhandle" name="cuSolverDNhandle" shape="rect">3.1.1.&nbsp;cusolverDnHandle_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              This is a pointer type to an opaque cuSolverDN context, which the user must initialize 
                              by calling <samp class="ph codeph">cusolverDnCreate()</samp> prior to calling  any other library function.
                              An un-initialized Handle object will lead to unexpected behavior, including crashes of cuSolverDN. 
                              The handle created and returned by <samp class="ph codeph">cusolverDnCreate()</samp> must be passed to 
                              every cuSolverDN function.
                              
                           </p>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cublasFillMode"><a name="cublasFillMode" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cublasFillMode" name="cublasFillMode" shape="rect">3.1.2.&nbsp;cublasFillMode_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              The type indicates which part (lower or upper) of the dense matrix was filled and 
                              consequently should be used by the function. Its values correspond to 
                              Fortran characters <samp class="ph codeph">‘L’</samp> or <samp class="ph codeph">‘l’</samp> (lower) and 
                              <samp class="ph codeph">‘U’</samp> or <samp class="ph codeph">‘u’</samp> (upper) that are often used as parameters 
                              to legacy BLAS implementations.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Value</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the lower part of the matrix is filled</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the upper part of the matrix is filled</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cublasOperation"><a name="cublasOperation" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cublasOperation" name="cublasOperation" shape="rect">3.1.3.&nbsp;cublasOperation_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              The <samp class="ph codeph">cublasOperation_t</samp> type indicates which operation needs to 
                              be performed with the dense matrix. Its values correspond to Fortran characters 
                              <samp class="ph codeph">‘N’</samp> or <samp class="ph codeph">‘n’</samp> (non-transpose), 
                              <samp class="ph codeph">‘T’</samp> or <samp class="ph codeph">‘t’</samp> (transpose) and 
                              <samp class="ph codeph">‘C’</samp> or <samp class="ph codeph">‘c’</samp> (conjugate transpose) that are often 
                              used as parameters to legacy BLAS implementations.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Value</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUBLAS_OP_N</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the non-transpose operation is selected</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUBLAS_OP_T</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the transpose operation is selected</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUBLAS_OP_C</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the conjugate transpose operation is selected</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cusolverEigType"><a name="cusolverEigType" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverEigType" name="cusolverEigType" shape="rect">3.1.4.&nbsp;cusolverEigType_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              The <samp class="ph codeph">cusolverEigType_t</samp> type indicates which type of eigenvalue solver is. 
                              Its values correspond to Fortran integer
                              <samp class="ph codeph">1</samp> (A*x = lambda*B*x),
                              <samp class="ph codeph">2</samp> (A*B*x = lambda*x),
                              <samp class="ph codeph">3</samp> (B*A*x = lambda*x),
                              used as parameters to legacy LAPACK implementations.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Value</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_EIG_TYPE_1</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">A*x = lambda*B*x</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_EIG_TYPE_2</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">A*B*x = lambda*x</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_EIG_TYPE_3</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">B*A*x = lambda*x</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cusolverEigMode"><a name="cusolverEigMode" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverEigMode" name="cusolverEigMode" shape="rect">3.1.5.&nbsp;cusolverEigMode_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              The <samp class="ph codeph">cusolverEigMode_t</samp> type indicates whether or not eigenvectors are computed.
                              Its values correspond to Fortran character
                              <samp class="ph codeph">'N'</samp> (only eigenvalues are computed),
                              <samp class="ph codeph">'V'</samp> (both eigenvalues and eigenvectors are computed)
                              used as parameters to legacy LAPACK implementations.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Value</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">only eigenvalues are computed</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">both eigenvalues and eigenvectors are computed</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cuSolverDNstatus"><a name="cuSolverDNstatus" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuSolverDNstatus" name="cuSolverDNstatus" shape="rect">3.1.6.&nbsp;cusolverStatus_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              This is the same as <samp class="ph codeph">cusolverStatus_t</samp> in the sparse LAPACK section.
                              
                           </p>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" xml:lang="en-us" id="cuSolverSP-types"><a name="cuSolverSP-types" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cuSolverSP-types" name="cuSolverSP-types" shape="rect">3.2.&nbsp;cuSolverSP Types </a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The <samp class="ph codeph">float</samp>, <samp class="ph codeph">double</samp>, <samp class="ph codeph">cuComplex</samp>, and <samp class="ph codeph">cuDoubleComplex</samp> data types are supported. The first two are standard C data types, while the last two are exported from <samp class="ph codeph">cuComplex.h</samp>.
                           
                        </p>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cuSolverSPhandle"><a name="cuSolverSPhandle" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuSolverSPhandle" name="cuSolverSPhandle" shape="rect">3.2.1.&nbsp;cusolverSpHandle_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              This is a pointer type to an opaque cuSolverSP context, which the user must initialize 
                              by calling <samp class="ph codeph">cusolverSpCreate()</samp> prior to calling any other library function.
                              An un-initialized Handle object will lead to unexpected behavior, including crashes of cuSolverSP.
                              The handle created and returned by <samp class="ph codeph">cusolverSpCreate()</samp> must be passed to 
                              every cuSolverSP function.
                              
                           </p>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cusparsematdescr"><a name="cusparsematdescr" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparsematdescr" name="cusparsematdescr" shape="rect">3.2.2.&nbsp;cusparseMatDescr_t</a></h3>
                        <div class="body conbody">
                           <p class="p">We have chosen to keep the same structure as exists in cuSparse to describe the shape and properties of a matrix. This enables
                              calls to either cuSparse or cuSolver using the same matrix description.
                           </p><pre xml:space="preserve">typedef struct {
    cusparseMatrixType_t MatrixType;
    cusparseFillMode_t FillMode;
    cusparseDiagType_t DiagType;
    cusparseIndexBase_t IndexBase;
} cusparseMatDescr_t;</pre><p class="p">
                              Please read documenation of CUSPARSE Library to understand each field of
                              <samp class="ph codeph">cusparseMatDescr_t</samp>.
                              
                           </p>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cuSolverSPstatus"><a name="cuSolverSPstatus" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuSolverSPstatus" name="cuSolverSPstatus" shape="rect">3.2.3.&nbsp;cusolverStatus_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              This is a status type returned by the library functions and 
                              it can have the following values.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                          <p class="p"></p>
                                          <p class="p"></p>
                                          <p class="p">The operation completed successfully.</p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                          <p class="p"></p>
                                          <p class="p"></p>
                                          <p class="p">The cuSolver library was not initialized. 
                                             This is usually caused by the lack of a prior call, an error 
                                             in the CUDA Runtime API called by the cuSolver routine, or 
                                             an error in the hardware setup.
                                          </p>
                                          <p class="p"><strong class="ph b">To correct:</strong> call <samp class="ph codeph">cusolverCreate()</samp> prior to the function
                                             call; and check that the hardware, an appropriate version of the driver, and 
                                             the cuSolver library are correctly installed.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                          <p class="p"></p>
                                          <p class="p"></p>
                                          <p class="p">Resource allocation failed inside the cuSolver library. 
                                             This is usually caused by a <samp class="ph codeph">cudaMalloc()</samp> failure.
                                          </p>
                                          <p class="p"><strong class="ph b">To correct:</strong> prior to the function call, deallocate previously 
                                             allocated memory as much as possible.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                          <p class="p"></p>
                                          <p class="p"></p>
                                          <p class="p">An unsupported value or parameter was passed to the function 
                                             (a negative vector size, for example).
                                          </p>
                                          <p class="p"><strong class="ph b">To correct:</strong> ensure that all the parameters being passed have valid values.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                          <p class="p"></p>
                                          <p class="p"></p>
                                          <p class="p">The function requires a feature absent from the device architecture; 
                                             usually caused by the lack of support for atomic operations or double precision.
                                          </p>
                                          <p class="p"><strong class="ph b">To correct:</strong> compile and run the application on a device with compute 
                                             capability 2.0 or above.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                          <p class="p"></p>
                                          <p class="p"></p>
                                          <p class="p">The GPU program failed to execute. This is often caused by 
                                             a launch failure of the kernel on the GPU, which can be caused by multiple reasons.
                                          </p>
                                          <p class="p"><strong class="ph b">To correct:</strong> check that the hardware, an appropriate version of the driver, 
                                             and the cuSolver library are correctly installed.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                          <p class="p"></p>
                                          <p class="p"></p>
                                          <p class="p">An internal cuSolver operation failed. 
                                             This error is usually caused by a <samp class="ph codeph">cudaMemcpyAsync()</samp> failure.
                                          </p>
                                          <p class="p"><strong class="ph b">To correct:</strong> check that the hardware, an appropriate version of the driver, 
                                             and the cuSolver library are correctly installed. Also, check that the memory 
                                             passed as a parameter to the routine is not being deallocated prior to the 
                                             routine’s completion.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="70%" rowspan="1" colspan="1">
                                          <p class="p"></p>
                                          <p class="p"></p>
                                          <p class="p">The matrix type is not supported by this function. 
                                             This is usually caused by passing an invalid matrix descriptor to the function.
                                          </p>
                                          <p class="p"><strong class="ph b">To correct:</strong> check that the fields in <samp class="ph codeph">descrA</samp> 
                                             were set correctly.
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" xml:lang="en-us" id="cuSolverRF-types"><a name="cuSolverRF-types" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cuSolverRF-types" name="cuSolverRF-types" shape="rect">3.3.&nbsp;cuSolverRF Types </a></h3>
                     <div class="body conbody">
                        <p class="p">
                           cuSolverRF only supports <samp class="ph codeph">double</samp>.
                           
                        </p>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cusolverRfHandle"><a name="cusolverRfHandle" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverRfHandle" name="cusolverRfHandle" shape="rect">cusolverRfHandle_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              The <samp class="ph codeph">cusolverRfHandle_t</samp> is a pointer to an opaque data structure that 
                              contains the cuSolverRF library handle. The user must initialize the handle by calling 
                              <samp class="ph codeph">cusolverRfCreate()</samp> prior to any other cuSolverRF library calls. 
                              The handle is passed to all other cuSolverRF library calls.
                              
                           </p>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cusolverRfMatrixFormat"><a name="cusolverRfMatrixFormat" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverRfMatrixFormat" name="cusolverRfMatrixFormat" shape="rect">cusolverRfMatrixFormat_t</a></h3>
                        <div class="body conbody">
                           <p class="p"> 
                              The <samp class="ph codeph">cusolverRfMatrixFormat_t</samp> is an enum that indicates the input/output 
                              matrix format assumed by the <samp class="ph codeph">cusolverRfSetupDevice()</samp>, 
                              <samp class="ph codeph">cusolverRfSetupHost()</samp>, <samp class="ph codeph">cusolverRfResetValues()</samp>, 
                              <samp class="ph codeph">cusolveRfExtractBundledFactorsHost()</samp> and 
                              <samp class="ph codeph">cusolverRfExtractSplitFactorsHost()</samp> routines.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Value</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_MATRIX_FORMAT_CSR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">matrix format CSR is assumed. (default)</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_MATRIX_FORMAT_CSC</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">matrix format CSC is assumed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cusolverRfNumericBoostReport"><a name="cusolverRfNumericBoostReport" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverRfNumericBoostReport" name="cusolverRfNumericBoostReport" shape="rect">cusolverRfNumericBoostReport_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              The <samp class="ph codeph">cusolverRfNumericBoostReport_t</samp> is an enum that indicates 
                              whether numeric boosting (of the pivot) was used during the 
                              <samp class="ph codeph">cusolverRfRefactor()</samp> and <samp class="ph codeph">cusolverRfSolve()</samp> routines. 
                              The numeric boosting is disabled by default.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Value</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_NUMERIC_BOOST_NOT_USED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">numeric boosting not used. (default)</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_NUMERIC_BOOST_USED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">numeric boosting used.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cusolverRfResetValuesFastMode"><a name="cusolverRfResetValuesFastMode" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverRfResetValuesFastMode" name="cusolverRfResetValuesFastMode" shape="rect">cusolverRfResetValuesFastMode_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              The <samp class="ph codeph">cusolverRfResetValuesFastMode_t</samp> is an enum that indicates 
                              the mode used for the <samp class="ph codeph">cusolverRfResetValues()</samp> routine. 
                              The fast mode requires extra memory and is recommended only 
                              if very fast calls to <samp class="ph codeph">cusolverRfResetValues()</samp> are needed.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Value</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_RESET_VALUES_FAST_MODE_OFF</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">fast mode disabled. (default)</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_RESET_VALUES_FAST_MODE_ON</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">fast mode enabled.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cusolverRfFactorization"><a name="cusolverRfFactorization" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverRfFactorization" name="cusolverRfFactorization" shape="rect">cusolverRfFactorization_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              The <samp class="ph codeph">cusolverRfFactorization_t</samp> is an enum that indicates which (internal) algorithm 
                              is used for refactorization in the <samp class="ph codeph">cusolverRfRefactor()</samp> routine.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Value</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_FACTORIZATION_ALG0</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algorithm 0. (default)</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_FACTORIZATION_ALG1</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algorithm 1.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_FACTORIZATION_ALG2</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algorithm 2. Domino-based scheme.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cusolverRfTriangularSolve"><a name="cusolverRfTriangularSolve" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverRfTriangularSolve" name="cusolverRfTriangularSolve" shape="rect">cusolverRfTriangularSolve_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              The <samp class="ph codeph">cusolverRfTriangularSolve_t</samp> is an enum that indicates which (internal) algorithm 
                              is used for triangular solve in the <samp class="ph codeph">cusolverRfSolve()</samp> routine.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Value</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_TRIANGULAR_SOLVE_ALG0</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algorithm 0.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_TRIANGULAR_SOLVE_ALG1</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algorithm 1. (default)</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_TRIANGULAR_SOLVE_ALG2</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algorithm 2. Domino-based scheme.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_TRIANGULAR_SOLVE_ALG3</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">algorithm 3. Domino-based scheme.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cusolverRfUnitDiagonal"><a name="cusolverRfUnitDiagonal" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverRfUnitDiagonal" name="cusolverRfUnitDiagonal" shape="rect">cusolverRfUnitDiagonal_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              The <samp class="ph codeph">cusolverRfUnitDiagonal_t</samp> is an enum that indicates whether and where the 
                              unit diagonal is stored in the input/output triangular factors in the 
                              <samp class="ph codeph">cusolverRfSetupDevice()</samp>, <samp class="ph codeph">cusolverRfSetupHost()</samp> and 
                              <samp class="ph codeph">cusolverRfExtractSplitFactorsHost()</samp> routines.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Value</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_UNIT_DIAGONAL_STORED_L</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">unit diagonal is stored in lower triangular factor. (default)</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_UNIT_DIAGONAL_STORED_U</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">unit diagonal is stored in upper triangular factor.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_UNIT_DIAGONAL_ASSUMED_L</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">unit diagonal is assumed in lower triangular factor.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_UNIT_DIAGONAL_ASSUMED_U</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">unit diagonal is assumed in upper triangular factor.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" xml:lang="en-us" id="cusolverRfStatus"><a name="cusolverRfStatus" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverRfStatus" name="cusolverRfStatus" shape="rect">cusolverStatus_t</a></h3>
                        <div class="body conbody">
                           <p class="p">
                              The <samp class="ph codeph">cusolverStatus_t</samp> is an enum that indicates 
                              success or failure of the cuSolverRF library call. It is returned by all the cuSolver library routines, and it uses the same
                              enumerated values as the sparse and dense Lapack routines.
                              
                           </p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" xml:lang="en-us" id="formats"><a name="formats" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#formats" name="formats" shape="rect">4.&nbsp;cuSolver Formats Reference</a></h2>
                  <div class="body conbody">
                     <p class="p"></p>
                  </div>
                  <div class="topic concept nested1" xml:lang="en-us" id="indexbase"><a name="indexbase" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#indexbase" name="indexbase" shape="rect">4.1.&nbsp;Index Base Format</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           The CSR or CSC format requires either zero-based or one-based index for a sparse matrix 
                           <samp class="ph codeph">A</samp>.
                           The GLU library supports only zero-based indexing.
                           Otherwise, both one-based and zero-based indexing are supported in cuSolver.  
                           
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="format-dense-vector"><a name="format-dense-vector" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#format-dense-vector" name="format-dense-vector" shape="rect">4.2.&nbsp;Vector (Dense) Format</a></h3>
                     <div class="body conbody">
                        <p class="p"> 
                           The vectors are assumed to be stored linearly in memory. For example, the vector
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>x</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>x</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>x</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>2</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>⋮</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>x</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>n</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"> 
                           is represented as
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>x</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>x</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>2</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>x</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>n</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="format-dense-matrix"><a name="format-dense-matrix" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#format-dense-matrix" name="format-dense-matrix" shape="rect">4.3.&nbsp;Matrix (Dense) Format</a></h3>
                     <div class="body conbody">
                        <p class="p"> 
                           The dense matrices are assumed to be stored in column-major order in memory. 
                           The sub-matrix can be accessed using the leading dimension of the original matrix. 
                           For examle, the <samp class="ph codeph">m*n</samp> (sub-)matrix
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>1</mn>
                                                               <mi>,</mi>
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>1</mn>
                                                               <mi>,</mi>
                                                               <mi>n</mi>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>2</mn>
                                                               <mi>,</mi>
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>2</mn>
                                                               <mi>,</mi>
                                                               <mi>n</mi>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>⋮</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mi>m</mi>
                                                               <mi>,</mi>
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mi>m</mi>
                                                               <mi>,</mi>
                                                               <mi>n</mi>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"> 
                           is represented as
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>1</mn>
                                                               <mi>,</mi>
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>1</mn>
                                                               <mi>,</mi>
                                                               <mi>n</mi>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>2</mn>
                                                               <mi>,</mi>
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>2</mn>
                                                               <mi>,</mi>
                                                               <mi>n</mi>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>⋮</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>⋱</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>⋮</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mi>m</mi>
                                                               <mi>,</mi>
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mi>m</mi>
                                                               <mi>,</mi>
                                                               <mi>n</mi>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>⋮</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>⋱</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>⋮</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mi>lda</mi>
                                                               <mi>,</mi>
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mi>lda</mi>
                                                               <mi>,</mi>
                                                               <mi>n</mi>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"> 
                           with its elements arranged linearly in memory as
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>1</mn>
                                                               <mi>,</mi>
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>2</mn>
                                                               <mi>,</mi>
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mi>m</mi>
                                                               <mi>,</mi>
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mi>lda</mi>
                                                               <mi>,</mi>
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>1</mn>
                                                               <mi>,</mi>
                                                               <mi>n</mi>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>2</mn>
                                                               <mi>,</mi>
                                                               <mi>n</mi>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mi>m</mi>
                                                               <mi>,</mi>
                                                               <mi>n</mi>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>…</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <msub>
                                                            <mi>a</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mi>lda</mi>
                                                               <mi>,</mi>
                                                               <mi>n</mi>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where <samp class="ph codeph">lda</samp> ≥ <samp class="ph codeph">m</samp> is the leading dimension of <samp class="ph codeph">A</samp>.
                           
                        </p>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="format-csr"><a name="format-csr" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#format-csr" name="format-csr" shape="rect">4.4.&nbsp;Matrix (CSR) Format</a></h3>
                     <div class="body conbody">
                        <p class="p"> 
                           In CSR format the matrix is represented by the following parameters
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">type </samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">size </samp></td>
                                    <td class="entry" valign="top" width="45.45454545454545%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">(int)  </samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph"></samp></td>
                                    <td class="entry" valign="top" width="45.45454545454545%" rowspan="1" colspan="1">the number of rows (and columns) in the matrix.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">(int)  </samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph"></samp></td>
                                    <td class="entry" valign="top" width="45.45454545454545%" rowspan="1" colspan="1">the number of non-zero elements in the matrix.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtr</samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">(int *)  </samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">n+1  </samp></td>
                                    <td class="entry" valign="top" width="45.45454545454545%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays 
                                       <samp class="ph codeph">csrColInd</samp> and <samp class="ph codeph">csrVal</samp>. 
                                       This array has also an extra entry at the end that stores the number of 
                                       non-zero elements in the matrix.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">csrColInd</samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">(int *)  </samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">nnz  </samp></td>
                                    <td class="entry" valign="top" width="45.45454545454545%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements in the matrix. 
                                       <strong class="ph b">  It is assumed that this array is sorted by row and by column within each row. </strong></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">csrVal</samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">(S|D|C|Z)*  </samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">nnz </samp></td>
                                    <td class="entry" valign="top" width="45.45454545454545%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements in the matrix. 
                                       <strong class="ph b"> It is assumed that this array is sorted by row and by column within each row. </strong></td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           Note that in our CSR format sparse matrices are assumed to be stored in row-major order, 
                           in other words, the index arrays are first sorted by row indices and then within each 
                           row by column indices. Also it is assumed that each pair of row and column indices appears only once.
                           
                        </p>
                        <p class="p">
                           For example, the <samp class="ph codeph">4x4</samp> matrix
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>6.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>7.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>8.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>9.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"> 
                           is represented as
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>csrRowPtr</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>2</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>4</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>8</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>9</mn>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>csrColInd</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>1</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>1</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>2</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>1</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>2</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>3</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>3</mn>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>csrVal</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mn>1.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>3.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>4.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>6.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>2.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>5.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>7.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>8.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>9.0</mn>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="format-csc"><a name="format-csc" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#format-csc" name="format-csc" shape="rect">4.5.&nbsp;Matrix (CSC) Format</a></h3>
                     <div class="body conbody">
                        <p class="p"> 
                           In CSC format the matrix is represented by the following parameters
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">type </samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">size </samp></td>
                                    <td class="entry" valign="top" width="45.45454545454545%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">(int)  </samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph"></samp></td>
                                    <td class="entry" valign="top" width="45.45454545454545%" rowspan="1" colspan="1">the number of rows (and columns) in the matrix.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">(int)  </samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph"></samp></td>
                                    <td class="entry" valign="top" width="45.45454545454545%" rowspan="1" colspan="1">the number of non-zero elements in the matrix.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">cscColPtr</samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">(int *)  </samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">n+1  </samp></td>
                                    <td class="entry" valign="top" width="45.45454545454545%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each column in the arrays 
                                       <samp class="ph codeph">cscRowInd</samp> and <samp class="ph codeph">cscVal</samp>. 
                                       This array has also an extra entry at the end that stores the number of 
                                       non-zero elements in the matrix.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">cscRowInd</samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">(int *)  </samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">nnz  </samp></td>
                                    <td class="entry" valign="top" width="45.45454545454545%" rowspan="1" colspan="1">the array of row indices corresponding to the non-zero elements in the matrix. 
                                       <strong class="ph b"> It is assumed that this array is sorted by column and by row within each column. </strong></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">cscVal</samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">(S|D|C|Z)*  </samp></td>
                                    <td class="entry" valign="top" width="18.181818181818183%" rowspan="1" colspan="1"><samp class="ph codeph">nnz </samp></td>
                                    <td class="entry" valign="top" width="45.45454545454545%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements in the matrix. 
                                       <strong class="ph b"> It is assumed that this array is sorted by column and by row within each column. </strong></td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           Note that in our CSC format sparse matrices are assumed to be stored in column-major order, 
                           in other words, the index arrays are first sorted by column indices and then within 
                           each column by row indices. Also it is assumed that each pair of row and column indices 
                           appears only once.
                           
                        </p>
                        <p class="p">
                           For example, the <samp class="ph codeph">4x4</samp> matrix
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>6.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>7.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>8.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>9.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p"> 
                           is represented as
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>cscColPtr</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>2</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>5</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>7</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>9</mn>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>cscRowInd</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>2</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>1</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>2</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>1</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>2</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>2</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>3</mn>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>cscVal</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mn>1.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>2.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>3.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>4.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>5.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>6.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>7.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>8.0</mn>
                                                      </mtd>
                                                      <mtd>
                                                         <mn>9.0</mn>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cuds-function-reference"><a name="cuds-function-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cuds-function-reference" name="cuds-function-reference" shape="rect">cuSolverDN: dense LAPACK Function Reference</a></h2>
                  <div class="body conbody">
                     <p class="p">
                        This chapter describes the API of cuSolverDN, which provides a subset of dense LAPACK functions.
                        
                     </p>
                  </div>
                  <div class="topic concept nested1" id="cuds-helper-function-reference"><a name="cuds-helper-function-reference" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cuds-helper-function-reference" name="cuds-helper-function-reference" shape="rect">cuSolverDN Helper Function Reference</a></h3>
                     <div class="body conbody">
                        <p class="p">The cuSolverDN helper functions are described in this section.</p>
                     </div>
                     <div class="topic concept nested2" id="cuSolverDNcreate"><a name="cuSolverDNcreate" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuSolverDNcreate" name="cuSolverDNcreate" shape="rect">5.1.1.&nbsp;cusolverDnCreate()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCreate(cusolverDnHandle_t *handle);
</pre><p class="p">
                              This function initializes the cuSolverDN library and creates a handle on the cuSolverDN context. 
                              It must be called before any other cuSolverDN API function is invoked. 
                              It allocates hardware resources necessary for accessing the GPU.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the handle to the cuSolverDN context.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the initialization succeeded.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the CUDA Runtime initialization failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuSolverDNdestroy"><a name="cuSolverDNdestroy" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuSolverDNdestroy" name="cuSolverDNdestroy" shape="rect">5.1.2.&nbsp;cusolverDnDestroy()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnDestroy(cusolverDnHandle_t handle);
</pre><p class="p">
                              This function releases CPU-side resources used by the cuSolverDN library. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the shutdown succeeded.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cudssetstream"><a name="cudssetstream" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cudssetstream" name="cudssetstream" shape="rect">cusolverDnSetStream()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSetStream(cusolverDnHandle_t handle, cudaStream_t streamId)
</pre><p class="p">This function sets the stream to be used by the cuSolverDN library to execute its routines.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">streamId</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the stream to be used by the library.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the stream was set successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cudsgetstream"><a name="cudsgetstream" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cudsgetstream" name="cudsgetstream" shape="rect">cusolverDnGetStream()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnGetStream(cusolverDnHandle_t handle, cudaStream_t *streamId)
</pre><p class="p">This function sets the stream to be used by the cuSolverDN library to execute its routines.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">streamId</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host   </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the stream to be used by the library.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the stream was set successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnCreateSyevjInfo"><a name="cusolverDnCreateSyevjInfo" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnCreateSyevjInfo" name="cusolverDnCreateSyevjInfo" shape="rect">5.1.5.&nbsp;cusolverDnCreateSyevjInfo()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCreateSyevjInfo(
    syevjInfo_t *info);
</pre><p class="p">
                              This function creates and initializes the structure of <samp class="ph codeph">syevj</samp>, 
                              <samp class="ph codeph">syevjBatched</samp> and <samp class="ph codeph">sygvj</samp> to default values.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the structure of syevj.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnDestroySyevjInfo"><a name="cusolverDnDestroySyevjInfo" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnDestroySyevjInfo" name="cusolverDnDestroySyevjInfo" shape="rect">5.1.6.&nbsp;cusolverDnDestroySyevjInfo()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnDestroySyevjInfo(
    syevjInfo_t info);
</pre><p class="p">
                              This function destroys and releases any memory required by the structure.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the structure of syevj.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources are released successfully.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnXsyevjSetTolerance"><a name="cusolverDnXsyevjSetTolerance" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnXsyevjSetTolerance" name="cusolverDnXsyevjSetTolerance" shape="rect">5.1.7.&nbsp;cusolverDnXsyevjSetTolerance()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnXsyevjSetTolerance(
    syevjInfo_t info,
    double tolerance)
</pre><p class="p">
                              This function configures tolerance of <samp class="ph codeph">syevj</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the structure of syevj.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tolerance</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">accuracy of numerical eigenvalues.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnXsyevjSetMaxSweeps"><a name="cusolverDnXsyevjSetMaxSweeps" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnXsyevjSetMaxSweeps" name="cusolverDnXsyevjSetMaxSweeps" shape="rect">5.1.8.&nbsp;cusolverDnXsyevjSetMaxSweeps()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnXsyevjSetMaxSweeps(
    syevjInfo_t info,
    int max_sweeps)
</pre><p class="p">
                              This function configures maximum number of sweeps in <samp class="ph codeph">syevj</samp>.
                              The default value is 100.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the structure of syevj.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">max_sweeps</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">maximum number of sweeps.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnXsyevjSetSortEig"><a name="cusolverDnXsyevjSetSortEig" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnXsyevjSetSortEig" name="cusolverDnXsyevjSetSortEig" shape="rect">5.1.9.&nbsp;cusolverDnXsyevjSetSortEig()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnXsyevjSetSortEig(
    syevjInfo_t info,
    int sort_eig)
</pre><p class="p">
                              if <samp class="ph codeph">sort_eig</samp> is zero, the eigenvalues are not sorted.
                              This function only works for <samp class="ph codeph">syevjBatched</samp>.
                              <samp class="ph codeph">syevj</samp> and <samp class="ph codeph">sygvj</samp> always sort eigenvalues in ascending order.
                              By default, eigenvalues are always sorted in ascending order.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the structure of syevj.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">sort_eig</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">sort_eig</samp> is zero, the eigenvalues are not sorted.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnXsyevjGetResidual"><a name="cusolverDnXsyevjGetResidual" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnXsyevjGetResidual" name="cusolverDnXsyevjGetResidual" shape="rect">5.1.10.&nbsp;cusolverDnXsyevjGetResidual()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnXsyevjGetResidual(
    cusolverDnHandle_t handle,
    syevjInfo_t info,
    double *residual)
</pre><p class="p">
                              This function reports residual of <samp class="ph codeph">syevj</samp> or <samp class="ph codeph">sygvj</samp>.
                              It does not support <samp class="ph codeph">syevjBatched</samp>.
                              If the user calls this function after <samp class="ph codeph">syevjBatched</samp>, 
                              the error <samp class="ph codeph">CUSOLVER_STATUS_NOT_SUPPORTED</samp> is returned.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the structure of syevj.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">residual</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">residual of syevj.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">does not support batched version</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnXsyevjGetSweeps"><a name="cusolverDnXsyevjGetSweeps" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnXsyevjGetSweeps" name="cusolverDnXsyevjGetSweeps" shape="rect">5.1.11.&nbsp;cusolverDnXsyevjGetSweeps()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnXsyevjGetSweeps(
    cusolverDnHandle_t handle,
    syevjInfo_t info,
    int *executed_sweeps)
</pre><p class="p">
                              This function reports number of executed sweeps of <samp class="ph codeph">syevj</samp> or <samp class="ph codeph">sygvj</samp>.
                              It does not support <samp class="ph codeph">syevjBatched</samp>.
                              If the user calls this function after <samp class="ph codeph">syevjBatched</samp>, 
                              the error <samp class="ph codeph">CUSOLVER_STATUS_NOT_SUPPORTED</samp> is returned.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the structure of syevj.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">executed_sweeps</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of executed sweeps.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">does not support batched version</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnCreateGesvdjInfo"><a name="cusolverDnCreateGesvdjInfo" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnCreateGesvdjInfo" name="cusolverDnCreateGesvdjInfo" shape="rect">5.1.12.&nbsp;cusolverDnCreateGesvdjInfo()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCreateGesvdjInfo(
    gesvdjInfo_t *info);
</pre><p class="p">
                              This function creates and initializes the structure of <samp class="ph codeph">gesvdj</samp> and
                              <samp class="ph codeph">gesvdjBatched</samp> to default values.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the structure of gesvdj.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the structure was initialized successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnDestroyGesvdjInfo"><a name="cusolverDnDestroyGesvdjInfo" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnDestroyGesvdjInfo" name="cusolverDnDestroyGesvdjInfo" shape="rect">5.1.13.&nbsp;cusolverDnDestroyGesvdjInfo()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnDestroyGesvdjInfo(
    gesvdjInfo_t info);
</pre><p class="p">
                              This function destroys and releases any memory required by the structure.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the structure of gesvdj.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources are released successfully.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnXgesvdjSetTolerance"><a name="cusolverDnXgesvdjSetTolerance" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnXgesvdjSetTolerance" name="cusolverDnXgesvdjSetTolerance" shape="rect">5.1.14.&nbsp;cusolverDnXgesvdjSetTolerance()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnXgesvdjSetTolerance(
    gesvdjInfo_t info,
    double tolerance)
</pre><p class="p">
                              This function configures tolerance of <samp class="ph codeph">gesvdj</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the structure of gesvdj.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tolerance</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">accuracy of numerical singular values.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnXgesvdjSetMaxSweeps"><a name="cusolverDnXgesvdjSetMaxSweeps" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnXgesvdjSetMaxSweeps" name="cusolverDnXgesvdjSetMaxSweeps" shape="rect">5.1.15.&nbsp;cusolverDnXgesvdjSetMaxSweeps()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnXgesvdjSetMaxSweeps(
    gesvdjInfo_t info,
    int max_sweeps)
</pre><p class="p">
                              This function configures maximum number of sweeps in <samp class="ph codeph">gesvdj</samp>.
                              The default value is 100.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the structure of gesvdj.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">max_sweeps</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">maximum number of sweeps.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnXgesvdjSetSortEig"><a name="cusolverDnXgesvdjSetSortEig" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnXgesvdjSetSortEig" name="cusolverDnXgesvdjSetSortEig" shape="rect">5.1.16.&nbsp;cusolverDnXgesvdjSetSortEig()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnXgesvdjSetSortEig(
    gesvdjInfo_t info,
    int sort_svd)
</pre><p class="p">
                              if <samp class="ph codeph">sort_svd</samp> is zero, the singular values are not sorted.
                              This function only works for <samp class="ph codeph">gesvdjBatched</samp>.
                              <samp class="ph codeph">gesvdj</samp> always sorts singular values in descending order.
                              By default, singular values are always sorted in descending order.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the structure of gesvdj.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">sort_svd</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">sort_svd</samp> is zero, the singular values are not sorted.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnXgesvdjGetResidual"><a name="cusolverDnXgesvdjGetResidual" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnXgesvdjGetResidual" name="cusolverDnXgesvdjGetResidual" shape="rect">5.1.17.&nbsp;cusolverDnXgesvdjGetResidual()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnXgesvdjGetResidual(
    cusolverDnHandle_t handle,
    gesvdjInfo_t info,
    double *residual)
</pre><p class="p">
                              This function reports residual of <samp class="ph codeph">gesvdj</samp>.
                              It does not support <samp class="ph codeph">gesvdjBatched</samp>.
                              If the user calls this function after <samp class="ph codeph">gesvdjBatched</samp>, 
                              the error <samp class="ph codeph">CUSOLVER_STATUS_NOT_SUPPORTED</samp> is returned.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the structure of gesvdj.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">residual</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">residual of gesvdj.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">does not support batched version</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDnXgesvdjGetSweeps"><a name="cusolverDnXgesvdjGetSweeps" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDnXgesvdjGetSweeps" name="cusolverDnXgesvdjGetSweeps" shape="rect">5.1.18.&nbsp;cusolverDnXgesvdjGetSweeps()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnXgesvdjGetSweeps(
    cusolverDnHandle_t handle,
    gesvdjInfo_t info,
    int *executed_sweeps)
</pre><p class="p">
                              This function reports number of executed sweeps of <samp class="ph codeph">gesvdj</samp>.
                              It does not support <samp class="ph codeph">gesvdjBatched</samp>.
                              If the user calls this function after <samp class="ph codeph">gesvdjBatched</samp>, 
                              the error <samp class="ph codeph">CUSOLVER_STATUS_NOT_SUPPORTED</samp> is returned.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the structure of gesvdj.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">executed_sweeps</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of executed sweeps.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">does not support batched version</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cuds-linearsolver-reference"><a name="cuds-linearsolver-reference" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cuds-linearsolver-reference" name="cuds-linearsolver-reference" shape="rect">Dense Linear Solver Reference</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter describes linear solver API of cuSolverDN, 
                           including Cholesky factorization, LU with partial pivoting, QR factorization and 
                           Bunch-Kaufman (LDLT) factorization.
                           
                        </p>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-potrf"><a name="cuds-lt-t-gt-potrf" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-potrf" name="cuds-lt-t-gt-potrf" shape="rect">cusolverDn&lt;t&gt;potrf()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              These helper functions calculate the necessary size of work buffers.
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnSpotrf_bufferSize(cusolverDnHandle_t handle,
                 cublasFillMode_t uplo,
                 int n,
                 float *A,
                 int lda,
                 int *Lwork );

cusolverStatus_t
cusolverDnDpotrf_bufferSize(cusolveDnHandle_t handle,
                 cublasFillMode_t uplo,
                 int n,
                 double *A,
                 int lda,
                 int *Lwork );

cusolverStatus_t 
cusolverDnCpotrf_bufferSize(cusolverDnHandle_t handle,
                 cublasFillMode_t uplo,
                 int n,
                 cuComplex *A,
                 int lda,
                 int *Lwork );

cusolverStatus_t 
cusolverDnZpotrf_bufferSize(cusolverDnHandle_t handle,
                 cublasFillMode_t uplo,
                 int n,
                 cuDoubleComplex *A,
                 int lda,
                 int *Lwork);
</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSpotrf(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           float *A,
           int lda,
           float *Workspace,
           int Lwork,
           int *devInfo );

cusolverStatus_t 
cusolverDnDpotrf(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           double *A,
           int lda,
           double *Workspace,
           int Lwork,
           int *devInfo );
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCpotrf(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           cuComplex *A,
           int lda,
           cuComplex *Workspace,
           int Lwork,
           int *devInfo );

cusolverStatus_t 
cusolverDnZpotrf(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           cuDoubleComplex *A,
           int lda,
           cuDoubleComplex *Workspace,
           int Lwork,
           int *devInfo );
</pre></div>
                           <p class="p">This function computes the Cholesky factorization of a Hermitian positive-definite matrix. </p>
                           <p class="p"><samp class="ph codeph">A</samp> is a <samp class="ph codeph">n×n</samp> Hermitian matrix, only lower or upper part is meaningful. 
                              The input parameter <samp class="ph codeph">uplo</samp> indicates which part of the matrix is used. 
                              The function would leave other part untouched.
                              
                           </p>
                           <p class="p">
                              If input parameter <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>,   
                              only lower triangular part of <samp class="ph codeph">A</samp> is processed, and replaced by 
                              lower triangular Cholesky factor <samp class="ph codeph">L</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mi>L</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>L</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              If input parameter <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,   
                              only upper triangular part of <samp class="ph codeph">A</samp> is processed, and replaced by 
                              upper triangular Cholesky factor <samp class="ph codeph">U</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <msup>
                                                <mi>U</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                             <mo>*</mo>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">Workspace</samp>.
                              The input parameter <samp class="ph codeph">Lwork</samp> is size of the working space, and it is returned by 
                              <samp class="ph codeph">potrf_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If Cholesky factorization failed, i.e. some leading minor of <samp class="ph codeph">A</samp> is not positive definite,
                              or equivalently some diagonal elements of <samp class="ph codeph">L</samp> or <samp class="ph codeph">U</samp> is not a real number.
                              The output parameter <samp class="ph codeph">devInfo</samp> would indicate smallest leading minor of <samp class="ph codeph">A</samp>
                              which is not positive definite.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of potrf</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">indicates if matrix <samp class="ph codeph">A</samp> lower or upper part is stored,
                                          the other part is not referenced.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with 
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Workspace</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">Lwork</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">Workspace</samp>, returned by <samp class="ph codeph">potrf_bufferSize</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the Cholesky factorization is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">devInfo =  i</samp>, the leading minor of order i is not positive definite.
                                          	
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp> or <samp class="ph codeph">lda&lt;max(1,n)</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-potrs"><a name="cuds-lt-t-gt-potrs" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-potrs" name="cuds-lt-t-gt-potrs" shape="rect">cusolverDn&lt;t&gt;potrs()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSpotrs(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           int nrhs,
           const float *A,
           int lda,
           float *B,
           int ldb,
           int *devInfo);

cusolverStatus_t 
cusolverDnDpotrs(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           int nrhs,
           const double *A,
           int lda,
           double *B,
           int ldb,
           int *devInfo);

cusolverStatus_t 
cusolverDnCpotrs(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           int nrhs,
           const cuComplex *A,
           int lda,
           cuComplex *B,
           int ldb,
           int *devInfo);

cusolverStatus_t 
cusolverDnZpotrs(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           int nrhs,
           const cuDoubleComplex *A,
           int lda,
           cuDoubleComplex *B,
           int ldb,
           int *devInfo);

</pre><p class="p">
                              This function solves a system of linear equations 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <mi>X</mi>
                                             <mo>=</mo>
                                             <mi>B</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">A</samp> is a <samp class="ph codeph">n×n</samp> Hermitian matrix, 
                              only lower or upper part is meaningful. 
                              The input parameter <samp class="ph codeph">uplo</samp> indicates which part of the matrix is used. 
                              The function would leave other part untouched.
                              
                           </p>
                           <p class="p">
                              The user has to call <samp class="ph codeph">potrf</samp> first to factorize matrix <samp class="ph codeph">A</samp>.
                              If input parameter <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>,   
                              <samp class="ph codeph">A</samp> is lower triangular Cholesky factor <samp class="ph codeph">L</samp>
                              correspoding to
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>=</mo>
                                 <mi>L</mi>
                                 <mo>*</mo>
                                 <msup>
                                    <mi>L</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              
                              .
                              
                              If input parameter <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,   
                              <samp class="ph codeph">A</samp> is upper triangular Cholesky factor <samp class="ph codeph">U</samp>
                              corresponding to
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>=</mo>
                                 <msup>
                                    <mi>U</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                                 <mo>*</mo>
                                 <mi>U</mi>
                              </math>
                              
                              .   
                              
                           </p>
                           <p class="p">
                              The operation is in-place, i.e. matrix <samp class="ph codeph">X</samp> overwrites matrix <samp class="ph codeph">B</samp>
                              with the same leading dimension <samp class="ph codeph">ldb</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of potrs</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolveDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">indicates if matrix <samp class="ph codeph">A</samp> lower or upper part is stored,
                                          the other part is not referenced.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nrhs</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">X</samp> and <samp class="ph codeph">B</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with 
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          <samp class="ph codeph">A</samp> is either lower cholesky factor <samp class="ph codeph">L</samp> or
                                          upper Cholesky factor <samp class="ph codeph">U</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">ldb * nrhs</samp>.
                                          <samp class="ph codeph">ldb</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          As an input, <samp class="ph codeph">B</samp> is right hand side matrix.
                                          As an output, <samp class="ph codeph">B</samp> is the solution matrix.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the Cholesky factorization is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          	
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp>, 
                                          <samp class="ph codeph">nrhs&lt;0</samp>, <samp class="ph codeph">lda&lt;max(1,n)</samp> or
                                          <samp class="ph codeph">ldb&lt;max(1,n)</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-potri"><a name="cuds-lt-t-gt-potri" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-potri" name="cuds-lt-t-gt-potri" shape="rect">cusolverDn&lt;t&gt;potri()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              These helper functions calculate the necessary size of work buffers.
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnSpotri_bufferSize(cusolverDnHandle_t handle,
                 cublasFillMode_t uplo,
                 int n,
                 float *A,
                 int lda,
                 int *Lwork );

cusolverStatus_t
cusolverDnDpotri_bufferSize(cusolveDnHandle_t handle,
                 cublasFillMode_t uplo,
                 int n,
                 double *A,
                 int lda,
                 int *Lwork );

cusolverStatus_t 
cusolverDnCpotri_bufferSize(cusolverDnHandle_t handle,
                 cublasFillMode_t uplo,
                 int n,
                 cuComplex *A,
                 int lda,
                 int *Lwork );

cusolverStatus_t 
cusolverDnZpotri_bufferSize(cusolverDnHandle_t handle,
                 cublasFillMode_t uplo,
                 int n,
                 cuDoubleComplex *A,
                 int lda,
                 int *Lwork);
</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSpotri(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           float *A,
           int lda,
           float *Workspace,
           int Lwork,
           int *devInfo );

cusolverStatus_t 
cusolverDnDpotri(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           double *A,
           int lda,
           double *Workspace,
           int Lwork,
           int *devInfo );
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCpotri(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           cuComplex *A,
           int lda,
           cuComplex *Workspace,
           int Lwork,
           int *devInfo );

cusolverStatus_t 
cusolverDnZpotri(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           cuDoubleComplex *A,
           int lda,
           cuDoubleComplex *Workspace,
           int Lwork,
           int *devInfo );
</pre></div>
                           <p class="p">
                              This function computes the inverse of a positive-definite matrix <samp class="ph codeph">A</samp> using the Cholesky
                              factorization
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mi>L</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>L</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                             <mo>=</mo>
                                             <msup>
                                                <mi>U</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                             <mo>*</mo>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              computed by <samp class="ph codeph">potrf()</samp>.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">A</samp> is a <samp class="ph codeph">n×n</samp> matrix containing the triangular factor
                              <samp class="ph codeph">L</samp> or <samp class="ph codeph">U</samp> computed by the Cholesky factorization.
                              Only lower or upper part is meaningful and the input parameter <samp class="ph codeph">uplo</samp> indicates
                              which part of the matrix is used. The function would leave the other part untouched.
                              
                           </p>
                           <p class="p">
                              If the input parameter <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>,   
                              only lower triangular part of <samp class="ph codeph">A</samp> is processed, and replaced the by 
                              lower triangular part of the inverse of <samp class="ph codeph">A</samp>.
                              
                           </p>
                           <p class="p">
                              If the input parameter <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,   
                              only upper triangular part of <samp class="ph codeph">A</samp> is processed, and replaced by 
                              the upper triangular part of the inverse of <samp class="ph codeph">A</samp>.
                              
                           </p>
                           <p class="p">
                              The user has to provide the working space which is pointed to by input parameter <samp class="ph codeph">Workspace</samp>.
                              The input parameter <samp class="ph codeph">Lwork</samp> is the size of the working space, returned by 
                              <samp class="ph codeph">potri_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If the computation of the inverse fails, i.e. some leading minor of <samp class="ph codeph">L</samp> or <samp class="ph codeph">U</samp>,
                              is null, the output parameter <samp class="ph codeph">devInfo</samp> would indicate the smallest leading minor of <samp class="ph codeph">L</samp>
                              or <samp class="ph codeph">U</samp> which is not positive definite.
                              
                           </p>
                           <p class="p">
                              If the output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting the handle).
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of potri</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">indicates if matrix <samp class="ph codeph">A</samp> lower or upper part is stored,
                                          the other part is not referenced.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> where 
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Workspace</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">Lwork</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">Workspace</samp>, returned by <samp class="ph codeph">potri_bufferSize</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the computation of the inverse is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">devInfo =  i</samp>, the leading minor of order i is zero.
                                          	
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp> or <samp class="ph codeph">lda&lt;max(1,n)</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-getrf"><a name="cuds-lt-t-gt-getrf" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-getrf" name="cuds-lt-t-gt-getrf" shape="rect">cusolverDn&lt;t&gt;getrf()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              These helper functions calculate the size of work buffers needed.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSgetrf_bufferSize(cusolverDnHandle_t handle,
                      int m,
                      int n,
                      float *A,
                      int lda,
                      int *Lwork );

cusolverStatus_t 
cusolverDnDgetrf_bufferSize(cusolverDnHandle_t handle,
                      int m,
                      int n,
                      double *A,
                      int lda,
                      int *Lwork );

cusolverStatus_t 
cusolverDnCgetrf_bufferSize(cusolverDnHandle_t handle,
                      int m,
                      int n,
                      cuComplex *A,
                      int lda,
                      int *Lwork );

cusolverStatus_t 
cusolverDnZgetrf_bufferSize(cusolverDnHandle_t handle,
                      int m,
                      int n,
                      cuDoubleComplex *A,
                      int lda,
                      int *Lwork );
</pre></div>
                           <div class="p">
                              The S and D data types are real single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSgetrf(cusolverDnHandle_t handle,
           int m,
           int n,
           float *A,
           int lda,
           float *Workspace,
           int *devIpiv,
           int *devInfo );

cusolverStatus_t 
cusolverDnDgetrf(cusolverDnHandle_t handle,
           int m,
           int n,
           double *A,
           int lda,
           double *Workspace,
           int *devIpiv,
           int *devInfo );
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCgetrf(cusolverDnHandle_t handle,
           int m,
           int n,
           cuComplex *A,
           int lda,
           cuComplex *Workspace,
           int *devIpiv,
           int *devInfo );

cusolverStatus_t 
cusolverDnZgetrf(cusolverDnHandle_t handle,
           int m,
           int n,
           cuDoubleComplex *A,
           int lda,
           cuDoubleComplex *Workspace,
           int *devIpiv,
           int *devInfo );
</pre></div>
                           <p class="p">This function computes the LU factorization of a <samp class="ph codeph">m×n</samp> matrix 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>P</mi>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mi>L</mi>
                                             <mo>*</mo>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">A</samp> is a <samp class="ph codeph">m×n</samp> matrix, 
                              <samp class="ph codeph">P</samp> is a permutation matrix, 
                              <samp class="ph codeph">L</samp> is a lower triangular matrix with unit diagonal, and 
                              <samp class="ph codeph">U</samp> is an upper triangular matrix.
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">Workspace</samp>.
                              The input parameter <samp class="ph codeph">Lwork</samp> is size of the working space, and it is returned by 
                              <samp class="ph codeph">getrf_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If LU factorization failed, i.e. matrix <samp class="ph codeph">A</samp> (<samp class="ph codeph">U</samp>) is singular, 
                              The output parameter <samp class="ph codeph">devInfo=i</samp> indicates <samp class="ph codeph">U(i,i) = 0</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <p class="p">
                              If <samp class="ph codeph">devIpiv</samp> is null, no pivoting is performed. 
                              The factorization is <samp class="ph codeph">A=L*U</samp>, which is not numerically stable.
                              
                           </p>
                           <p class="p">
                              No matter LU factorization failed or not, the output parameter <samp class="ph codeph">devIpiv</samp> contains
                              pivoting sequence, row <samp class="ph codeph">i</samp> is interchanged with row <samp class="ph codeph">devIpiv(i)</samp>.
                              
                           </p>
                           <p class="p">
                              The user can combine <samp class="ph codeph">getrf</samp> and <samp class="ph codeph">getrs</samp> to complete a linear solver. 
                              Please refer to appendix D.1. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of getrf</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with 
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,m)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Workspace</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">Lwork</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devIpiv</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">array of size at least <samp class="ph codeph">min(m,n)</samp>, containing pivot indices.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the LU factorization is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">devInfo =  i</samp>, the <samp class="ph codeph">U(i,i) = 0</samp>.
                                          	
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp> or <samp class="ph codeph">lda&lt;max(1,m)</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-getrs"><a name="cuds-lt-t-gt-getrs" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-getrs" name="cuds-lt-t-gt-getrs" shape="rect">cusolverDn&lt;t&gt;getrs()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSgetrs(cusolverDnHandle_t handle,
           cublasOperation_t trans,
           int n,
           int nrhs,
           const float *A,
           int lda,
           const int *devIpiv,
           float *B,
           int ldb,
           int *devInfo );

cusolverStatus_t 
cusolverDnDgetrs(cusolverDnHandle_t handle,
           cublasOperation_t trans,
           int n,
           int nrhs,
           const double *A,
           int lda,
           const int *devIpiv,
           double *B,
           int ldb,
           int *devInfo );

cusolverStatus_t 
cusolverDnCgetrs(cusolverDnHandle_t handle,
           cublasOperation_t trans,
           int n,
           int nrhs,
           const cuComplex *A,
           int lda,
           const int *devIpiv,
           cuComplex *B,
           int ldb,
           int *devInfo );

cusolverStatus_t 
cusolverDnZgetrs(cusolverDnHandle_t handle,
           cublasOperation_t trans,
           int n,
           int nrhs,
           const cuDoubleComplex *A,
           int lda,
           const int *devIpiv,
           cuDoubleComplex *B,
           int ldb,
           int *devInfo );



</pre><p class="p">This function solves a linear system of multiple right-hand sides</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>op(A)</mi>
                                             <mo>*</mo>
                                             <mi>X</mi>
                                             <mo>=</mo>
                                             <mi>B</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">A</samp> is a <samp class="ph codeph">n×n</samp> matrix, and was LU-factored by 
                              <samp class="ph codeph">getrf</samp>, that is, lower trianular part of A is <samp class="ph codeph">L</samp>, and 
                              upper triangular part (including diagonal elements) of <samp class="ph codeph">A</samp> is <samp class="ph codeph">U</samp>.
                              <samp class="ph codeph">B</samp> is a <samp class="ph codeph">n×nrhs</samp> right-hand side matrix.
                              
                           </p>
                           <p class="p">
                              The input parameter <samp class="ph codeph">trans</samp> is defined by 
                              
                           </p>
                           <p class="p d4p_eqn_block">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mtext>op</mtext>
                                 <mo stretchy="false">(</mo>
                                 <mi>A</mi>
                                 <mo stretchy="false">)</mo>
                                 <mo>=</mo>
                                 <mfenced open="{" close="">
                                    <mtable columnalign="left left" rowspacing="4pt" columnspacing="1em">
                                       <mtr>
                                          <mtd>
                                             <mi>A</mi>
                                          </mtd>
                                          <mtd>
                                             <mtext>if&nbsp;</mtext>
                                             <mtext mathvariant="sans-serif">trans == CUBLAS_OP_N</mtext>
                                          </mtd>
                                       </mtr>
                                       <mtr>
                                          <mtd>
                                             <msup>
                                                <mi>A</mi>
                                                <mi>T</mi>
                                             </msup>
                                          </mtd>
                                          <mtd>
                                             <mtext>if&nbsp;</mtext>
                                             <mtext mathvariant="sans-serif">trans == CUBLAS_OP_T</mtext>
                                          </mtd>
                                       </mtr>
                                       <mtr>
                                          <mtd>
                                             <msup>
                                                <mi>A</mi>
                                                <mi>H</mi>
                                             </msup>
                                          </mtd>
                                          <mtd>
                                             <mtext>if&nbsp;</mtext>
                                             <mtext mathvariant="sans-serif">trans == CUBLAS_OP_C</mtext>
                                          </mtd>
                                       </mtr>
                                    </mtable>
                                 </mfenced>
                              </math>
                           </p>
                           <p class="p">
                              The input parameter <samp class="ph codeph">devIpiv</samp> is an output of <samp class="ph codeph">getrf</samp>.
                              It contains pivot indices, which are used to permutate right-hand sides. 
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <p class="p">
                              The user can combine <samp class="ph codeph">getrf</samp> and <samp class="ph codeph">getrs</samp> to complete a linear solver.     
                              Please refer to appendix D.1. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">trans</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">operation <samp class="ph codeph">op(A)</samp> that is non- or (conj.) transpose.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nrhs</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of right-hand sides.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with 
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devIpiv</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">array of size at least <samp class="ph codeph">n</samp>, containing pivot indices.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">ldb * nrhs</samp> with
                                          <samp class="ph codeph">ldb</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">B</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"> if <samp class="ph codeph">devInfo = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          	
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp> or <samp class="ph codeph">lda&lt;max(1,n)</samp>
                                          or <samp class="ph codeph">ldb&lt;max(1,n)</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-geqrf"><a name="cuds-lt-t-gt-geqrf" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-geqrf" name="cuds-lt-t-gt-geqrf" shape="rect">cusolverDn&lt;t&gt;geqrf()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              These helper functions calculate the size of work buffers needed.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSgeqrf_bufferSize(cusolverDnHandle_t handle,
                      int m,
                      int n,
                      float *A,
                      int lda,
                      int *Lwork );

cusolverStatus_t 
cusolverDnDgeqrf_bufferSize(cusolverDnHandle_t handle,
                      int m,
                      int n,
                      double *A,
                      int lda,
                      int *Lwork );

cusolverStatus_t 
cusolverDnCgeqrf_bufferSize(cusolverDnHandle_t handle,
                      int m,
                      int n,
                      cuComplex *A,
                      int lda,
                      int *Lwork );

cusolverStatus_t 
cusolverDnZgeqrf_bufferSize(cusolverDnHandle_t handle,
                      int m,
                      int n,
                      cuDoubleComplex *A,
                      int lda,
                      int *Lwork );
</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSgeqrf(cusolverDnHandle_t handle,
           int m,
           int n,
           float *A,
           int lda,
           float *TAU,
           float *Workspace,
           int Lwork,
           int *devInfo );

cusolverStatus_t 
cusolverDnDgeqrf(cusolverDnHandle_t handle,
           int m,
           int n,
           double *A,
           int lda,
           double *TAU,
           double *Workspace,
           int Lwork,
           int *devInfo );
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCgeqrf(cusolverDnHandle_t handle,
           int m,
           int n,
           cuComplex *A,
           int lda,
           cuComplex *TAU,
           cuComplex *Workspace,
           int Lwork,
           int *devInfo );

cusolverStatus_t 
cusolverDnZgeqrf(cusolverDnHandle_t handle,
           int m,
           int n,
           cuDoubleComplex *A,
           int lda,
           cuDoubleComplex *TAU,
           cuDoubleComplex *Workspace,
           int Lwork,
           int *devInfo );
</pre></div>
                           <p class="p">This function computes the QR factorization of a <samp class="ph codeph">m×n</samp> matrix 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mi>Q</mi>
                                             <mo>*</mo>
                                             <mi>R</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">A</samp> is a <samp class="ph codeph">m×n</samp> matrix, 
                              <samp class="ph codeph">Q</samp> is a <samp class="ph codeph">m×n</samp> matrix, and 
                              <samp class="ph codeph">R</samp> is a <samp class="ph codeph">n×n</samp> upper triangular matrix.
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">Workspace</samp>.
                              The input parameter <samp class="ph codeph">Lwork</samp> is size of the working space, and it is returned by 
                              <samp class="ph codeph">geqrf_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              The matrix <samp class="ph codeph">R</samp> is overwritten in upper triangular part of <samp class="ph codeph">A</samp>,
                              including diagonal elements.
                              
                           </p>
                           <p class="p">
                              The matrix <samp class="ph codeph">Q</samp> is not formed explicitly, instead, a sequence of householder vectors 
                              are stored in lower triangular part of <samp class="ph codeph">A</samp>. 
                              The leading nonzero element of householder vector is assumed to be 1 such that 
                              output parameter <samp class="ph codeph">TAU</samp> contains the scaling factor <samp class="ph codeph">τ</samp>.
                              If <samp class="ph codeph">v</samp> is original householder vector, <samp class="ph codeph">q</samp> is the new 
                              householder vector corresponding to <samp class="ph codeph">τ</samp>, satisying the following relation
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>I</mi>
                                             <mo>-</mo>
                                             <mn>2</mn>
                                             <mo>*</mo>
                                             <mi>v</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>v</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                             <mo>=</mo>
                                             <mi>I</mi>
                                             <mo>-</mo>
                                             <mi>τ</mi>
                                             <mo>*</mo>
                                             <mi>q</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>q</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of geqrf</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with 
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,m)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">TAU</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension at least <samp class="ph codeph">min(m,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Workspace</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">Lwork</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of working array <samp class="ph codeph">Workspace</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the LU factorization is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          	
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp> or <samp class="ph codeph">lda&lt;max(1,m)</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-ormqr"><a name="cuds-lt-t-gt-ormqr" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-ormqr" name="cuds-lt-t-gt-ormqr" shape="rect">cusolverDn&lt;t&gt;ormqr()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              These helper functions calculate the size of work buffers needed.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSormqr_bufferSize(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    cublasOperation_t trans,
    int m,
    int n,
    int k,
    const float *A,
    int lda,
    const float *C,
    int ldc,
    int *lwork);

cusolverStatus_t 
cusolverDnDormqr_bufferSize(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    cublasOperation_t trans,
    int m,
    int n,
    int k,
    const double *A,
    int lda,
    const double *C,
    int ldc,
    int *lwork);

cusolverStatus_t
cusolverDnCunmqr_bufferSize(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    cublasOperation_t trans,
    int m,
    int n,
    int k,
    const cuComplex *A,
    int lda,
    const cuComplex *C,
    int ldc,
    int *lwork);

cusolverStatus_t
cusolverDnZunmqr_bufferSize(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    cublasOperation_t trans,
    int m,
    int n,
    int k,
    const cuDoubleComplex *A,
    int lda,
    const cuDoubleComplex *C,
    int ldc,
    int *lwork);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSormqr(cusolverDnHandle_t handle,
           cublasSideMode_t side,
           cublasOperation_t trans,
           int m,
           int n,
           int k,
           const float *A,
           int lda,
           const float *tau,
           float *C,
           int ldc,
           float *work,
           int lwork,
           int *devInfo);

cusolverStatus_t
cusolverDnDormqr(cusolverDnHandle_t handle,
           cublasSideMode_t side,
           cublasOperation_t trans,
           int m,
           int n,
           int k,
           const double *A,
           int lda,
           const double *tau,
           double *C,
           int ldc,
           double *work,
           int lwork,
           int *devInfo);
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCunmqr(cusolverDnHandle_t handle,
           cublasSideMode_t side,
           cublasOperation_t trans,
           int m,
           int n,
           int k,
           const cuComplex *A,
           int lda,
           const cuComplex *tau,
           cuComplex *C,
           int ldc,
           cuComplex *work,
           int lwork,
           int *devInfo);

cusolverStatus_t 
cusolverDnZunmqr(cusolverDnHandle_t handle,
           cublasSideMode_t side,
           cublasOperation_t trans,
           int m,
           int n,
           int k,
           const cuDoubleComplex *A,
           int lda,
           const cuDoubleComplex *tau,
           cuDoubleComplex *C,
           int ldc,
           cuDoubleComplex *work,
           int lwork,
           int *devInfo);
</pre></div>
                           <p class="p">
                              This function overwrites <samp class="ph codeph">m×n</samp> matrix <samp class="ph codeph">C</samp> by
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>C</mi>
                                             <mo>=</mo>
                                             <mfenced open="{" close="">
                                                <mtable columnalign="left left" rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>op</mtext>
                                                         <mo stretchy="false">(</mo>
                                                         <mi>Q</mi>
                                                         <mo stretchy="false">)</mo>
                                                         <mo>*</mo>
                                                         <mi>C</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">side == CUBLAS_SIDE_LEFT</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>C</mi>
                                                         <mo>*</mo>
                                                         <mtext>op</mtext>
                                                         <mo stretchy="false">(</mo>
                                                         <mi>Q</mi>
                                                         <mo stretchy="false">)</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">side == CUBLAS_SIDE_RIGHT</mtext>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The operation of <samp class="ph codeph">Q</samp> is defined by
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mtext>op</mtext>
                                             <mo stretchy="false">(</mo>
                                             <mi>Q</mi>
                                             <mo stretchy="false">)</mo>
                                             <mo>=</mo>
                                             <mfenced open="{" close="">
                                                <mtable columnalign="left left" rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>Q</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">transa == CUBLAS_OP_N</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msup>
                                                            <mi>Q</mi>
                                                            <mi>T</mi>
                                                         </msup>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">transa == CUBLAS_OP_T</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msup>
                                                            <mi>Q</mi>
                                                            <mi>H</mi>
                                                         </msup>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">transa == CUBLAS_OP_C</mtext>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">Q</samp> is a unitary matrix formed by a sequence of elementary reflection vectors 
                              from QR factorization (<samp class="ph codeph">geqrf</samp>) of <samp class="ph codeph">A</samp>.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">Q</samp>=<samp class="ph codeph">H(1)</samp><samp class="ph codeph">H(2)</samp> ... <samp class="ph codeph">H(k)</samp></p>
                           <p class="p"><samp class="ph codeph">Q</samp> is of order <samp class="ph codeph">m</samp> 
                              if <samp class="ph codeph">side</samp> = <samp class="ph codeph">CUBLAS_SIDE_LEFT</samp> and of order <samp class="ph codeph">n</samp>
                              if <samp class="ph codeph">side</samp> = <samp class="ph codeph">CUBLAS_SIDE_RIGHT</samp>.
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is size of the working space, and it is returned by 
                              <samp class="ph codeph">geqrf_bufferSize()</samp> or <samp class="ph codeph">ormqr_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <p class="p">
                              The user can combine <samp class="ph codeph">geqrf</samp>, <samp class="ph codeph">ormqr</samp> and <samp class="ph codeph">trsm</samp>
                              to complete a linear solver or a least-square solver. 
                              Please refer to appendix C.1. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of ormqr</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Handle to the cuSolverDn library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">side</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Indicates if matrix <samp class="ph codeph">Q</samp> is on the left or right of <samp class="ph codeph">C</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">trans</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Operation <samp class="ph codeph">op(Q)</samp> that is non- or (conj.) transpose.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Number of columns of matrix <samp class="ph codeph">C</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Number of rows of matrix <samp class="ph codeph">C</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">k</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Number of elementary relfections whose product defines the matrix Q.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * k</samp> with 
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,m)</samp>.
                                          The matrix <samp class="ph codeph">A</samp> is from <samp class="ph codeph">geqrf</samp>, so
                                          i-th column contains elementary reflection vector.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>. 
                                          if <samp class="ph codeph">side</samp> is <samp class="ph codeph">CUBLAS_SIDE_LEFT</samp>, lda &gt;= max(1,m);
                                          if <samp class="ph codeph">side</samp> is <samp class="ph codeph">CUBLAS_SIDE_RIGHT</samp>, lda &gt;= max(1,n).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tau</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension at least <samp class="ph codeph">min(m,n)</samp>.
                                          The vector <samp class="ph codeph">tau</samp> is from <samp class="ph codeph">geqrf</samp>, so
                                          <samp class="ph codeph">tau(i)</samp> is the scalar of i-th elementary reflection vector.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">C</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of size <samp class="ph codeph">ldc * n</samp>.
                                          On exit, <samp class="ph codeph">C</samp> is overwritten by <samp class="ph codeph">op(Q)*C</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldc</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Leading dimension of two-dimensional array of matrix <samp class="ph codeph">C</samp>.
                                          ldc &gt;= max(1,m).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Size of working array <samp class="ph codeph">work</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">If <samp class="ph codeph">devInfo = 0</samp>, the ormqr is successful.
                                          If <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          	
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">The operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">The library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">Invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp> or wrong <samp class="ph codeph">lda</samp>
                                          or <samp class="ph codeph">ldc</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">The device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">An internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-orgqr"><a name="cuds-lt-t-gt-orgqr" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-orgqr" name="cuds-lt-t-gt-orgqr" shape="rect">cusolverDn&lt;t&gt;orgqr()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              These helper functions calculate the size of work buffers needed.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSorgqr_bufferSize(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int k,
    const float *A,
    int lda,
    const float *tau,
    int *lwork);

cusolverStatus_t 
cusolverDnDorgqr_bufferSize(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int k,
    const double *A,
    int lda,
    const double *tau,
    int *lwork);

cusolverStatus_t 
cusolverDnCungqr_bufferSize(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int k,
    const cuComplex *A,
    int lda,
    const cuComplex *tau,
    int *lwork);

cusolverStatus_t 
cusolverDnZungqr_bufferSize(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int k,
    const cuDoubleComplex *A,
    int lda,
    const cuDoubleComplex *tau,
    int *lwork);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSorgqr(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int k,
    float *A,
    int lda,
    const float *tau,
    float *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnDorgqr(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int k,
    double *A,
    int lda,
    const double *tau,
    double *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCungqr(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int k,
    cuComplex *A,
    int lda,
    const cuComplex *tau,
    cuComplex *work,
    int lwork,
    int *devInfo);

cusolverStatus_t
cusolverDnZungqr(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int k,
    cuDoubleComplex *A,
    int lda,
    const cuDoubleComplex *tau,
    cuDoubleComplex *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <p class="p">
                              This function overwrites <samp class="ph codeph">m×n</samp> matrix <samp class="ph codeph">A</samp> by
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>Q</mi>
                                             <mo>=</mo>
                                             <mi>H(1)</mi>
                                             <mo>*</mo>
                                             <mi>H(2)</mi>
                                             <mo>*</mo>
                                             <mi>...</mi>
                                             <mo>*</mo>
                                             <mi>H(k)</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">Q</samp> is a unitary matrix formed by a sequence of elementary reflection vectors 
                              stored in <samp class="ph codeph">A</samp>.
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is size of the working space, and it is returned by 
                              <samp class="ph codeph">orgqr_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <p class="p">
                              The user can combine <samp class="ph codeph">geqrf</samp>, <samp class="ph codeph">orgqr</samp>
                              to complete orthogonalization.
                              Please refer to appendix C.2.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of ormqr</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">Q</samp>. 
                                          m &gt;= 0;
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">Q</samp>.
                                          m &gt;= n &gt;= 0;
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">k</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of elementary relfections whose product defines the matrix <samp class="ph codeph">Q</samp>.
                                          n &gt;= k &gt;= 0;
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with 
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,m)</samp>.
                                          i-th column of <samp class="ph codeph">A</samp> contains elementary reflection vector.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>. 
                                          lda &gt;= max(1,m).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tau</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">k</samp>.
                                          <samp class="ph codeph">tau(i)</samp> is the scalar of i-th elementary reflection vector.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of working array <samp class="ph codeph">work</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">info = 0</samp>, the orgqr is successful.
                                          if <samp class="ph codeph">info = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          	
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed 
                                          (<samp class="ph codeph">m,n,k&lt;0</samp>, <samp class="ph codeph">n&gt;m</samp>, <samp class="ph codeph">k&gt;n</samp> or 
                                          <samp class="ph codeph">lda&lt;m</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-sytrf"><a name="cuds-lt-t-gt-sytrf" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-sytrf" name="cuds-lt-t-gt-sytrf" shape="rect">cusolverDn&lt;t&gt;sytrf()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              These helper functions calculate the size of the needed buffers.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSsytrf_bufferSize(cusolverDnHandle_t handle,
                      int n,
                      float *A,
                      int lda,
                      int *Lwork );

cusolverStatus_t 
cusolverDnDsytrf_bufferSize(cusolverDnHandle_t handle,
                      int n,
                      double *A,
                      int lda,
                      int *Lwork );

cusolverStatus_t 
cusolverDnCsytrf_bufferSize(cusolverDnHandle_t handle,
                      int n,
                      cuComplex *A,
                      int lda,
                      int *Lwork );

cusolverStatus_t 
cusolverDnZsytrf_bufferSize(cusolverDnHandle_t handle,
                      int n,
                      cuDoubleComplex *A,
                      int lda,
                      int *Lwork );
</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSsytrf(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           float *A,
           int lda,
           int *ipiv,
           float *work,
           int lwork,
           int *devInfo );

cusolverStatus_t 
cusolverDnDsytrf(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           double *A,
           int lda,
           int *ipiv,
           double *work,
           int lwork,
           int *devInfo );
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCsytrf(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           cuComplex *A,
           int lda,
           int *ipiv,
           cuComplex *work,
           int lwork,
           int *devInfo );

cusolverStatus_t 
cusolverDnZsytrf(cusolverDnHandle_t handle,
           cublasFillMode_t uplo,
           int n,
           cuDoubleComplex *A,
           int lda,
           int *ipiv,
           cuDoubleComplex *work,
           int lwork,
           int *devInfo );
</pre></div>
                           <p class="p">
                              This function computes the Bunch-Kaufman factorization of 
                              a <samp class="ph codeph">n×n</samp> symmetric indefinite matrix 
                              
                           </p>
                           <p class="p"><samp class="ph codeph">A</samp> is a <samp class="ph codeph">n×n</samp> symmetric matrix, only lower or upper part is meaningful.
                              The input parameter <samp class="ph codeph">uplo</samp> which part of the matrix is used.
                              The function would leave other part untouched.
                              
                           </p>
                           <p class="p">
                              If input parameter <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>,  
                              only lower triangular part of <samp class="ph codeph">A</samp> is processed, and replaced by
                              lower triangular factor <samp class="ph codeph">L</samp> and block diagonal matrix <samp class="ph codeph">D</samp>.
                              Each block of <samp class="ph codeph">D</samp> is either 1x1 or 2x2 block, depending on pivoting.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>P</mi>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>P</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>T</mi>
                                                </mrow>
                                             </msup>
                                             <mo>=</mo>
                                             <mi>L</mi>
                                             <mo>*</mo>
                                             <mi>D</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>L</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>T</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              If input parameter <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,
                              only upper triangular part of <samp class="ph codeph">A</samp> is processed, and replaced by
                              upper triangular factor <samp class="ph codeph">U</samp> and block diagonal matrix <samp class="ph codeph">D</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>P</mi>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>P</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>T</mi>
                                                </mrow>
                                             </msup>
                                             <mo>=</mo>
                                             <mi>U</mi>
                                             <mo>*</mo>
                                             <mi>D</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>U</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>T</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is size of the working space, and it is returned by 
                              <samp class="ph codeph">sytrf_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If Bunch-Kaufman factorization failed, i.e. <samp class="ph codeph">A</samp> is singular.
                              The output parameter <samp class="ph codeph">devInfo = i</samp> would indicate <samp class="ph codeph">D(i,i)=0</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">devIpiv</samp> contains
                              pivoting sequence.
                              If <samp class="ph codeph">devIpiv(i) = k &gt; 0</samp>, <samp class="ph codeph">D(i,i)</samp> is 1x1 block, and 
                              <samp class="ph codeph">i-th</samp> row/column of <samp class="ph codeph">A</samp> is interchanged with 
                              <samp class="ph codeph">k-th</samp> row/column of <samp class="ph codeph">A</samp>.
                              If <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp> and 
                              <samp class="ph codeph">devIpiv(i-1) = devIpiv(i) = -m &lt; 0</samp>, 
                              <samp class="ph codeph">D(i-1:i,i-1:i)</samp> is a 2x2 block,
                              and <samp class="ph codeph">(i-1)-th</samp> row/column is interchanged with <samp class="ph codeph">m-th</samp> row/column.
                              If <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp> and 
                              <samp class="ph codeph">devIpiv(i+1) = devIpiv(i) = -m &lt; 0</samp>, 
                              <samp class="ph codeph">D(i:i+1,i:i+1)</samp> is a 2x2 block,
                              and <samp class="ph codeph">(i+1)-th</samp> row/column is interchanged with <samp class="ph codeph">m-th</samp> row/column.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of sytrf</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">indicates if matrix <samp class="ph codeph">A</samp> lower or upper part is stored,
                                          the other part is not referenced.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with 
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ipiv</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">array of size at least <samp class="ph codeph">n</samp>, containing pivot indices.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of working space <samp class="ph codeph">work</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the LU factorization is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">devInfo =  i</samp>, the <samp class="ph codeph">D(i,i) = 0</samp>.
                                          	
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp> or <samp class="ph codeph">lda&lt;max(1,n)</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-potrfBatched"><a name="cuds-lt-t-gt-potrfBatched" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-potrfBatched" name="cuds-lt-t-gt-potrfBatched" shape="rect">cusolverDn&lt;t&gt;potrfBatched()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnSpotrfBatched(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    float *Aarray[],
    int lda,
    int *infoArray,
    int batchSize);

cusolverStatus_t 
cusolverDnDpotrfBatched(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    double *Aarray[],
    int lda,
    int *infoArray,
    int batchSize);
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCpotrfBatched(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    cuComplex *Aarray[],
    int lda,
    int *infoArray,
    int batchSize);

cusolverStatus_t 
cusolverDnZpotrfBatched(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    cuDoubleComplex *Aarray[],
    int lda,
    int *infoArray,
    int batchSize);

</pre></div>
                           <p class="p">This function computes the Cholesky factorization of a squence of Hermitian positive-definite matrices. </p>
                           <p class="p">
                              Each <samp class="ph codeph">Aarray[i] for i=0,1,..., batchSize-1</samp> is a <samp class="ph codeph">n×n</samp> Hermitian matrix, 
                              only lower or upper part is meaningful. 
                              The input parameter <samp class="ph codeph">uplo</samp> indicates which part of the matrix is used. 
                              
                           </p>
                           <p class="p">
                              If input parameter <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>,   
                              only lower triangular part of <samp class="ph codeph">A</samp> is processed, and replaced by 
                              lower triangular Cholesky factor <samp class="ph codeph">L</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mi>L</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>L</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              If input parameter <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,   
                              only upper triangular part of <samp class="ph codeph">A</samp> is processed, and replaced by 
                              upper triangular Cholesky factor <samp class="ph codeph">U</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <msup>
                                                <mi>U</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                             <mo>*</mo>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              If Cholesky factorization failed, i.e. some leading minor of <samp class="ph codeph">A</samp> is not positive definite,
                              or equivalently some diagonal elements of <samp class="ph codeph">L</samp> or <samp class="ph codeph">U</samp> is not a real number.
                              The output parameter <samp class="ph codeph">infoArray</samp> would indicate smallest leading minor of <samp class="ph codeph">A</samp>
                              which is not positive definite.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">infoArray</samp> is an integer array of size <samp class="ph codeph">batchsize</samp>. 
                              If <samp class="ph codeph">potrfBatched</samp> returns <samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp>, 
                              <samp class="ph codeph">infoArray[0] = -i</samp> (less than zero), meaning that the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              If <samp class="ph codeph">potrfBatched</samp> returns <samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp> but 
                              <samp class="ph codeph">infoArray[i] = k</samp> is positive, then <samp class="ph codeph">i-th</samp> matrix is not positive definite
                              and the Cholesky factorization failed at row <samp class="ph codeph">k</samp>.
                              
                           </p>
                           <p class="p">
                              Remark: the other part of <samp class="ph codeph">A</samp> is used as a workspace.
                              For example, if <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,
                              upper triangle of <samp class="ph codeph">A</samp> contains cholesky factor <samp class="ph codeph">U</samp> and
                              lower triangle of <samp class="ph codeph">A</samp> is destroyed after <samp class="ph codeph">potrfBatched</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of potrfBatched</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">indicates if lower or upper part is stored,
                                          the other part is used as a workspace.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Aarray</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">array of pointers to &lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with 
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store each matrix <samp class="ph codeph">Aarray[i]</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">infoArray</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">array of size <samp class="ph codeph">batchSize</samp>.
                                          <samp class="ph codeph">infoArray[i]</samp> contains information of factorization of <samp class="ph codeph">Aarray[i]</samp>.
                                          if <samp class="ph codeph">potrfBatched</samp> returns <samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp>,
                                          <samp class="ph codeph">infoArray[0] = -i</samp> (less than zero) means the <samp class="ph codeph">i-th</samp>
                                          parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">potrfBatched</samp> returns <samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp>,
                                          <samp class="ph codeph">infoArray[i] = 0</samp> means the Cholesky factorization of 
                                          <samp class="ph codeph">i-th</samp> matrix is successful, and 
                                          <samp class="ph codeph">infoArray[i] = k</samp> means the leading submatrix of order k of <samp class="ph codeph">i-th</samp> matrix is not positive definite.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">batchSize</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of pointers in <samp class="ph codeph">Aarray</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp> or <samp class="ph codeph">lda&lt;max(1,n)</samp>
                                          or <samp class="ph codeph">batchSize&lt;1</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-potrsBatched"><a name="cuds-lt-t-gt-potrsBatched" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-potrsBatched" name="cuds-lt-t-gt-potrsBatched" shape="rect">cusolverDn&lt;t&gt;potrsBatched()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSpotrsBatched(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    int nrhs,
    float *Aarray[],
    int lda,
    float *Barray[],
    int ldb,
    int *info,
    int batchSize);

cusolverStatus_t 
cusolverDnDpotrsBatched(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    int nrhs, 
    double *Aarray[],
    int lda,
    double *Barray[],
    int ldb,
    int *info,
    int batchSize);

cusolverStatus_t
cusolverDnCpotrsBatched(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    int nrhs,
    cuComplex *Aarray[],
    int lda,
    cuComplex *Barray[],
    int ldb,
    int *info,
    int batchSize);

cusolverStatus_t
cusolverDnZpotrsBatched(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    int nrhs,
    cuDoubleComplex *Aarray[],
    int lda,
    cuDoubleComplex *Barray[],
    int ldb,
    int *info,
    int batchSize);

</pre><p class="p">
                              This function solves a squence of linear systems
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A[i]</mi>
                                             <mo>*</mo>
                                             <mi>X[i]</mi>
                                             <mo>=</mo>
                                             <mi>B[i]</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where each <samp class="ph codeph">Aarray[i] for i=0,1,..., batchSize-1</samp> is a 
                              <samp class="ph codeph">n×n</samp> Hermitian matrix, 
                              only lower or upper part is meaningful. 
                              The input parameter <samp class="ph codeph">uplo</samp> indicates which part of the matrix is used. 
                              
                           </p>
                           <p class="p">
                              The user has to call <samp class="ph codeph">potrfBatched</samp> first to factorize matrix <samp class="ph codeph">Aarray[i]</samp>.
                              If input parameter <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>,   
                              <samp class="ph codeph">A</samp> is lower triangular Cholesky factor <samp class="ph codeph">L</samp>
                              correspoding to
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>=</mo>
                                 <mi>L</mi>
                                 <mo>*</mo>
                                 <msup>
                                    <mi>L</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              
                              .
                              
                              If input parameter <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,   
                              <samp class="ph codeph">A</samp> is upper triangular Cholesky factor <samp class="ph codeph">U</samp>
                              corresponding to
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>=</mo>
                                 <msup>
                                    <mi>U</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                                 <mo>*</mo>
                                 <mi>U</mi>
                              </math>
                              
                              .   
                              
                           </p>
                           <p class="p">
                              The operation is in-place, i.e. matrix <samp class="ph codeph">X</samp> overwrites matrix <samp class="ph codeph">B</samp>
                              with the same leading dimension <samp class="ph codeph">ldb</samp>.
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">info</samp> is a scalar.
                              If <samp class="ph codeph">info = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <p class="p">
                              Remark 1: only <samp class="ph codeph">nrhs=1</samp> is supported.
                              
                           </p>
                           <p class="p">
                              Remark 2: <samp class="ph codeph">infoArray</samp> from <samp class="ph codeph">potrfBatched</samp> indicates if 
                              the matrix is positive definite. <samp class="ph codeph">info</samp> from <samp class="ph codeph">potrsBatched</samp>
                              only shows which input parameter is wrong (not counting handle).
                              
                           </p>
                           <p class="p">
                              Remark 3: the other part of <samp class="ph codeph">A</samp> is used as a workspace.
                              For example, if <samp class="ph codeph">uplo</samp> is <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,
                              upper triangle of <samp class="ph codeph">A</samp> contains cholesky factor <samp class="ph codeph">U</samp> and
                              lower triangle of <samp class="ph codeph">A</samp> is destroyed after <samp class="ph codeph">potrsBatched</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of potrsBatched</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolveDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">indicates if matrix <samp class="ph codeph">A</samp> lower or upper part is stored.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nrhs</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">X</samp> and <samp class="ph codeph">B</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Aarray</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">array of pointers to &lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with 
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          <samp class="ph codeph">Aarray[i]</samp> is either lower cholesky factor <samp class="ph codeph">L</samp> or
                                          upper Cholesky factor <samp class="ph codeph">U</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store each matrix <samp class="ph codeph">Aarray[i]</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Barray</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">array of pointers to &lt;type&gt; array of dimension <samp class="ph codeph">ldb * nrhs</samp>.
                                          <samp class="ph codeph">ldb</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          As an input, <samp class="ph codeph">Barray[i]</samp> is right hand side matrix.
                                          As an output, <samp class="ph codeph">Barray[i]</samp> is the solution matrix.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store each matrix <samp class="ph codeph">Barray[i]</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">info = 0</samp>, all parameters are correct.
                                          if <samp class="ph codeph">info = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">batchSize</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of pointers in <samp class="ph codeph">Aarray</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp>, 
                                          <samp class="ph codeph">nrhs&lt;0</samp>, <samp class="ph codeph">lda&lt;max(1,n)</samp>,
                                          <samp class="ph codeph">ldb&lt;max(1,n)</samp> or 
                                          <samp class="ph codeph">batchSize&lt;0</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cuds-eigensolver-reference"><a name="cuds-eigensolver-reference" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cuds-eigensolver-reference" name="cuds-eigensolver-reference" shape="rect">Dense Eigenvalue Solver Reference</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter describes eigenvalue solver API of cuSolverDN, 
                           including bidiagonalization and SVD.
                           
                        </p>
                     </div>
                     <div class="topic concept nested2" id="cusolverDn-lt-t-gt-gebrd"><a name="cusolverDn-lt-t-gt-gebrd" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDn-lt-t-gt-gebrd" name="cusolverDn-lt-t-gt-gebrd" shape="rect">cusolverDn&lt;t&gt;gebrd()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              These helper functions calculate the size of work buffers needed.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSgebrd_bufferSize(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int *Lwork );

cusolverStatus_t 
cusolverDnDgebrd_bufferSize(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int *Lwork );

cusolverStatus_t
cusolverDnCgebrd_bufferSize(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int *Lwork );

cusolverStatus_t 
cusolverDnZgebrd_bufferSize(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int *Lwork );
</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSgebrd(cusolverDnHandle_t handle,
           int m,
           int n,
           float *A,
           int lda,
           float *D,
           float *E,
           float *TAUQ,
           float *TAUP,
           float *Work,
           int Lwork,
           int *devInfo );

cusolverStatus_t 
cusolverDnDgebrd(cusolverDnHandle_t handle,
           int m,
           int n,
           double *A,
           int lda,
           double *D,
           double *E,
           double *TAUQ,
           double *TAUP,
           double *Work,
           int Lwork,
           int *devInfo );
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCgebrd(cusolverDnHandle_t handle,
           int m,
           int n,
           cuComplex *A,
           int lda,
           float *D,
           float *E,
           cuComplex *TAUQ,
           cuComplex *TAUP,
           cuComplex *Work,
           int Lwork,
           int *devInfo );

cusolverStatus_t 
cusolverDnZgebrd(cusolverDnHandle_t handle,
           int m,
           int n,
           cuDoubleComplex *A,
           int lda,
           double *D,
           double *E,
           cuDoubleComplex *TAUQ,
           cuDoubleComplex *TAUP,
           cuDoubleComplex *Work,
           int Lwork,
           int *devInfo );
</pre></div>
                           <p class="p">
                              This function reduces a general <samp class="ph codeph">m×n</samp> matrix <samp class="ph codeph">A</samp> 
                              to a real upper or lower bidiagonal form <samp class="ph codeph">B</samp> by an orthogonal transformation: 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msup>
                                    <mi>Q</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                                 <mo>*</mo>
                                 <mi>A</mi>
                                 <mo>*</mo>
                                 <mi>P</mi>
                                 <mo>=</mo>
                                 <mi>B</mi>
                              </math>
                           </p>
                           <p class="p">
                              If <samp class="ph codeph">m&gt;=n</samp>, <samp class="ph codeph">B</samp> is upper bidiagonal; 
                              if <samp class="ph codeph">m&lt;n</samp>, <samp class="ph codeph">B</samp> is lower bidiagonal.
                              
                           </p>
                           <p class="p">
                              The matrix <samp class="ph codeph">Q</samp> and <samp class="ph codeph">P</samp> are overwritten into 
                              matrix <samp class="ph codeph">A</samp> in the following sense:
                              
                           </p>
                           <p class="p">
                              if <samp class="ph codeph">m&gt;=n</samp>, the diagonal and the first superdiagonal are
                              overwritten with the upper bidiagonal matrix <samp class="ph codeph">B</samp>; 
                              the elements below the diagonal, with the array <samp class="ph codeph">TAUQ</samp>, 
                              represent the orthogonal matrix <samp class="ph codeph">Q</samp> as a product of elementary
                              reflectors, and the elements above the first superdiagonal,
                              with the array <samp class="ph codeph">TAUP</samp>, represent the orthogonal matrix <samp class="ph codeph">P</samp> 
                              as a product of elementary reflectors.
                              
                           </p>
                           <p class="p">
                              if <samp class="ph codeph">m&lt;n</samp>, the diagonal and the first subdiagonal are
                              overwritten with the lower bidiagonal matrix <samp class="ph codeph">B</samp>; 
                              the elements below the first subdiagonal, with the array <samp class="ph codeph">TAUQ</samp>,
                              represent the orthogonal matrix <samp class="ph codeph">Q</samp> as a product of
                              elementary reflectors, and the elements above the diagonal,
                              with the array <samp class="ph codeph">TAUP</samp>, represent the orthogonal matrix <samp class="ph codeph">P</samp> 
                              as a product of elementary reflectors.
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">Work</samp>.
                              The input parameter <samp class="ph codeph">Lwork</samp> is size of the working space, and it is returned by
                              <samp class="ph codeph">gebrd_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <p class="p">
                              Remark: <samp class="ph codeph">gebrd</samp> only supports <samp class="ph codeph">m&gt;=n</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of gebrd</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">D</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">real array of dimension <samp class="ph codeph">min(m,n)</samp>.
                                          The diagonal elements of the bidiagonal matrix <samp class="ph codeph">B</samp>:
                                          <samp class="ph codeph">D(i) = A(i,i)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">E</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">real array of dimension <samp class="ph codeph">min(m,n)</samp>.
                                          The off-diagonal elements of the bidiagonal matrix <samp class="ph codeph">B</samp>:
                                          if <samp class="ph codeph">m&gt;=n</samp>,
                                          <samp class="ph codeph">E(i) = A(i,i+1)</samp> for <samp class="ph codeph">i = 1,2,...,n-1</samp>;
                                          if <samp class="ph codeph">m&lt;n</samp>,
                                          <samp class="ph codeph">E(i) = A(i+1,i)</samp> for <samp class="ph codeph">i = 1,2,...,m-1</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">TAUQ</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">min(m,n)</samp>.
                                          The scalar factors of the elementary reflectors which
                                          represent the orthogonal matrix <samp class="ph codeph">Q</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">TAUP</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">min(m,n)</samp>.
                                          The scalar factors of the elementary reflectors which
                                          represent the orthogonal matrix <samp class="ph codeph">P</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">Lwork</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">Work</samp>, returned by <samp class="ph codeph">gebrd_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp>,
                                          or <samp class="ph codeph">lda&lt;max(1,m)</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-orgbr"><a name="cuds-lt-t-gt-orgbr" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-orgbr" name="cuds-lt-t-gt-orgbr" shape="rect">cusolverDn&lt;t&gt;orgbr()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              These helper functions calculate the size of work buffers needed.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSorgbr_bufferSize(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    int m,
    int n,
    int k,
    const float *A,
    int lda,
    const float *tau,
    int *lwork);

cusolverStatus_t
cusolverDnDorgbr_bufferSize(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    int m,
    int n,
    int k,
    const double *A,
    int lda,
    const double *tau,
    int *lwork);

cusolverStatus_t 
cusolverDnCungbr_bufferSize(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    int m,
    int n,
    int k,
    const cuComplex *A,
    int lda,
    const cuComplex *tau,
    int *lwork);

cusolverStatus_t 
cusolverDnZungbr_bufferSize(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    int m,
    int n,
    int k,
    const cuDoubleComplex *A,
    int lda,
    const cuDoubleComplex *tau,
    int *lwork);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSorgbr(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    int m,
    int n,
    int k,
    float *A,
    int lda,
    const float *tau,
    float *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnDorgbr(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    int m,
    int n,
    int k,
    double *A,
    int lda,
    const double *tau,
    double *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCungbr(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    int m,
    int n,
    int k,
    cuComplex *A,
    int lda,
    const cuComplex *tau,
    cuComplex *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnZungbr(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    int m,
    int n,
    int k,
    cuDoubleComplex *A,
    int lda,
    const cuDoubleComplex *tau,
    cuDoubleComplex *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <p class="p">
                              This function generates one of the unitary matrices <samp class="ph codeph">Q</samp> or 
                              <samp class="ph codeph">P**H</samp> determined by <samp class="ph codeph">gebrd</samp> when reducing a 
                              matrix A to bidiagonal form:
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msup>
                                    <mi>Q</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                                 <mo>*</mo>
                                 <mi>A</mi>
                                 <mo>*</mo>
                                 <mi>P</mi>
                                 <mo>=</mo>
                                 <mi>B</mi>
                              </math>
                           </p>
                           <p class="p"><samp class="ph codeph">Q</samp> and <samp class="ph codeph">P**H</samp> are defined as products of 
                              elementary reflectors H(i) or G(i) respectively.
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is size of the working space, and it is returned by 
                              <samp class="ph codeph">orgbr_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of orgbr</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">side</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">
                                          if <samp class="ph codeph">side</samp> = <samp class="ph codeph">CUBLAS_SIDE_LEFT</samp>, 
                                          generate Q.
                                          if <samp class="ph codeph">side</samp> = <samp class="ph codeph">CUBLAS_SIDE_RIGHT</samp>, 
                                          generate P**T.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">Q</samp> or <samp class="ph codeph">P**T</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">
                                          if <samp class="ph codeph">side</samp> = <samp class="ph codeph">CUBLAS_SIDE_LEFT</samp>,
                                          m&gt;= n&gt;= min(m,k). 
                                          if <samp class="ph codeph">side</samp> = <samp class="ph codeph">CUBLAS_SIDE_RIGHT</samp>, 
                                          n&gt;= m&gt;= min(n,k). 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">k</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">
                                          if <samp class="ph codeph">side</samp> = <samp class="ph codeph">CUBLAS_SIDE_LEFT</samp>,
                                          the number of columns in the original m-by-k matrix reduced by <samp class="ph codeph">gebrd</samp>.
                                          
                                          if <samp class="ph codeph">side</samp> = <samp class="ph codeph">CUBLAS_SIDE_RIGHT</samp>,
                                          the number of rows in the original k-by-n matrix reduced by <samp class="ph codeph">gebrd</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp>
                                          On entry, the vectors which define the elementary reflectors, 
                                          as returned by <samp class="ph codeph">gebrd</samp>.
                                          On exit, the m-by-n matrix <samp class="ph codeph">Q</samp> or <samp class="ph codeph">P**T</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>. 
                                          lda &gt;= max(1,m);
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tau</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">min(m,k)</samp>
                                          if <samp class="ph codeph">side</samp> is <samp class="ph codeph">CUBLAS_SIDE_LEFT</samp>;
                                          of dimension <samp class="ph codeph">min(n,k)</samp>
                                          if <samp class="ph codeph">side</samp> is <samp class="ph codeph">CUBLAS_SIDE_RIGHT</samp>;
                                          tau(i) must contain the scalar factor of the elementary
                                          reflector H(i) or G(i), which determines Q or P**T, as
                                          returned by <samp class="ph codeph">gebrd</samp> in its array argument 
                                          <samp class="ph codeph">TAUQ</samp> or <samp class="ph codeph">TAUP</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of working array <samp class="ph codeph">work</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">info = 0</samp>, the ormqr is successful.
                                          if <samp class="ph codeph">info = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          	
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp> or wrong <samp class="ph codeph">lda</samp>
                                          ).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolverDn-lt-t-gt-sytrd"><a name="cusolverDn-lt-t-gt-sytrd" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverDn-lt-t-gt-sytrd" name="cusolverDn-lt-t-gt-sytrd" shape="rect">cusolverDn&lt;t&gt;sytrd()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              These helper functions calculate the size of work buffers needed.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSsytrd_bufferSize(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    const float *A,
    int lda,
    const float *d,
    const float *e,
    const float *tau,
    int *lwork);

cusolverStatus_t 
cusolverDnDsytrd_bufferSize(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    const double *A,
    int lda,
    const double *d,
    const double *e,
    const double *tau,
    int *lwork);

cusolverStatus_t
cusolverDnChetrd_bufferSize(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    const cuComplex *A,
    int lda,
    const float *d,
    const float *e,
    const cuComplex *tau,
    int *lwork);

cusolverStatus_t 
cusolverDnZhetrd_bufferSize(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    const cuDoubleComplex *A,
    int lda,
    const double *d,
    const double *e,
    const cuDoubleComplex *tau,
    int *lwork);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSsytrd(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    float *A,
    int lda,
    float *d,
    float *e,
    float *tau,
    float *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnDsytrd(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    double *A,
    int lda,
    double *d,
    double *e,
    double *tau,
    double *work,
    int lwork,
    int *devInfo);
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnChetrd(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    cuComplex *A,
    int lda,
    float *d,
    float *e,
    cuComplex *tau,
    cuComplex *work,
    int lwork,
    int *devInfo);

cusolverStatus_t CUDENSEAPI cusolverDnZhetrd(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    cuDoubleComplex *A,
    int lda,
    double *d,
    double *e,
    cuDoubleComplex *tau,
    cuDoubleComplex *work,
    int lwork,
    int *devInfo);
</pre></div>
                           <p class="p">
                              This function reduces a general symmetric (Hermitian) <samp class="ph codeph">n×n</samp> matrix 
                              <samp class="ph codeph">A</samp> to real symmetric tridiagonal form <samp class="ph codeph">T</samp> by an orthogonal transformation: 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msup>
                                    <mi>Q</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                                 <mo>*</mo>
                                 <mi>A</mi>
                                 <mo>*</mo>
                                 <mi>Q</mi>
                                 <mo>=</mo>
                                 <mi>T</mi>
                              </math>
                           </p>
                           <p class="p">
                              As an output, <samp class="ph codeph">A</samp> contains <samp class="ph codeph">T</samp> and householder reflection vectors.
                              If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,
                              the diagonal and first superdiagonal of <samp class="ph codeph">A</samp> are overwritten 
                              by the corresponding elements of the tridiagonal matrix <samp class="ph codeph">T</samp>, 
                              and the elements above the first superdiagonal, with the array <samp class="ph codeph">tau</samp>, 
                              represent the orthogonal matrix <samp class="ph codeph">Q</samp> as a product of elementary reflectors; 
                              
                              If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>,
                              the diagonal and first subdiagonal of <samp class="ph codeph">A</samp> are overwritten 
                              by the corresponding elements of the tridiagonal matrix <samp class="ph codeph">T</samp>, 
                              and the elements below the first subdiagonal, with the array <samp class="ph codeph">tau</samp>, 
                              represent the orthogonal matrix <samp class="ph codeph">Q</samp> as a product of elementary reflectors.
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is size of the working space, and it is returned by
                              <samp class="ph codeph">sytrd_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of sytrd</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies which part of <samp class="ph codeph">A</samp> is stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>:
                                          Lower triangle of <samp class="ph codeph">A</samp> is stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>:
                                          Upper triangle of <samp class="ph codeph">A</samp> is stored.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows (columns) of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,
                                          the leading n-by-n upper triangular part of <samp class="ph codeph">A</samp>
                                          contains the upper triangular part of the matrix <samp class="ph codeph">A</samp>,
                                          and the strictly lower triangular part of <samp class="ph codeph">A</samp> is not referenced.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>,
                                          the leading n-by-n lower triangular part of <samp class="ph codeph">A</samp>
                                          contains the lower triangular part of the matrix <samp class="ph codeph">A</samp>,
                                          and the strictly upper triangular part of <samp class="ph codeph">A</samp> is not referenced.
                                          On exit, <samp class="ph codeph">A</samp> is overwritten by <samp class="ph codeph">T</samp>
                                          and householder reflection vectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>.
                                          <samp class="ph codeph">lda &gt;= max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">D</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">real array of dimension <samp class="ph codeph">n</samp>.
                                          The diagonal elements of the tridiagonal matrix <samp class="ph codeph">T</samp>:
                                          <samp class="ph codeph">D(i) = A(i,i)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">E</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">real array of dimension <samp class="ph codeph">(n-1)</samp>.
                                          The off-diagonal elements of the tridiagonal matrix <samp class="ph codeph">T</samp>:
                                          if <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,
                                          <samp class="ph codeph">E(i) = A(i,i+1)</samp>.
                                          if <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp><samp class="ph codeph">E(i) = A(i+1,i)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tau</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">(n-1)</samp>.
                                          The scalar factors of the elementary reflectors which
                                          represent the orthogonal matrix <samp class="ph codeph">Q</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">work</samp>, returned by <samp class="ph codeph">sytrd_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp>, 
                                          or <samp class="ph codeph">lda&lt;max(1,n)</samp>, or
                                          <samp class="ph codeph">uplo</samp> is not <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp> or
                                          <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-ormtr"><a name="cuds-lt-t-gt-ormtr" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-ormtr" name="cuds-lt-t-gt-ormtr" shape="rect">cusolverDn&lt;t&gt;ormtr()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              These helper functions calculate the size of work buffers needed.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSormtr_bufferSize(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    cublasFillMode_t uplo,
    cublasOperation_t trans,
    int m,
    int n,
    const float *A,
    int lda,
    const float *tau,
    const float *C,
    int ldc,
    int *lwork);

cusolverStatus_t 
cusolverDnDormtr_bufferSize(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    cublasFillMode_t uplo,
    cublasOperation_t trans,
    int m,
    int n,
    const double *A,
    int lda,
    const double *tau,
    const double *C,
    int ldc,
    int *lwork);

cusolverStatus_t 
cusolverDnCunmtr_bufferSize(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    cublasFillMode_t uplo,
    cublasOperation_t trans,
    int m,
    int n,
    const cuComplex *A,
    int lda,
    const cuComplex *tau,
    const cuComplex *C,
    int ldc,
    int *lwork);

cusolverStatus_t 
cusolverDnZunmtr_bufferSize(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    cublasFillMode_t uplo,
    cublasOperation_t trans,
    int m,
    int n,
    const cuDoubleComplex *A,
    int lda,
    const cuDoubleComplex *tau,
    const cuDoubleComplex *C,
    int ldc,
    int *lwork);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSormtr(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    cublasFillMode_t uplo,
    cublasOperation_t trans,
    int m,
    int n,
    float *A,
    int lda,
    float *tau,
    float *C,
    int ldc,
    float *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnDormtr(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    cublasFillMode_t uplo,
    cublasOperation_t trans,
    int m,
    int n,
    double *A,
    int lda,
    double *tau,
    double *C,
    int ldc,
    double *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCunmtr(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    cublasFillMode_t uplo,
    cublasOperation_t trans,
    int m,
    int n,
    cuComplex *A,
    int lda,
    cuComplex *tau,
    cuComplex *C,
    int ldc,
    cuComplex *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnZunmtr(
    cusolverDnHandle_t handle,
    cublasSideMode_t side,
    cublasFillMode_t uplo,
    cublasOperation_t trans,
    int m,
    int n,
    cuDoubleComplex *A,
    int lda,
    cuDoubleComplex *tau,
    cuDoubleComplex *C,
    int ldc,
    cuDoubleComplex *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <p class="p">
                              This function overwrites <samp class="ph codeph">m×n</samp> matrix <samp class="ph codeph">C</samp> by
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>C</mi>
                                             <mo>=</mo>
                                             <mfenced open="{" close="">
                                                <mtable columnalign="left left" rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mtext>op</mtext>
                                                         <mo stretchy="false">(</mo>
                                                         <mi>Q</mi>
                                                         <mo stretchy="false">)</mo>
                                                         <mo>*</mo>
                                                         <mi>C</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">side == CUBLAS_SIDE_LEFT</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>C</mi>
                                                         <mo>*</mo>
                                                         <mtext>op</mtext>
                                                         <mo stretchy="false">(</mo>
                                                         <mi>Q</mi>
                                                         <mo stretchy="false">)</mo>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">side == CUBLAS_SIDE_RIGHT</mtext>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">Q</samp> is a unitary matrix formed by a sequence of elementary reflection vectors 
                              from <samp class="ph codeph">sytrd</samp>.
                              
                           </p>
                           <p class="p">
                              The operation on <samp class="ph codeph">Q</samp> is defined by
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mtext>op</mtext>
                                             <mo stretchy="false">(</mo>
                                             <mi>Q</mi>
                                             <mo stretchy="false">)</mo>
                                             <mo>=</mo>
                                             <mfenced open="{" close="">
                                                <mtable columnalign="left left" rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>Q</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">transa == CUBLAS_OP_N</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msup>
                                                            <mi>Q</mi>
                                                            <mi>T</mi>
                                                         </msup>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">transa == CUBLAS_OP_T</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msup>
                                                            <mi>Q</mi>
                                                            <mi>H</mi>
                                                         </msup>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">transa == CUBLAS_OP_C</mtext>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is size of the working space, and it is returned by 
                              <samp class="ph codeph">ormtr_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of ormtr</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">side</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">side</samp> = <samp class="ph codeph">CUBLAS_SIDE_LEFT</samp>, 
                                          apply Q or Q**T from the Left;
                                          <samp class="ph codeph">side</samp> = <samp class="ph codeph">CUBLAS_SIDE_RIGHT</samp>, 
                                          apply Q or Q**T from the Right.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>:
                                          Lower triangle of <samp class="ph codeph">A</samp> contains elementary reflectors from <samp class="ph codeph">sytrd</samp>.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>:
                                          Upper triangle of <samp class="ph codeph">A</samp> contains elementary reflectors from <samp class="ph codeph">sytrd</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">trans</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">operation <samp class="ph codeph">op(Q)</samp> that is non- or (conj.) transpose.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">C</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">C</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * m</samp>
                                          if <samp class="ph codeph">side</samp> = <samp class="ph codeph">CUBLAS_SIDE_LEFT</samp>; 
                                          <samp class="ph codeph">lda * n</samp> if <samp class="ph codeph">side</samp> = <samp class="ph codeph">CUBLAS_SIDE_RIGHT</samp>.
                                          The matrix <samp class="ph codeph">A</samp> from <samp class="ph codeph">sytrd</samp>
                                          contains the elementary reflectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>. 
                                          if <samp class="ph codeph">side</samp> is <samp class="ph codeph">CUBLAS_SIDE_LEFT</samp>, lda &gt;= max(1,m);
                                          if <samp class="ph codeph">side</samp> is <samp class="ph codeph">CUBLAS_SIDE_RIGHT</samp>, lda &gt;= max(1,n).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tau</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">(m-1)</samp>
                                          if <samp class="ph codeph">side</samp> is <samp class="ph codeph">CUBLAS_SIDE_LEFT</samp>;
                                          of dimension <samp class="ph codeph">(n-1)</samp>
                                          if <samp class="ph codeph">side</samp> is <samp class="ph codeph">CUBLAS_SIDE_RIGHT</samp>;
                                          The vector <samp class="ph codeph">tau</samp> is from <samp class="ph codeph">sytrd</samp>, so
                                          <samp class="ph codeph">tau(i)</samp> is the scalar of i-th elementary reflection vector.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">C</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of size <samp class="ph codeph">ldc * n</samp>.
                                          On exit, <samp class="ph codeph">C</samp> is overwritten by 
                                          <samp class="ph codeph">op(Q)*C</samp> or <samp class="ph codeph">C*op(Q)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldc</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array of matrix <samp class="ph codeph">C</samp>.
                                          ldc &gt;= max(1,m).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of working array <samp class="ph codeph">work</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the ormqr is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          	
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp> or wrong <samp class="ph codeph">lda</samp>
                                          or <samp class="ph codeph">ldc</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-orgtr"><a name="cuds-lt-t-gt-orgtr" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-orgtr" name="cuds-lt-t-gt-orgtr" shape="rect">cusolverDn&lt;t&gt;orgtr()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              These helper functions calculate the size of work buffers needed.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSorgtr_bufferSize(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    const float *A,
    int lda,
    const float *tau,
    int *lwork);

cusolverStatus_t 
cusolverDnDorgtr_bufferSize(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    const double *A,
    int lda,
    const double *tau,
    int *lwork);

cusolverStatus_t 
cusolverDnCungtr_bufferSize(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    const cuComplex *A,
    int lda,
    const cuComplex *tau,
    int *lwork);

cusolverStatus_t 
cusolverDnZungtr_bufferSize(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    const cuDoubleComplex *A,
    int lda,
    const cuDoubleComplex *tau,
    int *lwork);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSorgtr(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    float *A,
    int lda,
    const float *tau,
    float *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnDorgtr(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    double *A,
    int lda,
    const double *tau,
    double *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCungtr(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    cuComplex *A,
    int lda,
    const cuComplex *tau,
    cuComplex *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnZungtr(
    cusolverDnHandle_t handle,
    cublasFillMode_t uplo,
    int n,
    cuDoubleComplex *A,
    int lda,
    const cuDoubleComplex *tau,
    cuDoubleComplex *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <p class="p">
                              This function generates a unitary matrix <samp class="ph codeph">Q</samp> which is defined as the  
                              product of n-1 elementary reflectors of order n, as returned by <samp class="ph codeph">sytrd</samp>:
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is size of the working space, and it is returned by 
                              <samp class="ph codeph">orgtr_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of orgtr</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>:
                                          Lower triangle of <samp class="ph codeph">A</samp> contains elementary reflectors from <samp class="ph codeph">sytrd</samp>.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>:
                                          Upper triangle of <samp class="ph codeph">A</samp> contains elementary reflectors from <samp class="ph codeph">sytrd</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows (columns) of matrix <samp class="ph codeph">Q</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp>
                                          On entry, matrix <samp class="ph codeph">A</samp> from <samp class="ph codeph">sytrd</samp>
                                          contains the elementary reflectors.
                                          On exit, matrix <samp class="ph codeph">A</samp> contains the n-by-n orthogonal matrix <samp class="ph codeph">Q</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>. 
                                          lda &gt;= max(1,n).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tau</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">(n-1)</samp><samp class="ph codeph">tau(i)</samp> is the scalar of i-th elementary reflection vector.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of working array <samp class="ph codeph">work</samp>.
                                          	
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the orgtr is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          	
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp> or wrong <samp class="ph codeph">lda</samp>
                                          ).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-gesvd"><a name="cuds-lt-t-gt-gesvd" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-gesvd" name="cuds-lt-t-gt-gesvd" shape="rect">cusolverDn&lt;t&gt;gesvd()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The helper functions below can calculate the sizes needed for pre-allocated buffer.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSgesvd_bufferSize(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int *lwork );

cusolverStatus_t 
cusolverDnDgesvd_bufferSize(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int *lwork );

cusolverStatus_t 
cusolverDnCgesvd_bufferSize(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int *lwork );

cusolverStatus_t
cusolverDnZgesvd_bufferSize(
    cusolverDnHandle_t handle,
    int m,
    int n,
    int *lwork );

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively. 
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSgesvd (
    cusolverDnHandle_t handle,
    signed char jobu,
    signed char jobvt,
    int m,
    int n,
    float *A,
    int lda,
    float *S,
    float *U,
    int ldu,
    float *VT,
    int ldvt,
    float *work,
    int lwork,
    float *rwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnDgesvd (
    cusolverDnHandle_t handle,
    signed char jobu,
    signed char jobvt,
    int m,
    int n,
    double *A,
    int lda,
    double *S,
    double *U,
    int ldu,
    double *VT,
    int ldvt,
    double *work,
    int lwork,
    double *rwork,
    int *devInfo);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively. 
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCgesvd (
    cusolverDnHandle_t handle,
    signed char jobu,
    signed char jobvt,
    int m,
    int n,
    cuComplex *A,
    int lda,
    float *S,
    cuComplex *U,
    int ldu,
    cuComplex *VT,
    int ldvt,
    cuComplex *work,
    int lwork,
    float *rwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnZgesvd (
    cusolverDnHandle_t handle,
    signed char jobu,
    signed char jobvt,
    int m,
    int n,
    cuDoubleComplex *A,
    int lda,
    double *S,
    cuDoubleComplex *U,
    int ldu,
    cuDoubleComplex *VT,
    int ldvt,
    cuDoubleComplex *work,
    int lwork,
    double *rwork,
    int *devInfo);
</pre></div>
                           <p class="p">
                              This function computes the singular value decomposition (SVD) of a 
                              <samp class="ph codeph">m×n</samp> matrix <samp class="ph codeph">A</samp> and corresponding  
                              the left and/or right singular vectors. The SVD is written
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mi>U</mi>
                                             <mo>*</mo>
                                             <mi>Σ</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>V</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">Σ</samp> is an <samp class="ph codeph">m×n</samp> matrix which is zero except for its
                              <samp class="ph codeph">min(m,n)</samp> diagonal elements, 
                              <samp class="ph codeph">U</samp> is an <samp class="ph codeph">m×m</samp> unitary matrix, and
                              <samp class="ph codeph">V</samp> is an <samp class="ph codeph">n×n</samp> unitary matrix.  
                              The diagonal elements of <samp class="ph codeph">Σ</samp>
                              are the singular values of <samp class="ph codeph">A</samp>; they are real and non-negative, and
                              are returned in descending order. 
                              The first <samp class="ph codeph">min(m,n)</samp> columns of
                              <samp class="ph codeph">U</samp> and <samp class="ph codeph">V</samp> are the left and right singular vectors of <samp class="ph codeph">A</samp>.
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is size of the working space, and it is returned by
                              <samp class="ph codeph">gesvd_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              if <samp class="ph codeph">bdsqr</samp> did not converge, <samp class="ph codeph">devInfo</samp> specifies how many
                              superdiagonals of an intermediate bidiagonal form 
                              did not converge to zero. 
                              
                           </p>
                           <p class="p">
                              The <samp class="ph codeph">rwork</samp> is real array of dimension (min(m,n)-1). 
                              If <samp class="ph codeph">devInfo</samp>&gt;0 and <samp class="ph codeph">rwork</samp> is not nil, 
                              <samp class="ph codeph">rwork</samp> contains the unconverged 
                              superdiagonal elements of an upper bidiagonal matrix. 
                              This is slightly different from LAPACK which puts unconverged superdiagonal elements in
                              <samp class="ph codeph">work</samp> if type is <samp class="ph codeph">real</samp>;
                              in <samp class="ph codeph">rwork</samp> if type is <samp class="ph codeph">complex</samp>.
                              <samp class="ph codeph">rwork</samp> can be a NULL pointer
                              if the user does not want the information from supperdiagonal. 
                              
                           </p>
                           <p class="p">
                              Appendix G.1 provides a simple example of <samp class="ph codeph">gesvd</samp>.
                              
                           </p>
                           <p class="p">
                              Remark 1: <samp class="ph codeph">gesvd</samp> only supports <samp class="ph codeph">m&gt;=n</samp>.
                              
                           </p>
                           <p class="p">
                              Remark 2: the routine returns
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msup>
                                    <mi>V</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              , not <samp class="ph codeph">V</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of gesvd</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">jobu</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options for computing all or part of the matrix <samp class="ph codeph">U</samp>:
                                          = 'A':  all m columns of U are returned in array U:
                                          = 'S':  the first min(m,n) columns of U (the left singular
                                          vectors) are returned in the array U;
                                          = 'O':  the first min(m,n) columns of U (the left singular
                                          vectors) are overwritten on the array A;
                                          = 'N':  no columns of U (no left singular vectors) are
                                          computed.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">jobvt</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options for computing all or part of the matrix V**T:
                                          = 'A':  all N rows of V**T are returned in the array VT;
                                          = 'S':  the first min(m,n) rows of V**T (the right singular
                                          vectors) are returned in the array VT;
                                          = 'O':  the first min(m,n) rows of V**T (the right singular
                                          vectors) are overwritten on the array A;
                                          = 'N':  no rows of V**T (no right singular vectors) are
                                          computed.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,m)</samp>.
                                          On exit, the contents of <samp class="ph codeph">A</samp> are destroyed.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">S</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">real array of dimension <samp class="ph codeph">min(m,n)</samp>.
                                          The singular values of A, sorted so that <samp class="ph codeph">S(i) &gt;= S(i+1)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">U</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">ldu * m</samp> with
                                          <samp class="ph codeph">ldu</samp> is not less than <samp class="ph codeph">max(1,m)</samp>.
                                          <samp class="ph codeph">U</samp> contains the <samp class="ph codeph">m×m</samp> 
                                          unitary matrix <samp class="ph codeph">U</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldu</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">U</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">VT</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">ldvt * n</samp> with
                                          <samp class="ph codeph">ldvt</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          <samp class="ph codeph">VT</samp> contains the <samp class="ph codeph">n×n</samp> 
                                          unitary matrix V**T.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldvt</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">Vt</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">work</samp>, returned by <samp class="ph codeph">gesvd_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">rwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">real array of dimension min(m,n)-1.
                                          It contains the unconverged superdiagonal elements of an upper bidiagonal matrix
                                          if <samp class="ph codeph">devInfo &gt; 0</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">devInfo &gt; 0</samp>, <samp class="ph codeph">devInfo</samp> indicates 
                                          how many superdiagonals of an intermediate 
                                          bidiagonal form did not converge to zero.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp> or 
                                          <samp class="ph codeph">lda&lt;max(1,m)</samp> or <samp class="ph codeph">ldu&lt;max(1,m)</samp> or
                                          <samp class="ph codeph">ldvt&lt;max(1,n)</samp> ).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-gesvdj"><a name="cuds-lt-t-gt-gesvdj" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-gesvdj" name="cuds-lt-t-gt-gesvdj" shape="rect">cusolverDn&lt;t&gt;gesvdj()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The helper functions below can calculate the sizes needed for pre-allocated buffer.
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnSgesvdj_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int econ,
    int m,
    int n, 
    const float *A,
    int lda,
    const float *S,
    const float *U,
    int ldu,
    const float *V,
    int ldv, 
    int *lwork,
    gesvdjInfo_t params);

cusolverStatus_t
cusolverDnDgesvdj_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    int econ,             
    int m,                
    int n,                
    const double *A,      
    int lda,             
    const double *S, 
    const double *U,      
    int ldu,              
    const double *V,      
    int ldv,              
    int *lwork,
    gesvdjInfo_t params);

cusolverStatus_t
cusolverDnCgesvdj_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    int econ,             
    int m,                
    int n,                
    const cuComplex *A,      
    int lda,             
    const float *S, 
    const cuComplex *U,      
    int ldu,              
    const cuComplex *V,      
    int ldv,              
    int *lwork,
    gesvdjInfo_t params);

cusolverStatus_t
cusolverDnZgesvdj_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    int econ,             
    int m,                
    int n,                
    const cuDoubleComplex *A,      
    int lda,             
    const double *S, 
    const cuDoubleComplex *U,      
    int ldu,              
    const cuDoubleComplex *V,      
    int ldv,              
    int *lwork,
    gesvdjInfo_t params);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively. 
                              <pre xml:space="preserve">

cusolverStatus_t 
cusolverDnSgesvdj(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int econ,
    int m,
    int n,
    float *A,
    int lda,
    float *S,
    float *U,
    int ldu,
    float *V,
    int ldv,
    float *work,
    int lwork,
    int *info,
    gesvdjInfo_t params);

cusolverStatus_t 
cusolverDnDgesvdj(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    int econ,             
    int m,                
    int n,                
    double *A,            
    int lda,              
    double *S,       
    double *U,            
    int ldu,              
    double *V,            
    int ldv,              
    double *work,
    int lwork,
    int *info,
    gesvdjInfo_t params);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively. 
                              <pre xml:space="preserve">

cusolverStatus_t 
cusolverDnCgesvdj(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    int econ,             
    int m,                
    int n,                
    cuComplex *A,            
    int lda,              
    float *S,       
    cuComplex *U,            
    int ldu,              
    cuComplex *V,            
    int ldv,              
    cuComplex *work,
    int lwork,
    int *info,
    gesvdjInfo_t params);

cusolverStatus_t 
cusolverDnZgesvdj(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    int econ,             
    int m,                
    int n,                
    cuDoubleComplex *A,            
    int lda,              
    double *S,       
    cuDoubleComplex *U,            
    int ldu,              
    cuDoubleComplex *V,            
    int ldv,              
    cuDoubleComplex *work,
    int lwork,
    int *info,
    gesvdjInfo_t params);

</pre></div>
                           <p class="p">
                              This function computes the singular value decomposition (SVD) of a 
                              <samp class="ph codeph">m×n</samp> matrix <samp class="ph codeph">A</samp> and corresponding  
                              the left and/or right singular vectors. The SVD is written
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mi>U</mi>
                                             <mo>*</mo>
                                             <mi>Σ</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>V</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">Σ</samp> is an <samp class="ph codeph">m×n</samp> matrix which is zero except for its
                              <samp class="ph codeph">min(m,n)</samp> diagonal elements, 
                              <samp class="ph codeph">U</samp> is an <samp class="ph codeph">m×m</samp> unitary matrix, and
                              <samp class="ph codeph">V</samp> is an <samp class="ph codeph">n×n</samp> unitary matrix.  
                              The diagonal elements of <samp class="ph codeph">Σ</samp>
                              are the singular values of <samp class="ph codeph">A</samp>; they are real and non-negative, and
                              are returned in descending order. 
                              The first <samp class="ph codeph">min(m,n)</samp> columns of
                              <samp class="ph codeph">U</samp> and <samp class="ph codeph">V</samp> are the left and right singular vectors of <samp class="ph codeph">A</samp>.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">gesvdj</samp> has the same functionality as <samp class="ph codeph">gesvd</samp>.
                              The difference is that <samp class="ph codeph">gesvd</samp> uses QR algorithm and <samp class="ph codeph">gesvdj</samp> uses Jacobi method.
                              The parallelism of Jacobi method gives GPU better performance on small and medium size matrices.
                              Moreover the user can configure <samp class="ph codeph">gesvdj</samp> to perform approximation up to certain accuracy.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">gesvdj</samp> iteratively generates a sequence of unitary matrices to transform matrix <samp class="ph codeph">A</samp>
                              to the following form
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>U</mi>
                                                <mi>H</mi>
                                             </msup>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <mi>V</mi>
                                             <mo>=</mo>
                                             <mi>S</mi>
                                             <mo>+</mo>
                                             <mi>E</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">S</samp> is diagonal and diagonal of <samp class="ph codeph">E</samp> is zero.
                              
                           </p>
                           <p class="p">
                              During the iterations, the Frobenius norm of <samp class="ph codeph">E</samp> decreases monotonically.
                              As <samp class="ph codeph">E</samp> goes down to zero, <samp class="ph codeph">S</samp> is the set of singular values.
                              In practice, Jacobi method stops if
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msub>
                                                <mi>||E||</mi>
                                                <mi>F</mi>
                                             </msub>
                                             <mi>≤</mi>
                                             <mo>eps</mo>
                                             <mo>*</mo>
                                             <msub>
                                                <mi>||A||</mi>
                                                <mi>F</mi>
                                             </msub>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">eps</samp> is given tolerance.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">gesvdj</samp> has two parameters to control the accuracy.
                              First parameter is tolerance (<samp class="ph codeph">eps</samp>).
                              The default value is machine accuracy but
                              The user can use function <samp class="ph codeph">cusolverDnXgesvdjSetTolerance</samp> to set a priori tolerance.
                              The second parameter is maximum number of sweeps which controls number of iterations of Jacobi method.
                              The default value is 100 but the user can use function <samp class="ph codeph">cusolverDnXgesvdjSetMaxSweeps</samp>
                              to set a proper bound. The experimentis show 15 sweeps are good enough to converge to machine accuracy.
                              <samp class="ph codeph">gesvdj</samp> stops either tolerance is met or maximum number of sweeps is met.
                              
                           </p>
                           <p class="p">
                              Jacobi method has quadratic convergence, so the accuracy is not proportional to number of sweeps.
                              To guarantee certain accuracy, the user should configure tolerance only.
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is the size of the working space, and it is returned by
                              <samp class="ph codeph">gesvdj_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">info = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle). If <samp class="ph codeph">info = min(m,n)+1</samp>,
                              <samp class="ph codeph">gesvdj</samp> does not converge under given tolerance and maximum sweeps.
                              
                           </p>
                           <p class="p">
                              If the user sets an improper tolerance, <samp class="ph codeph">gesvdj</samp> may not converge.
                              For example, tolerance should not be smaller than machine accuracy.
                              
                           </p>
                           <p class="p">
                              Appendix G.2 provides a simple example of <samp class="ph codeph">gesvdj</samp>.
                              
                           </p>
                           <p class="p">
                              Remark 1: <samp class="ph codeph">gesvdj</samp> supports any combination of <samp class="ph codeph">m</samp> and <samp class="ph codeph">n</samp>.
                              
                           </p>
                           <p class="p">
                              Remark 2: the routine returns
                              <samp class="ph codeph">V</samp>, not 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msup>
                                    <mi>V</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              . 
                              This is different from <samp class="ph codeph">gesvd</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of gesvdj</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">jobz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options to either compute singular value only or singular vectors as well:
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>
                                          : Compute singular values only;
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          : Compute singular values and singular vectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">econ</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">econ = 1 for economy size for <samp class="ph codeph">U</samp> and <samp class="ph codeph">V</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,m)</samp>.
                                          On exit, the contents of <samp class="ph codeph">A</samp> are destroyed.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">S</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">real array of dimension <samp class="ph codeph">min(m,n)</samp>.
                                          The singular values of A, sorted so that <samp class="ph codeph">S(i) &gt;= S(i+1)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">U</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">ldu * m</samp> if <samp class="ph codeph">econ</samp> is zero.
                                          If <samp class="ph codeph">econ</samp> is nonzero, the dimension is <samp class="ph codeph">ldu * min(m,n)</samp>.
                                          <samp class="ph codeph">U</samp> contains the left singular vectors. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldu</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">U</samp>.
                                          <samp class="ph codeph">ldu</samp> is not less than <samp class="ph codeph">max(1,m)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">V</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">ldv * n</samp> if <samp class="ph codeph">econ</samp> is zero.
                                          If <samp class="ph codeph">econ</samp> is nonzero, the dimension is <samp class="ph codeph">ldv * min(m,n)</samp>.
                                          <samp class="ph codeph">V</samp> contains the right singular vectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldv</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">V</samp>.
                                          <samp class="ph codeph">ldv</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of size <samp class="ph codeph">lwork</samp>, working space.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">work</samp>, returned by <samp class="ph codeph">gesvdj_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">info = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">info = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">info = min(m,n)+1</samp>, <samp class="ph codeph">gesvdj</samp> dose not converge
                                          under given tolerance and maximum sweeps.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">params</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">structure filled with parameters of Jacobi algorithm and results of gesvdj.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp> or 
                                          <samp class="ph codeph">lda&lt;max(1,m)</samp> or <samp class="ph codeph">ldu&lt;max(1,m)</samp> or
                                          <samp class="ph codeph">ldv&lt;max(1,n)</samp> or
                                          <samp class="ph codeph">jobz</samp> is not
                                          <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp> or <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          ).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-gesvdjbatch"><a name="cuds-lt-t-gt-gesvdjbatch" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-gesvdjbatch" name="cuds-lt-t-gt-gesvdjbatch" shape="rect">cusolverDn&lt;t&gt;gesvdjBatched()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The helper functions below can calculate the sizes needed for pre-allocated buffer.
                              
                              <pre xml:space="preserve">

cusolverStatus_t 
cusolverDnSgesvdjBatched_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int m,
    int n,
    const float *A,
    int lda,
    const float *S,
    const float *U,
    int ldu,
    const float *V,
    int ldv,
    int *lwork,
    gesvdjInfo_t params,
    int batchSize);

cusolverStatus_t 
cusolverDnDgesvdjBatched_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    int m,                
    int n,                
    const double *A,      
    int lda,              
    const double *S, 
    const double *U,      
    int ldu,              
    const double *V,     
    int ldv,              
    int *lwork,
    gesvdjInfo_t params,
    int batchSize);

cusolverStatus_t 
cusolverDnCgesvdjBatched_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    int m,                
    int n,                
    const cuComplex *A,      
    int lda,              
    const float *S, 
    const cuComplex *U,      
    int ldu,              
    const cuComplex *V,     
    int ldv,              
    int *lwork,
    gesvdjInfo_t params,
    int batchSize);

cusolverStatus_t 
cusolverDnZgesvdjBatched_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    int m,                
    int n,                
    const cuDoubleComplex *A,      
    int lda,              
    const double *S, 
    const cuDoubleComplex *U,      
    int ldu,              
    const cuDoubleComplex *V,     
    int ldv,              
    int *lwork,
    gesvdjInfo_t params,
    int batchSize);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively. 
                              <pre xml:space="preserve">

cusolverStatus_t
cusolverDnSgesvdjBatched(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int m,
    int n,
    float *A,
    int lda,
    float *S,
    float *U,
    int ldu,
    float *V,
    int ldv,
    float *work,
    int lwork,
    int *info,
    gesvdjInfo_t params,
    int batchSize);

cusolverStatus_t
cusolverDnDgesvdjBatched(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    int m,           
    int n,           
    double *A,       
    int lda,         
    double *S,  
    double *U,       
    int ldu,         
    double *V,       
    int ldv,         
    double *work,
    int lwork,
    int *info,       
    gesvdjInfo_t params,
    int batchSize);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively. 
                              
                              <pre xml:space="preserve">

cusolverStatus_t
cusolverDnCgesvdjBatched(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int m,
    int n,
    cuComplex *A,
    int lda,
    float *S,
    cuComplex *U,
    int ldu,
    cuComplex *V,
    int ldv,
    cuComplex *work,
    int lwork,
    int *info,
    gesvdjInfo_t params,
    int batchSize);

cusolverStatus_t
cusolverDnZgesvdjBatched(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int m,
    int n,
    cuDoubleComplex *A,
    int lda,
    double *S,
    cuDoubleComplex *U,
    int ldu,
    cuDoubleComplex *V,
    int ldv,
    cuDoubleComplex *work,
    int lwork,
    int *info,
    gesvdjInfo_t params,
    int batchSize);

</pre></div>
                           <p class="p">
                              This function computes singular values and singular vectors of a squence of general 
                              <samp class="ph codeph">m×n</samp> matrices
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msub>
                                                <mi>A</mi>
                                                <mi>j</mi>
                                             </msub>
                                             <mo>=</mo>
                                             <msub>
                                                <mi>U</mi>
                                                <mi>j</mi>
                                             </msub>
                                             <mo>*</mo>
                                             <msub>
                                                <mi>Σ</mi>
                                                <mi>j</mi>
                                             </msub>
                                             <mo>*</mo>
                                             <msubsup>
                                                <mi>V</mi>
                                                <mi>j</mi>
                                                <mi>H</mi>
                                             </msubsup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>Σ</mi>
                                    <mi>j</mi>
                                 </msub>
                              </math>
                              
                              
                              is a real <samp class="ph codeph">m×n</samp> diagonal matrix
                              which is zero except for its <samp class="ph codeph">min(m,n)</samp> diagonal elements.
                              
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>U</mi>
                                    <mi>j</mi>
                                 </msub>
                              </math>
                              
                              
                              (left singular vectors) is a <samp class="ph codeph">m×m</samp> unitary matrix and 
                              
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>V</mi>
                                    <mi>j</mi>
                                 </msub>
                              </math>
                              
                              
                              (right singular vectors) is a <samp class="ph codeph">n×n</samp> unitary matrix. 
                              
                              The diagonal elements of 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>Σ</mi>
                                    <mi>j</mi>
                                 </msub>
                              </math>
                              
                              
                              are the singular values of 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>j</mi>
                                 </msub>
                              </math>
                              
                              
                              in either descending order or non-sorting order. 
                              
                           </p>
                           <p class="p"><samp class="ph codeph">gesvdjBatched</samp> performs <samp class="ph codeph">gesvdj</samp> on each matrix.
                              It requires that all matrices are of the same size <samp class="ph codeph">m,n</samp> no greater than 32 
                              and are packed in contiguous way,
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>A</mi>
                                                <mo>=</mo>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mi>A0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>A1</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>⋯</mi>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              Each matrix is column-major with leading dimension <samp class="ph codeph">lda</samp>,
                              so the formula for random access is
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>k</mi>
                                 </msub>
                                 <mo>(i,j)</mo>
                                 <mo>=</mo>
                                 <mi>A[ i + lda*j + lda*n*k]</mi>
                              </math>
                              
                              .
                              
                           </p>
                           <p class="p">
                              The parameter <samp class="ph codeph">S</samp> also contains singular values of each matrix in contiguous way,
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>S</mi>
                                                <mo>=</mo>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mi>S0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>S1</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>⋯</mi>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The formula for random access of <samp class="ph codeph">S</samp> is
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>S</mi>
                                    <mi>k</mi>
                                 </msub>
                                 <mo>(j)</mo>
                                 <mo>=</mo>
                                 <mi>S[ j + min(m,n)*k]</mi>
                              </math>
                              
                              .
                              
                           </p>
                           <p class="p">
                              Except for tolerance and maximum sweeps, <samp class="ph codeph">gesvdjBatched</samp> can either sort 
                              the singular values in descending order (default) or chose as-is (without sorting) by the function
                              <samp class="ph codeph">cusolverDnXgesvdjSetSortEig</samp>.
                              If the user packs several tiny matrices into diagonal blocks of one matrix, 
                              non-sorting option can separate singular values of those tiny matrices. 
                              
                           </p>
                           <p class="p"><samp class="ph codeph">gesvdjBatched</samp> cannot report residual and executed sweeps by 
                              function <samp class="ph codeph">cusolverDnXgesvdjGetResidual</samp> and <samp class="ph codeph">cusolverDnXgesvdjGetSweeps</samp>.
                              Any call of the above two returns <samp class="ph codeph">CUSOLVER_STATUS_NOT_SUPPORTED</samp>.
                              The user needs to compute residual explicitly.
                              
                           </p>
                           <p class="p">
                              The user has to provide working space pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is the size of the working space, and it is returned by
                              <samp class="ph codeph">gesvdjBatched_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">info</samp> is an integer array of size <samp class="ph codeph">batchSize</samp>.
                              If the function returns <samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp>, 
                              the first element <samp class="ph codeph">info[0] = -i</samp> (less than zero) indicates <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              Otherwise, if <samp class="ph codeph">info[i] = min(m,n)+1</samp>, 
                              <samp class="ph codeph">gesvdjBatched</samp> does not converge on <samp class="ph codeph">i-th</samp> matrix 
                              under given tolerance and maximum sweeps.
                              
                           </p>
                           <p class="p">
                              Appendix G.3 provides a simple example of <samp class="ph codeph">gesvdjBatched</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of syevjBatched</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">jobz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options to either compute singular value only or singular vectors as well:
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>
                                          : Compute singular values only;
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          : Compute singular values and singular vectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">Aj</samp>.
                                          <samp class="ph codeph">m</samp> is no greater than 32.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">Aj</samp>.
                                          <samp class="ph codeph">n</samp> is no greater than 32.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n * batchSize</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          on Exit: the contents of <samp class="ph codeph">Aj</samp> are destroyed.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">Aj</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">S</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">a real array of dimension <samp class="ph codeph">min(m,n)*batchSize</samp>.
                                          It stores the singular values of <samp class="ph codeph">Aj</samp>
                                          in descending order or non-sorting order.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">U</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">ldu * m * batchSize</samp>.
                                          <samp class="ph codeph">Uj</samp> contains the left singular vectors of <samp class="ph codeph">Aj</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldu</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">Uj</samp>.
                                          <samp class="ph codeph">ldu</samp> is not less than <samp class="ph codeph">max(1,m)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">V</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">ldv * n * batchSize</samp>.
                                          <samp class="ph codeph">Vj</samp> contains the right singular vectors of <samp class="ph codeph">Aj</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldv</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">Vj</samp>.
                                          <samp class="ph codeph">ldv</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of size <samp class="ph codeph">lwork</samp>, working space.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">work</samp>, returned by <samp class="ph codeph">gesvdjBatched_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">an integer array of dimension <samp class="ph codeph">batchSize</samp>.
                                          If <samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp> is returned, 
                                          <samp class="ph codeph">info[0] = -i</samp> (less than zero) indicates <samp class="ph codeph">i-th</samp>
                                          parameter is wrong (not counting handle).
                                          Otherwise,
                                          if <samp class="ph codeph">info[i] = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">info[i] = min(m,n)+1</samp>, <samp class="ph codeph">gesvdjBatched</samp> 
                                          dose not converge on <samp class="ph codeph">i-th</samp> matrix
                                          under given tolerance and maximum sweeps.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">params</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">structure filled with parameters of Jacobi algorithm. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">batchSize</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of matrices. </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp> or
                                          <samp class="ph codeph">lda&lt;max(1,m)</samp> or <samp class="ph codeph">ldu&lt;max(1,m)</samp> or
                                          <samp class="ph codeph">ldv&lt;max(1,n)</samp> or
                                          <samp class="ph codeph">jobz</samp> is not
                                          <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp> or 
                                          <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          , or <samp class="ph codeph">batchSize&lt;0</samp>
                                          ).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-gesvda"><a name="cuds-lt-t-gt-gesvda" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-gesvda" name="cuds-lt-t-gt-gesvda" shape="rect">cusolverDn&lt;t&gt;gesvdaStridedBatched()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The helper functions below can calculate the sizes needed for pre-allocated buffer.
                              <pre xml:space="preserve">

cusolverStatus_t 
cusolverDnSgesvdaStridedBatched_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int rank,
    int m,
    int n,
    const float *A,
    int lda,
    long long int strideA,
    const float *S,
    long long int strideS,
    const float *U,
    int ldu,
    long long int strideU,
    const float *V,
    int ldv,
    long long int strideV,
    int *lwork,
    int batchSize);

cusolverStatus_t 
cusolverDnDgesvdaStridedBatched_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int rank,
    int m,
    int n,
    const double *A,
    int lda,
    long long int strideA,
    const double *S,
    long long int strideS,
    const double *U,
    int ldu,
    long long int strideU,
    const double *V,
    int ldv,
    long long int strideV,
    int *lwork,
    int batchSize);

cusolverStatus_t 
cusolverDnCgesvdaStridedBatched_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int rank,
    int m,
    int n,
    const cuComplex *A,
    int lda,
    long long int strideA,
    const float *S,
    long long int strideS,
    const cuComplex *U,
    int ldu,
    long long int strideU,
    const cuComplex *V,
    int ldv,
    long long int strideV,
    int *lwork,
    int batchSize);

cusolverStatus_t 
cusolverDnZgesvdaStridedBatched_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int rank,
    int m,
    int n,
    const cuDoubleComplex *A,
    int lda,
    long long int strideA,
    const double *S,
    long long int strideS,
    const cuDoubleComplex *U,
    int ldu,
    long long int strideU,
    const cuDoubleComplex *V,
    int ldv,
    long long int strideV,
    int *lwork,
    int batchSize);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively. 
                              <pre xml:space="preserve">

cusolverStatus_t 
cusolverDnSgesvdaStridedBatched(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int rank,
    int m,
    int n,
    const float *A,
    int lda,
    long long int strideA,
    float *S,
    long long int strideS,
    float *U,
    int ldu,
    long long int strideU,
    float *V,
    int ldv,
    long long int strideV,
    float *work,
    int lwork,
    int *info,
    double *h_R_nrmF,
    int batchSize);

cusolverStatus_t 
cusolverDnDgesvdaStridedBatched(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int rank,
    int m,
    int n,
    const double *A,
    int lda,
    long long int strideA,
    double *S,
    long long int strideS,
    double *U,
    int ldu,
    long long int strideU,
    double *V,
    int ldv,
    long long int strideV,
    double *work,
    int lwork,
    int *info,
    double *h_R_nrmF,
    int batchSize);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively. 
                              <pre xml:space="preserve">

cusolverStatus_t 
cusolverDnCgesvdaStridedBatched(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int rank,
    int m,
    int n,
    const cuComplex *A,
    int lda,
    long long int strideA,
    float *S,
    long long int strideS,
    cuComplex *U,
    int ldu,
    long long int strideU,
    cuComplex *V,
    int ldv,
    long long int strideV,
    cuComplex *work,
    int lwork,
    int *info,
    double *h_R_nrmF,
    int batchSize);

cusolverStatus_t 
cusolverDnZgesvdaStridedBatched(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    int rank,
    int m,
    int n,
    const cuDoubleComplex *A,
    int lda,
    long long int strideA,
    double *S,
    long long int strideS,
    cuDoubleComplex *U,
    int ldu,
    long long int strideU,
    cuDoubleComplex *V,
    int ldv,
    long long int strideV,
    cuDoubleComplex *work,
    int lwork,
    int *info,
    double *h_R_nrmF,
    int batchSize);

</pre></div>
                           <p class="p">
                              This function <samp class="ph codeph">gesvda</samp> (<samp class="ph codeph">a</samp> stands for approximate) approximates the singular value decomposition of a tall skinny 
                              <samp class="ph codeph">m×n</samp> matrix <samp class="ph codeph">A</samp> and corresponding  
                              the left and right singular vectors. 
                              The economy form of SVD is written by
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mi>U</mi>
                                             <mo>*</mo>
                                             <mi>Σ</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>V</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">Σ</samp> is an <samp class="ph codeph">n×n</samp> matrix.
                              <samp class="ph codeph">U</samp> is an <samp class="ph codeph">m×n</samp> unitary matrix, and
                              <samp class="ph codeph">V</samp> is an <samp class="ph codeph">n×n</samp> unitary matrix.  
                              The diagonal elements of <samp class="ph codeph">Σ</samp>
                              are the singular values of <samp class="ph codeph">A</samp>; they are real and non-negative, and
                              are returned in descending order. 
                              <samp class="ph codeph">U</samp> and <samp class="ph codeph">V</samp> are the left and right singular vectors of <samp class="ph codeph">A</samp>.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">gesvda</samp> computes eigenvalues of <samp class="ph codeph">A**T*A</samp> to approximate 
                              singular values and singular vectors.
                              It generates matrices <samp class="ph codeph">U</samp> and <samp class="ph codeph">V</samp> 
                              and transforms the matrix <samp class="ph codeph">A</samp> to the following form
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>U</mi>
                                                <mi>H</mi>
                                             </msup>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <mi>V</mi>
                                             <mo>=</mo>
                                             <mi>S</mi>
                                             <mo>+</mo>
                                             <mi>E</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">S</samp> is diagonal and <samp class="ph codeph">E</samp> depends on rounding errors.
                              To certain conditions, <samp class="ph codeph">U</samp>, <samp class="ph codeph">V</samp> and <samp class="ph codeph">S</samp>
                              approximate singular values and singular vectors up to machine zero of single precision.
                              In general, <samp class="ph codeph">V</samp> is unitary, <samp class="ph codeph">S</samp> is more accurate than <samp class="ph codeph">U</samp>.
                              If singular value is far from zero, then left singular vector <samp class="ph codeph">U</samp> is accurate.
                              In other words, the accuracy of singular values and left singular vectors depend 
                              on the distance between singular value and zero.
                              
                           </p>
                           <p class="p">
                              The input parameter <samp class="ph codeph">rank</samp> decides the number of singualr values and singular vectors
                              are computed in parameter <samp class="ph codeph">S</samp>, <samp class="ph codeph">U</samp> and <samp class="ph codeph">V</samp>.
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">h_RnrmF</samp> computes Frobenius norm of residual.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>-</mo>
                                             <mo>U</mo>
                                             <mo>*</mo>
                                             <mi>S</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>V</mi>
                                                <mi>H</mi>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              if the paramter <samp class="ph codeph">rank</samp> is equal <samp class="ph codeph">n</samp>.
                              Otherwise, <samp class="ph codeph">h_RnrmF</samp> reports  
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>||</mi>
                                             <mo>U</mo>
                                             <mo>*</mo>
                                             <mi>S</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>V</mi>
                                                <mi>H</mi>
                                             </msup>
                                             <mi>||</mi>
                                             <mo>-</mo>
                                             <mi>||S||</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              in Frobenius norm sense. That is, how far <samp class="ph codeph">U</samp> is from unitary.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">gesvdaStridedBatched</samp> performs <samp class="ph codeph">gesvda</samp> on each matrix.
                              It requires that all matrices are of the same size <samp class="ph codeph">m,n</samp>
                              and are packed in contiguous way,
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>A</mi>
                                                <mo>=</mo>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mi>A0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>A1</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>⋯</mi>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              Each matrix is column-major with leading dimension <samp class="ph codeph">lda</samp>,
                              so the formula for random access is
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>k</mi>
                                 </msub>
                                 <mo>(i,j)</mo>
                                 <mo>=</mo>
                                 <mi>A[ i + lda*j + strideA*k]</mi>
                              </math>
                              
                              .
                              
                              Similarly, the formula for random access of <samp class="ph codeph">S</samp> is
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>S</mi>
                                    <mi>k</mi>
                                 </msub>
                                 <mo>(j)</mo>
                                 <mo>=</mo>
                                 <mi>S[ j + StrideS*k]</mi>
                              </math>
                              
                              
                              , the formula for random access of <samp class="ph codeph">U</samp> is
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>U</mi>
                                    <mi>k</mi>
                                 </msub>
                                 <mo>(i,j)</mo>
                                 <mo>=</mo>
                                 <mi>U[ i + ldu*j + strideU*k]</mi>
                              </math>
                              
                              
                              and the formula for random access of <samp class="ph codeph">V</samp> is
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>V</mi>
                                    <mi>k</mi>
                                 </msub>
                                 <mo>(i,j)</mo>
                                 <mo>=</mo>
                                 <mi>V[ i + ldv*j + strideV*k]</mi>
                              </math>
                              
                              .
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is the size of the working space, and it is returned by
                              <samp class="ph codeph">gesvdaStridedBatched_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">info</samp> is an integer array of size <samp class="ph codeph">batchSize</samp>.
                              If the function returns <samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp>,
                              the first element <samp class="ph codeph">info[0] = -i</samp> (less than zero) indicates <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              Otherwise, if <samp class="ph codeph">info[i] = min(m,n)+1</samp>,
                              <samp class="ph codeph">gesvdaStridedBatched</samp> does not converge on <samp class="ph codeph">i-th</samp> matrix
                              under given tolerance.
                              
                           </p>
                           <p class="p">
                              Appendix G.4 provides a simple example of <samp class="ph codeph">gesvda</samp>.
                              
                           </p>
                           <p class="p">
                              Remark 1: the routine returns
                              <samp class="ph codeph">V</samp>, not 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msup>
                                    <mi>V</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              . 
                              This is different from <samp class="ph codeph">gesvd</samp>.
                              
                           </p>
                           <p class="p">
                              Remark 2: if the user is confident on the accuracy of singular values and singular vectors,
                              for example, certain conditions hold (required singular value is far from zero), 
                              then the performance can be improved by passing
                              null pointer to h_RnrmF, i.e. no computation of residual norm.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of gesvda</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">jobz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options to either compute singular value only or singular vectors as well:
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>
                                          : Compute singular values only;
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          : Compute singular values and singular vectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">rank</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of singular values (from largest to smallest).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">Aj</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">Aj</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">strideA * batchSize</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,m)</samp>.
                                          <samp class="ph codeph">Aj</samp> is of dimension <samp class="ph codeph">m * n</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">Aj</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">strideA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">value of type long long int that gives the address offset between 
                                          <samp class="ph codeph">A[i]</samp> and <samp class="ph codeph">A[i+1]</samp>.
                                          <samp class="ph codeph">strideA</samp> is not less than <samp class="ph codeph">lda*n</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">S</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">a real array of dimension <samp class="ph codeph">strideS*batchSize</samp>.
                                          It stores the singular values of <samp class="ph codeph">Aj</samp>
                                          in descending order.
                                          <samp class="ph codeph">Sj</samp> is of dimension <samp class="ph codeph">rank * 1</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">strideS</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">value of type long long int that gives the address offset between 
                                          <samp class="ph codeph">S[i]</samp> and <samp class="ph codeph">S[i+1]</samp>.
                                          <samp class="ph codeph">strideS</samp> is not less than <samp class="ph codeph">rank</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">U</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">strideU * batchSize</samp>.
                                          <samp class="ph codeph">Uj</samp> contains the left singular vectors of <samp class="ph codeph">Aj</samp>.
                                          <samp class="ph codeph">Uj</samp> is of dimension <samp class="ph codeph">m * rank</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldu</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">Uj</samp>.
                                          <samp class="ph codeph">ldu</samp> is not less than <samp class="ph codeph">max(1,m)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">strideU</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">value of type long long int that gives the address offset between 
                                          <samp class="ph codeph">U[i]</samp> and <samp class="ph codeph">U[i+1]</samp>.
                                          <samp class="ph codeph">strideU</samp> is not less than <samp class="ph codeph">ldu*rank</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">V</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">strideV * batchSize</samp>.
                                          <samp class="ph codeph">Vj</samp> contains the right singular vectors of <samp class="ph codeph">Aj</samp>.
                                          <samp class="ph codeph">Vj</samp> is of dimension <samp class="ph codeph">n * rank</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldv</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">Vj</samp>.
                                          <samp class="ph codeph">ldv</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">strideV</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">value of type long long int that gives the address offset between 
                                          <samp class="ph codeph">V[i]</samp> and <samp class="ph codeph">V[i+1]</samp>.
                                          <samp class="ph codeph">strideV</samp> is not less than <samp class="ph codeph">ldv*rank</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of size <samp class="ph codeph">lwork</samp>, working space.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">work</samp>, returned by <samp class="ph codeph">gesvdaStridedBatched_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">an integer array of dimension <samp class="ph codeph">batchSize</samp>.
                                          If <samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp> is returned,
                                          <samp class="ph codeph">info[0] = -i</samp> (less than zero) indicates <samp class="ph codeph">i-th</samp>
                                          parameter is wrong (not counting handle).
                                          Otherwise,
                                          if <samp class="ph codeph">info[i] = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">info[i] = min(m,n)+1</samp>, <samp class="ph codeph">gesvdaStridedBatched</samp>
                                          dose not converge on <samp class="ph codeph">i-th</samp> matrix.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_RnrmF</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;double&gt; array of size <samp class="ph codeph">batchSize</samp>.
                                          <samp class="ph codeph">h_RnrmF[i]</samp> is norm of residual of <samp class="ph codeph">i-th</samp> matrix.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">batchSize</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of matrices. 
                                          <samp class="ph codeph">batchSize</samp> is not less than 1.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n&lt;0</samp> or 
                                          <samp class="ph codeph">lda&lt;max(1,m)</samp> or <samp class="ph codeph">ldu&lt;max(1,m)</samp> or
                                          <samp class="ph codeph">ldv&lt;max(1,n)</samp> or
                                          <samp class="ph codeph">strideA&lt;lda*n</samp> or
                                          <samp class="ph codeph">strideS&lt;rank</samp> or
                                          <samp class="ph codeph">strideU&lt;ldu*rank</samp> or
                                          <samp class="ph codeph">strideV&lt;ldv*rank</samp> or
                                          <samp class="ph codeph">batchSize&lt;1</samp> or
                                          <samp class="ph codeph">jobz</samp> is not
                                          <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp> or <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          ).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-syevd"><a name="cuds-lt-t-gt-syevd" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-syevd" name="cuds-lt-t-gt-syevd" shape="rect">cusolverDn&lt;t&gt;syevd()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The helper functions below can calculate the sizes needed for pre-allocated buffer.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSsyevd_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const float *A,
    int lda,
    const float *W,
    int *lwork);

cusolverStatus_t 
cusolverDnDsyevd_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const double *A,
    int lda,
    const double *W,
    int *lwork);

cusolverStatus_t 
cusolverDnCheevd_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const cuComplex *A,
    int lda,
    const float *W,
    int *lwork);

cusolverStatus_t 
cusolverDnZheevd_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const cuDoubleComplex *A,
    int lda,
    const double *W,
    int *lwork);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively. 
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSsyevd(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    float *A,
    int lda,
    float *W,
    float *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnDsyevd(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    double *A,
    int lda,
    double *W,
    double *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively. 
                              
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCheevd(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    cuComplex *A,
    int lda,
    float *W,
    cuComplex *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnZheevd(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    cuDoubleComplex *A,
    int lda,
    double *W,
    cuDoubleComplex *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <p class="p">
                              This function computes eigenvalues and eigenvectors of a symmetric (Hermitian) 
                              <samp class="ph codeph">n×n</samp> matrix <samp class="ph codeph">A</samp>. 
                              The standard symmetric eigenvalue problem is
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <mi>V</mi>
                                             <mo>=</mo>
                                             <mi>V</mi>
                                             <mo>*</mo>
                                             <mi>Λ</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">Λ</samp> is a real <samp class="ph codeph">n×n</samp> diagonal matrix.
                              <samp class="ph codeph">V</samp> is an <samp class="ph codeph">n×n</samp> unitary matrix.  
                              The diagonal elements of <samp class="ph codeph">Λ</samp> are the eigenvalues of <samp class="ph codeph">A</samp> 
                              in ascending order. 
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is size of the working space, and it is returned by
                              <samp class="ph codeph">syevd_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle). If <samp class="ph codeph">devInfo = i</samp> (greater than zero), 
                              <samp class="ph codeph">i</samp> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.
                              
                           </p>
                           <p class="p">
                              if <samp class="ph codeph">jobz</samp> = CUSOLVER_EIG_MODE_VECTOR, 
                              <samp class="ph codeph">A</samp> contains the orthonormal eigenvectors 
                              of the matrix <samp class="ph codeph">A</samp>. The eigenvectors are computed by a divide and conquer algorithm.
                              
                           </p>
                           <p class="p">
                              Appendix F.1 provides a simple example of <samp class="ph codeph">syevd</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of syevd</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">jobz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options to either compute eigenvalue only or compute eigen-pair:
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>
                                          : Compute eigenvalues only;
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          : Compute eigenvalues and eigenvectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies which part of <samp class="ph codeph">A</samp> is stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>: 
                                          Lower triangle of <samp class="ph codeph">A</samp> is stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>: 
                                          Upper triangle of <samp class="ph codeph">A</samp> is stored.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows (or columns) of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>, 
                                          the leading n-by-n upper triangular part of <samp class="ph codeph">A</samp> 
                                          contains the upper triangular part of the matrix <samp class="ph codeph">A</samp>.  
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>, 
                                          the leading n-by-n lower triangular part of <samp class="ph codeph">A</samp> 
                                          contains the lower triangular part of the matrix <samp class="ph codeph">A</samp>.
                                          On exit, if <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>, 
                                          and <samp class="ph codeph">devInfo</samp> = 0, 
                                          <samp class="ph codeph">A</samp> contains the
                                          orthonormal eigenvectors of the matrix <samp class="ph codeph">A</samp>.
                                          If <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>, 
                                          the contents of <samp class="ph codeph">A</samp> are destroyed.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">W</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">a real array of dimension <samp class="ph codeph">n</samp>.
                                          The eigenvalue values of <samp class="ph codeph">A</samp>, in ascending order ie, sorted so that <samp class="ph codeph">W(i) &lt;=  W(i+1)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">work</samp>, returned by <samp class="ph codeph">syevd_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">devInfo =  i (&gt; 0)</samp>, <samp class="ph codeph">devInfo</samp> indicates 
                                          <samp class="ph codeph">i</samp> off-diagonal elements of an intermediate tridiagonal form 
                                          did not converge to zero;
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp>, or 
                                          <samp class="ph codeph">lda&lt;max(1,n)</samp>, or <samp class="ph codeph">jobz</samp> is not 
                                          <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp> or <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>, or 
                                          <samp class="ph codeph">uplo</samp> is not <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp> or 
                                          <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-syevdx"><a name="cuds-lt-t-gt-syevdx" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-syevdx" name="cuds-lt-t-gt-syevdx" shape="rect">cusolverDn&lt;t&gt;syevdx()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The helper functions below can calculate the sizes needed for pre-allocated buffer.
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnSsyevdx_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    cusolverEigRange_t range,
    cublasFillMode_t uplo, 
    int n,
    const float *A,
    int lda,
    float vl,
    float vu,
    int il,
    int iu,
    int *h_meig,
    const float *W,
    int *lwork);

cusolverStatus_t
cusolverDnDsyevdx_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    cusolverEigRange_t range,
    cublasFillMode_t uplo, 
    int n,
    const double *A,
    int lda,
    double vl,
    double vu,
    int il,
    int iu,
    int *h_meig,
    const double *W,
    int *lwork);

cusolverStatus_t
cusolverDnCheevdx_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    cusolverEigRange_t range,
    cublasFillMode_t uplo, 
    int n,
    const cuComplex *A,
    int lda,
    float vl,
    float vu,
    int il,
    int iu,
    int *h_meig,
    const float *W,
    int *lwork);

cusolverStatus_t
cusolverDnZheevdx_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    cusolverEigRange_t range,
    cublasFillMode_t uplo, 
    int n,
    const cuDoubleComplex *A,
    int lda,
    double vl,
    double vu,
    int il,
    int iu,
    int *h_meig,
    const double *W,
    int *lwork);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively. 
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnSsyevdx(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    cusolverEigRange_t range,
    cublasFillMode_t uplo, 
    int n,
    float *A,
    int lda,
    float vl,
    float vu,
    int il,
    int iu,
    int *h_meig,
    float *W, 
    float *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnDsyevdx(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    cusolverEigRange_t range,
    cublasFillMode_t uplo, 
    int n,
    double *A,
    int lda,
    double vl,
    double vu,
    int il,
    int iu,
    int *h_meig,
    double *W, 
    double *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively. 
                              
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCheevdx(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    cusolverEigRange_t range,
    cublasFillMode_t uplo, 
    int n,
    cuComplex *A,
    int lda,
    float vl,
    float vu,
    int il,
    int iu,
    int *h_meig,
    float *W, 
    cuComplex *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnZheevdx(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz, 
    cusolverEigRange_t range,
    cublasFillMode_t uplo, 
    int n,
    cuDoubleComplex *A,
    int lda,
    double vl,
    double vu,
    int il,
    int iu,
    int *h_meig,
    double *W, 
    cuDoubleComplex *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <p class="p">
                              This function computes all or selection of the eigenvalues and optionally eigenvectors of a symmetric (Hermitian) 
                              <samp class="ph codeph">n×n</samp> matrix <samp class="ph codeph">A</samp>. 
                              The standard symmetric eigenvalue problem is
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <mi>V</mi>
                                             <mo>=</mo>
                                             <mi>V</mi>
                                             <mo>*</mo>
                                             <mi>Λ</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">Λ</samp> is a real <samp class="ph codeph">n×h_meig</samp> diagonal matrix.
                              <samp class="ph codeph">V</samp> is an <samp class="ph codeph">n×h_meig</samp> unitary matrix.  
                              <samp class="ph codeph">h_meig</samp> is the number of eigenvalues/eigenvectors computed by the routine, 
                              <samp class="ph codeph">h_meig</samp> is equal to <samp class="ph codeph">n</samp> 
                              when the whole spectrum (e.g., <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_ALL</samp>)
                              is requested.
                              The diagonal elements of <samp class="ph codeph">Λ</samp> are the eigenvalues of <samp class="ph codeph">A</samp> 
                              in ascending order. 
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is size of the working space, and it is returned by
                              <samp class="ph codeph">syevdx_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle). If <samp class="ph codeph">devInfo = i</samp> (greater than zero), 
                              <samp class="ph codeph">i</samp> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.
                              
                           </p>
                           <p class="p">
                              if <samp class="ph codeph">jobz</samp> = CUSOLVER_EIG_MODE_VECTOR, 
                              <samp class="ph codeph">A</samp> contains the orthonormal eigenvectors 
                              of the matrix <samp class="ph codeph">A</samp>. The eigenvectors are computed by a divide and conquer algorithm.
                              
                           </p>
                           <p class="p">
                              Appendix F.1 provides a simple example of <samp class="ph codeph">syevdx</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of syevdx</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">jobz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options to either compute eigenvalue only or compute eigen-pair:
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>
                                          : Compute eigenvalues only;
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          : Compute eigenvalues and eigenvectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">range</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options to which selection of eigenvalues and optionally eigenvectors that need to be computed:
                                          <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_ALL</samp>
                                          : all eigenvalues/eigenvectors will be found, will becomes the classical syevd/heevd routine;
                                          <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_V</samp>
                                          : all eigenvalues/eigenvectors in the half-open interval (vl,vu] will be found;
                                          <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_I</samp>
                                          : the il-th through iu-th eigenvalues/eigenvectors will be found;
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies which part of <samp class="ph codeph">A</samp> is stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>: 
                                          Lower triangle of <samp class="ph codeph">A</samp> is stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>: 
                                          Upper triangle of <samp class="ph codeph">A</samp> is stored.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows (or columns) of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>, 
                                          the leading n-by-n upper triangular part of <samp class="ph codeph">A</samp> 
                                          contains the upper triangular part of the matrix <samp class="ph codeph">A</samp>.  
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>, 
                                          the leading n-by-n lower triangular part of <samp class="ph codeph">A</samp> 
                                          contains the lower triangular part of the matrix <samp class="ph codeph">A</samp>.
                                          On exit, if <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>, 
                                          and <samp class="ph codeph">devInfo</samp> = 0, 
                                          <samp class="ph codeph">A</samp> contains the
                                          orthonormal eigenvectors of the matrix <samp class="ph codeph">A</samp>.
                                          If <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>, 
                                          the contents of <samp class="ph codeph">A</samp> are destroyed.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>.<samp class="ph codeph">lda</samp> is not less than<samp class="ph codeph"> max(1,n)</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">vl,vu</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">
                                          real values float or double for (C, S) or (Z, D) precision respectively. 
                                          If <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_V</samp>, 
                                          the lower and upper bounds 
                                          of the interval to be searched for eigenvalues. vl &gt; vu.
                                          Not referenced if <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_ALL</samp> 
                                          or <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_I</samp>.
                                          Note that, if eigenvalues are very close to each other, 
                                          it is well known that two different eigenvalues routines
                                          might find slightly different number of eigenvalues inside 
                                          the same interval. This is due to the fact that different 
                                          eigenvalue algorithms, or even same algorithm but different run might find 
                                          eigenvalues within some rounding error close to the machine precision.
                                          Thus, if the user want to be sure not to miss any eigenvalue within 
                                          the interval bound, we suggest that, the user substract/add epsilon (machine precision) 
                                          to the interval bound such as (vl=vl-eps, vu=vu+eps]. this suggestion is valid 
                                          for any selective routine from cuSolver or LAPACK. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">il,iu</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">
                                          integer. 
                                          If <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_I</samp>,
                                          the indices (in ascending order) of the
                                          smallest and largest eigenvalues to be returned.
                                          1 &lt;= il &lt;= iu &lt;= n, if n &gt; 0; il = 1 and iu = 0 if n = 0.
                                          Not referenced if <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_ALL</samp> 
                                          or <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_V</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_meig</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">
                                          integer. 
                                          The total number of eigenvalues found.  0 &lt;= h_meig &lt;= n.
                                          If <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_ALL</samp>, h_meig = n, 
                                          and if <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_I</samp>, h_meig = iu-il+1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">W</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">a real array of dimension <samp class="ph codeph">n</samp>.
                                          The eigenvalue values of <samp class="ph codeph">A</samp>, in ascending order ie, sorted so that <samp class="ph codeph">W(i) &lt;=  W(i+1)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">work</samp>, returned by <samp class="ph codeph">syevdx_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">devInfo =  i (&gt; 0)</samp>, <samp class="ph codeph">devInfo</samp> indicates 
                                          <samp class="ph codeph">i</samp> off-diagonal elements of an intermediate tridiagonal form 
                                          did not converge to zero;
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp>, or 
                                          <samp class="ph codeph">lda&lt;max(1,n)</samp>, or <samp class="ph codeph">jobz</samp> is not 
                                          <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp> or <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>, or 
                                          <samp class="ph codeph">range</samp> is not <samp class="ph codeph">CUSOLVER_EIG_RANGE_ALL</samp> or <samp class="ph codeph">CUSOLVER_EIG_RANGE_V</samp> or <samp class="ph codeph">CUSOLVER_EIG_RANGE_I</samp>, or
                                          <samp class="ph codeph">uplo</samp> is not <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp> or 
                                          <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-sygvd"><a name="cuds-lt-t-gt-sygvd" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-sygvd" name="cuds-lt-t-gt-sygvd" shape="rect">cusolverDn&lt;t&gt;sygvd()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The helper functions below can calculate the sizes needed for pre-allocated buffer.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSsygvd_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const float *A,
    int lda,
    const float *B,
    int ldb,
    const float *W,
    int *lwork);

cusolverStatus_t
cusolverDnDsygvd_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const double *A,
    int lda,
    const double *B,
    int ldb,
    const double *W,
    int *lwork);

cusolverStatus_t 
cusolverDnChegvd_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const cuComplex *A,
    int lda,
    const cuComplex *B,
    int ldb,
    const float *W,
    int *lwork);

cusolverStatus_t 
cusolverDnZhegvd_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const cuDoubleComplex *A,
    int lda,
    const cuDoubleComplex *B,
    int ldb,
    const double *W,
    int *lwork);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively. 
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnSsygvd(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    float *A,
    int lda,
    float *B,
    int ldb,
    float *W,
    float *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnDsygvd(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    double *A,
    int lda,
    double *B,
    int ldb,
    double *W,
    double *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively. 
                              
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnChegvd(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    cuComplex *A,
    int lda,
    cuComplex *B,
    int ldb,
    float *W,
    cuComplex *work,
    int lwork,
    int *devInfo);

cusolverStatus_t 
cusolverDnZhegvd(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    cuDoubleComplex *A,
    int lda,
    cuDoubleComplex *B,
    int ldb,
    double *W,
    cuDoubleComplex *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <p class="p">
                              This function computes eigenvalues and eigenvectors of a symmetric (Hermitian) 
                              <samp class="ph codeph">n×n</samp> matrix-pair (<samp class="ph codeph">A</samp>,<samp class="ph codeph">B</samp>). 
                              The generalized symmetric-definite eigenvalue problem is
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>eig(A,B)</mi>
                                             <mo>=</mo>
                                             <mfenced open="{" close="">
                                                <mtable columnalign="left left" rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>A</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>B</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>*</mo>
                                                         <mi>Λ</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_1</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>A</mi>
                                                         <mo>*</mo>
                                                         <mi>B</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>V</mi>
                                                         <mo>*</mo>
                                                         <mi>Λ</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_2</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>B</mi>
                                                         <mo>*</mo>
                                                         <mi>A</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>V</mi>
                                                         <mo>*</mo>
                                                         <mi>Λ</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_3</mtext>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where the matrix <samp class="ph codeph">B</samp> is positive definite.
                              <samp class="ph codeph">Λ</samp> is a real <samp class="ph codeph">n×n</samp> diagonal matrix.
                              The diagonal elements of <samp class="ph codeph">Λ</samp> are the eigenvalues of 
                              (<samp class="ph codeph">A</samp>, <samp class="ph codeph">B</samp>) in ascending order.
                              <samp class="ph codeph">V</samp> is an <samp class="ph codeph">n×n</samp> orthogonal matrix. 
                              The eigenvectors are normalized as follows: 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mfenced open="{" close="">
                                                <mtable columnalign="left left" rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <msup>
                                                            <mi>V</mi>
                                                            <mi>H</mi>
                                                         </msup>
                                                         <mo>*</mo>
                                                         <mi>B</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>I</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_1, CUSOLVER_EIG_TYPE_2</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msup>
                                                            <mi>V</mi>
                                                            <mi>H</mi>
                                                         </msup>
                                                         <mo>*</mo>
                                                         <mi>inv(B)</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>I</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_3</mtext>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is size of the working space, and it is returned by
                              <samp class="ph codeph">sygvd_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle). If <samp class="ph codeph">devInfo = i</samp> (i &gt; 0 and i&lt;=n) and 
                              <samp class="ph codeph">jobz</samp> = CUSOLVER_EIG_MODE_NOVECTOR, 
                              <samp class="ph codeph">i</samp> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.
                              If <samp class="ph codeph">devInfo = N + i</samp> (i &gt; 0), then the leading minor of order <samp class="ph codeph">i</samp> of 
                              <samp class="ph codeph">B</samp> is not positive definite.
                              The factorization of <samp class="ph codeph">B</samp> could not be completed and 
                              no eigenvalues or eigenvectors were computed. 
                              
                           </p>
                           <p class="p">
                              if <samp class="ph codeph">jobz</samp> = CUSOLVER_EIG_MODE_VECTOR, 
                              <samp class="ph codeph">A</samp> contains the orthogonal eigenvectors 
                              of the matrix <samp class="ph codeph">A</samp>. The eigenvectors are computed by divide and conquer algorithm.
                              
                           </p>
                           <p class="p">
                              Appendix F.2 provides a simple example of <samp class="ph codeph">sygvd</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of sygvd</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">itype</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Specifies the problem type to be solved:
                                          <samp class="ph codeph">itype</samp>=CUSOLVER_EIG_TYPE_1: A*x = (lambda)*B*x.
                                          <samp class="ph codeph">itype</samp>=CUSOLVER_EIG_TYPE_2: A*B*x = (lambda)*x.
                                          <samp class="ph codeph">itype</samp>=CUSOLVER_EIG_TYPE_3: B*A*x = (lambda)*x.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">jobz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options to either compute eigenvalue only or compute eigen-pair:
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>
                                          : Compute eigenvalues only;
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          : Compute eigenvalues and eigenvectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies which part of <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> are stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>: 
                                          Lower triangle of <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> are stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>: 
                                          Upper triangle of <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> are stored.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows (or columns) of matrix <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>, 
                                          the leading n-by-n upper triangular part of <samp class="ph codeph">A</samp> 
                                          contains the upper triangular part of the matrix <samp class="ph codeph">A</samp>.  
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>, 
                                          the leading n-by-n lower triangular part of <samp class="ph codeph">A</samp> 
                                          contains the lower triangular part of the matrix <samp class="ph codeph">A</samp>.
                                          On exit, if <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>, 
                                          and <samp class="ph codeph">devInfo</samp> = 0, 
                                          <samp class="ph codeph">A</samp> contains the
                                          orthonormal eigenvectors of the matrix <samp class="ph codeph">A</samp>.
                                          If <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>, 
                                          the contents of <samp class="ph codeph">A</samp> are destroyed.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>.
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">ldb * n</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,
                                          the leading n-by-n upper triangular part of <samp class="ph codeph">B</samp>
                                          contains the upper triangular part of the matrix <samp class="ph codeph">B</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>,
                                          the leading n-by-n lower triangular part of <samp class="ph codeph">B</samp>
                                          contains the lower triangular part of the matrix <samp class="ph codeph">B</samp>.
                                          On exit, if <samp class="ph codeph">devInfo</samp> is less than <samp class="ph codeph">n</samp>,
                                          <samp class="ph codeph">B</samp> is overwritten by triangular factor <samp class="ph codeph">U</samp>
                                          or <samp class="ph codeph">L</samp> from the Cholesky factorization of <samp class="ph codeph">B</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">B</samp>.
                                          <samp class="ph codeph">ldb</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">W</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">a real array of dimension <samp class="ph codeph">n</samp>.
                                          The eigenvalue values of <samp class="ph codeph">A</samp>, sorted so that <samp class="ph codeph">W(i) &gt;= W(i+1)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">work</samp>, returned by <samp class="ph codeph">sygvd_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">devInfo =  i (&gt; 0)</samp>, <samp class="ph codeph">devInfo</samp> indicates 
                                          either <samp class="ph codeph">potrf</samp> or <samp class="ph codeph">syevd</samp> is wrong.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp>, or 
                                          <samp class="ph codeph">lda&lt;max(1,n)</samp>, or <samp class="ph codeph">ldb&lt;max(1,n)</samp>,
                                          or <samp class="ph codeph">itype</samp> is not 1, 2 or 3,
                                          or <samp class="ph codeph">jobz</samp> is not 'N' or 'V', or 
                                          <samp class="ph codeph">uplo</samp> is not <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp> or 
                                          <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-sygvdx"><a name="cuds-lt-t-gt-sygvdx" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-sygvdx" name="cuds-lt-t-gt-sygvdx" shape="rect">cusolverDn&lt;t&gt;sygvdx()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The helper functions below can calculate the sizes needed for pre-allocated buffer.
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnSsygvdx_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cusolverEigRange_t range,
    cublasFillMode_t uplo, 
    int n,
    const float *A, 
    int lda,
    const float *B, 
    int ldb,
    float vl,
    float vu,
    int il,
    int iu,
    int *h_meig,
    const float *W,
    int *lwork);

cusolverStatus_t
cusolverDnDsygvdx_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype, 
    cusolverEigMode_t jobz,  
    cusolverEigRange_t range,
    cublasFillMode_t uplo,  
    int n,
    const double *A, 
    int lda,
    const double *B, 
    int ldb,
    double vl,
    double vu,
    int il,
    int iu,
    int *h_meig,
    const double *W,
    int *lwork);

cusolverStatus_t
cusolverDnChegvdx_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype, 
    cusolverEigMode_t jobz,  
    cusolverEigRange_t range,
    cublasFillMode_t uplo,  
    int n,
    const cuComplex *A, 
    int lda,
    const cuComplex *B, 
    int ldb,
    float vl,
    float vu,
    int il,
    int iu,
    int *h_meig,
    const float *W,
    int *lwork);

cusolverStatus_t
cusolverDnZhegvdx_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,   
    cusolverEigMode_t jobz, 
    cusolverEigRange_t range,
    cublasFillMode_t uplo,  
    int n,
    const cuDoubleComplex *A,
    int lda,
    const cuDoubleComplex *B, 
    int ldb,
    double vl,
    double vu,
    int il,
    int iu,
    int *h_meig,
    const double *W,
    int *lwork);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively. 
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnSsygvdx(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,   
    cusolverEigMode_t jobz,  
    cusolverEigRange_t range,
    cublasFillMode_t uplo,  
    int n,
    float *A, 
    int lda,
    float *B, 
    int ldb,
    float vl,
    float vu,
    int il,
    int iu,
    int *h_meig,
    float *W, 
    float *work,
    int lwork,
    int *devInfo);

cusolverStatus_t
cusolverDnDsygvdx(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,  
    cusolverEigMode_t jobz,  
    cusolverEigRange_t range,
    cublasFillMode_t uplo,  
    int n,
    double *A, 
    int lda,
    double *B, 
    int ldb,
    double vl,
    double vu,
    int il,
    int iu,
    int *h_meig,
    double *W, 
    double *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively. 
                              
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnChegvdx(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,   
    cusolverEigMode_t jobz,  
    cusolverEigRange_t range,
    cublasFillMode_t uplo,  
    int n,
    cuComplex *A,
    int lda,
    cuComplex *B, 
    int ldb,
    float vl,
    float vu,
    int il,
    int iu,
    int *h_meig,
    float *W, 
    cuComplex *work,
    int lwork,
    int *devInfo);

cusolverStatus_t
cusolverDnZhegvdx(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,   
    cusolverEigMode_t jobz,  
    cusolverEigRange_t range,
    cublasFillMode_t uplo,  
    int n,
    cuDoubleComplex *A, 
    int lda,
    cuDoubleComplex *B, 
    int ldb,
    double vl,
    double vu,
    int il,
    int iu,
    int *h_meig,
    double *W, 
    cuDoubleComplex *work,
    int lwork,
    int *devInfo);

</pre></div>
                           <p class="p">
                              This function computes  all or selection of the eigenvalues and optionally eigenvectors of a symmetric (Hermitian) 
                              <samp class="ph codeph">n×n</samp> matrix-pair (<samp class="ph codeph">A</samp>,<samp class="ph codeph">B</samp>). 
                              The generalized symmetric-definite eigenvalue problem is
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>eig(A,B)</mi>
                                             <mo>=</mo>
                                             <mfenced open="{" close="">
                                                <mtable columnalign="left left" rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>A</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>B</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>*</mo>
                                                         <mi>Λ</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_1</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>A</mi>
                                                         <mo>*</mo>
                                                         <mi>B</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>V</mi>
                                                         <mo>*</mo>
                                                         <mi>Λ</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_2</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>B</mi>
                                                         <mo>*</mo>
                                                         <mi>A</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>V</mi>
                                                         <mo>*</mo>
                                                         <mi>Λ</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_3</mtext>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where the matrix <samp class="ph codeph">B</samp> is positive definite.
                              <samp class="ph codeph">Λ</samp> is a real <samp class="ph codeph">n×h_meig</samp> diagonal matrix.
                              The diagonal elements of <samp class="ph codeph">Λ</samp> are the eigenvalues of 
                              (<samp class="ph codeph">A</samp>, <samp class="ph codeph">B</samp>) in ascending order.
                              <samp class="ph codeph">V</samp> is an <samp class="ph codeph">n×h_meig</samp> orthogonal matrix. 
                              <samp class="ph codeph">h_meig</samp> is the number of eigenvalues/eigenvectors computed by the routine, 
                              <samp class="ph codeph">h_meig</samp> is equal to <samp class="ph codeph">n</samp> 
                              when the whole spectrum (e.g., <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_ALL</samp>)
                              is requested.
                              The eigenvectors are normalized as follows: 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mfenced open="{" close="">
                                                <mtable columnalign="left left" rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <msup>
                                                            <mi>V</mi>
                                                            <mi>H</mi>
                                                         </msup>
                                                         <mo>*</mo>
                                                         <mi>B</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>I</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_1, CUSOLVER_EIG_TYPE_2</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msup>
                                                            <mi>V</mi>
                                                            <mi>H</mi>
                                                         </msup>
                                                         <mo>*</mo>
                                                         <mi>inv(B)</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>I</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_3</mtext>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is size of the working space, and it is returned by
                              <samp class="ph codeph">sygvdx_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">devInfo = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle). If <samp class="ph codeph">devInfo = i</samp> (i &gt; 0 and i&lt;=n) and 
                              <samp class="ph codeph">jobz</samp> = CUSOLVER_EIG_MODE_NOVECTOR, 
                              <samp class="ph codeph">i</samp> off-diagonal elements of an intermediate tridiagonal form did not converge to zero.
                              If <samp class="ph codeph">devInfo = n + i</samp> (i &gt; 0), then the leading minor of order <samp class="ph codeph">i</samp> of 
                              <samp class="ph codeph">B</samp> is not positive definite.
                              The factorization of <samp class="ph codeph">B</samp> could not be completed and 
                              no eigenvalues or eigenvectors were computed. 
                              
                           </p>
                           <p class="p">
                              if <samp class="ph codeph">jobz</samp> = CUSOLVER_EIG_MODE_VECTOR, 
                              <samp class="ph codeph">A</samp> contains the orthogonal eigenvectors 
                              of the matrix <samp class="ph codeph">A</samp>. The eigenvectors are computed by divide and conquer algorithm.
                              
                           </p>
                           <p class="p">
                              Appendix F.2 provides a simple example of <samp class="ph codeph">sygvdx</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of sygvdx</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">itype</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Specifies the problem type to be solved:
                                          <samp class="ph codeph">itype</samp>=CUSOLVER_EIG_TYPE_1: A*x = (lambda)*B*x.
                                          <samp class="ph codeph">itype</samp>=CUSOLVER_EIG_TYPE_2: A*B*x = (lambda)*x.
                                          <samp class="ph codeph">itype</samp>=CUSOLVER_EIG_TYPE_3: B*A*x = (lambda)*x.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">jobz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options to either compute eigenvalue only or compute eigen-pair:
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>
                                          : Compute eigenvalues only;
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          : Compute eigenvalues and eigenvectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">range</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options to which selection of eigenvalues and optionally eigenvectors that need to be computed:
                                          <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_ALL</samp>
                                          : all eigenvalues/eigenvectors will be found, will becomes the classical syevd/heevd routine;
                                          <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_V</samp>
                                          : all eigenvalues/eigenvectors in the half-open interval (vl,vu] will be found;
                                          <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_I</samp>
                                          : the il-th through iu-th eigenvalues/eigenvectors will be found;
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies which part of <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> are stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>: 
                                          Lower triangle of <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> are stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>: 
                                          Upper triangle of <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> are stored.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows (or columns) of matrix <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>, 
                                          the leading n-by-n upper triangular part of <samp class="ph codeph">A</samp> 
                                          contains the upper triangular part of the matrix <samp class="ph codeph">A</samp>.  
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>, 
                                          the leading n-by-n lower triangular part of <samp class="ph codeph">A</samp> 
                                          contains the lower triangular part of the matrix <samp class="ph codeph">A</samp>.
                                          On exit, if <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>, 
                                          and <samp class="ph codeph">devInfo</samp> = 0, 
                                          <samp class="ph codeph">A</samp> contains the
                                          orthonormal eigenvectors of the matrix <samp class="ph codeph">A</samp>.
                                          If <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>, 
                                          the contents of <samp class="ph codeph">A</samp> are destroyed.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>.
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">ldb * n</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,
                                          the leading n-by-n upper triangular part of <samp class="ph codeph">B</samp>
                                          contains the upper triangular part of the matrix <samp class="ph codeph">B</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>,
                                          the leading n-by-n lower triangular part of <samp class="ph codeph">B</samp>
                                          contains the lower triangular part of the matrix <samp class="ph codeph">B</samp>.
                                          On exit, if <samp class="ph codeph">devInfo</samp> is less than <samp class="ph codeph">n</samp>,
                                          <samp class="ph codeph">B</samp> is overwritten by triangular factor <samp class="ph codeph">U</samp>
                                          or <samp class="ph codeph">L</samp> from the Cholesky factorization of <samp class="ph codeph">B</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">B</samp>.
                                          <samp class="ph codeph">ldb</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">vl,vu</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">
                                          real values float or double for (C, S) or (Z, D) precision respectively. 
                                          If <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_V</samp>, 
                                          the lower and upper bounds 
                                          of the interval to be searched for eigenvalues. vl &gt; vu.
                                          Not referenced if <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_ALL</samp> 
                                          or <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_I</samp>.
                                          Note that, if eigenvalues are very close to each other, 
                                          it is well known that two different eigenvalues routines
                                          might find slightly different number of eigenvalues inside 
                                          the same interval. This is due to the fact that different 
                                          eigenvalue algorithms, or even same algorithm but different run might find 
                                          eigenvalues within some rounding error close to the machine precision.
                                          Thus, if the user want to be sure not to miss any eigenvalue within 
                                          the interval bound, we suggest that, the user substract/add epsilon (machine precision) 
                                          to the interval bound such as (vl=vl-eps, vu=vu+eps]. this suggestion is valid 
                                          for any selective routine from cuSolver or LAPACK. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">il,iu</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">
                                          integer. 
                                          If <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_I</samp>,
                                          the indices (in ascending order) of the
                                          smallest and largest eigenvalues to be returned.
                                          1 &lt;= il &lt;= iu &lt;= n, if n &gt; 0; il = 1 and iu = 0 if n = 0.
                                          Not referenced if <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_ALL</samp> 
                                          or <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_V</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_meig</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">
                                          integer. 
                                          The total number of eigenvalues found.  0 &lt;= h_meig &lt;= n.
                                          If <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_ALL</samp>, h_meig = n, 
                                          and if <samp class="ph codeph">range</samp> = <samp class="ph codeph">CUSOLVER_EIG_RANGE_I</samp>, h_meig = iu-il+1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">W</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">a real array of dimension <samp class="ph codeph">n</samp>.
                                          The eigenvalue values of <samp class="ph codeph">A</samp>, sorted so that <samp class="ph codeph">W(i) &gt;= W(i+1)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">work</samp>, returned by <samp class="ph codeph">sygvdx_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">devInfo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">devInfo = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">devInfo = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">devInfo =  i (&gt; 0)</samp>, <samp class="ph codeph">devInfo</samp> indicates 
                                          either <samp class="ph codeph">potrf</samp> or <samp class="ph codeph">syevd</samp> is wrong.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp>, or 
                                          <samp class="ph codeph">lda&lt;max(1,n)</samp>, or <samp class="ph codeph">ldb&lt;max(1,n)</samp>,
                                          or <samp class="ph codeph">itype</samp> is not <samp class="ph codeph">CUSOLVER_EIG_TYPE_1</samp> or <samp class="ph codeph">CUSOLVER_EIG_TYPE_2</samp> or <samp class="ph codeph">CUSOLVER_EIG_TYPE_3</samp>  
                                          or <samp class="ph codeph">jobz</samp> is not <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp> or <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTORL</samp>, 
                                          or <samp class="ph codeph">range</samp> is not <samp class="ph codeph">CUSOLVER_EIG_RANGE_ALL</samp> or <samp class="ph codeph">CUSOLVER_EIG_RANGE_V</samp> or <samp class="ph codeph">CUSOLVER_EIG_RANGE_I</samp>,
                                          or <samp class="ph codeph">uplo</samp> is not <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp> or 
                                          <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-syevj"><a name="cuds-lt-t-gt-syevj" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-syevj" name="cuds-lt-t-gt-syevj" shape="rect">cusolverDn&lt;t&gt;syevj()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The helper functions below can calculate the sizes needed for pre-allocated buffer.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSsyevj_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const float *A,
    int lda,
    const float *W,
    int *lwork,
    syevjInfo_t params);

cusolverStatus_t 
cusolverDnDsyevj_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const double *A,
    int lda,
    const double *W,
    int *lwork,
    syevjInfo_t params);

cusolverStatus_t 
cusolverDnCheevj_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const cuComplex *A,
    int lda,
    const float *W,
    int *lwork,
    syevjInfo_t params);

cusolverStatus_t 
cusolverDnZheevj_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const cuDoubleComplex *A,
    int lda,
    const double *W,
    int *lwork,
    syevjInfo_t params);
</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively. 
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSsyevj(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    float *A,
    int lda,
    float *W,
    float *work,
    int lwork,
    int *info,
    syevjInfo_t params);

cusolverStatus_t 
cusolverDnDsyevj(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    double *A,
    int lda,
    double *W,
    double *work,
    int lwork,
    int *info,
    syevjInfo_t params);
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively. 
                              
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnCheevj(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    cuComplex *A,
    int lda,
    float *W,
    cuComplex *work,
    int lwork,
    int *info,
    syevjInfo_t params);

cusolverStatus_t 
cusolverDnZheevj(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    cuDoubleComplex *A,
    int lda,
    double *W,
    cuDoubleComplex *work,
    int lwork,
    int *info,
    syevjInfo_t params);

</pre></div>
                           <p class="p">
                              This function computes eigenvalues and eigenvectors of a symmetric (Hermitian) 
                              <samp class="ph codeph">n×n</samp> matrix <samp class="ph codeph">A</samp>. 
                              The standard symmetric eigenvalue problem is
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <mi>Q</mi>
                                             <mo>=</mo>
                                             <mi>Q</mi>
                                             <mo>*</mo>
                                             <mi>Λ</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">Λ</samp> is a real <samp class="ph codeph">n×n</samp> diagonal matrix.
                              <samp class="ph codeph">Q</samp> is an <samp class="ph codeph">n×n</samp> unitary matrix.  
                              The diagonal elements of <samp class="ph codeph">Λ</samp> are the eigenvalues of <samp class="ph codeph">A</samp> 
                              in ascending order. 
                              
                           </p>
                           <p class="p"><samp class="ph codeph">syevj</samp> has the same functionality as <samp class="ph codeph">syevd</samp>. 
                              The difference is that <samp class="ph codeph">syevd</samp> uses QR algorithm and <samp class="ph codeph">syevj</samp> uses Jacobi method.
                              The parallelism of Jacobi method gives GPU better performance on small and medium size matrices. 
                              Moreover the user can configure <samp class="ph codeph">syevj</samp> to perform approximation up to certain accuracy. 
                              
                           </p>
                           <p class="p">
                              How does it work?
                              
                           </p>
                           <p class="p"><samp class="ph codeph">syevj</samp> iteratively generates a sequence of unitary matrices to transform matrix <samp class="ph codeph">A</samp> 
                              to the following form
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msup>
                                                <mi>V</mi>
                                                <mi>H</mi>
                                             </msup>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <mi>V</mi>
                                             <mo>=</mo>
                                             <mi>W</mi>
                                             <mo>+</mo>
                                             <mi>E</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">W</samp> is diagonal and <samp class="ph codeph">E</samp> is symmetric without diagonal.
                              
                           </p>
                           <p class="p">
                              During the iterations, the Frobenius norm of <samp class="ph codeph">E</samp> decreases monotonically.
                              As <samp class="ph codeph">E</samp> goes down to zero, <samp class="ph codeph">W</samp> is the set of eigenvalues. 
                              In practice, Jacobi method stops if
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msub>
                                                <mi>||E||</mi>
                                                <mi>F</mi>
                                             </msub>
                                             <mi>≤</mi>
                                             <mo>eps</mo>
                                             <mo>*</mo>
                                             <msub>
                                                <mi>||A||</mi>
                                                <mi>F</mi>
                                             </msub>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">eps</samp> is given tolerance.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">syevj</samp> has two parameters to control the accuracy. 
                              First parameter is tolerance (<samp class="ph codeph">eps</samp>). 
                              The default value is machine accuracy but 
                              The user can use function <samp class="ph codeph">cusolverDnXsyevjSetTolerance</samp> to set a priori tolerance. 
                              The second parameter is maximum number of sweeps which controls number of iterations of Jacobi method.
                              The default value is 100 but the user can use function <samp class="ph codeph">cusolverDnXsyevjSetMaxSweeps</samp> 
                              to set a proper bound. The experimentis show 15 sweeps are good enough to converge to machine accuracy.
                              <samp class="ph codeph">syevj</samp> stops either tolerance is met or maximum number of sweeps is met.
                              
                           </p>
                           <p class="p">
                              Jacobi method has quadratic convergence, so the accuracy is not proportional to number of sweeps.
                              To guarantee certain accuracy, the user should configure tolerance only.
                              
                           </p>
                           <p class="p">
                              After <samp class="ph codeph">syevj</samp>, the user can query residual by function <samp class="ph codeph">cusolverDnXsyevjGetResidual</samp>
                              and number of executed sweeps by function <samp class="ph codeph">cusolverDnXsyevjGetSweeps</samp>.
                              However the user needs to be aware that residual is the Frobenius norm of <samp class="ph codeph">E</samp>, not accuracy of 
                              individual eigenvalue, i.e. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>residual</mi>
                                             <mi>=</mi>
                                             <msub>
                                                <mi>||E||</mi>
                                                <mi>F</mi>
                                             </msub>
                                             <mo>=</mo>
                                             <msub>
                                                <mrow>
                                                   <mi>||</mi>
                                                   <mi>Λ</mi>
                                                   <mo>-</mo>
                                                   <mi>W</mi>
                                                   <mi>||</mi>
                                                </mrow>
                                                <mi>F</mi>
                                             </msub>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The same as <samp class="ph codeph">syevd</samp>, the user has to provide working space pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is the size of the working space, and it is returned by
                              <samp class="ph codeph">syevj_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">info = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle). If <samp class="ph codeph">info = n+1</samp>, 
                              <samp class="ph codeph">syevj</samp> does not converge under given tolerance and maximum sweeps.
                              
                           </p>
                           <p class="p">
                              If the user sets an improper tolerance, <samp class="ph codeph">syevj</samp> may not converge.
                              For example, tolerance should not be smaller than machine accuracy.
                              
                           </p>
                           <p class="p">
                              if <samp class="ph codeph">jobz</samp> = CUSOLVER_EIG_MODE_VECTOR, 
                              <samp class="ph codeph">A</samp> contains the orthonormal eigenvectors <samp class="ph codeph">V</samp>.
                              
                           </p>
                           <p class="p">
                              Appendix F.3 provides a simple example of <samp class="ph codeph">syevj</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of syevj</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">jobz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options to either compute eigenvalue only or compute eigen-pair:
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>
                                          : Compute eigenvalues only;
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          : Compute eigenvalues and eigenvectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies which part of <samp class="ph codeph">A</samp> is stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>: 
                                          Lower triangle of <samp class="ph codeph">A</samp> is stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>: 
                                          Upper triangle of <samp class="ph codeph">A</samp> is stored.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows (or columns) of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>, 
                                          the leading n-by-n upper triangular part of <samp class="ph codeph">A</samp> 
                                          contains the upper triangular part of the matrix <samp class="ph codeph">A</samp>.  
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>, 
                                          the leading n-by-n lower triangular part of <samp class="ph codeph">A</samp> 
                                          contains the lower triangular part of the matrix <samp class="ph codeph">A</samp>.
                                          On exit, if <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>, 
                                          and <samp class="ph codeph">info</samp> = 0, 
                                          <samp class="ph codeph">A</samp> contains the
                                          orthonormal eigenvectors of the matrix <samp class="ph codeph">A</samp>.
                                          If <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>, 
                                          the contents of <samp class="ph codeph">A</samp> are destroyed.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">W</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">a real array of dimension <samp class="ph codeph">n</samp>.
                                          The eigenvalue values of <samp class="ph codeph">A</samp>, in ascending order ie, sorted so that <samp class="ph codeph">W(i) &lt;=  W(i+1)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">work</samp>, returned by <samp class="ph codeph">syevj_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">info = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">info = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">info =  n+1</samp>, <samp class="ph codeph">syevj</samp> dose not converge
                                          under given tolerance and maximum sweeps.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">params</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">structure filled with parameters of Jacobi algorithm and results of syevj. 
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp>, or 
                                          <samp class="ph codeph">lda&lt;max(1,n)</samp>, or <samp class="ph codeph">jobz</samp> is not 
                                          <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp> or <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>, or 
                                          <samp class="ph codeph">uplo</samp> is not <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp> or 
                                          <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-sygvj"><a name="cuds-lt-t-gt-sygvj" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-sygvj" name="cuds-lt-t-gt-sygvj" shape="rect">cusolverDn&lt;t&gt;sygvj()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The helper functions below can calculate the sizes needed for pre-allocated buffer.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSsygvj_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const float *A,
    int lda,
    const float *B,
    int ldb,
    const float *W,
    int *lwork,
    syevjInfo_t params);

cusolverStatus_t 
cusolverDnDsygvj_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const double *A,
    int lda,
    const double *B,
    int ldb,
    const double *W,
    int *lwork,
    syevjInfo_t params);

cusolverStatus_t 
cusolverDnChegvj_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const cuComplex *A,
    int lda,
    const cuComplex *B,
    int ldb,
    const float *W,
    int *lwork,
    syevjInfo_t params);

cusolverStatus_t 
cusolverDnZhegvj_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const cuDoubleComplex *A,
    int lda,
    const cuDoubleComplex *B,
    int ldb,
    const double *W,
    int *lwork,
    syevjInfo_t params);

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively. 
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSsygvj(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    float *A,
    int lda,
    float *B,
    int ldb,
    float *W,
    float *work,
    int lwork,
    int *info,
    syevjInfo_t params);

cusolverStatus_t
cusolverDnDsygvj(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    double *A,
    int lda,
    double *B,
    int ldb,
    double *W,
    double *work,
    int lwork,
    int *info,
    syevjInfo_t params);

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively. 
                              
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnChegvj(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    cuComplex *A,
    int lda,
    cuComplex *B,
    int ldb,
    float *W,
    cuComplex *work,
    int lwork,
    int *info,
    syevjInfo_t params);

cusolverStatus_t 
cusolverDnZhegvj(
    cusolverDnHandle_t handle,
    cusolverEigType_t itype,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    cuDoubleComplex *A,
    int lda,
    cuDoubleComplex *B,
    int ldb,
    double *W,
    cuDoubleComplex *work,
    int lwork,
    int *info,
    syevjInfo_t params);

</pre></div>
                           <p class="p">
                              This function computes eigenvalues and eigenvectors of a symmetric (Hermitian) 
                              <samp class="ph codeph">n×n</samp> matrix-pair (<samp class="ph codeph">A</samp>,<samp class="ph codeph">B</samp>). 
                              The generalized symmetric-definite eigenvalue problem is
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>eig(A,B)</mi>
                                             <mo>=</mo>
                                             <mfenced open="{" close="">
                                                <mtable columnalign="left left" rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>A</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>B</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>*</mo>
                                                         <mi>Λ</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_1</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>A</mi>
                                                         <mo>*</mo>
                                                         <mi>B</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>V</mi>
                                                         <mo>*</mo>
                                                         <mi>Λ</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_2</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>B</mi>
                                                         <mo>*</mo>
                                                         <mi>A</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>V</mi>
                                                         <mo>*</mo>
                                                         <mi>Λ</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_3</mtext>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where the matrix <samp class="ph codeph">B</samp> is positive definite.
                              <samp class="ph codeph">Λ</samp> is a real <samp class="ph codeph">n×n</samp> diagonal matrix.
                              The diagonal elements of <samp class="ph codeph">Λ</samp> are the eigenvalues of 
                              (<samp class="ph codeph">A</samp>, <samp class="ph codeph">B</samp>) in ascending order.
                              <samp class="ph codeph">V</samp> is an <samp class="ph codeph">n×n</samp> orthogonal matrix. 
                              The eigenvectors are normalized as follows: 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mfenced open="{" close="">
                                                <mtable columnalign="left left" rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <msup>
                                                            <mi>V</mi>
                                                            <mi>H</mi>
                                                         </msup>
                                                         <mo>*</mo>
                                                         <mi>B</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>I</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_1, CUSOLVER_EIG_TYPE_2</mtext>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <msup>
                                                            <mi>V</mi>
                                                            <mi>H</mi>
                                                         </msup>
                                                         <mo>*</mo>
                                                         <mi>inv(B)</mi>
                                                         <mo>*</mo>
                                                         <mi>V</mi>
                                                         <mo>=</mo>
                                                         <mi>I</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mtext>if&nbsp;</mtext>
                                                         <mtext mathvariant="sans-serif">itype = CUSOLVER_EIG_TYPE_3</mtext>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              This function has the same functionality as <samp class="ph codeph">sygvd</samp> except that <samp class="ph codeph">syevd</samp> 
                              in <samp class="ph codeph">sygvd</samp> is replaced by <samp class="ph codeph">syevj</samp> in <samp class="ph codeph">sygvj</samp>.
                              Therefore, <samp class="ph codeph">sygvj</samp> inherits properties of <samp class="ph codeph">syevj</samp>, 
                              the user can use <samp class="ph codeph">cusolverDnXsyevjSetTolerance</samp> and <samp class="ph codeph">cusolverDnXsyevjSetMaxSweeps</samp>
                              to configure tolerance and maximum sweeps.
                              
                           </p>
                           <p class="p">
                              However the meaning of residual is different from <samp class="ph codeph">syevj</samp>.
                              <samp class="ph codeph">sygvj</samp> first computes Cholesky factorization of matrix <samp class="ph codeph">B</samp>, 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>B</mi>
                                             <mo>=</mo>
                                             <mi>L</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>L</mi>
                                                <mi>H</mi>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              transform the problem to standard eigenvalue problem, then calls <samp class="ph codeph">syevj</samp>.
                              
                           </p>
                           <p class="p">
                              For example, the standard eigenvalue problem of type I is 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>M</mi>
                                             <mo>*</mo>
                                             <mi>Q</mi>
                                             <mo>=</mo>
                                             <mi>Q</mi>
                                             <mo>*</mo>
                                             <mi>Λ</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where matrix <samp class="ph codeph">M</samp> is symmtric
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>M</mi>
                                             <mo>=</mo>
                                             <msup>
                                                <mi>L</mi>
                                                <mi>-1</mi>
                                             </msup>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>L</mi>
                                                <mi>-H</mi>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The residual is the result of <samp class="ph codeph">syevj</samp> on matrix <samp class="ph codeph">M</samp>, not <samp class="ph codeph">A</samp>.
                              
                           </p>
                           <p class="p">
                              The user has to provide working space which is pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is the size of the working space, and it is returned by
                              <samp class="ph codeph">sygvj_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              If output parameter <samp class="ph codeph">info = -i</samp> (less than zero), the <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle). If <samp class="ph codeph">info = i</samp> (i &gt; 0 and i&lt;=n), 
                              <samp class="ph codeph">B</samp> is not positive definite, 
                              the factorization of <samp class="ph codeph">B</samp> could not be completed and 
                              no eigenvalues or eigenvectors were computed. 
                              If <samp class="ph codeph">info = n+1</samp>, <samp class="ph codeph">syevj</samp> does not converge under given tolerance and maximum sweeps.
                              In this case, the eigenvalues and eigenvectors are still computed because non-convergence comes from 
                              improper tolerance of maximum sweeps.
                              
                           </p>
                           <p class="p">
                              if <samp class="ph codeph">jobz</samp> = CUSOLVER_EIG_MODE_VECTOR, 
                              <samp class="ph codeph">A</samp> contains the orthogonal eigenvectors <samp class="ph codeph">V</samp>. 
                              
                           </p>
                           <p class="p">
                              Appendix F.4 provides a simple example of <samp class="ph codeph">sygvj</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of sygvj</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">itype</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">Specifies the problem type to be solved:
                                          <samp class="ph codeph">itype</samp>=CUSOLVER_EIG_TYPE_1: A*x = (lambda)*B*x.
                                          <samp class="ph codeph">itype</samp>=CUSOLVER_EIG_TYPE_2: A*B*x = (lambda)*x.
                                          <samp class="ph codeph">itype</samp>=CUSOLVER_EIG_TYPE_3: B*A*x = (lambda)*x.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">jobz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options to either compute eigenvalue only or compute eigen-pair:
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>
                                          : Compute eigenvalues only;
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          : Compute eigenvalues and eigenvectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies which part of <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> are stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>: 
                                          Lower triangle of <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> are stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>: 
                                          Upper triangle of <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp> are stored.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows (or columns) of matrix <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>, 
                                          the leading n-by-n upper triangular part of <samp class="ph codeph">A</samp> 
                                          contains the upper triangular part of the matrix <samp class="ph codeph">A</samp>.  
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>, 
                                          the leading n-by-n lower triangular part of <samp class="ph codeph">A</samp> 
                                          contains the lower triangular part of the matrix <samp class="ph codeph">A</samp>.
                                          On exit, if <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>, 
                                          and <samp class="ph codeph">info</samp> = 0, 
                                          <samp class="ph codeph">A</samp> contains the
                                          orthonormal eigenvectors of the matrix <samp class="ph codeph">A</samp>.
                                          If <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>, 
                                          the contents of <samp class="ph codeph">A</samp> are destroyed.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">A</samp>.
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">B</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">ldb * n</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>,
                                          the leading n-by-n upper triangular part of <samp class="ph codeph">B</samp>
                                          contains the upper triangular part of the matrix <samp class="ph codeph">B</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>,
                                          the leading n-by-n lower triangular part of <samp class="ph codeph">B</samp>
                                          contains the lower triangular part of the matrix <samp class="ph codeph">B</samp>.
                                          On exit, if <samp class="ph codeph">info</samp> is less than <samp class="ph codeph">n</samp>,
                                          <samp class="ph codeph">B</samp> is overwritten by triangular factor <samp class="ph codeph">U</samp>
                                          or <samp class="ph codeph">L</samp> from the Cholesky factorization of <samp class="ph codeph">B</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldb</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">B</samp>.
                                          <samp class="ph codeph">ldb</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">W</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">a real array of dimension <samp class="ph codeph">n</samp>.
                                          The eigenvalue values of <samp class="ph codeph">A</samp>, sorted so that <samp class="ph codeph">W(i) &gt;= W(i+1)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">working space, &lt;type&gt; array of size <samp class="ph codeph">lwork</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">work</samp>, returned by <samp class="ph codeph">sygvj_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">if <samp class="ph codeph">info = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">info = -i</samp>, the <samp class="ph codeph">i-th</samp> parameter is wrong (not counting handle).
                                          if <samp class="ph codeph">info =  i (&gt; 0)</samp>, <samp class="ph codeph">info</samp> indicates 
                                          either <samp class="ph codeph">B</samp> is not positive definite or 
                                          <samp class="ph codeph">syevj</samp> (called by <samp class="ph codeph">sygvj</samp>) does not converge.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp>, or 
                                          <samp class="ph codeph">lda&lt;max(1,n)</samp>, or <samp class="ph codeph">ldb&lt;max(1,n)</samp>,
                                          or <samp class="ph codeph">itype</samp> is not 1, 2 or 3,
                                          or <samp class="ph codeph">jobz</samp> is not <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp> or
                                          <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>, or 
                                          <samp class="ph codeph">uplo</samp> is not <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp> or 
                                          <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>).
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cuds-lt-t-gt-syevjbatch"><a name="cuds-lt-t-gt-syevjbatch" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cuds-lt-t-gt-syevjbatch" name="cuds-lt-t-gt-syevjbatch" shape="rect">cusolverDn&lt;t&gt;syevjBatched()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The helper functions below can calculate the sizes needed for pre-allocated buffer.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverDnSsyevjBatched_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const float *A,
    int lda,
    const float *W,
    int *lwork,
    syevjInfo_t params,
    int batchSize
    );

cusolverStatus_t 
cusolverDnDsyevjBatched_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const double *A,
    int lda,
    const double *W,
    int *lwork,
    syevjInfo_t params,
    int batchSize
    );

cusolverStatus_t
cusolverDnCheevjBatched_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const cuComplex *A,
    int lda,
    const float *W,
    int *lwork,
    syevjInfo_t params,
    int batchSize
    );

cusolverStatus_t
cusolverDnZheevjBatched_bufferSize(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    const cuDoubleComplex *A,
    int lda,
    const double *W,
    int *lwork,
    syevjInfo_t params,
    int batchSize
    );

</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively. 
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnSsyevjBatched(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    float *A,
    int lda,
    float *W,
    float *work,
    int lwork,
    int *info,
    syevjInfo_t params,
    int batchSize
    );

cusolverStatus_t 
cusolverDnDsyevjBatched(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    double *A,
    int lda,
    double *W,
    double *work,
    int lwork,
    int *info,
    syevjInfo_t params,
    int batchSize
    );

</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively. 
                              
                              <pre xml:space="preserve">
cusolverStatus_t
cusolverDnCheevjBatched(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    cuComplex *A,
    int lda,
    float *W,
    cuComplex *work,
    int lwork,
    int *info,
    syevjInfo_t params,
    int batchSize
    );

cusolverStatus_t 
cusolverDnZheevjBatched(
    cusolverDnHandle_t handle,
    cusolverEigMode_t jobz,
    cublasFillMode_t uplo,
    int n,
    cuDoubleComplex *A,
    int lda,
    double *W,
    cuDoubleComplex *work,
    int lwork,
    int *info,
    syevjInfo_t params,
    int batchSize
    );

</pre></div>
                           <p class="p">
                              This function computes eigenvalues and eigenvectors of a squence of symmetric (Hermitian) 
                              <samp class="ph codeph">n×n</samp> matrices
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msub>
                                                <mi>A</mi>
                                                <mi>j</mi>
                                             </msub>
                                             <mo>*</mo>
                                             <msub>
                                                <mi>Q</mi>
                                                <mi>j</mi>
                                             </msub>
                                             <mo>=</mo>
                                             <msub>
                                                <mi>Q</mi>
                                                <mi>j</mi>
                                             </msub>
                                             <mo>*</mo>
                                             <msub>
                                                <mi>Λ</mi>
                                                <mi>j</mi>
                                             </msub>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>Λ</mi>
                                    <mi>j</mi>
                                 </msub>
                              </math>
                              
                              
                              is a real <samp class="ph codeph">n×n</samp> diagonal matrix.
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>Q</mi>
                                    <mi>j</mi>
                                 </msub>
                              </math>
                              
                              
                              is an <samp class="ph codeph">n×n</samp> unitary matrix.  
                              The diagonal elements of 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>Λ</mi>
                                    <mi>j</mi>
                                 </msub>
                              </math>
                              
                              
                              are the eigenvalues of 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>j</mi>
                                 </msub>
                              </math>
                              
                              
                              in either ascending order or non-sorting order. 
                              
                           </p>
                           <p class="p"><samp class="ph codeph">syevjBatched</samp> performs <samp class="ph codeph">syevj</samp> on each matrix.
                              It requires that all matrices are of the same size <samp class="ph codeph">n</samp> no greater than 32 
                              and are packed in contiguous way,
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>A</mi>
                                                <mo>=</mo>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mi>A0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>A1</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>⋯</mi>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              Each matrix is column-major with leading dimension <samp class="ph codeph">lda</samp>,
                              so the formula for random access is
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>k</mi>
                                 </msub>
                                 <mo>(i,j)</mo>
                                 <mo>=</mo>
                                 <mi>A[ i + lda*j + lda*n*k]</mi>
                              </math>
                              
                              .
                              
                           </p>
                           <p class="p">
                              The parameter <samp class="ph codeph">W</samp> also contains eigenvalues of each matrix in contiguous way,
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>W</mi>
                                                <mo>=</mo>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mi>W0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>W1</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>⋯</mi>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The formula for random access of <samp class="ph codeph">W</samp> is
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>W</mi>
                                    <mi>k</mi>
                                 </msub>
                                 <mo>(j)</mo>
                                 <mo>=</mo>
                                 <mi>W[ j + n*k]</mi>
                              </math>
                              
                              .
                              
                           </p>
                           <p class="p">
                              Except for tolerance and maximum sweeps, <samp class="ph codeph">syevjBatched</samp> can either sort 
                              the eigenvalues in ascending order (default) or chose as-is (without sorting) by the function
                              <samp class="ph codeph">cusolverDnXsyevjSetSortEig</samp>.
                              If the user packs several tiny matrices into diagonal blocks of one matrix, 
                              non-sorting option can separate spectrum of those tiny matrices. 
                              
                           </p>
                           <p class="p"><samp class="ph codeph">syevjBatched</samp> cannot report residual and executed sweeps by 
                              function <samp class="ph codeph">cusolverDnXsyevjGetResidual</samp> and <samp class="ph codeph">cusolverDnXsyevjGetSweeps</samp>.
                              Any call of the above two returns <samp class="ph codeph">CUSOLVER_STATUS_NOT_SUPPORTED</samp>.
                              The user needs to compute residual explicitly.
                              
                           </p>
                           <p class="p">
                              The user has to provide working space pointed by input parameter <samp class="ph codeph">work</samp>.
                              The input parameter <samp class="ph codeph">lwork</samp> is the size of the working space, and it is returned by
                              <samp class="ph codeph">syevjBatched_bufferSize()</samp>.
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">info</samp> is an integer array of size <samp class="ph codeph">batchSize</samp>.
                              If the function returns <samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp>, 
                              the first element <samp class="ph codeph">info[0] = -i</samp> (less than zero) indicates <samp class="ph codeph">i-th</samp>
                              parameter is wrong (not counting handle).
                              Otherwise, if <samp class="ph codeph">info[i] = n+1</samp>, 
                              <samp class="ph codeph">syevjBatched</samp> does not converge on <samp class="ph codeph">i-th</samp> matrix 
                              under given tolerance and maximum sweeps.
                              
                           </p>
                           <p class="p">
                              if <samp class="ph codeph">jobz</samp> = CUSOLVER_EIG_MODE_VECTOR, 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mi>j</mi>
                                 </msub>
                              </math>
                              
                              
                              contains the orthonormal eigenvectors 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>V</mi>
                                    <mi>j</mi>
                                 </msub>
                              </math>
                              
                              .
                              
                           </p>
                           <p class="p">
                              Appendix F.5 provides a simple example of <samp class="ph codeph">syevjBatched</samp>.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">API of syevjBatched</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverDN library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">jobz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies options to either compute eigenvalue only or compute eigen-pair:
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>
                                          : Compute eigenvalues only;
                                          <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>
                                          : Compute eigenvalues and eigenvectors.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">uplo</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">specifies which part of <samp class="ph codeph">Aj</samp> is stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>: 
                                          Lower triangle of <samp class="ph codeph">Aj</samp> is stored.
                                          <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>: 
                                          Upper triangle of <samp class="ph codeph">Aj</samp> is stored.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows (or columns) of matrix each <samp class="ph codeph">Aj</samp>.
                                          <samp class="ph codeph">n</samp> is no greater than 32.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">A</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of dimension <samp class="ph codeph">lda * n * batchSize</samp> with
                                          <samp class="ph codeph">lda</samp> is not less than <samp class="ph codeph">max(1,n)</samp>.
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>, 
                                          the leading n-by-n upper triangular part of <samp class="ph codeph">Aj</samp> 
                                          contains the upper triangular part of the matrix <samp class="ph codeph">Aj</samp>.  
                                          If <samp class="ph codeph">uplo</samp> = <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp>, 
                                          the leading n-by-n lower triangular part of <samp class="ph codeph">Aj</samp> 
                                          contains the lower triangular part of the matrix <samp class="ph codeph">Aj</samp>.
                                          On exit, if <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>, 
                                          and <samp class="ph codeph">info[j]</samp> = 0, 
                                          <samp class="ph codeph">Aj</samp> contains the
                                          orthonormal eigenvectors of the matrix <samp class="ph codeph">Aj</samp>.
                                          If <samp class="ph codeph">jobz</samp> = <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp>, 
                                          the contents of <samp class="ph codeph">Aj</samp> are destroyed.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lda</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">leading dimension of two-dimensional array used to store matrix <samp class="ph codeph">Aj</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">W</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">a real array of dimension <samp class="ph codeph">n*batchSize</samp>.
                                          It stores the eigenvalues of <samp class="ph codeph">Aj</samp>
                                          in ascending order or non-sorting order.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">work</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of size <samp class="ph codeph">lwork</samp>, workspace.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">lwork</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">size of <samp class="ph codeph">work</samp>, returned by <samp class="ph codeph">syevjBatched_bufferSize</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">an integer array of dimension <samp class="ph codeph">batchSize</samp>.
                                          If <samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp> is returned, 
                                          <samp class="ph codeph">info[0] = -i</samp> (less than zero) indicates <samp class="ph codeph">i-th</samp>
                                          parameter is wrong (not counting handle).
                                          Otherwise,
                                          if <samp class="ph codeph">info[i] = 0</samp>, the operation is successful.
                                          if <samp class="ph codeph">info[i] =  n+1</samp>, <samp class="ph codeph">syevjBatched</samp> 
                                          dose not converge on <samp class="ph codeph">i-th</samp> matrix
                                          under given tolerance and maximum sweeps.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">params</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">structure filled with parameters of Jacobi algorithm. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">batchSize</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of matrices. </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n&lt;0</samp>, 
                                          <samp class="ph codeph">n&gt;32</samp> or 
                                          <samp class="ph codeph">lda&lt;max(1,n)</samp>, or <samp class="ph codeph">jobz</samp> is not 
                                          <samp class="ph codeph">CUSOLVER_EIG_MODE_NOVECTOR</samp> or <samp class="ph codeph">CUSOLVER_EIG_MODE_VECTOR</samp>, or 
                                          <samp class="ph codeph">uplo</samp> is not <samp class="ph codeph">CUBLAS_FILL_MODE_LOWER</samp> or 
                                          <samp class="ph codeph">CUBLAS_FILL_MODE_UPPER</samp>), or <samp class="ph codeph">batchSize&lt;0</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="cusolver-function-reference"><a name="cusolver-function-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cusolver-function-reference" name="cusolver-function-reference" shape="rect">cuSolverSP: sparse LAPACK Function Reference</a></h2>
                  <div class="body conbody">
                     <p class="p">
                        This chapter describes the API of cuSolverSP, which provides a subset of LAPACK funtions for sparse matrices in CSR or CSC
                        format.
                        
                     </p>
                  </div>
                  <div class="topic concept nested1" id="cusolver-helper-function-reference"><a name="cusolver-helper-function-reference" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-helper-function-reference" name="cusolver-helper-function-reference" shape="rect">Helper Function Reference</a></h3>
                     <div class="body conbody">
                        <p class="p"></p>
                     </div>
                     <div class="topic concept nested2" id="cusolverecreate"><a name="cusolverecreate" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolverecreate" name="cusolverecreate" shape="rect">cusolverSpCreate()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t
cusolverSpCreate(cusolverSpHandle_t *handle)
</pre><p class="p">
                              This function initializes the cuSolverSP library and creates a handle on the cuSolver context. 
                              It must be called before any other cuSolverSP API function is invoked. 
                              It allocates hardware resources necessary for accessing the GPU.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the pointer to the handle to the cuSolverSP context.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the initialization succeeded.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the CUDA Runtime initialization failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparsedestroy"><a name="cusparsedestroy" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparsedestroy" name="cusparsedestroy" shape="rect">cusolverSpDestroy()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">cusolverStatus_t
cusolverSpDestroy(cusolverSpHandle_t handle)</pre><p class="p">
                              This function releases CPU-side resources used by the cuSolverSP library. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the handle to the cuSolverSP context.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the shutdown succeeded.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusparsesetstream"><a name="cusparsesetstream" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusparsesetstream" name="cusparsesetstream" shape="rect">cusolverSpSetStream()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t
cusolverSpSetStream(cusolverSpHandle_t handle, cudaStream_t streamId)
</pre><p class="p">This function sets the stream to be used by the cuSolverSP library to execute its routines.</p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the handle to the cuSolverSP context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">streamId</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the stream to be used by the library.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the stream was set successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csrissym"><a name="cusolver-lt-t-gt-csrissym" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csrissym" name="cusolver-lt-t-gt-csrissym" shape="rect">cusolverSpXcsrissym()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusolverStatus_t 
cusolverSpXcsrissymHost(cusolverSpHandle_t handle,
              int m,
              int nnzA,
              const cusparseMatDescr_t descrA,
              const int *csrRowPtrA,
              const int *csrEndPtrA,
              const int *csrColIndA,
              int *issym);

</pre><p class="p">
                              This function checks if <samp class="ph codeph">A</samp> has symmetric pattern or not.
                              The output parameter <samp class="ph codeph">issym</samp> reports 1 if 
                              <samp class="ph codeph">A</samp> is symmetric; otherwise, it reports 0.  
                              
                           </p>
                           <p class="p">
                              The matrix <samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                              format by the four arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, 
                              <samp class="ph codeph">csrEndPtrA</samp> and <samp class="ph codeph">csrColIndA</samp>. 
                              
                           </p>
                           <p class="p">
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              
                           </p>
                           <p class="p">
                              The <samp class="ph codeph">csrlsvlu</samp> and <samp class="ph codeph">csrlsvqr</samp> do not accept non-general matrix.
                              the user has to extend the matrix into its missing upper/lower part, otherwise the result is 
                              not expected. The user can use <samp class="ph codeph">csrissym</samp> to check if the matrix 
                              has symmetric pattern or not.
                              
                           </p>
                           <p class="p">
                              Remark 1: only CPU path is provided.
                              
                           </p>
                           <p class="p">
                              Remark 2: the user has to check returned status to get valid information. 
                              The function converts <samp class="ph codeph">A</samp> to CSC format and 
                              compare CSR and CSC format. If the CSC failed because of insufficient resources,
                              <samp class="ph codeph">issym</samp> is undefined, and this state can only be detected by the return status code.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">MemorySpace  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSolverSP library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                          It is the size of <samp class="ph codeph">csrValA</samp> and <samp class="ph codeph">csrColIndA</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp> elements that contains the start of every row.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrEndPtrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp> elements that contains the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp>column indices of the nonzero elements 
                                          of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">MemorySpace  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">issym</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">1 if <samp class="ph codeph">A</samp> is symmetric; 0 otherwise.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnzA&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusolver-high-level-function-reference"><a name="cusolver-high-level-function-reference" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-high-level-function-reference" name="cusolver-high-level-function-reference" shape="rect">High Level Function Reference</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This section describes high level API of cuSolverSP, including linear solver, 
                           least-square solver and eigenvalue solver.
                           The high-level API is designed for ease-of-use, so it allocates any required memory under the hood automatically.
                           If the host or GPU system memory is not enough, an error is returned.
                           
                        </p>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csrlsvlu"><a name="cusolver-lt-t-gt-csrlsvlu" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csrlsvlu" name="cusolver-lt-t-gt-csrlsvlu" shape="rect">6.2.1.&nbsp;cusolverSp&lt;t&gt;csrlsvlu()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverSpScsrlsvlu[Host](cusolverSpHandle_t handle,
                 int n,
                 int nnzA,
                 const cusparseMatDescr_t descrA,
                 const float *csrValA,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 const float *b,
                 float tol,
                 int reorder,
                 float *x,
                 int *singularity);

cusolverStatus_t 
cusolverSpDcsrlsvlu[Host](cusolverSpHandle_t handle,
                 int n,
                 int nnzA,
                 const cusparseMatDescr_t descrA,
                 const double *csrValA,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 const double *b,
                 double tol,
                 int reorder,
                 double *x,
                 int *singularity);

cusolverStatus_t 
cusolverSpCcsrlsvlu[Host](cusolverSpHandle_t handle,
                 int n,
                 int nnzA,
                 const cusparseMatDescr_t descrA,
                 const cuComplex *csrValA,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 const cuComplex *b,
                 float tol,
                 int reorder,
                 cuComplex *x,
                 int *singularity);

cusolverStatus_t 
cusolverSpZcsrlsvlu[Host](cusolverSpHandle_t handle,
                 int n,
                 int nnzA,
                 const cusparseMatDescr_t descrA,
                 const cuDoubleComplex *csrValA,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 const cuDoubleComplex *b,
                 double tol,
                 int reorder,
                 cuDoubleComplex *x,
                 int *singularity);

</pre><p class="p">This function solves the linear system </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <mi>x</mi>
                                             <mo>=</mo>
                                             <mi>b</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">n×n</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and <samp class="ph codeph">csrColIndA</samp>. 
                              <samp class="ph codeph">b</samp> is the right-hand-side vector of size <samp class="ph codeph">n</samp>, 
                              and <samp class="ph codeph">x</samp> is the solution vector of size <samp class="ph codeph">n</samp>.
                              
                           </p>
                           <p class="p">
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              If matrix <samp class="ph codeph">A</samp> is symmetric/Hermitian and only lower/upper part is used or meaningful, 
                              the user has to extend the matrix into its missing upper/lower part, otherwise the result would be wrong. 
                              
                           </p>
                           <p class="p">
                              The linear system is solved by sparse LU with partial pivoting, 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>P</mi>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mi>L</mi>
                                             <mo>*</mo>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">cusolver</samp> library provides three reordering schemes, 
                              <samp class="ph codeph">symrcm</samp><samp class="ph codeph">symamd</samp>, and <samp class="ph codeph">csrmetisnd</samp>  
                              to reduce zero fill-in which dramactically affects the performance of LU factorization.
                              The input parameter <samp class="ph codeph">reorder</samp> can enable <samp class="ph codeph">symrcm</samp> 
                              (<samp class="ph codeph">symamd</samp> or <samp class="ph codeph">csrmetisnd</samp>) if 
                              <samp class="ph codeph">reorder</samp> is 1 (2, or 3), otherwise, no reordering is performed.
                              
                           </p>
                           <p class="p">
                              If <samp class="ph codeph">reorder</samp> is nonzero, <samp class="ph codeph">csrlsvlu</samp> does 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>P</mi>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>Q</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>T</mi>
                                                </mrow>
                                             </msup>
                                             <mo>=</mo>
                                             <mi>L</mi>
                                             <mo>*</mo>
                                             <mi>U</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>Q</mi>
                                 <mo>=</mo>
                                 <mi>symrcm</mi>
                                 <mi>(</mi>
                                 <mi>A</mi>
                                 <mo>+</mo>
                                 <msup>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>T</mi>
                                    </mrow>
                                 </msup>
                                 <mi>)</mi>
                              </math>
                              
                              . 
                              
                           </p>
                           <p class="p">
                              If <samp class="ph codeph">A</samp> is singular under given tolerance (<samp class="ph codeph">max(tol,0)</samp>), 
                              then some diagonal elements of <samp class="ph codeph">U</samp> is zero, i.e.  
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>|U(j,j)|</mi>
                                             <mo>&lt;</mo>
                                             <mi>tol for some j</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The output parameter <samp class="ph codeph">singularity</samp> is the smallest index of such <samp class="ph codeph">j</samp>.
                              If <samp class="ph codeph">A</samp> is non-singular, <samp class="ph codeph">singularity</samp> is -1.
                              The index is base-0, independent of base index of <samp class="ph codeph">A</samp>.
                              For example, if 2nd column of <samp class="ph codeph">A</samp> is the same as first column, 
                              then <samp class="ph codeph">A</samp> is singular and <samp class="ph codeph">singularity = 1</samp> which means <samp class="ph codeph">U(1,1)≈0</samp>.
                              
                           </p>
                           <p class="p">
                              Remark 1: <samp class="ph codeph">csrlsvlu</samp> performs traditional LU with partial pivoting, the pivot of k-th column is
                              determined dynamically based on the k-th column of intermediate matrix. 
                              <samp class="ph codeph">csrlsvlu</samp> follows Gilbert and Peierls's algorithm [4] which uses depth-first-search 
                              and topological ordering to solve triangular system (Davis also describes this algorithm in detail in his book [1]). 
                              since cuda 10.1, <samp class="ph codeph">csrlsvlu</samp> will incrementally reallocate the memory to store <samp class="ph codeph">L</samp> and
                              <samp class="ph codeph">U</samp>. This feature can avoid over-estimate size from QR factorization.
                              In some cases, zero fill-in of QR can be order of magnitude higher than LU.
                              
                           </p>
                           <p class="p">
                              Remark 2: only CPU (Host) path is provided. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverSP library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. 
                                          The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and 
                                          <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnzA</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(n)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">n</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnzA</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(n)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">b</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">right hand side vector of size <samp class="ph codeph">n</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tol</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">tolerance to decide if singular or not. </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">reorder</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">no ordering if <samp class="ph codeph">reorder</samp>=0. 
                                          Otherwise, <samp class="ph codeph">symrcm</samp>, <samp class="ph codeph">symamd</samp>, or <samp class="ph codeph">csrmetisnd</samp> 
                                          is used to reduce zero fill-in.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">solution vector of size <samp class="ph codeph">n</samp>, x = inv(A)*b.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">singularity</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">-1 if <samp class="ph codeph">A</samp> is invertible.
                                          Otherwise, first index j such that <samp class="ph codeph">U(j,j)≈0</samp></td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n,nnzA&lt;=0</samp>,
                                          base index is not 0 or 1, <samp class="ph codeph">reorder</samp> is not 0,1,2,3)
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csrlsvqr"><a name="cusolver-lt-t-gt-csrlsvqr" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csrlsvqr" name="cusolver-lt-t-gt-csrlsvqr" shape="rect">6.2.2.&nbsp;cusolverSp&lt;t&gt;csrlsvqr()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverSpScsrlsvqr[Host](cusolverSpHandle_t handle,
                 int m,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 const float *csrValA,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 const float *b,
                 float tol,
                 int reorder,
                 float *x,
                 int *singularity);

cusolverStatus_t 
cusolverSpDcsrlsvqr[Host](cusolverSpHandle_t handle,
                 int m,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 const double *csrValA,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 const double *b,
                 double tol,
                 int reorder,
                 double *x,
                 int *singularity);

cusolverStatus_t 
cusolverSpCcsrlsvqr[Host](cusolverSpHandle_t handle,
                 int m,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 const cuComplex *csrValA,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 const cuComplex *b,
                 float tol,
                 int reorder,
                 cuComplex *x,
                 int *singularity);

cusolverStatus_t 
cusolverSpZcsrlsvqr[Host](cusolverSpHandle_t handle,
                 int m,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 const cuDoubleComplex *csrValA,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 const cuDoubleComplex *b,
                 double tol,
                 int reorder,
                 cuDoubleComplex *x,
                 int *singularity);

</pre><p class="p">This function solves the linear system </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <mi>x</mi>
                                             <mo>=</mo>
                                             <mi>b</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and <samp class="ph codeph">csrColIndA</samp>. 
                              <samp class="ph codeph">b</samp> is the right-hand-side vector of size <samp class="ph codeph">m</samp>, 
                              and <samp class="ph codeph">x</samp> is the solution vector of size <samp class="ph codeph">m</samp>.
                              
                           </p>
                           <p class="p">
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              If matrix <samp class="ph codeph">A</samp> is symmetric/Hermitian and only lower/upper part is used or meaningful, 
                              the user has to extend the matrix into its missing upper/lower part, otherwise the result would be wrong. 
                              
                           </p>
                           <p class="p">
                              The linear system is solved by sparse QR factorization, 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A = Q*R</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              If <samp class="ph codeph">A</samp> is singular under given tolerance (<samp class="ph codeph">max(tol,0)</samp>), 
                              then some diagonal elements of <samp class="ph codeph">R</samp> is zero, i.e.  
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>|R(j,j)|</mi>
                                             <mo>&lt;</mo>
                                             <mi>tol for some j</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The output parameter <samp class="ph codeph">singularity</samp> is the smallest index of such <samp class="ph codeph">j</samp>.
                              If <samp class="ph codeph">A</samp> is non-singular, <samp class="ph codeph">singularity</samp> is -1.
                              The <samp class="ph codeph">singularity</samp> is base-0, independent of base index of <samp class="ph codeph">A</samp>.
                              For example, if 2nd column of <samp class="ph codeph">A</samp> is the same as first column, 
                              then <samp class="ph codeph">A</samp> is singular
                              and <samp class="ph codeph">singularity = 1</samp> which means <samp class="ph codeph">R(1,1)≈0</samp>.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">cusolver</samp> library provides three reordering schemes,
                              <samp class="ph codeph">symrcm</samp><samp class="ph codeph">symamd</samp>, and <samp class="ph codeph">csrmetisnd</samp>
                              to reduce zero fill-in which dramactically affects the performance of QR factorization.
                              The input parameter <samp class="ph codeph">reorder</samp> can enable <samp class="ph codeph">symrcm</samp>
                              (<samp class="ph codeph">symamd</samp> or <samp class="ph codeph">csrmetisnd</samp>) if
                              <samp class="ph codeph">reorder</samp> is 1 (2, or 3), otherwise, no reordering is performed.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverSP library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">b</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">right hand side vector of size <samp class="ph codeph">m</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tol</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">tolerance to decide if singular or not. </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">reorder</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">no ordering if <samp class="ph codeph">reorder</samp>=0.
                                          Otherwise, <samp class="ph codeph">symrcm</samp>, <samp class="ph codeph">symamd</samp>, or <samp class="ph codeph">csrmetisnd</samp>
                                          is used to reduce zero fill-in.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">solution vector of size <samp class="ph codeph">m</samp>, x = inv(A)*b.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">singularity</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">-1 if <samp class="ph codeph">A</samp> is invertible.
                                          Otherwise, first index j such that <samp class="ph codeph">R(j,j)≈0</samp></td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>,
                                          base index is not 0 or 1, <samp class="ph codeph">reorder</samp> is not 0,1,2,3)
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csrlsvchol"><a name="cusolver-lt-t-gt-csrlsvchol" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csrlsvchol" name="cusolver-lt-t-gt-csrlsvchol" shape="rect">6.2.3.&nbsp;cusolverSp&lt;t&gt;csrlsvchol()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverSpScsrlsvchol[Host](cusolverSpHandle_t handle,
                     int m,
                     int nnz,
                     const cusparseMatDescr_t descrA,
                     const float *csrVal,
                     const int *csrRowPtr,
                     const int *csrColInd,
                     const float *b,
                     float tol,
                     int reorder,
                     float *x,
                     int *singularity);

cusolverStatus_t 
cusolverSpDcsrlsvchol[Host](cusolverSpHandle_t handle,
                     int m,
                     int nnz,
                     const cusparseMatDescr_t descrA,
                     const double *csrVal,
                     const int *csrRowPtr,
                     const int *csrColInd,
                     const double *b,
                     double tol,
                     int reorder,
                     double *x,
                     int *singularity);

cusolverStatus_t 
cusolverSpCcsrlsvchol[Host](cusolverSpHandle_t handle,
                     int m,
                     int nnz,
                     const cusparseMatDescr_t descrA,
                     const cuComplex *csrVal,
                     const int *csrRowPtr,
                     const int *csrColInd,
                     const cuComplex *b,
                     float tol,
                     int reorder,
                     cuComplex *x,
                     int *singularity);

cusolverStatus_t 
cusolverSpZcsrlsvchol[Host](cusolverSpHandle_t handle,
                     int m,
                     int nnz,
                     const cusparseMatDescr_t descrA,
                     const cuDoubleComplex *csrVal,
                     const int *csrRowPtr,
                     const int *csrColInd,
                     const cuDoubleComplex *b,
                     double tol,
                     int reorder,
                     cuDoubleComplex *x,
                     int *singularity);

</pre><p class="p">This function solves the linear system </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <mi>x</mi>
                                             <mo>=</mo>
                                             <mi>b</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> symmetric postive definite sparse matrix 
                              that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and <samp class="ph codeph">csrColIndA</samp>. 
                              <samp class="ph codeph">b</samp> is the right-hand-side vector of size <samp class="ph codeph">m</samp>, 
                              and <samp class="ph codeph">x</samp> is the solution vector of size <samp class="ph codeph">m</samp>.
                              
                           </p>
                           <p class="p">
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp> and 
                              upper triangular part of <samp class="ph codeph">A</samp> is ignored 
                              (if parameter <samp class="ph codeph">reorder</samp> is zero).
                              In other words, suppose input matrix <samp class="ph codeph">A</samp> is decomposed as  
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>=</mo>
                                 <mi>L</mi>
                                 <mo>+</mo>
                                 <mi>D</mi>
                                 <mo>+</mo>
                                 <mi>U</mi>
                              </math>
                              
                              , where <samp class="ph codeph">L</samp> is lower triangular, <samp class="ph codeph">D</samp> is diagonal and 
                              <samp class="ph codeph">U</samp> is upper triangular.
                              The function would ignore <samp class="ph codeph">U</samp> and regard <samp class="ph codeph">A</samp> as a symmetric matrix 
                              with the formula
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>=</mo>
                                 <mi>L</mi>
                                 <mo>+</mo>
                                 <mi>D</mi>
                                 <mo>+</mo>
                                 <msup>
                                    <mi>L</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              .
                              If parameter <samp class="ph codeph">reorder</samp> is nonzero, the user has to extend <samp class="ph codeph">A</samp> 
                              to a full matrix, otherwise the solution would be wrong.
                              
                           </p>
                           <p class="p">
                              The linear system is solved by sparse Cholesky factorization, 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mi>G</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>G</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>H</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where <samp class="ph codeph">G</samp> is the Cholesky factor, a lower triangular matrix.
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">singularity</samp> has two meanings:
                              
                           </p>
                           <div class="p"><a name="cusolver-lt-t-gt-csrlsvchol__ul_ivn_fbt_nm" shape="rect">
                                 <!-- --></a><ul class="ul" id="cusolver-lt-t-gt-csrlsvchol__ul_ivn_fbt_nm">
                                 <li class="li">
                                    If <samp class="ph codeph">A</samp> is not postive definite, there exists some integer <samp class="ph codeph">k</samp>
                                    such that <samp class="ph codeph">A(0:k, 0:k)</samp> is not positive definite.
                                    <samp class="ph codeph">singularity</samp> is the minimum of such <samp class="ph codeph">k</samp>.
                                    
                                 </li>
                                 <li class="li">
                                    If <samp class="ph codeph">A</samp> is postive definite but near singular under tolerance (<samp class="ph codeph">max(tol,0)</samp>),
                                    i.e. there exists some integer <samp class="ph codeph">k</samp> such that 
                                    
                                    
                                    
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                       <mi>G</mi>
                                       <mfenced open="(" close=")">
                                          <mtable rowspacing="4pt" columnspacing="1em">
                                             <mtr>
                                                <mtd>
                                                   <mi>k,k</mi>
                                                </mtd>
                                             </mtr>
                                          </mtable>
                                       </mfenced>
                                       <mo>&lt;=</mo>
                                       <mi>tol</mi>
                                    </math>
                                    
                                    
                                    . <samp class="ph codeph">singularity</samp> is the minimum of such <samp class="ph codeph">k</samp>.
                                    
                                 </li>
                              </ul>
                           </div>
                           <p class="p"><samp class="ph codeph">singularity</samp> is base-0.
                              If <samp class="ph codeph">A</samp> is positive definite and not near singular under tolerance,
                              <samp class="ph codeph">singularity</samp> is -1.
                              If the user wants to know if <samp class="ph codeph">A</samp> is postive definite or not,  
                              <samp class="ph codeph">tol=0</samp> is enough.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">cusolver</samp> library provides three reordering schemes,
                              <samp class="ph codeph">symrcm</samp><samp class="ph codeph">symamd</samp>, and <samp class="ph codeph">csrmetisnd</samp>
                              to reduce zero fill-in which dramactically affects the performance of Cholesky factorization.
                              The input parameter <samp class="ph codeph">reorder</samp> can enable <samp class="ph codeph">symrcm</samp>
                              (<samp class="ph codeph">symamd</samp> or <samp class="ph codeph">csrmetisnd</samp>) if
                              <samp class="ph codeph">reorder</samp> is 1 (2, or 3), otherwise, no reordering is performed.
                              
                           </p>
                           <p class="p">
                              Remark 1: the function works for in-place 
                              (<samp class="ph codeph">x</samp> and <samp class="ph codeph">b</samp> point to the same memory block) and out-of-place.
                              
                           </p>
                           <p class="p">
                              Remark 2: the function only works on 32-bit index, if matrix <samp class="ph codeph">G</samp> has large zero fill-in
                              such that number of nonzeros is bigger than 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msup>
                                    <mn>2</mn>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mn>31</mn>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              , then <samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp> is returned. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverSP library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">b</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">right hand side vector of size <samp class="ph codeph">m</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tol</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">tolerance to decide singularity. </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">reorder</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">no ordering if <samp class="ph codeph">reorder</samp>=0.
                                          Otherwise, <samp class="ph codeph">symrcm</samp>, <samp class="ph codeph">symamd</samp>, or <samp class="ph codeph">csrmetisnd</samp>
                                          is used to reduce zero fill-in.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">solution vector of size <samp class="ph codeph">m</samp>, x = inv(A)*b.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">singularity</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">-1 if <samp class="ph codeph">A</samp> is symmetric postive definite.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>,
                                          base index is not 0 or 1, <samp class="ph codeph">reorder</samp> is not 0,1,2,3)
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csrlsqvqr"><a name="cusolver-lt-t-gt-csrlsqvqr" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csrlsqvqr" name="cusolver-lt-t-gt-csrlsqvqr" shape="rect">6.2.4.&nbsp;cusolverSp&lt;t&gt;csrlsqvqr()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverSpScsrlsqvqr[Host](cusolverSpHandle_t handle,
                  int m,
                  int n,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  const float *csrValA,
                  const int *csrRowPtrA,
                  const int *csrColIndA,
                  const float *b,
                  float tol,
                  int *rankA,
                  float *x,
                  int *p,
                  float *min_norm);

cusolverStatus_t 
cusolverSpDcsrlsqvqr[Host](cusolverSpHandle_t handle,
                  int m,
                  int n,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  const double *csrValA,
                  const int *csrRowPtrA,
                  const int *csrColIndA,
                  const double *b,
                  double tol,
                  int *rankA,
                  double *x,
                  int *p,
                  double *min_norm);
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverSpCcsrlsqvqr[Host](cusolverSpHandle_t handle,
                  int m,
                  int n,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  const cuComplex *csrValA,
                  const int *csrRowPtrA,
                  const int *csrColIndA,
                  const cuComplex *b,
                  float tol,
                  int *rankA,
                  cuComplex *x,
                  int *p,
                  float *min_norm);

cusolverStatus_t 
cusolverSpZcsrlsqvqr[Host](cusolverSpHandle_t handle,
                  int m,
                  int n,
                  int nnz,
                  const cusparseMatDescr_t descrA,
                  const cuDoubleComplex *csrValA,
                  const int *csrRowPtrA,
                  const int *csrColIndA,
                  const cuDoubleComplex *b,
                  double tol,
                  int *rankA,
                  cuDoubleComplex *x,
                  int *p,
                  double *min_norm);
</pre></div>
                           <p class="p">This function solves the following least-square problem
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>x</mi>
                                             <mo>=</mo>
                                             <mi>argmin</mi>
                                             <mi>||</mi>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <mi>z</mi>
                                             <mo>-</mo>
                                             <mi>b</mi>
                                             <mi>||</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×n</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                              <samp class="ph codeph">csrColIndA</samp>. 
                              <samp class="ph codeph">b</samp> is the right-hand-side vector of size <samp class="ph codeph">m</samp>,
                              and <samp class="ph codeph">x</samp> is the least-square solution vector of size <samp class="ph codeph">n</samp>.
                              
                           </p>
                           <p class="p">
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              If <samp class="ph codeph">A</samp> is square, symmetric/Hermitian and only lower/upper part is used or meaningful,
                              the user has to extend the matrix into its missing upper/lower part, otherwise the result is wrong.
                              
                           </p>
                           <p class="p">
                              This function only works if <samp class="ph codeph">m</samp> is greater or equal to <samp class="ph codeph">n</samp>, in other words, 
                              <samp class="ph codeph">A</samp> is a tall matrix.
                              
                           </p>
                           <p class="p">
                              The least-square problem is solved by sparse QR factorization with column pivoting,
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>P</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>T</mi>
                                                </mrow>
                                             </msup>
                                             <mo>=</mo>
                                             <mi>Q</mi>
                                             <mo>*</mo>
                                             <mi>R</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              If <samp class="ph codeph">A</samp> is of full rank (i.e. all columns of <samp class="ph codeph">A</samp> are linear independent), 
                              then matrix <samp class="ph codeph">P</samp> is an identity.
                              Suppose rank of <samp class="ph codeph">A</samp> is <samp class="ph codeph">k</samp>, less than <samp class="ph codeph">n</samp>, 
                              the permutation matrix <samp class="ph codeph">P</samp> reorders columns of 
                              <samp class="ph codeph">A</samp> in the following sense:
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>A</mi>
                                                <mo>*</mo>
                                                <msup>
                                                   <mi>P</mi>
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mi>T</mi>
                                                   </mrow>
                                                </msup>
                                                <mo>=</mo>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>A</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>A</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                                <mo>=</mo>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>Q</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>Q</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>R</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>R</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd></mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>R</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>2</mn>
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>R</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mn>1</mn>
                                       <mn>1</mn>
                                    </mrow>
                                 </msub>
                              </math>
                              
                              and <samp class="ph codeph">A</samp> have the same rank, but 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>R</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mn>2</mn>
                                       <mn>2</mn>
                                    </mrow>
                                 </msub>
                              </math>
                              
                              is almost zero, i.e. every column of 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mn>2</mn>
                                    </mrow>
                                 </msub>
                              </math>
                              
                              is linear combination of 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mn>1</mn>
                                    </mrow>
                                 </msub>
                              </math>
                              
                              .
                              
                           </p>
                           <p class="p">
                              The input parameter <samp class="ph codeph">tol</samp> decides numerical rank. 
                              The absolute value of every entry in 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>R</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mn>2</mn>
                                       <mn>2</mn>
                                    </mrow>
                                 </msub>
                              </math>
                              
                              is less than or equal to <samp class="ph codeph">tolerance=max(tol,0)</samp>.
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">rankA</samp> denotes numerical rank of <samp class="ph codeph">A</samp>.
                              
                           </p>
                           <p class="p">
                              Suppose 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>y</mi>
                                 <mo>=</mo>
                                 <mi>P</mi>
                                 <mo>*</mo>
                                 <mi>x</mi>
                              </math>
                              
                              and 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>c</mi>
                                 <mo>=</mo>
                                 <msup>
                                    <mi>Q</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                                 <mo>*</mo>
                                 <mi>b</mi>
                              </math>
                              
                              , the least square problem can be reformed by
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>min</mi>
                                                <mo>||</mo>
                                                <mi>A</mi>
                                                <mo>*</mo>
                                                <mi>x</mi>
                                                <mo>-</mo>
                                                <mi>b</mi>
                                                <mo>||</mo>
                                                <mo>=</mo>
                                                <mi>min</mi>
                                                <mo>||</mo>
                                                <mi>R</mi>
                                                <mo>*</mo>
                                                <mi>y</mi>
                                                <mo>-</mo>
                                                <mi>c</mi>
                                                <mo>||</mo>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              or in matrix form
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>R</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>R</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd></mtd>
                                                         <mtd>
                                                            <msub>
                                                               <mi>R</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>2</mn>
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>y</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>y</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                                <mo>=</mo>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>c</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>c</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The output parameter <samp class="ph codeph">min_norm</samp> is 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mo>||</mo>
                                 <msub>
                                    <mi>c</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mn>2</mn>
                                    </mrow>
                                 </msub>
                                 <mo>||</mo>
                              </math>
                              
                              , which is minimum value of least-square problem. 
                              
                           </p>
                           <p class="p">
                              If <samp class="ph codeph">A</samp> is not of full rank, above equation does not have a unique solution. 
                              The least-square problem is equivalent to 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>min</mi>
                                                         <mo>||</mo>
                                                         <mi>y</mi>
                                                         <mo>||</mo>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>subject to </mi>
                                                         <msub>
                                                            <mi>R</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>1</mn>
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                         <mo>*</mo>
                                                         <msub>
                                                            <mi>y</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                         <mo>+</mo>
                                                         <msub>
                                                            <mi>R</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>1</mn>
                                                               <mn>2</mn>
                                                            </mrow>
                                                         </msub>
                                                         <mo>*</mo>
                                                         <msub>
                                                            <mi>y</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>2</mn>
                                                            </mrow>
                                                         </msub>
                                                         <mo>=</mo>
                                                         <msub>
                                                            <mi>c</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                               <mn>1</mn>
                                                            </mrow>
                                                         </msub>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              Or equivalently another least-square problem 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>min||</mi>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>R</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                            <mo>\</mo>
                                                            <msub>
                                                               <mi>R</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                                  <mn>2</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mi>I</mi>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                                <mo>*</mo>
                                                <msub>
                                                   <mi>y</mi>
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mn>2</mn>
                                                   </mrow>
                                                </msub>
                                                <mo>-</mo>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <msub>
                                                               <mi>R</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                            <mo>\</mo>
                                                            <msub>
                                                               <mi>c</mi>
                                                               <mrow class="MJX-TeXAtom-ORD">
                                                                  <mn>1</mn>
                                                               </mrow>
                                                            </msub>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mi>O</mi>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                                <mi>||</mi>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The output parameter <samp class="ph codeph">x</samp> is 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msup>
                                    <mi>P</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>T</mi>
                                    </mrow>
                                 </msup>
                                 <mo>*</mo>
                                 <mi>y</mi>
                              </math>
                              
                              , the solution of least-square problem.
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">p</samp> is a vector of size <samp class="ph codeph">n</samp>.
                              It corresponds to a permutation matrix <samp class="ph codeph">P</samp>.
                              <samp class="ph codeph">p(i)=j</samp> means <samp class="ph codeph">(P*x)(i) = x(j)</samp>.
                              If <samp class="ph codeph">A</samp> is of full rank, <samp class="ph codeph">p=0:n-1</samp>.
                              
                           </p>
                           <p class="p">
                              Remark 1: <samp class="ph codeph">p</samp> is always base 0, independent of base index of <samp class="ph codeph">A</samp>.
                              
                           </p>
                           <p class="p">
                              Remark 2: only CPU (Host) path is provided. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolver library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">b</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">right hand side vector of size <samp class="ph codeph">m</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tol</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">tolerance to decide rank of <samp class="ph codeph">A</samp>. 
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">rankA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">numerical rank of <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">solution vector of size <samp class="ph codeph">n</samp>, x=pinv(A)*b.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">p</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">a vector of size <samp class="ph codeph">n</samp>, which represents the permuation matrix <samp class="ph codeph">P</samp> satisfying A*P^T=Q*R.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">min_norm</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">||A*x-b||, x=pinv(A)*b</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnz&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csreigsi"><a name="cusolver-lt-t-gt-csreigsi" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csreigsi" name="cusolver-lt-t-gt-csreigsi" shape="rect">6.2.5.&nbsp;cusolverSp&lt;t&gt;csreigvsi()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverSpScsreigvsi[Host](cusolverSpHandle_t handle,
                 int m,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 const float *csrValA,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 float mu0,
                 const float *x0,
                 int maxite,
                 float tol,
                 float *mu,
                 float *x);

cusolverStatus_t
cusolverSpDcsreigvsi[Host](cusolverSpHandle_t handle,
                 int m,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 const double *csrValA,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 double mu0,
                 const double *x0,
                 int maxite,
                 double tol,
                 double *mu,
                 double *x);
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverSpCcsreigvsi[Host](cusolverSpHandle_t handle,
                 int m,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 const cuComplex *csrValA,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 cuComplex mu0,
                 const cuComplex *x0,
                 int maxite,
                 float tol,
                 cuComplex *mu,
                 cuComplex *x);

cusolverStatus_t 
cusolverSpZcsreigvsi(cusolverSpHandle_t handle,
                 int m,
                 int nnz,
                 const cusparseMatDescr_t descrA,
                 const cuDoubleComplex *csrValA,
                 const int *csrRowPtrA,
                 const int *csrColIndA,
                 cuDoubleComplex mu0,
                 const cuDoubleComplex *x0,
                 int maxite,
                 double tol,
                 cuDoubleComplex *mu,
                 cuDoubleComplex *x);
</pre></div>
                           <p class="p">This function solves the simple eigenvalue problem  
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>*</mo>
                                 <mi>x</mi>
                                 <mo>=</mo>
                                 <mi>λ</mi>
                                 <mo>*</mo>
                                 <mi>x</mi>
                              </math>
                              
                              by shift-inverse method.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                              <samp class="ph codeph">csrColIndA</samp>.
                              The output paramter <samp class="ph codeph">x</samp> is the approximated eigenvector of size <samp class="ph codeph">m</samp>,
                              
                           </p>
                           <p class="p">
                              The following shift-inverse method corrects eigenpair step-by-step until convergence.
                              
                           </p>
                           <p class="p">
                              It accepts several parameters:
                              
                           </p>
                           <p class="p"><samp class="ph codeph">mu0</samp> is an initial guess of eigenvalue.
                              The shift-inverse method will converge to the eigenvalue <samp class="ph codeph">mu</samp> nearest <samp class="ph codeph">mu0</samp>
                              if <samp class="ph codeph">mu</samp> is a singleton. 
                              Otherwise, the shift-inverse method may not converge.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">x0</samp> is an initial eigenvector.
                              If the user has no preference, just chose <samp class="ph codeph">x0</samp> randomly.
                              <samp class="ph codeph">x0</samp> must be nonzero. 
                              It can be non-unit length. 
                              
                           </p>
                           <p class="p"><samp class="ph codeph">tol</samp> is the tolerance to decide convergence. 
                              If <samp class="ph codeph">tol</samp> is less than zero, it would be treated as zero.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">maxite</samp> is maximum number of iterations. 
                              It is useful when shift-inverse method does not converge because the tolerance is too small or 
                              the desired eigenvalue is not a singleton.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Shift-Inverse Method </strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="left" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mi>Given a initial guess of eigenvalue </mi>
                                                      <mi>μ0</mi>
                                                      <mi>and initial vector </mi>
                                                      <mi>x0</mi>
                                                   </mtr>
                                                   <mtr>
                                                      <msup>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mi>(0)</mi>
                                                         </mrow>
                                                      </msup>
                                                      <mo>=</mo>
                                                      <mi>x0 of unit length</mi>
                                                   </mtr>
                                                   <mtr>
                                                      <mi>for j = 0 : maxite</mi>
                                                   </mtr>
                                                   <mtr>
                                                      <mi> </mi>
                                                      <mi> </mi>
                                                      <mi>solve </mi>
                                                      <mi>(</mi>
                                                      <mi>A</mi>
                                                      <mo>-</mo>
                                                      <mi>μ0</mi>
                                                      <mo>*</mo>
                                                      <mi>I</mi>
                                                      <mi>)</mi>
                                                      <mo>*</mo>
                                                      <msup>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mi>(k+1)</mi>
                                                         </mrow>
                                                      </msup>
                                                      <mo>=</mo>
                                                      <msup>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mi>(k)</mi>
                                                         </mrow>
                                                      </msup>
                                                   </mtr>
                                                   <mtr>
                                                      <mi> </mi>
                                                      <mi> </mi>
                                                      <mi>normalize </mi>
                                                      <msup>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mi>(k+1)</mi>
                                                         </mrow>
                                                      </msup>
                                                      <mi>to unit length </mi>
                                                   </mtr>
                                                   <mtr>
                                                      <mi> </mi>
                                                      <mi> </mi>
                                                      <mi>compute approx. eigenvalue  </mi>
                                                      <mi>μ</mi>
                                                      <mo>=</mo>
                                                      <msup>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mi>H</mi>
                                                         </mrow>
                                                      </msup>
                                                      <mo>*</mo>
                                                      <mi>A</mi>
                                                      <mo>*</mo>
                                                      <mi>x</mi>
                                                      <mi> where </mi>
                                                      <mi>x</mi>
                                                      <mo>=</mo>
                                                      <msup>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mi>(k+1)</mi>
                                                         </mrow>
                                                      </msup>
                                                   </mtr>
                                                   <mtr>
                                                      <mi> </mi>
                                                      <mi> </mi>
                                                      <mi>if ||</mi>
                                                      <mi>A</mi>
                                                      <mo>*</mo>
                                                      <msup>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mi>(k+1)</mi>
                                                         </mrow>
                                                      </msup>
                                                      <mo>-</mo>
                                                      <mi>μ</mi>
                                                      <mo>*</mo>
                                                      <msup>
                                                         <mi>x</mi>
                                                         <mrow class="MJX-TeXAtom-ORD">
                                                            <mi>(k+1)</mi>
                                                         </mrow>
                                                      </msup>
                                                      <mi>||</mi>
                                                      <mi>&lt;</mi>
                                                      <mi> tolerance, then stop</mi>
                                                   </mtr>
                                                   <mtr>
                                                      <mi>endfor</mi>
                                                   </mtr>
                                                </mtable>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              If <samp class="ph codeph">A</samp> is symmetric/Hermitian and only lower/upper part is used or meaningful,
                              the user has to extend the matrix into its missing upper/lower part, otherwise the result is wrong.
                              
                           </p>
                           <p class="p">
                              Remark 1: <samp class="ph codeph">[cu|h]solver[S|D]csreigvsi</samp> only allows <samp class="ph codeph">mu0</samp> as a real number.
                              This works if <samp class="ph codeph">A</samp> is symmetric.
                              Otherwise, the non-real eigenvalue has a conjugate counterpart on the complex plan, and 
                              shift-inverse method would not converge to such eigevalue
                              even the eigenvalue is a singleton.
                              The user has to extend <samp class="ph codeph">A</samp> to complex numbre and call 
                              <samp class="ph codeph">[cu|h]solver[C|Z]csreigvsi</samp> with <samp class="ph codeph">mu0</samp> not on real axis.
                              
                           </p>
                           <p class="p">
                              Remark 2: the tolerance <samp class="ph codeph">tol</samp> should not be smaller than |mu0|*eps, 
                              where eps is machine zero.
                              Otherwise, shift-inverse may not converge because of small tolerance.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolver library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">mu0</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">initial guess of eigenvalue.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">x0</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">initial guess of eigenvector, a vecotr of size <samp class="ph codeph">m</samp>. 
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">maxite</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">maximum iterations in shift-inverse method.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">tol</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">tolerance for convergence.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace</samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">mu</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">approximated eigenvalue nearest <samp class="ph codeph">mu0</samp> under tolerance.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">approximated eigenvector of size <samp class="ph codeph">m</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csreigs"><a name="cusolver-lt-t-gt-csreigs" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csreigs" name="cusolver-lt-t-gt-csreigs" shape="rect">6.2.6.&nbsp;cusolverSp&lt;t&gt;csreigs()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
solverspScsreigs[Host](cusolverSpHandle_t handle,
                int m,
                int nnz,
                const cusparseMatDescr_t descrA,
                const float *csrValA,
                const int *csrRowPtrA,
                const int *csrColIndA,
                cuComplex left_bottom_corner,
                cuComplex right_upper_corner,
                int *num_eigs);

cusolverStatus_t 
cusolverSpDcsreigs[Host](cusolverSpHandle_t handle,
                int m,
                int nnz,
                const cusparseMatDescr_t descrA,
                const double *csrValA,
                const int *csrRowPtrA,
                const int *csrColIndA,
                cuDoubleComplex left_bottom_corner,
                cuDoubleComplex right_upper_corner,
                int *num_eigs);

cusolverStatus_t 
cusolverSpCcsreigs[Host](cusolverSpHandle_t handle,
                int m,
                int nnz,
                const cusparseMatDescr_t descrA,
                const cuComplex *csrValA,
                const int *csrRowPtrA,
                const int *csrColIndA,
                cuComplex left_bottom_corner,
                cuComplex right_upper_corner,
                int *num_eigs);

cusolverStatus_t 
cusolverSpZcsreigs[Host](cusolverSpHandle_t handle,
                int m,
                int nnz,
                const cusparseMatDescr_t descrA,
                const cuDoubleComplex *csrValA,
                const int *csrRowPtrA,
                const int *csrColIndA,
                cuDoubleComplex left_bottom_corner,
                cuDoubleComplex right_upper_corner,
                int *num_eigs);


</pre><p class="p">This function computes number of algebraic eigenvalues in a given box <samp class="ph codeph">B</samp> by contour integral 
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>number of algebraic eigenvalues in box B</mi>
                                             <mo>=</mo>
                                             <mfrac>
                                                <mrow>
                                                   <mn>1</mn>
                                                </mrow>
                                                <mrow>
                                                   <mn>2</mn>
                                                   <mo>*</mo>
                                                   <mi>π</mi>
                                                   <mo>*</mo>
                                                   <msqrt>
                                                      <mo>-</mo>
                                                      <mn>1</mn>
                                                   </msqrt>
                                                </mrow>
                                             </mfrac>
                                             <msub>
                                                <mo>∮</mo>
                                                <mrow>
                                                   <mi>C</mi>
                                                </mrow>
                                             </msub>
                                             <mfrac>
                                                <mrow>
                                                   <msup>
                                                      <mi>P</mi>
                                                      <mrow class="MJX-TeXAtom-ORD">
                                                         <mo>′</mo>
                                                      </mrow>
                                                   </msup>
                                                   <mi>(z)</mi>
                                                </mrow>
                                                <mrow>
                                                   <mi>P(z)</mi>
                                                </mrow>
                                             </mfrac>
                                             <mi>d</mi>
                                             <mi>z</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where closed line <samp class="ph codeph">C</samp> is boundary of the box <samp class="ph codeph">B</samp> 
                              which is a rectangle specified by two points, one is left bottom corner 
                              (input parameter <samp class="ph codeph">left_botoom_corner</samp>) and 
                              the other is right upper corner (input parameter <samp class="ph codeph">right_upper_corner</samp>). 
                              <samp class="ph codeph">P(z)=det(A - z*I)</samp> is the characteristic polynomial of <samp class="ph codeph">A</samp>. 
                              
                           </p>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×m</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, and
                              <samp class="ph codeph">csrColIndA</samp>. 
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">num_eigs</samp> is number of algebraic eigenvalues in the box <samp class="ph codeph">B</samp>.
                              This number may not be accurate due to several reasons:
                              
                           </p>
                           <p class="p">
                              1. the contour <samp class="ph codeph">C</samp> is close to some eigenvalues or even passes through some eigenvalues.
                              
                           </p>
                           <p class="p">
                              2. the numerical integration is not accurate due to coarse grid size. 
                              The default resolution is 1200 grids along contour <samp class="ph codeph">C</samp> uniformly.
                              
                           </p>
                           <p class="p">
                              Even though <samp class="ph codeph">csreigs</samp> may not be accurate, it still can give the user some idea
                              how many eigenvalues in a region where the resolution of disk theorem is bad.
                              For example, standard 3-point stencil of finite difference of Laplacian operator is a tridiagonal matrix,
                              and disk theorem would show "all eigenvalues are in the interval [0, 4*N^2]" 
                              where N is number of grids. 
                              In this case, <samp class="ph codeph">csreigs</samp> is useful for any interval inside [0, 4*N^2].
                              
                           </p>
                           <p class="p">
                              Remark 1: if <samp class="ph codeph">A</samp> is symmetric in real or hermitian in complex, all eigenvalues are real.
                              The user still needs to specify a box, not an interval. 
                              The height of the box can be much smaller than the width.
                              
                           </p>
                           <p class="p">
                              Remark 2: only CPU (Host) path is provided. 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">handle to the cuSolverSP library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnz</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>+</mo>
                                             <mn>1</mn>
                                          </math>
                                          		
                                          	elements that contains the start of every row and the end of the last row plus one.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of
                                          		<samp class="ph codeph">nnz</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          	column indices of the nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">left_bottom_corner</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">left bottom corner of the box.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">right_upper_corner</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">right upper corner of the box.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">num_eigs</samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"> number of algebraic eigenvalues in a box.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,nnz&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cusolver-low-level-function-reference"><a name="cusolver-low-level-function-reference" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-low-level-function-reference" name="cusolver-low-level-function-reference" shape="rect">Low Level Function Reference</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This section describes low level API of cuSolverSP, including symrcm and batched QR. 
                           
                        </p>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csrsymrcm"><a name="cusolver-lt-t-gt-csrsymrcm" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csrsymrcm" name="cusolver-lt-t-gt-csrsymrcm" shape="rect">6.3.1.&nbsp;cusolverSpXcsrsymrcm()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusolverStatus_t 
cusolverSpXcsrsymrcmHost(cusolverSpHandle_t handle,
             int n,
             int nnzA,
             const cusparseMatDescr_t descrA,
             const int *csrRowPtrA,
             const int *csrColIndA,
             int *p);

</pre><p class="p">
                              This function implements Symmetric Reverse Cuthill-McKee permutation.
                              It returns a permutation vector <samp class="ph codeph">p</samp> such that 
                              <samp class="ph codeph">A(p,p)</samp> would concentrate nonzeros to diagonal.
                              This is equivalent to <samp class="ph codeph">symrcm</samp> in MATLAB, however the result 
                              may not be the same because of different heuristics in the pseudoperipheral finder.
                              The <samp class="ph codeph">cuSolverSP</samp> library implements <samp class="ph codeph">symrcm</samp> based on 
                              the following two papers:
                              
                           </p>
                           <p class="p">
                              E. Chuthill and J. McKee, reducing the bandwidth of sparse symmetric matrices, 
                              ACM '69 Proceedings of the 1969 24th national conference, Pages 157-172  
                              
                           </p>
                           <p class="p">
                              Alan George, Joseph W. H. Liu, An Implementation of a Pseudoperipheral Node Finder,
                              ACM Transactions on Mathematical Software (TOMS) Volume 5 Issue 3, Sept. 1979, 
                              Pages 284-295 
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">p</samp> is an integer array of <samp class="ph codeph">n</samp> elements.
                              It represents a permutation array and it indexed using the base-0 convention. 
                              The permutation array <samp class="ph codeph">p</samp> corresponds to a permutation matrix <samp class="ph codeph">P</samp>, 
                              and satisfies the following relation:
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A(p,p)</mi>
                                             <mo>=</mo>
                                             <mi>P</mi>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>P</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>T</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">n×n</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, 
                              and <samp class="ph codeph">csrColIndA</samp>. 
                              
                           </p>
                           <p class="p">
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              Internally <samp class="ph codeph">rcm</samp> works on
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>+</mo>
                                 <msup>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>T</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              , the user does not need to extend the matrix if the matrix is not symmetric.
                              
                           </p>
                           <p class="p">
                              Remark 1: only CPU (Host) path is provided.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSolverSP library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                          It is the size of <samp class="ph codeph">csrValA</samp> and <samp class="ph codeph">csrColIndA</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">n+1</samp> elements that contains the start of every row and 
                                          the end of the last row plus one.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp>column indices of the nonzero elements 
                                          of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">hsolver  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">p</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">permutation vector of size <samp class="ph codeph">n</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n,nnzA&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csrsymmdq"><a name="cusolver-lt-t-gt-csrsymmdq" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csrsymmdq" name="cusolver-lt-t-gt-csrsymmdq" shape="rect">6.3.2.&nbsp;cusolverSpXcsrsymmdq()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusolverStatus_t 
cusolverSpXcsrsymmdqHost(cusolverSpHandle_t handle,
             int n,
             int nnzA,
             const cusparseMatDescr_t descrA,
             const int *csrRowPtrA,
             const int *csrColIndA,
             int *p);

</pre><p class="p">
                              This function implements Symmetric Minimum Degree Algorithm based on Quotient Graph.
                              It returns a permutation vector <samp class="ph codeph">p</samp> such that 
                              <samp class="ph codeph">A(p,p)</samp> would have less zero fill-in during Cholesky factorization.
                              The <samp class="ph codeph">cuSolverSP</samp> library implements <samp class="ph codeph">symmdq</samp> based on 
                              the following two papers:
                              
                           </p>
                           <p class="p">
                              Patrick R. Amestoy, Timothy A. Davis, Iain S. Duff,
                              An Approximate Minimum Degree Ordering Algorithm, 
                              SIAM J. Matrix Analysis Applic. Vol 17, no 4, pp. 886-905, Dec. 1996.
                              
                           </p>
                           <p class="p">
                              Alan George, Joseph W. Liu, A Fast Implementation of the Minimum Degree Algorithm 
                              Using Quotient Graphs, ACM Transactions on Mathematical Software, Vol 6, No. 3, September 1980, page 337-358.
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">p</samp> is an integer array of <samp class="ph codeph">n</samp> elements.
                              It represents a permutation array with base-0 index. 
                              The permutation array <samp class="ph codeph">p</samp> corresponds to a permutation matrix <samp class="ph codeph">P</samp>, 
                              and satisfies the following relation:
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A(p,p)</mi>
                                             <mo>=</mo>
                                             <mi>P</mi>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>P</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>T</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">n×n</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, 
                              and <samp class="ph codeph">csrColIndA</samp>. 
                              
                           </p>
                           <p class="p">
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              Internally <samp class="ph codeph">mdq</samp> works on
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>+</mo>
                                 <msup>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>T</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              , the user does not need to extend the matrix if the matrix is not symmetric.
                              
                           </p>
                           <p class="p">
                              Remark 1: only CPU (Host) path is provided.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSolverSP library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                          It is the size of <samp class="ph codeph">csrValA</samp> and <samp class="ph codeph">csrColIndA</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">n+1</samp> elements that contains the start of every row and 
                                          the end of the last row plus one.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp>column indices of the nonzero elements 
                                          of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">hsolver  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">p</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">permutation vector of size <samp class="ph codeph">n</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n,nnzA&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csrsymamd"><a name="cusolver-lt-t-gt-csrsymamd" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csrsymamd" name="cusolver-lt-t-gt-csrsymamd" shape="rect">6.3.3.&nbsp;cusolverSpXcsrsymamd()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusolverStatus_t 
cusolverSpXcsrsymamdHost(cusolverSpHandle_t handle,
             int n,
             int nnzA,
             const cusparseMatDescr_t descrA,
             const int *csrRowPtrA,
             const int *csrColIndA,
             int *p);

</pre><p class="p">
                              This function implements Symmetric Approximate Minimum Degree Algorithm based on Quotient Graph.
                              It returns a permutation vector <samp class="ph codeph">p</samp> such that 
                              <samp class="ph codeph">A(p,p)</samp> would have less zero fill-in during Cholesky factorization.
                              The <samp class="ph codeph">cuSolverSP</samp> library implements <samp class="ph codeph">symamd</samp> based on 
                              the following paper:
                              
                           </p>
                           <p class="p">
                              Patrick R. Amestoy, Timothy A. Davis, Iain S. Duff,
                              An Approximate Minimum Degree Ordering Algorithm, 
                              SIAM J. Matrix Analysis Applic. Vol 17, no 4, pp. 886-905, Dec. 1996.
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">p</samp> is an integer array of <samp class="ph codeph">n</samp> elements.
                              It represents a permutation array with base-0 index.
                              The permutation array <samp class="ph codeph">p</samp> corresponds to a permutation matrix <samp class="ph codeph">P</samp>, 
                              and satisfies the following relation:
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A(p,p)</mi>
                                             <mo>=</mo>
                                             <mi>P</mi>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>P</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>T</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">n×n</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, 
                              and <samp class="ph codeph">csrColIndA</samp>. 
                              
                           </p>
                           <p class="p">
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              Internally <samp class="ph codeph">amd</samp> works on
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>+</mo>
                                 <msup>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>T</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              , the user does not need to extend the matrix if the matrix is not symmetric.
                              
                           </p>
                           <p class="p">
                              Remark 1: only CPU (Host) path is provided.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSolverSP library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                          It is the size of <samp class="ph codeph">csrValA</samp> and <samp class="ph codeph">csrColIndA</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">n+1</samp> elements that contains the start of every row and 
                                          the end of the last row plus one.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp>column indices of the nonzero elements 
                                          of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">hsolver  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">p</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">permutation vector of size <samp class="ph codeph">n</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n,nnzA&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csrmetis"><a name="cusolver-lt-t-gt-csrmetis" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csrmetis" name="cusolver-lt-t-gt-csrmetis" shape="rect">6.3.4.&nbsp;cusolverSpXcsrmetisnd()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusolverStatus_t 
cusolverSpXcsrmetisndHost(
    cusolverSpHandle_t handle,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    const int64_t *options,
    int *p);

</pre><p class="p">
                              This function is a wrapper of <samp class="ph codeph">METIS_NodeND</samp>.
                              It returns a permutation vector <samp class="ph codeph">p</samp> such that 
                              <samp class="ph codeph">A(p,p)</samp> would have less zero fill-in during nested dissection.
                              The <samp class="ph codeph">cuSolverSP</samp> library links <samp class="ph codeph">libmetis_static.a</samp> 
                              which is 64-bit metis-5.1.0 .
                              
                           </p>
                           <p class="p">
                              The parameter <samp class="ph codeph">options</samp> is the configuration of <samp class="ph codeph">metis</samp>.
                              For those who do not have experiences of <samp class="ph codeph">metis</samp>, 
                              set <samp class="ph codeph">options = NULL</samp> for default setting.
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">p</samp> is an integer array of <samp class="ph codeph">n</samp> elements.
                              It represents a permutation array with base-0 index.
                              The permutation array <samp class="ph codeph">p</samp> corresponds to a permutation matrix <samp class="ph codeph">P</samp>, 
                              and satisfies the following relation:
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A(p,p)</mi>
                                             <mo>=</mo>
                                             <mi>P</mi>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>P</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>T</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">n×n</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, 
                              and <samp class="ph codeph">csrColIndA</samp>. 
                              
                           </p>
                           <p class="p">
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              Internally <samp class="ph codeph">csrmetisnd</samp> works on
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>+</mo>
                                 <msup>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>T</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              , the user does not need to extend the matrix if the matrix is not symmetric.
                              
                           </p>
                           <p class="p">
                              Remark 1: only CPU (Host) path is provided.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSolverSP library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                          It is the size of <samp class="ph codeph">csrValA</samp> and <samp class="ph codeph">csrColIndA</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">n+1</samp> elements that contains the start of every row and 
                                          the end of the last row plus one.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp>column indices of the nonzero elements 
                                          of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">options</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array to configure <samp class="ph codeph">metis</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">p</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">permutation vector of size <samp class="ph codeph">n</samp>.
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n,nnzA&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csrzfd"><a name="cusolver-lt-t-gt-csrzfd" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csrzfd" name="cusolver-lt-t-gt-csrzfd" shape="rect">6.3.5.&nbsp;cusolverSpXcsrzfd()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusolverStatus_t 
cusolverSpScsrzfdHost(
    cusolverSpHandle_t handle,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const float *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    int *P,
    int *numnz)

cusolverStatus_t 
cusolverSpDcsrzfdHost(
    cusolverSpHandle_t handle,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const double *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    int *P,
    int *numnz)

cusolverStatus_t 
cusolverSpCcsrzfdHost(
    cusolverSpHandle_t handle,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const cuComplex *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    int *P,
    int *numnz)

cusolverStatus_t 
cusolverSpZcsrzfdHost(
    cusolverSpHandle_t handle,
    int n,
    int nnzA,
    const cusparseMatDescr_t descrA,
    const cuDoubleComplex *csrValA,
    const int *csrRowPtrA,
    const int *csrColIndA,
    int *P,
    int *numnz)

</pre><p class="p">
                              This function implements MC21, zero-free diagonal algorithm.
                              It returns a permutation vector <samp class="ph codeph">p</samp> such that 
                              <samp class="ph codeph">A(p,:)</samp> has no zero diagonal.
                              
                           </p>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">n×n</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp>, 
                              and <samp class="ph codeph">csrColIndA</samp>. 
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              
                           </p>
                           <p class="p">
                              The output parameter <samp class="ph codeph">p</samp> is an integer array of <samp class="ph codeph">n</samp> elements.
                              It represents a permutation array with base-0 index. 
                              The permutation array <samp class="ph codeph">p</samp> corresponds to a permutation matrix <samp class="ph codeph">P</samp>, 
                              and satisfies the following relation:
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A(p,:)</mi>
                                             <mo>=</mo>
                                             <mi>P</mi>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              The output parameter <samp class="ph codeph">numnz</samp> describes number of nonzero diagonal in permutated matrix 
                              <samp class="ph codeph">A(p,:)</samp>. If <samp class="ph codeph">numnz</samp> is less than <samp class="ph codeph">n</samp>, 
                              matrix <samp class="ph codeph">A</samp> has structural singularity.
                              
                           </p>
                           <p class="p">
                              Remark 1: only CPU (Host) path is provided.
                              
                           </p>
                           <p class="p">
                              Remark 2: this routine does not maximize diagonal value of permuted matrix.
                              The user cannot expect this routine can make "LU without pivoting" stable.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSolverSP library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows and columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                          It is the size of <samp class="ph codeph">csrValA</samp> and <samp class="ph codeph">csrColIndA</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of
                                          <samp class="ph codeph">nnzA</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">(</mo>
                                             <mo>=</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(m)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo>-</mo>
                                          </math><samp class="ph codeph">csrRowPtrA(0)</samp><math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mo stretchy="false">)</mo>
                                          </math>
                                          nonzero elements of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">n+1</samp> elements that contains the start of every row and 
                                          the end of the last row plus one.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp>column indices of the nonzero elements 
                                          of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">*Host MemSpace </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">p</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">permutation vector of size <samp class="ph codeph">n</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">numnz</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros on diagonal of permuted matrix.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">n,nnzA&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csrperm"><a name="cusolver-lt-t-gt-csrperm" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csrperm" name="cusolver-lt-t-gt-csrperm" shape="rect">6.3.6.&nbsp;cusolverSpXcsrperm()</a></h3>
                        <div class="body conbody"><pre xml:space="preserve">

cusolverStatus_t 
cusolverSpXcsrperm_bufferSizeHost(cusolverSpHandle_t handle,
                          int m,
                          int n,
                          int nnzA,
                          const cusparseMatDescr_t descrA,
                          int *csrRowPtrA,
                          int *csrColIndA,
                          const int *p,
                          const int *q,
                          size_t *bufferSizeInBytes);

cusolverStatus_t 
cusolverSpXcsrpermHost(cusolverSpHandle_t handle,
                int m,
                int n,
                int nnzA,
                const cusparseMatDescr_t descrA,
                int *csrRowPtrA,
                int *csrColIndA,
                const int *p,
                const int *q,
                int *map,
                void *pBuffer);

</pre><p class="p">
                              Given a left permutation vector <samp class="ph codeph">p</samp> which corresponds to 
                              permutation matrix <samp class="ph codeph">P</samp> and a right permutation vector <samp class="ph codeph">q</samp>
                              which corresponds to permutation matrix <samp class="ph codeph">Q</samp>, 
                              this function computes permutation of matrix <samp class="ph codeph">A</samp> by
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>B</mi>
                                             <mo>=</mo>
                                             <mi>P</mi>
                                             <mo>*</mo>
                                             <mi>A</mi>
                                             <mo>*</mo>
                                             <msup>
                                                <mi>Q</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>T</mi>
                                                </mrow>
                                             </msup>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p"><samp class="ph codeph">A</samp> is an <samp class="ph codeph">m×n</samp> sparse matrix that is defined in CSR storage
                              format by the three arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp> and 
                              <samp class="ph codeph">csrColIndA</samp>. 
                              
                           </p>
                           <p class="p">
                              The operation is in-place, i.e. the matrix <samp class="ph codeph">A</samp> is overwritten by <samp class="ph codeph">B</samp>.
                              
                           </p>
                           <p class="p">
                              The permutation vector <samp class="ph codeph">p</samp> and <samp class="ph codeph">q</samp> are base 0.  
                              <samp class="ph codeph">p</samp> performs row permutation while 
                              <samp class="ph codeph">q</samp> performs column permutation.
                              One can also use MATLAB command 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>B</mi>
                                 <mo>=</mo>
                                 <mi>A(p,q)</mi>
                              </math>
                              
                              to permutate matrix <samp class="ph codeph">A</samp>.
                              
                           </p>
                           <p class="p">
                              This function only computes sparsity pattern of <samp class="ph codeph">B</samp>.
                              The user can use parameter <samp class="ph codeph">map</samp> to get <samp class="ph codeph">csrValB</samp> as well.
                              The parameter <samp class="ph codeph">map</samp> is an input/output.
                              If the user sets <samp class="ph codeph">map=0:1:(nnzA-1)</samp> before calling <samp class="ph codeph">csrperm</samp>, 
                              <samp class="ph codeph">csrValB=csrValA(map)</samp>.
                              
                           </p>
                           <p class="p">
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              If <samp class="ph codeph">A</samp> is symmetric and only lower/upper part is provided, 
                              the user has to pass
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>+</mo>
                                 <msup>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>T</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              into this function.
                              
                           </p>
                           <p class="p">
                              This function requires a buffer size returned by <samp class="ph codeph">csrperm_bufferSize()</samp>. 
                              The address of <samp class="ph codeph">pBuffer</samp> must be a multiple of 128 bytes. 
                              If it is not, <samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp> is returned. 
                              
                           </p>
                           <p class="p">
                              For example, if matrix <samp class="ph codeph">A</samp> is
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>A</mi>
                                                <mo>=</mo>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mi>1.0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>2.0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>3.0</mi>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mi>4.0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>5.0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>6.0</mi>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mi>7.0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>8.0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>9.0</mi>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              and left permutation vector <samp class="ph codeph">p=(0,2,1)</samp>,
                              right permutation vector <samp class="ph codeph">q=(2,1,0)</samp>, then  
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>P</mi>
                                 <mo>*</mo>
                                 <mi>A</mi>
                                 <mo>*</mo>
                                 <msup>
                                    <mi>Q</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>T</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              is    
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <p class="p d4p_eqn_block">
                                             <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>P</mi>
                                                <mo>*</mo>
                                                <mi>A</mi>
                                                <mo>*</mo>
                                                <msup>
                                                   <mi>Q</mi>
                                                   <mrow class="MJX-TeXAtom-ORD">
                                                      <mi>T</mi>
                                                   </mrow>
                                                </msup>
                                                <mo>=</mo>
                                                <mfenced open="(" close=")">
                                                   <mtable rowspacing="4pt" columnspacing="1em">
                                                      <mtr>
                                                         <mtd>
                                                            <mi>3.0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>2.0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>1.0</mi>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mi>9.0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>8.0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>7.0</mi>
                                                         </mtd>
                                                      </mtr>
                                                      <mtr>
                                                         <mtd>
                                                            <mi>6.0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>5.0</mi>
                                                         </mtd>
                                                         <mtd>
                                                            <mi>4.0</mi>
                                                         </mtd>
                                                      </mtr>
                                                   </mtable>
                                                </mfenced>
                                             </math>
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              Remark 1: only CPU (Host) path is provided.
                              
                           </p>
                           <p class="p">
                              Remark 2: the user can combine <samp class="ph codeph">csrsymrcm</samp> and <samp class="ph codeph">csrperm</samp>
                              to get 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>P</mi>
                                 <mo>*</mo>
                                 <mi>A</mi>
                                 <mo>*</mo>
                                 <msup>
                                    <mi>P</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>T</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              which has less zero fill-in during QR factorization.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSolver library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of matrix <samp class="ph codeph">A</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of matrix <samp class="ph codeph">A</samp>.
                                          It is the size of <samp class="ph codeph">csrValA</samp> and <samp class="ph codeph">csrColIndA</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of matrix <samp class="ph codeph">A</samp>. 
                                          The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and 
                                          <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row
                                          and end of last row plus one of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp>column indices of the nonzero elements 
                                          of matrix <samp class="ph codeph">A</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">p</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">left permutation vector of size <samp class="ph codeph">m</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">q</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">right permutation vector of size <samp class="ph codeph">n</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">map</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp> indices.
                                          If the user wants to get relationship between <samp class="ph codeph">A</samp> and <samp class="ph codeph">B</samp>,
                                          <samp class="ph codeph">map</samp> must be set <samp class="ph codeph">0:1:(nnzA-1)</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is returned by 
                                          <samp class="ph codeph">csrperm_bufferSize()</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">hsolver  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row
                                          and end of last row plus one of matrix <samp class="ph codeph">B</samp>. 
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp>column indices of the nonzero elements
                                          of matrix <samp class="ph codeph">B</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">map</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp> indices that maps matrix <samp class="ph codeph">A</samp>
                                          to matrix <samp class="ph codeph">B</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">pBufferSizeInBytes</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnzA&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="topic concept nested2" id="cusolver-lt-t-gt-csrqrbatched"><a name="cusolver-lt-t-gt-csrqrbatched" shape="rect">
                           <!-- --></a><h3 class="title topictitle2"><a href="#cusolver-lt-t-gt-csrqrbatched" name="cusolver-lt-t-gt-csrqrbatched" shape="rect">6.3.7.&nbsp;cusolverSpXcsrqrBatched()</a></h3>
                        <div class="body conbody">
                           <div class="p">
                              The create and destroy methods start and end the lifetime of a csrqrInfo object.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverSpCreateCsrqrInfo(csrqrInfo_t *info);

cusolverStatus_t 
cusolverSpDestroyCsrqrInfo(csrqrInfo_t info);
</pre></div>
                           <div class="p">
                              Analysis is the same for all data types, but each data type has a unique buffer size.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverSpXcsrqrAnalysisBatched(cusolverSpHandle_t handle,
                           int m,
                           int n,
                           int nnzA,
                           const cusparseMatDescr_t descrA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           csrqrInfo_t info);

cusolverStatus_t 
cusolverSpScsrqrBufferInfoBatched(cusolverSpHandle_t handle,
                           int m,
                           int n,
                           int nnzA,
                           const cusparseMatDescr_t descrA,
                           const float *csrValA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           int batchSize,
                           csrqrInfo_t info,
                           size_t *internalDataInBytes,
                           size_t *workspaceInBytes);

cusolverStatus_t 
cusolverSpDcsrqrBufferInfoBatched(cusolverSpHandle_t handle,
                           int m,
                           int n,
                           int nnzA,
                           const cusparseMatDescr_t descrA,
                           const double *csrValA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           int batchSize,
                           csrqrInfo_t info,
                           size_t *internalDataInBytes,
                           size_t *workspaceInBytes);
</pre></div>
                           <div class="p">
                              Calculate buffer sizes for complex valued data types.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverSpCcsrqrBufferInfoBatched(cusolverSpHandle_t handle,
                           int m,
                           int n,
                           int nnzA,
                           const cusparseMatDescr_t descrA,
                           const cuComplex *csrValA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           int batchSize,
                           csrqrInfo_t info,
                           size_t *internalDataInBytes,
                           size_t *workspaceInBytes);

cusolverStatus_t 
cusolverSpZcsrqrBufferInfoBatched(cusolverSpHandle_t handle,
                           int m,
                           int n,
                           int nnzA,
                           const cusparseMatDescr_t descrA,
                           const cuDoubleComplex *csrValA,
                           const int *csrRowPtrA,
                           const int *csrColIndA,
                           int batchSize,
                           csrqrInfo_t info,
                           size_t *internalDataInBytes,
                           size_t *workspaceInBytes);
</pre></div>
                           <div class="p">
                              The S and D data types are real valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverSpScsrqrsvBatched(cusolverSpHandle_t handle,
                        int m,
                        int n,
                        int nnzA,
                        const cusparseMatDescr_t descrA,
                        const float *csrValA,
                        const int *csrRowPtrA,
                        const int *csrColIndA,
                        const float *b,
                        float *x,
                        int batchSize,
                        csrqrInfo_t info,
                        void *pBuffer);

cusolverStatus_t 
cusolverSpDcsrqrsvBatched(cusolverSpHandle_t handle,
                        int m,
                        int n,
                        int nnz,
                        const cusparseMatDescr_t descrA,
                        const double *csrValA,
                        const int *csrRowPtrA,
                        const int *csrColIndA,
                        const double *b,
                        double *x,
                        int batchSize,
                        csrqrInfo_t info,
                        void *pBuffer);
</pre></div>
                           <div class="p">
                              The C and Z data types are complex valued single and double precision, respectively.
                              <pre xml:space="preserve">
cusolverStatus_t 
cusolverSpCcsrqrsvBatched(cusolverSpHandle_t handle,
                        int m,
                        int n,
                        int nnzA,
                        const cusparseMatDescr_t descrA,
                        const cuComplex *csrValA,
                        const int *csrRowPtrA,
                        const int *csrColIndA,
                        const cuComplex *b,
                        cuComplex *x,
                        int batchSize,
                        csrqrInfo_t info,
                        void *pBuffer);

cusolverStatus_t 
cusolverSpZcsrqrsvBatched(cusolverSpHandle_t handle,
                        int m,
                        int n,
                        int nnzA,
                        const cusparseMatDescr_t descrA,
                        const cuDoubleComplex *csrValA,
                        const int *csrRowPtrA,
                        const int *csrColIndA,
                        const cuDoubleComplex *b,
                        cuDoubleComplex *x,
                        int batchSize,
                        csrqrInfo_t info,
                        void *pBuffer);
</pre></div>
                           <p class="p">
                              The batched sparse QR factorization is used to solve either a set of least-squares problems 
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msub>
                                                <mi>x</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>j</mi>
                                                </mrow>
                                             </msub>
                                             <mo>=</mo>
                                             <mi>argmin</mi>
                                             <mi>||</mi>
                                             <msub>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>j</mi>
                                                </mrow>
                                             </msub>
                                             <mo>*</mo>
                                             <mi>z</mi>
                                             <mo>-</mo>
                                             <msub>
                                                <mi>b</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>j</mi>
                                                </mrow>
                                             </msub>
                                             <mi>||</mi>
                                             <mi>, j = 1,2,..., batchSize</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              or a set of linear systems
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msub>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>j</mi>
                                                </mrow>
                                             </msub>
                                             <msub>
                                                <mi>x</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>j</mi>
                                                </mrow>
                                             </msub>
                                             <mo>=</mo>
                                             <msub>
                                                <mi>b</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>j</mi>
                                                </mrow>
                                             </msub>
                                             <mi>, j = 1,2,..., batchSize</mi>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p class="p">
                              where each 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>j</mi>
                                    </mrow>
                                 </msub>
                              </math>
                              
                              is a <samp class="ph codeph">m×n</samp> sparse matrix that is defined in CSR storage
                              format by the four arrays <samp class="ph codeph">csrValA</samp>, <samp class="ph codeph">csrRowPtrA</samp> 
                              and <samp class="ph codeph">csrColIndA</samp>. 
                              
                           </p>
                           <p class="p">
                              The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>.
                              If <samp class="ph codeph">A</samp> is symmetric and only lower/upper part is prvided,
                              the user has to pass
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <mi>A</mi>
                                 <mo>+</mo>
                                 <msup>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>H</mi>
                                    </mrow>
                                 </msup>
                              </math>
                              
                              into this function.
                              
                           </p>
                           <p class="p">
                              The prerequisite to use batched sparse QR has two-folds. 
                              First all matrices 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>j</mi>
                                    </mrow>
                                 </msub>
                              </math>
                              
                              must have the same sparsity pattern.
                              Second, no column pivoting is used in least-square problem, so the solution is valid only if 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>j</mi>
                                    </mrow>
                                 </msub>
                              </math>
                              
                              is of full rank for all <samp class="ph codeph">j = 1,2,..., batchSize </samp>.
                              All matrices have the same sparity pattern, so only one copy of 
                              <samp class="ph codeph">csrRowPtrA</samp> and <samp class="ph codeph">csrColIndA</samp> is used.
                              But the array <samp class="ph codeph">csrValA</samp> stores coefficients of 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>j</mi>
                                    </mrow>
                                 </msub>
                              </math>
                              
                              one after another.
                              In other words, <samp class="ph codeph">csrValA[k*nnzA : (k+1)*nnzA]</samp> is the value of 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>k</mi>
                                    </mrow>
                                 </msub>
                              </math>
                              
                              .
                              
                           </p>
                           <p class="p">
                              The batched QR uses opaque data structure <samp class="ph codeph">csrqrInfo</samp> to keep intermediate data,
                              for example, matrix <samp class="ph codeph">Q</samp> and matrix <samp class="ph codeph">R</samp> of QR factorization. 
                              The user needs to create <samp class="ph codeph">csrqrInfo</samp> first by <samp class="ph codeph">cusolverSpCreateCsrqrInfo</samp>
                              before any function in batched QR operation. The <samp class="ph codeph">csrqrInfo</samp> would not release 
                              internal data until <samp class="ph codeph">cusolverSpDestroyCsrqrInfo</samp> is called. 
                              
                           </p>
                           <p class="p">
                              There are three routines in batched sparse QR, <samp class="ph codeph">cusolverSpXcsrqrAnalysisBatched</samp>,
                              <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrBufferInfoBatched</samp> and 
                              <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrsvBatched</samp>.
                              
                           </p>
                           <p class="p">
                              First, <samp class="ph codeph">cusolverSpXcsrqrAnalysisBatched</samp> is the analysis phase,
                              used to analyze sparsity pattern of 
                              matrix <samp class="ph codeph">Q</samp> and matrix <samp class="ph codeph">R</samp> of QR factorization.
                              Also parallelism is extracted during analysis phase.
                              Once analysis phase is done, the size of working space to perform QR is known. 
                              However <samp class="ph codeph">cusolverSpXcsrqrAnalysisBatched</samp> uses CPU to analyze the structure of 
                              matrix <samp class="ph codeph">A</samp>, and this may consume a lot of memory.
                              If host memory is not sufficient to finish the analysis, 
                              <samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp> is returned.
                              The required memory for analysis is proportional to zero fill-in in QR factorization.
                              The user may need to perform some kind of reordering to minimize zero fill-in, 
                              for example, <samp class="ph codeph">colamd</samp> or <samp class="ph codeph">symrcm</samp> in MATLAB.
                              <samp class="ph codeph">cuSolverSP</samp> library provides <samp class="ph codeph">symrcm</samp> (<samp class="ph codeph">cusolverSpXcsrsymrcm</samp>).
                              
                           </p>
                           <p class="p">
                              Second, the user needs to choose proper <samp class="ph codeph">batchSize</samp> and to prepare working space 
                              for sparse QR. 
                              There are two memory blocks used in batched sparse QR. 
                              One is internal memory block used to store matrix <samp class="ph codeph">Q</samp> and matrix <samp class="ph codeph">R</samp>.
                              The other is working space used to perform numerical factorization.
                              The size of the former is proportional to <samp class="ph codeph">batchSize</samp>, and the size is specified by 
                              returned parameter <samp class="ph codeph">internalDataInBytes</samp> of 
                              <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrBufferInfoBatched</samp>.
                              while the size of the latter is almost independent of <samp class="ph codeph">batchSize</samp>,
                              and the size is specified by returned parameter <samp class="ph codeph">workspaceInBytes</samp> of 
                              <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrBufferInfoBatched</samp>.
                              The internal memory block is allocated implicitly during first call of 
                              <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrsvBatched</samp>.
                              The user only needs to allocate working space for <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrsvBatched</samp>.
                              
                           </p>
                           <p class="p">
                              Instead of trying all batched matrices, the user can find maximum <samp class="ph codeph">batchSize</samp>  
                              by querying <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrBufferInfoBatched</samp>.
                              For example, the user can increase <samp class="ph codeph">batchSize</samp> till summation of 
                              <samp class="ph codeph">internalDataInBytes</samp> and <samp class="ph codeph">workspaceInBytes</samp> is greater than 
                              size of available device memory.
                              
                           </p>
                           <p class="p">
                              Suppose that the user needs to perform 253 linear solvers and available device memory is 2GB.
                              if <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrsvBatched</samp> can only afford <samp class="ph codeph">batchSize</samp> 100, 
                              the user has to call <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrsvBatched</samp> three times to finish all.
                              The user calls <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrBufferInfoBatched</samp> with <samp class="ph codeph">batchSize</samp> 100.
                              The opaque <samp class="ph codeph">info</samp> would remember this <samp class="ph codeph">batchSize</samp> and any subsequent 
                              call of <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrsvBatched</samp> cannot exceed this value.
                              In this example, the first two calls of <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrsvBatched</samp> will use 
                              <samp class="ph codeph">batchSize</samp> 100, and last call of <samp class="ph codeph">cusolverSp[S|D|C|Z]csrqrsvBatched</samp>
                              will use <samp class="ph codeph">batchSize</samp> 53.
                              
                           </p>
                           <p class="p">
                              Example: suppose that A0, A1, .., A9 have the same sparsity pattern, the 
                              following code solves 10 linear systems 
                              
                              
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                 <msub>
                                    <mi>A</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>j</mi>
                                    </mrow>
                                 </msub>
                                 <msub>
                                    <mi>x</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>j</mi>
                                    </mrow>
                                 </msub>
                                 <mo>=</mo>
                                 <msub>
                                    <mi>b</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                       <mi>j</mi>
                                    </mrow>
                                 </msub>
                                 <mi>, j = 0,2,..., 9</mi>
                              </math>
                              
                              by batched sparse QR.
                              
                           </p><pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Suppose that A0, A1, .., A9 are m x m sparse matrix represented by CSR format, </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Each matrix Aj has nonzero nnzA, and shares the same csrRowPtrA and csrColIndA.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// csrValA is aggregation of A0, A1, ..., A9.</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m ; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of rows and columns of each Aj </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzA ; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of nonzeros of each Aj</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrRowPtrA ; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// each Aj has the same csrRowPtrA </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *csrColIndA ; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// each Aj has the same csrColIndA</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *csrValA ; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// aggregation of A0,A1,...,A9</span>
cont <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchSize = 10; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// 10 linear systems </span>

cusolverSpHandle_t handle; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// handle to cusolver library</span>
csrqrInfo_t info = NULL;
cusparseMatDescr_t descrA = NULL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *pBuffer = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// working space for numerical factorization</span>
 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create a descriptor</span>
cusparseCreateMatDescr(&amp;descrA);
cusparseSetMatIndexBase(descrA, CUSPARSE_INDEX_BASE_ONE); <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// A is base-1</span>
cusparseSetMatType(descrA, CUSPARSE_MATRIX_TYPE_GENERAL); <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// A is a general matrix</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: create empty info structure</span>
cusolverSpCreateCsrqrInfo(&amp;info);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: symbolic analysis</span>
cusolverSpXcsrqrAnalysisBatched(
    handle, m, m, nnzA,
    descrA, csrRowPtrA, csrColIndA, info);
</pre><pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: allocate working space for Aj*xj=bj</span>
cusolverSpDcsrqrBufferInfoBatched(
    handle, m, m, nnzA,
    descrA,
    csrValA, csrRowPtrA, csrColIndA,
    batchSize, 
    info,
    &amp;internalDataInBytes,
    &amp;workspaceInBytes);

cudaMalloc(&amp;pBuffer, workspaceInBytes);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: solve Aj*xj = bj</span>
cusolverSpDcsrqrsvBatched(
    handle, m, m, nnzA,
    descrA, csrValA, csrRowPtrA, csrColIndA,
    b,
    x,
    batchSize,
    info,
    pBuffer);
 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 7: destroy info</span>
cusolverSpDestroyCsrqrInfo(info);

</pre><p class="p">
                              Please refer to Appendix B for detailed examples.
                              
                           </p>
                           <p class="p">
                              Remark 1: only GPU (device) path is provided.
                              
                           </p>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Input</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">handle to the cuSolverSP library context.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">m</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of rows of each matrix <samp class="ph codeph">Aj</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of columns of each matrix <samp class="ph codeph">Aj</samp>.
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of nonzeros of each matrix <samp class="ph codeph">Aj</samp>.
                                          It is the size <samp class="ph codeph">csrColIndA</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">descrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the descriptor of each matrix <samp class="ph codeph">Aj</samp>. 
                                          The supported matrix type is <samp class="ph codeph">CUSPARSE_MATRIX_TYPE_GENERAL</samp>. 
                                          Also, the supported index bases are <samp class="ph codeph">CUSPARSE_INDEX_BASE_ZERO</samp> and 
                                          <samp class="ph codeph">CUSPARSE_INDEX_BASE_ONE</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">device  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">nnzA*batchSize</samp> nonzero elements
                                          of matrices <samp class="ph codeph">A0, A1, ...</samp>.
                                          All matrices are aggregated one after another.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">device  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">m+1</samp> elements that contains the start of every row and 
                                          the end of the last row plus one.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">device  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">integer array of <samp class="ph codeph">nnzA</samp>column indices of the nonzero elements 
                                          of each matrix <samp class="ph codeph">Aj</samp>.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">b</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">device  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">m*batchSize</samp>
                                          of right-hand-side vectors <samp class="ph codeph">b0, b1, ...</samp>.
                                          All vectors are aggregated one after another.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">batchSize</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of systems to be solved.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">info</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">opaque structure for QR factorization.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">pBuffer</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">buffer allocated by the user, the size is returned by 
                                          <samp class="ph codeph">cusolverSpXcsrqrBufferInfoBatched()</samp>.
                                          
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Output</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">cusolverSp MemSpace  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">description</samp></td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">x</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">device  </samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">&lt;type&gt; array of <samp class="ph codeph">m*batchSize</samp>
                                          of solution vectors <samp class="ph codeph">x0, x1, ...</samp>.
                                          All vectors are aggregated one after another.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">internalDataInBytes</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the internal data.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="30%" rowspan="1" colspan="1"><samp class="ph codeph">workspaceInBytes</samp></td>
                                       <td class="entry" valign="top" width="20%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">number of bytes of the buffer in numerical factorization.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the resources could not be allocated.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">invalid parameters were passed (<samp class="ph codeph">m,n,nnzA&lt;=0</samp>),
                                          base index is not 0 or 1.
                                          
                                       </td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ARCH_MISMATCH</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the device only supports compute capability 2.0 and above.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                    </tr>
                                    <tr class="row">
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_MATRIX_TYPE_NOT_SUPPORTED</samp></td>
                                       <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the matrix type is not supported.</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="glu-reference"><a name="glu-reference" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#glu-reference" name="glu-reference" shape="rect">cuSolverRF: Refactorization Reference</a></h2>
                  <div class="body conbody">
                     <p class="p">
                        This chapter describes API of cuSolverRF, a library for fast refactorization. 
                        
                     </p>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-access-bundled-factors-device"><a name="glu-lt-t-gt-access-bundled-factors-device" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-access-bundled-factors-device" name="glu-lt-t-gt-access-bundled-factors-device" shape="rect">cusolverRfAccessBundledFactors()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfAccessBundledFactors(/* Input */
                                  cusolverRfHandle_t handle,
                                  /* Output (in the host memory) */
                                  int* nnzM,
                                  /* Output (in the device memory) */
                                  int** Mp,
                                  int** Mi,
                                  double** Mx);

</pre><p class="p">
                           This routine allows direct access to the lower <samp class="ph codeph">L</samp> and 
                           upper <samp class="ph codeph">U</samp> triangular factors stored in the cuSolverRF library handle. 
                           The factors are compressed into a single matrix <samp class="ph codeph">M=(L-I)+U</samp>, 
                           where the unitary diagonal of <samp class="ph codeph">L</samp> is not stored. 
                           It is assumed that a prior call to the <samp class="ph codeph">cusolverRfRefactor()</samp> was done 
                           in order to generate these triangular factors.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzM</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">M</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Mp</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">Mi</samp> and <samp class="ph codeph">Mx</samp>. 
                                       This array has also an extra entry at the end that stores the number of 
                                       non-zero elements in the matrix $M$. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Mi</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements 
                                       in the matrix <samp class="ph codeph">M</samp>. 
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzM</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Mx</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements 
                                       in the matrix <samp class="ph codeph">M</samp>. 
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzM</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-analyze"><a name="glu-lt-t-gt-analyze" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-analyze" name="glu-lt-t-gt-analyze" shape="rect">cusolverRfAnalyze()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfAnalyze(cusolverRfHandle_t handle);

</pre><p class="p">
                           This routine performs the appropriate analysis of parallelism available in the LU re-factorization depending upon the algorithm
                           chosen by the user.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mo>=</mo>
                                          <mi>L</mi>
                                          <mo>*</mo>
                                          <mi>U</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           It is assumed that a prior call to the <samp class="ph codeph">cusolverRfSetup[Host|Device]()</samp> was done 
                           in order to create internal data structures needed for the analysis.
                           
                        </p>
                        <p class="p">
                           This routine needs to be called only once for a single linear system
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an allocation of memory failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-assemble-device"><a name="glu-lt-t-gt-assemble-device" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-assemble-device" name="glu-lt-t-gt-assemble-device" shape="rect">cusolverRfSetupDevice()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfSetupDevice(/* Input (in the device memory) */
                    int n,
                    int nnzA,
                    int* csrRowPtrA,
                    int* csrColIndA,
                    double* csrValA,
                    int nnzL,
                    int* csrRowPtrL,
                    int* csrColIndL,
                    double* csrValL,
                    int nnzU,
                    int* csrRowPtrU,
                    int* csrColIndU,
                    double* csrValU,
                    int* P,
                    int* Q,
                    /* Output */
                    cusolverRfHandle_t handle);

</pre><p class="p">
                           This routine assembles the internal data structures of the cuSolverRF library. 
                           It is often the first routine to be called after the call to the 
                           <samp class="ph codeph">cusolverRfCreate()</samp> routine.
                           
                        </p>
                        <p class="p">
                           This routine accepts as input (on the device) the original matrix <samp class="ph codeph">A</samp>, 
                           the lower <samp class="ph codeph">(L)</samp> and upper <samp class="ph codeph">(U)</samp> triangular factors, 
                           as well as the left <samp class="ph codeph">(P)</samp> and the right <samp class="ph codeph">(Q)</samp> permutations 
                           resulting from the full LU factorization of the first <samp class="ph codeph">(i=1)</samp> linear system 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The permutations <samp class="ph codeph">P</samp> and <samp class="ph codeph">Q</samp> represent the final composition of 
                           all the left and right reorderings applied to the original matrix <samp class="ph codeph">A</samp>, respectively. 
                           However, these permutations are often associated with partial pivoting and reordering to 
                           minimize fill-in, respectively.
                           
                        </p>
                        <p class="p">
                           This routine needs to be called only once for a single linear system 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of rows (and columns) of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">A</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">csrColIndA</samp> and <samp class="ph codeph">csrValA</samp>. 
                                       This array has also an extra entry at the end that stores the number of 
                                       non-zero elements in the matrix. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements 
                                       in the matrix. 
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzA</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements 
                                       in the matrix. 
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzA</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">L</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">csrColIndL</samp> and <samp class="ph codeph">csrValL</samp>.
                                       This array has also an extra entry at the end that stores the number of
                                       non-zero elements in the matrix <samp class="ph codeph">L</samp>. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">L</samp>.  
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrValL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">L</samp>.  
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">U</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">csrColIndU</samp> and <samp class="ph codeph">csrValU</samp>.
                                       This array has also an extra entry at the end that stores the number of
                                       non-zero elements in the matrix <samp class="ph codeph">U</samp>. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">U</samp>.
                                       It is assumed that this array is sorted by row and by column within each row.
                                       The array size is <samp class="ph codeph">nnzU</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrValU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">U</samp>. 
                                       It is assumed that this array is sorted by row and by column within each row.
                                       The array size is <samp class="ph codeph">nnzU</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">P</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the left permutation (often associated with pivoting). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Q</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the right permutation (often associated with reordering). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the GLU library.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an unsupported value or parameter was passed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an allocation of memory failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-assemble-host"><a name="glu-lt-t-gt-assemble-host" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-assemble-host" name="glu-lt-t-gt-assemble-host" shape="rect">cusolverRfSetupHost()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfSetupHost(/* Input (in the host memory) */
                  int n,
                  int nnzA,
                  int* h_csrRowPtrA,
                  int* h_csrColIndA,
                  double* h_csrValA,
                  int nnzL,
                  int* h_csrRowPtrL,
                  int* h_csrColIndL,
                  double* h_csrValL,
                  int nnzU,
                  int* h_csrRowPtrU,
                  int* h_csrColIndU,
                  double* h_csrValU,
                  int* h_P,
                  int* h_Q,
                  /* Output */
                  cusolverRfHandle_t handle);

</pre><p class="p">
                           This routine assembles the internal data structures of the cuSolverRF library. 
                           It is often the first routine to be called after the call to the 
                           <samp class="ph codeph">cusolverRfCreate()</samp> routine.
                           
                        </p>
                        <p class="p">
                           This routine accepts as input (on the host) the original matrix <samp class="ph codeph">A</samp>, 
                           the lower <samp class="ph codeph">(L)</samp> and upper <samp class="ph codeph">(U)</samp> triangular factors, 
                           as well as the left <samp class="ph codeph">(P)</samp> and the right <samp class="ph codeph">(Q)</samp> permutations 
                           resulting from the full LU factorization of the first <samp class="ph codeph">(i=1)</samp> linear system 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The permutations <samp class="ph codeph">P</samp> and <samp class="ph codeph">Q</samp> represent the final composition of 
                           all the left and right reorderings applied to the original matrix <samp class="ph codeph">A</samp>, respectively. 
                           However, these permutations are often associated with partial pivoting and reordering to 
                           minimize fill-in, respectively.
                           
                        </p>
                        <p class="p">
                           This routine needs to be called only once for a single linear system 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of rows (and columns) of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">A</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">h_csrColIndA</samp> and <samp class="ph codeph">h_csrValA</samp>. 
                                       This array has also an extra entry at the end that stores the number of 
                                       non-zero elements in the matrix. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements 
                                       in the matrix. 
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzA</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrValA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements 
                                       in the matrix. 
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzA</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">L</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrRowPtrL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">h_csrColIndL</samp> and <samp class="ph codeph">h_csrValL</samp>.
                                       This array has also an extra entry at the end that stores the number of
                                       non-zero elements in the matrix <samp class="ph codeph">L</samp>. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrColIndL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">L</samp>.  
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrValL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">L</samp>.  
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">U</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrRowPtrU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">h_csrColIndU</samp> and <samp class="ph codeph">h_csrValU</samp>.
                                       This array has also an extra entry at the end that stores the number of
                                       non-zero elements in the matrix <samp class="ph codeph">U</samp>. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrColIndU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">U</samp>.
                                       It is assumed that this array is sorted by row and by column within each row.
                                       The array size is <samp class="ph codeph">nnzU</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrValU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">U</samp>. 
                                       It is assumed that this array is sorted by row and by column within each row.
                                       The array size is <samp class="ph codeph">nnzU</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_P</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the left permutation (often associated with pivoting). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_Q</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the right permutation (often associated with reordering). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an unsupported value or parameter was passed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an allocation of memory failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-create"><a name="glu-lt-t-gt-create" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-create" name="glu-lt-t-gt-create" shape="rect">cusolverRfCreate()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t cusolverRfCreate(cusolverRfHandle_t *handle);

</pre><p class="p">
                           This routine initializes the cuSolverRF library. 
                           It allocates required resources and must be called prior to any other cuSolverRF library routine.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the pointer to the cuSolverRF library handle.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an allocation of memory failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-extract-bundled-factors-host"><a name="glu-lt-t-gt-extract-bundled-factors-host" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-extract-bundled-factors-host" name="glu-lt-t-gt-extract-bundled-factors-host" shape="rect">cusolverRfExtractBundledFactorsHost()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfExtractBundledFactorsHost(/* Input */
                                 cusolverRfHandle_t handle,
                                 /* Output (in the host memory) */
                                 int* h_nnzM,
                                 int** h_Mp,
                                 int** h_Mi,
                                 double** h_Mx);


</pre><p class="p">
                           This routine extracts lower <samp class="ph codeph">(L)</samp> and upper <samp class="ph codeph">(U)</samp> triangular factors 
                           from the cuSolverRF library handle into the host memory. 
                           The factors are compressed into a single matrix <samp class="ph codeph">M=(L-I)+U</samp>, 
                           where the unitary diagonal of <samp class="ph codeph">(L)</samp> is not stored. 
                           It is assumed that a prior call to the <samp class="ph codeph">cusolverRfRefactor()</samp> was done 
                           in order to generate these triangular factors.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_nnzM</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">M</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_Mp</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">h_Mi</samp> and <samp class="ph codeph">h_Mx</samp>. 
                                       This array has also an extra entry at the end that stores the number of 
                                       non-zero elements in the matrix <samp class="ph codeph">M</samp>. 
                                       The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_Mi</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements 
                                       in the matrix. 
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">h_nnzM</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_Mx</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements 
                                       in the matrix. 
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">h_nnzM</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an allocation of memory failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-extract-split-factors-host"><a name="glu-lt-t-gt-extract-split-factors-host" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-extract-split-factors-host" name="glu-lt-t-gt-extract-split-factors-host" shape="rect">cusolverRfExtractSplitFactorsHost()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfExtractSplitFactorsHost(/* Input */
                               cusolverRfHandle_t handle,
                               /* Output (in the host memory) */
                               int* h_nnzL,
                               int** h_Lp,
                               int** h_Li,
                               double** h_Lx,
                               int* h_nnzU,
                               int** h_Up,
                               int** h_Ui,
                               double** h_Ux);

</pre><p class="p">
                           This routine extracts lower <samp class="ph codeph">(L)</samp> and upper <samp class="ph codeph">(U)</samp> triangular factors 
                           from the cuSolverRF library handle into the host memory. 
                           It is assumed that a prior call to the <samp class="ph codeph">cusolverRfRefactor()</samp> was done 
                           in order to generate these triangular factors.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_nnzL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">L</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_Lp</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">h_Li</samp> and <samp class="ph codeph">h_Lx</samp>.
                                       This array has also an extra entry at the end that stores the number of
                                       non-zero elements in the matrix <samp class="ph codeph">L</samp>. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_Li</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">L</samp>.
                                       It is assumed that this array is sorted by row and by column within each row.
                                       The array size is <samp class="ph codeph">h_nnzL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_Lx</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">L</samp>.
                                       It is assumed that this array is sorted by row and by column within each row.
                                       The array size is <samp class="ph codeph">h_nnzL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_nnzU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">U</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_Up</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">h_Ui</samp> and <samp class="ph codeph">h_Ux</samp>.
                                       This array has also an extra entry at the end that stores the number of
                                       non-zero elements in the matrix <samp class="ph codeph">U</samp>. 
                                       The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_Ui</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">U</samp>.
                                       It is assumed that this array is sorted by row and by column within each row.
                                       The array size is <samp class="ph codeph">h_nnzU</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_Ux</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">U</samp>.
                                       It is assumed that this array is sorted by row and by column within each row.
                                       The array size is <samp class="ph codeph">h_nnzU</samp>.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an allocation of memory failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-destroy"><a name="glu-lt-t-gt-destroy" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-destroy" name="glu-lt-t-gt-destroy" shape="rect">cusolverRfDestroy()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t cusolverRfDestroy(cusolverRfHandle_t handle);

</pre><p class="p">
                           This routine shuts down the cuSolverRF library. 
                           It releases acquired resources and must be called after all the  cuSolverRF library routines.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the cuSolverRF library handle.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-get-matrix-format"><a name="glu-lt-t-gt-get-matrix-format" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-get-matrix-format" name="glu-lt-t-gt-get-matrix-format" shape="rect">cusolverRfGetMatrixFormat()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfGetMatrixFormat(cusolverRfHandle_t handle,
                      cusolverRfMatrixFormat_t *format,
                      cusolverRfUnitDiagonal_t *diag);

</pre><p class="p">
                           This routine gets the matrix format used in the <samp class="ph codeph">cusolverRfSetupDevice()</samp>, 
                           <samp class="ph codeph">cusolverRfSetupHost()</samp>, <samp class="ph codeph">cusolverRfResetValues()</samp>, 
                           <samp class="ph codeph">cusolverRfExtractBundledFactorsHost()</samp> and 
                           <samp class="ph codeph">cusolverRfExtractSplitFactorsHost()</samp> routines.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">format</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the enumerated matrix format type.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">diag</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the enumerated unit diagonal type.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-get-numeric-properties"><a name="glu-lt-t-gt-get-numeric-properties" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-get-numeric-properties" name="glu-lt-t-gt-get-numeric-properties" shape="rect">cusolverRfGetNumericProperties()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfGetNumericProperties(cusolverRfHandle_t handle,
                           double *zero,
                           double *boost);

</pre><p class="p">
                           This routine gets the numeric values used for checking for ''zero'' pivot and 
                           for boosting it in the <samp class="ph codeph">cusolverRfRefactor()</samp> and 
                           <samp class="ph codeph">cusolverRfSolve()</samp> routines. 
                           The numeric boosting will be used only if <samp class="ph codeph">boost &gt; 0.0</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">zero</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the value below which zero pivot is flagged.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">boost</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the value which is substituted for zero pivot (if the later is flagged).</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-get-numeric-boost-report"><a name="glu-lt-t-gt-get-numeric-boost-report" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-get-numeric-boost-report" name="glu-lt-t-gt-get-numeric-boost-report" shape="rect">cusolverRfGetNumericBoostReport()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfGetNumericBoostReport(cusolverRfHandle_t handle,
                             cusolverRfNumericBoostReport_t *report);

</pre><p class="p">
                           This routine gets the report whether numeric boosting was used 
                           in the <samp class="ph codeph">cusolverRfRefactor()</samp> and <samp class="ph codeph">cusolverRfSolve()</samp> routines.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">report</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the enumerated boosting report type.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-get-reset-values-fast-mode"><a name="glu-lt-t-gt-get-reset-values-fast-mode" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-get-reset-values-fast-mode" name="glu-lt-t-gt-get-reset-values-fast-mode" shape="rect">cusolverRfGetResetValuesFastMode()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfGetResetValuesFastMode(cusolverRfHandle_t handle,
                               rfResetValuesFastMode_t *fastMode);

</pre><p class="p">
                           This routine gets the mode used in the <samp class="ph codeph">cusolverRfResetValues</samp> routine.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">fastMode</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the enumerated mode type.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-get-algs"><a name="glu-lt-t-gt-get-algs" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-get-algs" name="glu-lt-t-gt-get-algs" shape="rect">cusolverRfGet_Algs()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfGet_Algs(cusolverRfHandle_t handle, 
             cusolverRfFactorization_t* fact_alg,
             cusolverRfTriangularSolve_t* solve_alg);

</pre><p class="p">
                           This routine gets the algorithm used for the refactorization in 
                           <samp class="ph codeph">cusolverRfRefactor()</samp> and the triangular solve in <samp class="ph codeph">cusolverRfSolve()</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">alg</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the enumerated algorithm type.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-refactor"><a name="glu-lt-t-gt-refactor" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-refactor" name="glu-lt-t-gt-refactor" shape="rect">cusolverRfRefactor()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t cusolverRfRefactor(cusolverRfHandle_t handle);

</pre><p class="p">
                           This routine performs the LU re-factorization
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mo>=</mo>
                                          <mi>L</mi>
                                          <mo>*</mo>
                                          <mi>U</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           exploring the available parallelism on the GPU. 
                           It is assumed that a prior call to the <samp class="ph codeph">glu_analyze()</samp> was done 
                           in order to find the available paralellism.
                           
                        </p>
                        <p class="p">
                           This routine may be called multiple times, once for each of the linear systems 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ZERO_PIVOT</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a zero pivot was encountered during the computation.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-reset-values"><a name="glu-lt-t-gt-reset-values" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-reset-values" name="glu-lt-t-gt-reset-values" shape="rect">cusolverRfResetValues()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfResetValues(/* Input (in the device memory) */
                 int n,
                 int nnzA,
                 int* csrRowPtrA,
                 int* csrColIndA,
                 double* csrValA,
                 int* P,
                 int* Q,
                 /* Output */
                 cusolverRfHandle_t handle);

</pre><p class="p">
                           This routine updates internal data structures with the values of the new coefficient matrix. 
                           It is assumed that the arrays <samp class="ph codeph">csrRowPtrA</samp>, <samp class="ph codeph">csrColIndA</samp>, 
                           <samp class="ph codeph">P</samp> and <samp class="ph codeph">Q</samp> have not changed since the last call to 
                           the <samp class="ph codeph">cusolverRfSetup[Host|Device]</samp> routine. 
                           This assumption reflects the fact that the sparsity pattern of coefficient matrices 
                           as well as reordering to minimize fill-in and pivoting remain the same in the set of linear systems
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           This routine may be called multiple times, once for each of the linear systems
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of rows (and columns) of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">A</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">csrColIndA</samp> and <samp class="ph codeph">csrValA</samp>. 
                                       This array has also an extra entry at the end that stores the number of 
                                       non-zero elements in the matrix. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements 
                                       in the matrix. 
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzA</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements 
                                       in the matrix. 
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzA</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">P</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the left permutation (often associated with pivoting). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Q</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the right permutation (often associated with reordering). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an unsupported value or parameter was passed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-set-matrix-format"><a name="glu-lt-t-gt-set-matrix-format" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-set-matrix-format" name="glu-lt-t-gt-set-matrix-format" shape="rect">cusolverRfSetMatrixFormat()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfSetMatrixFormat(cusolverRfHandle_t handle,
                      gluMatrixFormat_t format,
                      gluUnitDiagonal_t diag);

</pre><p class="p">
                           This routine sets the matrix format used in the <samp class="ph codeph">cusolverRfSetupDevice()</samp>, 
                           <samp class="ph codeph">cusolverRfSetupHost()</samp>, <samp class="ph codeph">cusolverRfResetValues()</samp>, 
                           <samp class="ph codeph">cusolverRfExtractBundledFactorsHost()</samp> and 
                           <samp class="ph codeph">cusolverRfExtractSplitFactorsHost()</samp> routines.
                           It may be called once prior to <samp class="ph codeph">cusolverRfSetupDevice()</samp> and 
                           <samp class="ph codeph">cusolverRfSetupHost()</samp> routines.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">format</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the enumerated matrix format type.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">diag</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the enumerated unit diagonal type.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an enumerated mode parameter is wrong.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="unique_752983775"><a name="unique_752983775" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#unique_752983775" name="unique_752983775" shape="rect">cusolverRfSetNumericProperties()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfSetNumericProperties(cusolverRfHandle_t handle,
                           double zero,
                           double boost);

</pre><p class="p">
                           This routine sets the numeric values used for checking for ''zero'' pivot and 
                           for boosting it in the <samp class="ph codeph">cusolverRfRefactor()</samp> and 
                           <samp class="ph codeph">cusolverRfSolve()</samp> routines. 
                           It may be called multiple times prior to <samp class="ph codeph">cusolverRfRefactor()</samp> and 
                           <samp class="ph codeph">cusolverRfSolve()</samp> routines.
                           The numeric boosting will be used only if <samp class="ph codeph">boost &gt; 0.0</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">zero</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the value below which zero pivot is flagged.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">boost</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the value which is substituted for zero pivot (if the later is flagged).</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-set-reset-values-fast-mode"><a name="glu-lt-t-gt-set-reset-values-fast-mode" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-set-reset-values-fast-mode" name="glu-lt-t-gt-set-reset-values-fast-mode" shape="rect">cusolverRfSetResetValuesFastMode()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfSetResetValuesFastMode(cusolverRfHandle_t handle,
                               gluResetValuesFastMode_t fastMode);

</pre><p class="p">
                           This routine sets the mode used in the <samp class="ph codeph">cusolverRfResetValues</samp> routine.
                           The fast mode requires extra memory and is recommended only if very fast calls to 
                           <samp class="ph codeph">cusolverRfResetValues()</samp> are needed. 
                           It may be called once prior to <samp class="ph codeph">cusolverRfAnalyze()</samp> routine.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">fastMode</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the enumerated mode type.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an enumerated mode parameter is wrong.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-set-algs"><a name="glu-lt-t-gt-set-algs" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-set-algs" name="glu-lt-t-gt-set-algs" shape="rect">cusolverRfSetAlgs()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfSetAlgs(cusolverRfHandle_t handle, 
             gluFactorization_t fact_alg,
             gluTriangularSolve_t alg);

</pre><p class="p">
                           This routine sets the algorithm used for the refactorization in 
                           <samp class="ph codeph">cusolverRfRefactor()</samp> and the triangular solve in <samp class="ph codeph">cusolverRfSolve()</samp>.
                           It may be called once prior to <samp class="ph codeph">cusolverRfAnalyze()</samp> routine.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">alg</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the enumerated algorithm type.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glu-lt-t-gt-solve"><a name="glu-lt-t-gt-solve" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glu-lt-t-gt-solve" name="glu-lt-t-gt-solve" shape="rect">cusolverRfSolve()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfSolve(/* Input (in the device memory) */
          cusolverRfHandle_t handle,
          int *P,
          int *Q,
          int nrhs,
          double *Temp,
          int ldt,
          /* Input/Output (in the device memory) */
          double *XF,
          /* Input */
          int ldxf);

</pre><p class="p">
                           This routine performs the forward and backward solve with the lower
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>L</mi>
                              <mi>∈</mi>
                              <msup>
                                 <mi>R</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>nxn</mi>
                                 </mrow>
                              </msup>
                           </math>
                           
                           and upper 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>U</mi>
                              <mi>∈</mi>
                              <msup>
                                 <mi>R</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>nxn</mi>
                                 </mrow>
                              </msup>
                           </math>
                           
                           triangular factors resulting from the LU re-factorization
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mo>=</mo>
                                          <mi>L</mi>
                                          <mo>*</mo>
                                          <mi>U</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           which is assumed to have been computed by a prior call to the <samp class="ph codeph">cusolverRfRefactor()</samp> routine.
                           
                        </p>
                        <p class="p">
                           The routine can solve linear systems with multiple right-hand-sides (rhs),
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mi>X</mi>
                                          <mo>=</mo>
                                          <mi>(LU)</mi>
                                          <mi>X</mi>
                                          <mo>=</mo>
                                          <mi>L</mi>
                                          <mi>(UX)</mi>
                                          <mo>=</mo>
                                          <mi>L</mi>
                                          <mi>Y</mi>
                                          <mo>=</mo>
                                          <mi>F</mi>
                                          <mi>&nbsp;</mi>
                                          <mi>where</mi>
                                          <mi>&nbsp;</mi>
                                          <mi>U</mi>
                                          <mi>X</mi>
                                          <mo>=</mo>
                                          <mi>Y</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           even though currently only a single rhs is supported.
                           
                        </p>
                        <p class="p">
                           This routine may be called multiple times, once for each of the linear systems
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">P</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the left permutation (often associated with pivoting). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Q</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the right permutation (often associated with reordering). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nrhs</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number right-hand-sides to be solved.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Temp</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the dense matrix that contains temporary workspace (of size <samp class="ph codeph">ldt*nrhs</samp>).
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldt</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the leading dimension of dense matrix Temp (<samp class="ph codeph">ldt &gt;= n</samp>).
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">XF</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the dense matrix that contains the right-hand-sides <samp class="ph codeph">F</samp>
                                       and solutions <samp class="ph codeph">X</samp> 
                                       (of size <samp class="ph codeph">ldxf*nrhs</samp>).
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldxf</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the leading dimension of dense matrix <samp class="ph codeph">XF</samp> 
                                       (<samp class="ph codeph">ldxf &gt;= n</samp>).
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an unsupported value or parameter was passed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glubatch-lt-t-gt-assemble-host"><a name="glubatch-lt-t-gt-assemble-host" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glubatch-lt-t-gt-assemble-host" name="glubatch-lt-t-gt-assemble-host" shape="rect">cusolverRfBatchSetupHost()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfBatchSetupHost(/* Input (in the host memory) */
                       int batchSize,
                       int n,
                       int nnzA,
                       int* h_csrRowPtrA,
                       int* h_csrColIndA,
                       double *h_csrValA_array[],
                       int nnzL,
                       int* h_csrRowPtrL,
                       int* h_csrColIndL,
                       double *h_csrValL,
                       int nnzU,
                       int* h_csrRowPtrU,
                       int* h_csrColIndU,
                       double *h_csrValU,
                       int* h_P,
                       int* h_Q,
                       /* Output */
                       cusolverRfHandle_t handle);

</pre><p class="p">
                           This routine assembles the internal data structures of the cuSolverRF library for batched operation.
                           It is called after the call to the <samp class="ph codeph">cusolverRfCreate()</samp> routine, 
                           and before any other batched routines.
                           
                        </p>
                        <p class="p">
                           The batched operation assumes that the user has the following linear systems   
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>b</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                          <mi>, j = 1,2,..., batchSize</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where each matrix in the set 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <mi>{</mi>
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mi>}</mi>
                           </math>
                           
                           has the same sparsity pattern, and quite similar such that factorization can be done 
                           by the same permutation <samp class="ph codeph">P</samp> and <samp class="ph codeph">Q</samp>.
                           In other words, 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mi>, j&gt;1</mi>
                           </math>
                           
                           is a small perturbation of 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>1</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           .
                           
                        </p>
                        <p class="p">
                           This routine accepts as input (on the host) the original matrix <samp class="ph codeph">A</samp> 
                           (sparsity pattern and batched values), the lower <samp class="ph codeph">(L)</samp> and upper <samp class="ph codeph">(U)</samp> 
                           triangular factors, as well as the left <samp class="ph codeph">(P)</samp> and the right <samp class="ph codeph">(Q)</samp> 
                           permutations resulting from the full LU factorization of the first <samp class="ph codeph">(i=1)</samp> 
                           linear system  
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The permutations <samp class="ph codeph">P</samp> and <samp class="ph codeph">Q</samp> represent the final composition of 
                           all the left and right reorderings applied to the original matrix <samp class="ph codeph">A</samp>, respectively. 
                           However, these permutations are often associated with partial pivoting and reordering to 
                           minimize fill-in, respectively.
                           
                        </p>
                        <p class="p">
                           Remark 1: the matrices <samp class="ph codeph">A</samp>, <samp class="ph codeph">L</samp> and <samp class="ph codeph">U</samp> 
                           must be CSR format and base-0. 
                           
                        </p>
                        <p class="p">
                           Remark 2: to get best performance, <samp class="ph codeph">batchSize</samp> should be multiple of 32 and 
                           greater or equal to 32.
                           The algorithm is memory-bound, once bandwidth limit is reached, there is no room to 
                           improve performance by large <samp class="ph codeph">batchSize</samp>.
                           In practice, <samp class="ph codeph">batchSize</samp> of 32 - 128 is often enough to obtain good performance, 
                           but in some cases larger <samp class="ph codeph">batchSize</samp> might be beneficial.
                           
                        </p>
                        <p class="p">
                           This routine needs to be called only once for a single linear system 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">batchSize</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of matrices in the batched mode.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of rows (and columns) of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">A</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">h_csrColIndA</samp> and <samp class="ph codeph">h_csrValA</samp>. 
                                       This array has also an extra entry at the end that stores the number of 
                                       non-zero elements in the matrix. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements 
                                       in the matrix. 
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzA</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrValA_array</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">array of pointers of size <samp class="ph codeph">batchSize</samp>, 
                                       each pointer points to the array of values corresponding to the non-zero elements in the matrix.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">L</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrRowPtrL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">h_csrColIndL</samp> and <samp class="ph codeph">h_csrValL</samp>.
                                       This array has also an extra entry at the end that stores the number of
                                       non-zero elements in the matrix <samp class="ph codeph">L</samp>. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrColIndL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">L</samp>.  
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrValL</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">L</samp>.  
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzL</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">U</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrRowPtrU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">h_csrColIndU</samp> and <samp class="ph codeph">h_csrValU</samp>.
                                       This array has also an extra entry at the end that stores the number of
                                       non-zero elements in the matrix <samp class="ph codeph">U</samp>. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrColIndU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">U</samp>.
                                       It is assumed that this array is sorted by row and by column within each row.
                                       The array size is <samp class="ph codeph">nnzU</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_csrValU</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of values corresponding to the non-zero elements
                                       in the matrix <samp class="ph codeph">U</samp>. 
                                       It is assumed that this array is sorted by row and by column within each row.
                                       The array size is <samp class="ph codeph">nnzU</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_P</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the left permutation (often associated with pivoting). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">h_Q</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the right permutation (often associated with reordering). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an unsupported value or parameter was passed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an allocation of memory failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glubatch-lt-t-gt-analyze"><a name="glubatch-lt-t-gt-analyze" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glubatch-lt-t-gt-analyze" name="glubatch-lt-t-gt-analyze" shape="rect">cusolverRfBatchAnalyze()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t cusolverRfBatchAnalyze(cusolverRfHandle_t handle);

</pre><p class="p">
                           This routine performs the appropriate analysis of parallelism available in the batched LU re-factorization.
                           
                        </p>
                        <p class="p">
                           It is assumed that a prior call to the <samp class="ph codeph">cusolverRfBatchSetup[Host]()</samp>
                           was done in order to create internal data structures needed for the analysis.
                           
                        </p>
                        <p class="p">
                           This routine needs to be called only once for a single linear system 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>b</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                          <mi>, j = 1,2,..., batchSize</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ALLOC_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an allocation of memory failed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glubatch-lt-t-gt-reset-values"><a name="glubatch-lt-t-gt-reset-values" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glubatch-lt-t-gt-reset-values" name="glubatch-lt-t-gt-reset-values" shape="rect">cusolverRfBatchResetValues()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfBatchResetValues(/* Input (in the device memory) */
                      int batchSize,
                      int n,
                      int nnzA,
                      int* csrRowPtrA,
                      int* csrColIndA,
                      double* csrValA_array[],
                      int *P,
                      int *Q,
                      /* Output */
                      cusolverRfHandle_t handle);

</pre><p class="p">
                           This routine updates internal data structures with the values of the new coefficient matrix.
                           It is assumed that the arrays <samp class="ph codeph">csrRowPtrA</samp>, <samp class="ph codeph">csrColIndA</samp>,
                           <samp class="ph codeph">P</samp> and <samp class="ph codeph">Q</samp> have not changed since the last call to 
                           the <samp class="ph codeph">cusolverRfbatch_setup_host</samp> routine.
                           
                        </p>
                        <p class="p">
                           This assumption reflects the fact that the sparsity pattern of coefficient matrices 
                           as well as reordering to minimize fill-in and pivoting remain the same in the set of linear systems
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>b</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                          <mi>, j = 1,2,..., batchSize</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The input parameter <samp class="ph codeph">csrValA_array</samp> is an array of pointers on device memory.
                           <samp class="ph codeph">csrValA_array(j)</samp> points to matrix 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           which is also on device memory.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">batchSize</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of matrices in batched mode.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">n</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of rows (and columns) of matrix <samp class="ph codeph">A</samp>.
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nnzA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number of non-zero elements of matrix <samp class="ph codeph">A</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrRowPtrA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input</samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of offsets corresponding to the start of each row in the arrays
                                       <samp class="ph codeph">csrColIndA</samp> and <samp class="ph codeph">csrValA</samp>. 
                                       This array has also an extra entry at the end that stores the number of 
                                       non-zero elements in the matrix. The array size is <samp class="ph codeph">n+1</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrColIndA</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the array of column indices corresponding to the non-zero elements 
                                       in the matrix. 
                                       It is assumed that this array is sorted by row and by column within each row. 
                                       The array size is <samp class="ph codeph">nnzA</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">csrValA_array</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">array of pointers of size <samp class="ph codeph">batchSize</samp>, 
                                       each pointer points to the array of values corresponding to the non-zero elements in the matrix.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">P</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the left permutation (often associated with pivoting). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Q</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the right permutation (often associated with reordering). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an unsupported value or parameter was passed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glubatch-lt-t-gt-refactor"><a name="glubatch-lt-t-gt-refactor" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glubatch-lt-t-gt-refactor" name="glubatch-lt-t-gt-refactor" shape="rect">cusolverRfBatchRefactor()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t cusolverRfBatchRefactor(cusolverRfHandle_t handle);

</pre><p class="p">
                           This routine performs the LU re-factorization 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>M</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <mi>P</mi>
                                          <mo>*</mo>
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                          <mo>*</mo>
                                          <msup>
                                             <mi>Q</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>T</mi>
                                             </mrow>
                                          </msup>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>L</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                          <mo>*</mo>
                                          <msub>
                                             <mi>U</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>j</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           exploring the available parallelism on the GPU. 
                           It is assumed that a prior call to the <samp class="ph codeph">cusolverRfBatchAnalyze()</samp> was done 
                           in order to find the available paralellism.
                           
                        </p>
                        <p class="p">
                           Remark: <samp class="ph codeph">cusolverRfBatchRefactor()</samp> would not report any failure of LU refactorization.
                           The user has to call <samp class="ph codeph">cusolverRfBatchZeroPivot()</samp> to know which matrix failed the LU refactorization.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host  </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glubatch-lt-t-gt-solve"><a name="glubatch-lt-t-gt-solve" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glubatch-lt-t-gt-solve" name="glubatch-lt-t-gt-solve" shape="rect">cusolverRfBatchSolve()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfBatchSolve(/* Input (in the device memory) */
               cusolverRfHandle_t handle,
               int *P,
               int *Q,
               int nrhs,
               double *Temp,
               int ldt,
               /* Input/Output (in the device memory) */
               double *XF_array[],
               /* Input */
               int ldxf);

</pre><p class="p">
                           To solve 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>*</mo>
                              <msub>
                                 <mi>x</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>=</mo>
                              <msub>
                                 <mi>b</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           
                           , first we reform the equation by 
                           
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>M</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>*</mo>
                              <mi>Q</mi>
                              <mo>*</mo>
                              <msub>
                                 <mi>x</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>=</mo>
                              <mi>P</mi>
                              <mo>*</mo>
                              <msub>
                                 <mi>b</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           
                           where 
                           
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>M</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>=</mo>
                              <mi>P</mi>
                              <mo>*</mo>
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>*</mo>
                              <msup>
                                 <mi>Q</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>T</mi>
                                 </mrow>
                              </msup>
                           </math>
                           
                           . Then do refactorization  
                           
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>M</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>=</mo>
                              <msub>
                                 <mi>L</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>*</mo>
                              <msub>
                                 <mi>U</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           
                           by <samp class="ph codeph">cusolverRfBatch_Refactor()</samp>.
                           Further <samp class="ph codeph">cusolverRfBatch_Solve()</samp> takes over the remaining steps, including:
                           
                        </p>
                        <p class="p">
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>z</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>=</mo>
                              <mi>P</mi>
                              <mo>*</mo>
                              <msub>
                                 <mi>b</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                        </p>
                        <p class="p">
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>M</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>*</mo>
                              <msub>
                                 <mi>y</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>=</mo>
                              <msub>
                                 <mi>z</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                        </p>
                        <p class="p">
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>x</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>=</mo>
                              <msup>
                                 <mi>Q</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>T</mi>
                                 </mrow>
                              </msup>
                              <mo>*</mo>
                              <msub>
                                 <mi>y</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                        </p>
                        <p class="p">
                           The input parameter <samp class="ph codeph">XF_array</samp> is an array of pointers on device memory.
                           <samp class="ph codeph">XF_array(j)</samp> points to matrix  
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>x</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           which is also on device memory.
                           
                        </p>
                        <p class="p">
                           Remark 1: only a single rhs is supported.
                           
                        </p>
                        <p class="p">
                           Remark 2: no singularity is reported during backward solve. 
                           If some matrix  
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           failed the refactorization and
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>U</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           has some zero diagonal, backward solve would compute NAN. 
                           The user has to call <samp class="ph codeph">cusolverRfBatch_Zero_Pivot</samp> to check if refactorization is successful or not.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">Memory </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">P</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the left permutation (often associated with pivoting). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Q</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the right permutation (often associated with reordering). 
                                       The array size in <samp class="ph codeph">n</samp>.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">nrhs</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the number right-hand-sides to be solved.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">Temp</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the dense matrix that contains temporary workspace (of size <samp class="ph codeph">ldt*nrhs</samp>).
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldt</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the leading dimension of dense matrix Temp (<samp class="ph codeph">ldt &gt;= n</samp>).
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">XF_array</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">device </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">in/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">array of pointers of size <samp class="ph codeph">batchSize</samp>, 
                                       each pointer points to the dense matrix that contains the right-hand-sides
                                       <samp class="ph codeph">F</samp> and solutions <samp class="ph codeph">X</samp> 
                                       (of size <samp class="ph codeph">ldxf*nrhs</samp>).
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">ldxf</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the leading dimension of dense matrix <samp class="ph codeph">XF</samp> 
                                       (<samp class="ph codeph">ldxf &gt;= n</samp>).
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INVALID_VALUE</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an unsupported value or parameter was passed.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_EXECUTION_FAILED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a kernel failed to launch on the GPU.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_INTERNAL_ERROR</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">an internal operation failed.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="glubatch-lt-t-gt-zero_pivot"><a name="glubatch-lt-t-gt-zero_pivot" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#glubatch-lt-t-gt-zero_pivot" name="glubatch-lt-t-gt-zero_pivot" shape="rect">cusolverRfBatchZeroPivot()</a></h3>
                     <div class="body conbody"><pre xml:space="preserve">
cusolverStatus_t 
cusolverRfBatchZeroPivot(/* Input */
                    cusolverRfHandle_t handle
                    /* Output (in the host memory) */
                    int *position);

</pre><p class="p">
                           Although 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           is close to each other, it does not mean  
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>M</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>=</mo>
                              <mi>P</mi>
                              <mo>*</mo>
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>*</mo>
                              <msup>
                                 <mi>Q</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>T</mi>
                                 </mrow>
                              </msup>
                              <mo>=</mo>
                              <msub>
                                 <mi>L</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mo>*</mo>
                              <msub>
                                 <mi>U</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           exists for every j.
                           The user can query which matrix failed LU refactorization by checking corresponding value in
                           <samp class="ph codeph">position</samp> array.
                           The input parameter <samp class="ph codeph">position</samp> is an integer array of size <samp class="ph codeph">batchSize</samp>.
                           
                        </p>
                        <p class="p">
                           The <samp class="ph codeph">j-th</samp> component denotes the refactorization result of matrix
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           .
                           If <samp class="ph codeph">position(j)</samp> is -1, the LU refactorization of matrix
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           is successful.
                           If <samp class="ph codeph">position(j)</samp> is <samp class="ph codeph">k &gt;= 0</samp>, matrix  
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           is not LU factorizable and its matrix  
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>U</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                              <mi>(j,j)</mi>
                           </math>
                           
                           is zero.
                           
                        </p>
                        <p class="p">
                           The return value of <samp class="ph codeph">cusolverRfBatch_Zero_Pivot</samp> is 
                           <samp class="ph codeph">CUSOLVER_STATUS_ZERO_PIVOT</samp> if there exists one 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>j</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           which failed LU refactorization. 
                           The user can redo LU factorization to get new permutation <samp class="ph codeph">P</samp> and <samp class="ph codeph">Q</samp>
                           if error code <samp class="ph codeph">CUSOLVER_STATUS_ZERO_PIVOT</samp> is returned.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b"></strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">parameter</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">MemSpace </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">In/out </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1"><samp class="ph codeph">Meaning</samp></td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">handle</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">input </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">the handle to the cuSolverRF library.
                                       
                                    </td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="25%" rowspan="1" colspan="1"><samp class="ph codeph">position</samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">host </samp></td>
                                    <td class="entry" valign="top" width="16.666666666666664%" rowspan="1" colspan="1"><samp class="ph codeph">output </samp></td>
                                    <td class="entry" valign="top" width="41.66666666666667%" rowspan="1" colspan="1">integer array of size <samp class="ph codeph">batchSize</samp>. 
                                       The value of <samp class="ph codeph">position(j)</samp> reports singularity of matrix <samp class="ph codeph">Aj</samp>,
                                       -1 if no structural/numerical zero, <samp class="ph codeph">k &gt;= 0</samp> 
                                       if <samp class="ph codeph">Aj(k,k)</samp> is either structural zero or numerical zero. 
                                       
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><span class="desc tabledesc"><strong class="ph b">Status Returned</strong></span><tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_SUCCESS</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the operation completed successfully.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_NOT_INITIALIZED</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">the library was not initialized.</td>
                                 </tr>
                                 <tr class="row">
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1"><samp class="ph codeph">CUSOLVER_STATUS_ZERO_PIVOT</samp></td>
                                    <td class="entry" valign="top" width="50%" rowspan="1" colspan="1">a zero pivot was encountered during the computation.</td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" xml:lang="en-us" id="cuSolverRF_examples"><a name="cuSolverRF_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#cuSolverRF_examples" name="cuSolverRF_examples" shape="rect">A.&nbsp;cuSolverRF Examples</a></h2>
                  <div class="topic concept nested1" id="cuSolverRF-example1"><a name="cuSolverRF-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cuSolverRF-example1" name="cuSolverRF-example1" shape="rect">A.1.&nbsp;cuSolverRF In-memory Example</a></h3>
                     <div class="body conbody">
                        <div class="p">
                           This is an example in the C programming language of how to use the standard routines 
                           in the cuSolverRF library. We focus on solving the set of linear systems  
                           
                           
                           
                           <div class="tablenoborder">
                              <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                                 <tbody class="tbody">
                                    <tr class="row">
                                       <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <msub>
                                                <mi>A</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>i</mi>
                                                </mrow>
                                             </msub>
                                             <msub>
                                                <mi>x</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>i</mi>
                                                </mrow>
                                             </msub>
                                             <mo>=</mo>
                                             <msub>
                                                <mi>f</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                   <mi>i</mi>
                                                </mrow>
                                             </msub>
                                          </math>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           
                           
                           but we change the indexing from one- to zero-based to follow the C programming language. 
                           The example begins with the usual includes and main()
                           <pre xml:space="preserve">
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;cuda_runtime.h&gt;
#include "cusolverRf.h"

#define TEST_PASSED  0
#define TEST_FAILED  1

int main (void){
    /* matrix A */
    int n;
    int nnzA;
    int *Ap=NULL;
    int *Ai=NULL;
    double *Ax=NULL;
    int *d_Ap=NULL;
    int *d_Ai=NULL;
    double *d_rAx=NULL;
    /* matrices L and U */
    int nnzL, nnzU;
    int *Lp=NULL;
    int *Li=NULL;
    double* Lx=NULL;
    int *Up=NULL;
    int *Ui=NULL;
    double* Ux=NULL;
    /* reordering matrices */
    int *P=NULL;
    int *Q=NULL;
    int * d_P=NULL;
    int * d_Q=NULL;
    /* solution and rhs */
    int nrhs; //# of rhs for each system (currently only =1 is supported) 
    double *d_X=NULL;
    double *d_T=NULL;
    /* cuda */
    cudaError_t cudaStatus;
    /* cuolverRf */
    cusolverRfHandle_t gH=NULL;
    cusolverStatus_t status;
    /* host sparse direct solver */
    /* ... */
    /* other variables */
    int tnnzL, tnnzU;
    int *tLp=NULL;
    int *tLi=NULL;
    double *tLx=NULL;
    int *tUp=NULL;
    int *tUi=NULL;
    double *tUx=NULL;
    double t1, t2; 


</pre></div>
                        <div class="p"> Then we initialize the library.
                           <pre xml:space="preserve">


    /* ASSUMPTION: recall that we are solving a set of linear systems 
       A_{i} x_{i} = f_{i}  for i=0,...,k-1 
       where the sparsity pattern of the coefficient matrices A_{i} 
       as well as the reordering to minimize fill-in and the pivoting 
       used during the LU factorization remain the same. */
 

    /* Step 1: solve the first linear system (i=0) on the host,
               using host sparse direct solver, which involves
               full LU factorization and solve. */
    /* ... */


    /* Step 2: interface to the library by extracting the following 
               information from the first solve:
               a) triangular factors L and U
               b) pivoting and reordering permutations P and Q
               c) also, allocate all the necessary memory */
    /* ... */ 


    /* Step 3: use the library to solve subsequent (i=1,...,k-1) linear systems
    a) the  library setup (called only once) */
    //create handle
    status = cusolverRfCreate(&amp;gH);
    if (status != CUSOLVER_STATUS_SUCCESS){
        printf ("[cusolverRf status \%d]\n",status);
        return TEST_FAILED;
    }

    //set fast mode 
    status = cusolverRfSetResetValuesFastMode(gH,GLU_RESET_VALUES_FAST_MODE_ON);
    if (status != CUSOLVER_STATUS_SUCCESS){
        printf ("[cusolverRf status \%d]\n",status);
        return TEST_FAILED;
    }

</pre></div>
                        <div class="p"> Call refactorization and solve.
                           <pre xml:space="preserve">

    //assemble internal data structures (you should use the coeffcient matrix A 
    //corresponding to the second (i=1) linear system in this call) 
    t1 = cusolver_test_seconds();
    status = cusolverRfSetupHost(n, nnzA, Ap, Ai, Ax, 
                               nnzL, Lp, Li, Lx, nnzU, Up, Ui, Ux, P, Q, gH);
    cudaStatus = cudaDeviceSynchronize();
    t2 = cusolver_test_seconds();
    if ((status != CUSOLVER_STATUS_SUCCESS) || (cudaStatus != cudaSuccess)) {
        printf ("[cusolverRf status \%d]\n",status);
        return TEST_FAILED;
    }
    printf("cusolverRfSetupHost time = \%f (s)\n", t2-t1);

    //analyze available parallelism
    t1 = cusolver_test_seconds();
    status = cusolverRfAnalyze(gH);
    cudaStatus = cudaDeviceSynchronize();
    t2 = cusolver_test_seconds();
    if ((status != CUSOLVER_STATUS_SUCCESS) || (cudaStatus != cudaSuccess)) {
        printf ("[cusolverRf status \%d]\n",status);
        return TEST_FAILED;
    }
    printf("cusolverRfAnalyze time = \%f (s)\n", t2-t1);

    /* b) The  library subsequent (i=1,...,k-1) LU re-factorization 
          and solve (called multiple times). */
    for (i=1; i&lt;k; i++){ 
        //LU re-factorization
        t1 = cusolver_test_seconds();
        status = cusolverRfRefactor(gH);
        cudaStatus = cudaDeviceSynchronize();
        t2 = cusolver_test_seconds();
        if ((status != CUSOLVER_STATUS_SUCCESS) || (cudaStatus != cudaSuccess)) {
            printf ("[cusolverRF status \%d]\n",status);
            return TEST_FAILED;
        }
        printf("cuSolverReRefactor time = \%f (s)\n", t2-t1);   

        //forward and backward solve
        t1 = cusolver_test_seconds();
        status = cusolverRfSolve(gH, d_P, d_Q, nrhs, d_T, n, d_X, n);
        cudaStatus = cudaDeviceSynchronize();
        t2 = cusolver_test_seconds();
        if ((status != CUSOLVER_STATUS_SUCCESS) || (cudaStatus != cudaSuccess)) {
            printf ("[cusolverRf status \%d]\n",status);
            return TEST_FAILED;
        }
        printf("cusolverRfSolve time = \%f (s)\n", t2-t1);   

</pre></div>
                        <div class="p"> Extract the results and return.
                           <pre xml:space="preserve">
        // extract the factors (if needed)
        status = cusolverRfExtractSplitFactorsHost(gH, &amp;tnnzL, &amp;tLp, &amp;tLi, &amp;tLx, 
                                                &amp;tnnzU, &amp;tUp, &amp;tUi, &amp;tUx);
        if(status != CUSOLVER_STATUS_SUCCESS){
            printf ("[cusolverRf status \%d]\n",status);
            return TEST_FAILED;
        }  
        /*
        //print
        int row, j;
        printf("printing L\n");
        for (row=0; row&lt;n; row++){
            for (j=tLp[row]; j&lt;tLp[row+1]; j++){
                printf("\%d,\%d,\%f\n",row,tLi[j],tLx[j]); 
            } 
        }
        printf("printing U\n");
        for (row=0; row&lt;n; row++){
            for (j=tUp[row]; j&lt;tUp[row+1]; j++){
                printf("\%d,\%d,\%f\n",row,tUi[j],tUx[j]); 
            } 
        }
        */

        /* perform any other operations based on the solution */
        /* ... */

        /* check if done */
        /* ... */

        /* proceed to solve the next linear system */
        // update the coefficient matrix using reset values
        // (assuming that the new linear system, in other words,
        //  new values are already on the GPU in the array d_rAx)
        t1 = cusolver_test_seconds();
        status = cusolverRfResetValues(n,nnzA,d_Ap,d_Ai,d_rAx,d_P,d_Q,gH);
        cudaStatus = cudaDeviceSynchronize();
        t2 = cusolver_test_seconds();
        if ((status != CUSOLVER_STATUS_SUCCESS) || (cudaStatus != cudaSuccess)) {
            printf ("[cusolverRf status \%d]\n",status);
            return TEST_FAILED;
        }
        printf("cusolverRfResetValues time = \%f (s)\n", t2-t1);
    }

    /* free memory and exit */
    /* ... */
    return TEST_PASSED;
}

</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="cuSolverRFbatch-example1"><a name="cuSolverRFbatch-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#cuSolverRFbatch-example1" name="cuSolverRFbatch-example1" shape="rect">A.2.&nbsp;cuSolverRF-batch Example</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides an example in the C programming language of how to use the batched routines 
                           in the cuSolverRF library. 
                           We focus on solving the set of linear systems
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>f</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="p">
                           but we change the indexing from one- to zero-based to follow the C programming language.
                           The first part is the usual includes and main definition
                           <pre xml:space="preserve">
#include &lt;stdio.h&gt;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include "cusolverRf.h"</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#define TEST_PASSED  0</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#define TEST_FAILED  1</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>){
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* matrix A */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchSize;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzA;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *Ap=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *Ai=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//array of pointers to the values of each matrix in the batch (of size</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//batchSize) on the host</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> **Ax_array=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//For example, if Ax_batch is the array (of size batchSize*nnzA) containing </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//the values of each matrix in the batch written contiguosly one matrix  </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//after another on the host, then Ax_array[j] = &amp;Ax_batch[nnzA*j];</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//for j=0,...,batchSize-1.</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *Ax_batch=NULL; 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_Ap=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_Ai=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//array of pointers to the values of each matrix in the batch (of size</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//batchSize) on the device</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> **d_Ax_array=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//For example, if d_Ax_batch is the array (of size batchSize*nnzA) containing </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//the values of each matrix in the batch written contiguosly one matrix  </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//after another on the device, then d_Ax_array[j] = &amp;d_Ax_batch[nnzA*j];</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//for j=0,...,batchSize-1.</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_Ax_batch=NULL; 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* matrices L and U */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzL, nnzU;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *Lp=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *Li=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>* Lx=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *Up=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *Ui=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>* Ux=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* reordering matrices */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *P=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *Q=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_P=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_Q=NULL;

</pre></div>
                        <div class="p">
                           Next we initialize the data needed and the create library handles
                           <pre xml:space="preserve">
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* solution and rhs */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nrhs; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//# of rhs for each system (currently only =1 is supported) </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//temporary storage (of size 2*batchSize*n*nrhs)</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_T=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//array (of size batchSize*n*nrhs) containing the values of each rhs in </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//the batch written contiguously one rhs after another on the device</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> **d_X_array=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//array (of size batchSize*n*nrhs) containing the values of each rhs in </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//the batch written contiguously one rhs after another on the host</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> **X_array=NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* cuda */</span>
    cudaError_t cudaStatus;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* cusolverRf */</span>
    cusolverRfHandle_t gH=NULL;
    cusolverStatus_t status;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host sparse direct solver */</span>
    ...
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* other variables */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> t1, t2; 

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ASSUMPTION: 
       recall that we are solving a batch of linear systems 
       A_{j} x_{j} = f_{j}  for j=0,...,batchSize-1 
       where the sparsity pattern of the coefficient matrices A_{j} 
       as well as the reordering to minimize fill-in and the pivoting 
       used during the LU factorization remain the same. */</span>
 

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Step 1: solve the first linear system (j=0) on the host,
               using host sparse direct solver, which involves
               full LU factorization and solve. */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ... */</span>


    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Step 2: interface to the library by extracting the following 
               information from the first solve:
               a) triangular factors L and U
               b) pivoting and reordering permutations P and Q
               c) also, allocate all the necessary memory */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ... */</span>           

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Step 3: use the library to solve the remaining (j=1,...,batchSize-1) 
               linear systems.
    a) the library setup (called only once) */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//create handle</span>
    status = cusolverRfcreate(&amp;gH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (status != CUSOLVER_STATUS_SUCCESS){
        printf (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"[cusolverRf status %d]\n"</span>,status);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> TEST_FAILED;
    }

</pre></div>
                        <div class="p">
                           We call the batch solve method and return.
                           <pre xml:space="preserve">

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//assemble internal data structures </span>
    t1 = cusolver_test_seconds();
    status = cusolverRfBatchSetupHost(batchSize, n, nnzA, Ap, Ai, Ax_array, 
                                    nnzL, Lp, Li, Lx, nnzU, Up, Ui, Ux, P, Q, gH);
    cudaStatus = cudaDeviceSynchronize();
    t2 = cusolver_test_seconds();
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ((status != CUSOLVER_STATUS_SUCCESS) || (cudaStatus != cudaSuccess)) {
        printf (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"[cusolverRf status %d]\n"</span>,status);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> TEST_FAILED;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cusolverRfBatchSetupHost time = %f (s)\n"</span>, t2-t1);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//analyze available parallelism</span>
    t1 = cusolver_test_seconds();
    status = cusolverRfBatchAnalyze(gH);
    cudaStatus = cudaDeviceSynchronize();
    t2 = cusolver_test_seconds();
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ((status != CUSOLVER_STATUS_SUCCESS) || (cudaStatus != cudaSuccess)) {
        printf (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"[cusolverRf status %d]\n"</span>,status);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> TEST_FAILED;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cusolverRfBatchAnalyze time = %f (s)\n"</span>, t2-t1);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* b) The library subsequent (j=1,...,batchSize-1) LU re-factorization 
          and solve (may be called multiple times). For the subsequent batches
          the values can be reset using cusolverRfBatch_reset_values_routine. */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//LU re-factorization</span>
    t1 = cusolver_test_seconds();
    status = cusolverRfBatchRefactor(gH);
    cudaStatus = cudaDeviceSynchronize();
    t2 = cusolver_test_seconds();
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ((status != CUSOLVER_STATUS_SUCCESS) || (cudaStatus != cudaSuccess)) {
        printf (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"[cusolverRf status %d]\n"</span>,status);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> TEST_FAILED;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cusolverRfBatchRefactor time = %f (s)\n"</span>, t2-t1);   

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//forward and backward solve</span>
    t1 = cusolver_test_seconds();
    status = cusolverRfBatchSolve(gH, d_P, d_Q, nrhs, d_T, n, d_X_array, n);
    cudaStatus = cudaDeviceSynchronize();
    t2 = cusolver_test_seconds();
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ((status != CUSOLVER_STATUS_SUCCESS) || (cudaStatus != cudaSuccess)) {
        printf (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"[cusolverRf status %d]\n"</span>,status);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> TEST_FAILED;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"cusolverRfBatchSolve time = %f (s)\n"</span>, t2-t1);   
    
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free memory and exit */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ... */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> TEST_PASSED;
}

</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" xml:lang="en-us" id="csrqr_batch_examples"><a name="csrqr_batch_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#csrqr_batch_examples" name="csrqr_batch_examples" shape="rect">B.&nbsp;CSR QR Batch Examples</a></h2>
                  <div class="topic concept nested1" id="csrqrbatch-example1"><a name="csrqrbatch-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#csrqrbatch-example1" name="csrqrbatch-example1" shape="rect">B.1.&nbsp;Batched Sparse QR example 1</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to use batched sparse QR to solver a set of linear systems
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <msub>
                                             <mi>x</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>b</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>i</mi>
                                             </mrow>
                                          </msub>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           All matrices 
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>A</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>i</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           are small perturbations of 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.1</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.1</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.1</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           All right-hand side vectors
                           
                           
                           <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <msub>
                                 <mi>b</mi>
                                 <mrow class="MJX-TeXAtom-ORD">
                                    <mi>i</mi>
                                 </mrow>
                              </msub>
                           </math>
                           
                           are small perturbation of the Matlab vector 'ones(4,1)'.
                           
                        </p>
                        <p class="p">
                           We assume device memory is big enough to compute all matrices in one pass.
                           
                        </p>
                        <div class="p">
                           The usual includes and main definition
                           <pre xml:space="preserve">
#include &lt;stdio.h&gt;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverSp.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime_api.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverSpHandle_t cusolverH = NULL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// GPU does batch QR</span>
    csrqrInfo_t info = NULL;
    cusparseMatDescr_t descrA = NULL;

    cusparseStatus_t cusparse_status = CUSPARSE_STATUS_SUCCESS;
    cusolverStatus_t cusolver_status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    cudaError_t cudaStat5 = cudaSuccess;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// GPU does batch QR</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// d_A is CSR format, d_csrValA is of size nnzA*batchSize</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// d_x is a matrix of size batchSize * m</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// d_b is a matrix of size batchSize * m</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrRowPtrA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrColIndA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_csrValA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_b = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// batchSize * m</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_x = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// batchSize * m</span>

    size_t size_qr = 0;
    size_t size_internal = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *buffer_qr = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// working space for numerical factorization</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*      | 1                |
 *  A = |       2          |
 *      |            3     |
 *      | 0.1  0.1  0.1  4 |
 *  CSR of A is based-1
 *
 *  b = [1 1 1 1]
 */</span> 

</pre></div>
                        <div class="p">
                           Set up the library handle and data
                           <pre xml:space="preserve">
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 4 ;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzA = 7;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> csrRowPtrA[m+1]  = { 1, 2, 3, 4, 8};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> csrColIndA[nnzA] = { 1, 2, 3, 1, 2, 3, 4};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> csrValA[nnzA] = { 1.0, 2.0, 3.0, 0.1, 0.1, 0.1, 4.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> b[m] = {1.0, 1.0, 1.0, 1.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchSize = 17;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *csrValABatch = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*)malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*nnzA*batchSize);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *bBatch       = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*)malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m*batchSize);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *xBatch       = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*)malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m*batchSize);
    assert( NULL != csrValABatch );
    assert( NULL != bBatch );
    assert( NULL != xBatch );

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: prepare Aj and bj on host</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//  Aj is a small perturbation of A</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//  bj is a small perturbation of b</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//  csrValABatch = [A0, A1, A2, ...]</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//  bBatch = [b0, b1, b2, ...]</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> colidx = 0 ; colidx &lt; nnzA ; colidx++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = csrValA[colidx];
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span> (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchId = 0 ; batchId &lt; batchSize ; batchId++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> eps = ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)((rand() % 100) + 1)) * 1.e-4;
            csrValABatch[batchId*nnzA + colidx] = Areg + eps;
        }  
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; m ; j++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> breg = b[j];
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span> (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchId = 0 ; batchId &lt; batchSize ; batchId++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> eps = ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)((rand() % 100) + 1)) * 1.e-4;
            bBatch[batchId*m + j] = breg + eps;
        }  
    }

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: create cusolver handle, qr info and matrix descriptor</span>
    cusolver_status = cusolverSpCreate(&amp;cusolverH);
    assert (cusolver_status == CUSOLVER_STATUS_SUCCESS);

    cusparse_status = cusparseCreateMatDescr(&amp;descrA); 
    assert(cusparse_status == CUSPARSE_STATUS_SUCCESS);

    cusparseSetMatType(descrA, CUSPARSE_MATRIX_TYPE_GENERAL);
    cusparseSetMatIndexBase(descrA, CUSPARSE_INDEX_BASE_ONE); <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// base-1</span>

    cusolver_status = cusolverSpCreateCsrqrInfo(&amp;info);
    assert(cusolver_status == CUSOLVER_STATUS_SUCCESS);

</pre></div>
                        <div class="p">
                           Call the solver
                           <pre xml:space="preserve">

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: copy Aj and bj to device</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrValA   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * nnzA * batchSize);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * nnzA);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrRowPtrA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * (m+1));
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_b         , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m * batchSize);
    cudaStat5 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_x         , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m * batchSize);
    assert(cudaStat1 == cudaSuccess);
    assert(cudaStat2 == cudaSuccess);
    assert(cudaStat3 == cudaSuccess);
    assert(cudaStat4 == cudaSuccess);
    assert(cudaStat5 == cudaSuccess);

    cudaStat1 = cudaMemcpy(d_csrValA   , csrValABatch, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * nnzA * batchSize, cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(d_csrColIndA, csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * nnzA, cudaMemcpyHostToDevice);
    cudaStat3 = cudaMemcpy(d_csrRowPtrA, csrRowPtrA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * (m+1), cudaMemcpyHostToDevice);
    cudaStat4 = cudaMemcpy(d_b, bBatch, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m * batchSize, cudaMemcpyHostToDevice);
    assert(cudaStat1 == cudaSuccess);
    assert(cudaStat2 == cudaSuccess);
    assert(cudaStat3 == cudaSuccess);
    assert(cudaStat4 == cudaSuccess);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: symbolic analysis</span>
    cusolver_status = cusolverSpXcsrqrAnalysisBatched(
        cusolverH, m, m, nnzA,
        descrA, d_csrRowPtrA, d_csrColIndA,
        info);
    assert(cusolver_status == CUSOLVER_STATUS_SUCCESS);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: prepare working space</span>
    cusolver_status = cusolverSpDcsrqrBufferInfoBatched(
         cusolverH, m, m, nnzA,
         descrA, d_csrValA, d_csrRowPtrA, d_csrColIndA,
         batchSize,
         info,
         &amp;size_internal,
         &amp;size_qr);
    assert(cusolver_status == CUSOLVER_STATUS_SUCCESS);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"numerical factorization needs internal data %lld bytes\n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span>)size_internal);      
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"numerical factorization needs working space %lld bytes\n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span>)size_qr);      

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;buffer_qr, size_qr);
    assert(cudaStat1 == cudaSuccess);

</pre></div>
                        <div class="p">
                           Get results back
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: numerical factorization</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// assume device memory is big enough to compute all matrices.</span>
    cusolver_status = cusolverSpDcsrqrsvBatched(
        cusolverH, m, m, nnzA,
        descrA, d_csrValA, d_csrRowPtrA, d_csrColIndA,
        d_b, d_x,
        batchSize,
        info,
        buffer_qr);
    assert(cusolver_status == CUSOLVER_STATUS_SUCCESS);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 7: check residual </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// xBatch = [x0, x1, x2, ...]</span>
    cudaStat1 = cudaMemcpy(xBatch, d_x, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m*batchSize, cudaMemcpyDeviceToHost);
    assert(cudaStat1 == cudaSuccess);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> baseA = (CUSPARSE_INDEX_BASE_ONE == cusparseGetMatIndexBase(descrA))? 1:0 ;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchId = 0 ; batchId &lt; batchSize; batchId++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// measure |bj - Aj*xj|</span>
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *csrValAj = csrValABatch + batchId * nnzA;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *xj = xBatch + batchId * m;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *bj = bBatch + batchId * m;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// sup| bj - Aj*xj|</span>
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> sup_res = 0;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> start = csrRowPtrA[row ] - baseA;
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> end   = csrRowPtrA[row+1] - baseA;
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Ax = 0.0; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Aj(row,:)*xj</span>
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> colidx = start ; colidx &lt; end ; colidx++){
                <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = csrColIndA[colidx] - baseA;
                <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = csrValAj[colidx];
                <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> xreg = xj[col];
                Ax = Ax + Areg * xreg;
            }
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> r = bj[row] - Ax;
            sup_res = (sup_res &gt; fabs(r))? sup_res : fabs(r);
        }
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"batchId %d: sup|bj - Aj*xj| = %E \n"</span>, batchId, sup_res);
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchId = 0 ; batchId &lt; batchSize; batchId++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *xj = xBatch + batchId * m;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"x%d[%d] = %E\n"</span>, batchId, row, xj[row]);
        } 
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"\n"</span>);
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}

</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="csrqrbatch-example2"><a name="csrqrbatch-example2" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#csrqrbatch-example2" name="csrqrbatch-example2" shape="rect">B.2.&nbsp;Batched Sparse QR example 2</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This is the same as example 1 in appendix C except that 
                           we assume device memory is not enough, so we need to cut 17 matrices into
                           several chunks and compute each chunk by batched sparse QR.
                           
                        </p>
                        <div class="p">
                           The usual includes and main definitions
                           <pre xml:space="preserve">
#include &lt;stdio.h&gt;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverSp.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime_api.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#define imin( x, y ) ((x)&lt;(y))? (x) : (y) </span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverSpHandle_t cusolverH = NULL;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// GPU does batch QR</span>
    csrqrInfo_t info = NULL;
    cusparseMatDescr_t descrA = NULL;

    cusparseStatus_t cusparse_status = CUSPARSE_STATUS_SUCCESS;
    cusolverStatus_t cusolver_status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    cudaError_t cudaStat5 = cudaSuccess;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// GPU does batch QR</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// d_A is CSR format, d_csrValA is of size nnzA*batchSize</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// d_x is a matrix of size batchSize * m</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// d_b is a matrix of size batchSize * m</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrRowPtrA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_csrColIndA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_csrValA = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_b = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// batchSize * m</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_x = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// batchSize * m</span>

    size_t size_qr = 0;
    size_t size_internal = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> *buffer_qr = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// working space for numerical factorization</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*      | 1                |
 *  A = |       2          |
 *      |            3     |
 *      | 0.1  0.1  0.1  4 |
 *  CSR of A is based-1
 *
 *  b = [1 1 1 1]
 */</span> 

</pre></div>
                        <div class="p">
                           Create the library handle
                           <pre xml:space="preserve">
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 4 ;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nnzA = 7;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> csrRowPtrA[m+1]  = { 1, 2, 3, 4, 8};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> csrColIndA[nnzA] = { 1, 2, 3, 1, 2, 3, 4};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> csrValA[nnzA] = { 1.0, 2.0, 3.0, 0.1, 0.1, 0.1, 4.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> b[m] = {1.0, 1.0, 1.0, 1.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchSize = 17;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *csrValABatch = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*)malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*nnzA*batchSize);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *bBatch       = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*)malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m*batchSize);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *xBatch       = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*)malloc(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m*batchSize);
    assert( NULL != csrValABatch );
    assert( NULL != bBatch );
    assert( NULL != xBatch );

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: prepare Aj and bj on host</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//  Aj is a small perturbation of A</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//  bj is a small perturbation of b</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//  csrValABatch = [A0, A1, A2, ...]</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//  bBatch = [b0, b1, b2, ...]</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> colidx = 0 ; colidx &lt; nnzA ; colidx++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = csrValA[colidx];
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span> (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchId = 0 ; batchId &lt; batchSize ; batchId++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> eps = ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)((rand() % 100) + 1)) * 1.e-4;
            csrValABatch[batchId*nnzA + colidx] = Areg + eps;
        }  
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; m ; j++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> breg = b[j];
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span> (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchId = 0 ; batchId &lt; batchSize ; batchId++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> eps = ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)((rand() % 100) + 1)) * 1.e-4;
            bBatch[batchId*m + j] = breg + eps;
        }  
    }

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: create cusolver handle, qr info and matrix descriptor</span>
    cusolver_status = cusolverSpCreate(&amp;cusolverH);
    assert (cusolver_status == CUSOLVER_STATUS_SUCCESS);

    cusparse_status = cusparseCreateMatDescr(&amp;descrA); 
    assert(cusparse_status == CUSPARSE_STATUS_SUCCESS);

    cusparseSetMatType(descrA, CUSPARSE_MATRIX_TYPE_GENERAL);
    cusparseSetMatIndexBase(descrA, CUSPARSE_INDEX_BASE_ONE); <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// base-1</span>

    cusolver_status = cusolverSpCreateCsrqrInfo(&amp;info);
    assert(cusolver_status == CUSOLVER_STATUS_SUCCESS);

</pre></div>
                        <div class="p">
                           Set up the data
                           <pre xml:space="preserve">

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: copy Aj and bj to device</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrValA   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * nnzA * batchSize);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * nnzA);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_csrRowPtrA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * (m+1));
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_b         , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m * batchSize);
    cudaStat5 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_x         , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m * batchSize);
    assert(cudaStat1 == cudaSuccess);
    assert(cudaStat2 == cudaSuccess);
    assert(cudaStat3 == cudaSuccess);
    assert(cudaStat4 == cudaSuccess);
    assert(cudaStat5 == cudaSuccess);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// don't copy csrValABatch and bBatch because device memory may be big enough</span>
    cudaStat1 = cudaMemcpy(d_csrColIndA, csrColIndA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * nnzA, cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(d_csrRowPtrA, csrRowPtrA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * (m+1), cudaMemcpyHostToDevice);
    assert(cudaStat1 == cudaSuccess);
    assert(cudaStat2 == cudaSuccess);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: symbolic analysis</span>
    cusolver_status = cusolverSpXcsrqrAnalysisBatched(
        cusolverH, m, m, nnzA,
        descrA, d_csrRowPtrA, d_csrColIndA,
        info);
    assert(cusolver_status == CUSOLVER_STATUS_SUCCESS);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: find "proper" batchSize</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// get available device memory</span>
    size_t free_mem = 0;
    size_t total_mem = 0;
    cudaStat1 = cudaMemGetInfo( &amp;free_mem, &amp;total_mem );
    assert( cudaSuccess == cudaStat1 );

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchSizeMax = 2;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">while</span>(batchSizeMax &lt; batchSize){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"batchSizeMax = %d\n"</span>, batchSizeMax);
        cusolver_status = cusolverSpDcsrqrBufferInfoBatched(
            cusolverH, m, m, nnzA,
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// d_csrValA is don't care </span>
            descrA, d_csrValA, d_csrRowPtrA, d_csrColIndA,
            batchSizeMax, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// WARNING: use batchSizeMax</span>
            info,
            &amp;size_internal,
            &amp;size_qr);
        assert(cusolver_status == CUSOLVER_STATUS_SUCCESS);

        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( (size_internal + size_qr) &gt; free_mem ){ 
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// current batchSizeMax exceeds hardware limit, so cut it by half. </span>
            batchSizeMax /= 2; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">break</span>; 
        } 
        batchSizeMax *= 2; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// double batchSizMax and try it again. </span>
    }
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// correct batchSizeMax such that it is not greater than batchSize. </span>
    batchSizeMax = imin(batchSizeMax, batchSize);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"batchSizeMax = %d\n"</span>, batchSizeMax);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Assume device memory is not big enough, and batchSizeMax = 2</span>
    batchSizeMax = 2;

</pre></div>
                        <div class="p">
                           Perform analysis and call solve
                           <pre xml:space="preserve">

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: prepare working space</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// [necessary]</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Need to call cusolverDcsrqrBufferInfoBatched again with batchSizeMax</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// to fix batchSize used in numerical factorization.</span>
    cusolver_status = cusolverSpDcsrqrBufferInfoBatched(
         cusolverH, m, m, nnzA,
         <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// d_csrValA is don't care </span>
         descrA, d_csrValA, d_csrRowPtrA, d_csrColIndA,
         batchSizeMax, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// WARNING: use batchSizeMax</span>
         info,
         &amp;size_internal,
         &amp;size_qr);
    assert(cusolver_status == CUSOLVER_STATUS_SUCCESS);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"numerical factorization needs internal data %lld bytes\n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span>)size_internal);      
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"numerical factorization needs working space %lld bytes\n"</span>, (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span>)size_qr);      

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;buffer_qr, size_qr);
    assert(cudaStat1 == cudaSuccess);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 7: solve Aj*xj = bj</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> idx = 0 ; idx &lt; batchSize; idx += batchSizeMax){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// current batchSize 'cur_batchSize' is the batchSize used in numerical factorization</span>
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> cur_batchSize = imin(batchSizeMax, batchSize - idx);
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"current batchSize = %d\n"</span>, cur_batchSize);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// copy part of Aj and bj to device</span>
        cudaStat1 = cudaMemcpy(d_csrValA, csrValABatch + idx*nnzA, 
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * nnzA * cur_batchSize, cudaMemcpyHostToDevice);
        cudaStat2 = cudaMemcpy(d_b, bBatch + idx*m, 
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m * cur_batchSize, cudaMemcpyHostToDevice);
        assert(cudaStat1 == cudaSuccess);
        assert(cudaStat2 == cudaSuccess);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// solve part of Aj*xj = bj </span>
        cusolver_status = cusolverSpDcsrqrsvBatched(
            cusolverH, m, m, nnzA,
            descrA, d_csrValA, d_csrRowPtrA, d_csrColIndA,
            d_b, d_x,
            cur_batchSize, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// WARNING: use current batchSize</span>
            info,
            buffer_qr);
        assert(cusolver_status == CUSOLVER_STATUS_SUCCESS);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// copy part of xj back to host</span>
        cudaStat1 = cudaMemcpy(xBatch + idx*m, d_x, 
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m * cur_batchSize, cudaMemcpyDeviceToHost);
        assert(cudaStat1 == cudaSuccess);
    }


</pre></div>
                        <div class="p">
                           Check results 
                           <pre xml:space="preserve">

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 7: check residual </span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// xBatch = [x0, x1, x2, ...]</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> baseA = (CUSPARSE_INDEX_BASE_ONE == cusparseGetMatIndexBase(descrA))? 1:0 ;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchId = 0 ; batchId &lt; batchSize; batchId++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// measure |bj - Aj*xj|</span>
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *csrValAj = csrValABatch + batchId * nnzA;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *xj = xBatch + batchId * m;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *bj = bBatch + batchId * m;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// sup| bj - Aj*xj|</span>
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> sup_res = 0;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> start = csrRowPtrA[row ] - baseA;
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> end   = csrRowPtrA[row+1] - baseA;
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Ax = 0.0; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Aj(row,:)*xj</span>
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> colidx = start ; colidx &lt; end ; colidx++){
                <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = csrColIndA[colidx] - baseA;
                <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = csrValAj[colidx];
                <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> xreg = xj[col];
                Ax = Ax + Areg * xreg;
            }
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> r = bj[row] - Ax;
            sup_res = (sup_res &gt; fabs(r))? sup_res : fabs(r);
        }
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"batchId %d: sup|bj - Aj*xj| = %E \n"</span>, batchId, sup_res);
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchId = 0 ; batchId &lt; batchSize; batchId++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *xj = xBatch + batchId * m;
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"x%d[%d] = %E\n"</span>, batchId, row, xj[row]);
        } 
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"\n"</span>);
    }

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}

</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" xml:lang="en-us" id="qr_examples"><a name="qr_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#qr_examples" name="qr_examples" shape="rect">C.&nbsp;QR Examples</a></h2>
                  <div class="topic concept nested1" id="ormqr-example1"><a name="ormqr-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#ormqr-example1" name="ormqr-example1" shape="rect">C.1.&nbsp;QR Factorization Dense Linear Solver</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to use a dense QR factorization to solve a linear system
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>b</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           A is a 3x3 dense matrix, nonsingular. 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>6.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The following code uses three steps:
                           
                        </p>
                        <p class="p">
                           Step 1:  A = Q*R by geqrf.  
                           
                        </p>
                        <p class="p">
                           Step 2:  B := Q^T*B by ormqr.  
                           
                        </p>
                        <p class="p">
                           Step 3: solve R*X = B by trsm.
                           
                        </p>
                        <div class="p">
                           The usual includes and main definition
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include ormqr_example.cpp 
 *   nvcc -o -fopenmp a.out ormqr_example.o -L/usr/local/cuda/lib64 -lcudart -lcublas -lcusolver
 *
 */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cublas_v2.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>


<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}


<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cublasHandle_t cublasH = NULL;
    cublasStatus_t cublas_status = CUBLAS_STATUS_SUCCESS;
    cusolverStatus_t cusolver_status = CUSOLVER_STATUS_SUCCESS;    
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldb = m;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nrhs = 1; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of right hand side vectors</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*       | 1 2 3 |
 *   A = | 4 5 6 |
 *       | 2 1 1 |
 *
 *   x = (1 1 1)'
 *   b = (6 15 4)'
 */</span>

</pre></div>
                        <div class="p">
                           Create the library handle and load the data
                           <pre xml:space="preserve"> 

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*m] = { 1.0, 4.0, 2.0, 2.0, 5.0, 1.0, 3.0, 6.0, 1.0}; 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">//    double X[ldb*nrhs] = { 1.0, 1.0, 1.0}; // exact solution</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> B[ldb*nrhs] = { 6.0, 15.0, 4.0}; 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> XC[ldb*nrhs]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// solution matrix from GPU</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// linear memory of GPU  </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_tau = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// linear memory of GPU </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_B  = NULL; 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *devInfo = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// info in gpu (device copy)</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  lwork = 0; 

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info_gpu = 0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> one = 1;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A = (matlab base-1)\n"</span>);
    printMatrix(m, m, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"B = (matlab base-1)\n"</span>);
    printMatrix(m, nrhs, B, ldb, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"B"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create cusolver/cublas handle</span>
    cusolver_status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);

    cublas_status = cublasCreate(&amp;cublasH);
    assert(CUBLAS_STATUS_SUCCESS == cublas_status);
    
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: copy A and B to device</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_tau, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_B  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * ldb * nrhs);
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>));
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m   , cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(d_B, B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * ldb * nrhs, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

</pre></div>
                        <div class="p">
                           Call the solver 
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query working space of geqrf and ormqr</span>
    cusolver_status = cusolverDnDgeqrf_bufferSize(
        cusolverH, 
        m, 
        m, 
        d_A, 
        lda, 
        &amp;lwork);
    assert (cusolver_status == CUSOLVER_STATUS_SUCCESS);
 
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: compute QR factorization</span>
    cusolver_status = cusolverDnDgeqrf(
        cusolverH, 
        m, 
        m, 
        d_A, 
        lda, 
        d_tau, 
        d_work, 
        lwork, 
        devInfo);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);
    assert(cudaSuccess == cudaStat1);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// check if QR is good or not</span>
    cudaStat1 = cudaMemcpy(&amp;info_gpu, devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"after geqrf: info_gpu = %d\n"</span>, info_gpu);
    assert(0 == info_gpu);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: compute Q^T*B</span>
    cusolver_status= cusolverDnDormqr(
        cusolverH, 
        CUBLAS_SIDE_LEFT, 
        CUBLAS_OP_T,
        m, 
        nrhs, 
        m, 
        d_A, 
        lda,
        d_tau,
        d_B,
        ldb,
        d_work,
        lwork,
        devInfo);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);
    assert(cudaSuccess == cudaStat1);

</pre></div>
                        <div class="p">
                           Check the results
                           <pre xml:space="preserve"> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// check if QR is good or not</span>
    cudaStat1 = cudaMemcpy(&amp;info_gpu, devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"after ormqr: info_gpu = %d\n"</span>, info_gpu);
    assert(0 == info_gpu);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: compute x = R \ Q^T*B</span>

    cublas_status = cublasDtrsm(
         cublasH,
         CUBLAS_SIDE_LEFT,
         CUBLAS_FILL_MODE_UPPER,
         CUBLAS_OP_N, 
         CUBLAS_DIAG_NON_UNIT,
         m,
         nrhs,
         &amp;one,
         d_A,
         lda,
         d_B,
         ldb);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUBLAS_STATUS_SUCCESS == cublas_status);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(XC, d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*ldb*nrhs, cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"X = (matlab base-1)\n"</span>);
    printMatrix(m, nrhs, XC, ldb, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"X"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// free resources</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_tau  ) cudaFree(d_tau);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_B    ) cudaFree(d_B);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (devInfo) cudaFree(devInfo);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);


    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cublasH ) cublasDestroy(cublasH);   
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH) cusolverDnDestroy(cusolverH);   

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}

</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="orgqr-example1"><a name="orgqr-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#orgqr-example1" name="orgqr-example1" shape="rect">C.2.&nbsp;orthogonalization</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to do orthgonalization by QR factorization.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mo>=</mo>
                                          <mi>Q</mi>
                                          <mo>*</mo>
                                          <mi>R</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           A is a 3x2 dense matrix,
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The following code uses three steps:
                           
                        </p>
                        <p class="p">
                           Step 1:  A = Q*R by geqrf.  
                           
                        </p>
                        <p class="p">
                           Step 2:  form Q by orgqr.  
                           
                        </p>
                        <p class="p">
                           Step 3: check if Q is unitary or not.
                           
                        </p>
                        <div class="p">
                           The usual includes and main definition
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include orgqr_example.cpp 
 *   g++ -fopenmp -o a.out orgqr_example.o -L/usr/local/cuda/lib64 -lcudart -lcublas -lcusolver
 *  
 */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;string.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cublas_v2.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cublasHandle_t cublasH = NULL;
    cublasStatus_t cublas_status = CUBLAS_STATUS_SUCCESS;
    cusolverStatus_t cusolver_status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 2;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*       | 1 2  |
 *   A = | 4 5  |
 *       | 2 1  |
 */</span>


</pre></div>
                        <div class="p">
                           Create the library handle and load the data
                           <pre xml:space="preserve"> 

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*n] = { 1.0, 4.0, 2.0, 2.0, 5.0, 1.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Q[lda*n]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// orthonormal columns</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> R[n*n]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// R = I - Q**T*Q </span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_tau = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *devInfo = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_R = NULL;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lwork_geqrf = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lwork_orgqr = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lwork = 0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info_gpu = 0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> h_one = 1;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> h_minus_one = -1;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A = (matlab base-1)\n"</span>);
    printMatrix(m, n, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create cusolverDn/cublas handle</span>
    cusolver_status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);

    cublas_status = cublasCreate(&amp;cublasH);
    assert(CUBLAS_STATUS_SUCCESS == cublas_status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: copy A and B to device</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_tau, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*n);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>));
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_R  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*n*n);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);


</pre></div>
                        <div class="p">
                           Call the solver 
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query working space of geqrf and orgqr</span>
    cusolver_status = cusolverDnDgeqrf_bufferSize(
        cusolverH,
        m,
        n,
        d_A,
        lda,
        &amp;lwork_geqrf);
    assert (cusolver_status == CUSOLVER_STATUS_SUCCESS);
    cusolver_status = cusolverDnDorgqr_bufferSize(
        cusolverH,
        m,
        n,
        n,
        d_A,
        lda,
        &amp;lwork_orgqr);
    assert (cusolver_status == CUSOLVER_STATUS_SUCCESS);
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// lwork = max(lwork_geqrf, lwork_orgqr)</span>
    lwork = (lwork_geqrf &gt; lwork_orgqr)? lwork_geqrf : lwork_orgqr;

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: compute QR factorization</span>
    cusolver_status = cusolverDnDgeqrf(
        cusolverH,
        m,
        n,
        d_A,
        lda,
        d_tau,
        d_work,
        lwork,
        devInfo);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);
    assert(cudaSuccess == cudaStat1);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// check if QR is successful or not</span>
    cudaStat1 = cudaMemcpy(&amp;info_gpu, devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"after geqrf: info_gpu = %d\n"</span>, info_gpu);
    assert(0 == info_gpu);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: compute Q</span>
    cusolver_status= cusolverDnDorgqr(
        cusolverH,
        m,
        n,
        n,
        d_A,
        lda,
        d_tau,
        d_work,
        lwork,
        devInfo);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);
    assert(cudaSuccess == cudaStat1);


</pre></div>
                        <div class="p">
                           Check the results
                           <pre xml:space="preserve"> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// check if QR is good or not</span>
    cudaStat1 = cudaMemcpy(&amp;info_gpu, devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"after orgqr: info_gpu = %d\n"</span>, info_gpu);
    assert(0 == info_gpu);

    cudaStat1 = cudaMemcpy(Q, d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n, cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Q = (matlab base-1)\n"</span>);
    printMatrix(m, n, Q, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Q"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: measure R = I - Q**T*Q</span>
    memset(R, 0, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*n*n);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; n ; j++){
        R[j + n*j] = 1.0; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// R(j,j)=1</span>
    }

    cudaStat1 = cudaMemcpy(d_R, R, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*n*n, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// R = -Q**T*Q + I</span>
    cublas_status = cublasDgemm_v2(
        cublasH,
        CUBLAS_OP_T, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Q**T</span>
        CUBLAS_OP_N, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Q</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of rows of R</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of columns of R</span>
        m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of columns of Q**T </span>
        &amp;h_minus_one, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host pointer */</span>
        d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Q**T</span>
        lda,
        d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// Q</span>
        lda,
        &amp;h_one, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* hostpointer */</span>
        d_R,
        n);
    assert(CUBLAS_STATUS_SUCCESS == cublas_status);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> dR_nrm2 = 0.0;
    cublas_status = cublasDnrm2_v2(
        cublasH, n*n, d_R, 1, &amp;dR_nrm2);
    assert(CUBLAS_STATUS_SUCCESS == cublas_status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|I - Q**T*Q| = %E\n"</span>, dR_nrm2);


</pre></div>
                        <div class="p">
                           free resources
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// free resources</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_tau  ) cudaFree(d_tau);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (devInfo) cudaFree(devInfo);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_R    ) cudaFree(d_R);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cublasH ) cublasDestroy(cublasH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH) cusolverDnDestroy(cusolverH);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}



</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" xml:lang="en-us" id="lu_examples"><a name="lu_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#lu_examples" name="lu_examples" shape="rect">D.&nbsp;LU Examples</a></h2>
                  <div class="topic concept nested1" id="getrf-example1"><a name="getrf-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#getrf-example1" name="getrf-example1" shape="rect">D.1.&nbsp;LU Factorization</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to use a dense LU factorization to solve a linear system
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>b</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           A is a 3x3 dense matrix, nonsingular. 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>6.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>7.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>8.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>10.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The code uses getrf to do LU factorization and getrs to do backward and forward solve.
                           The parameter pivot_on decides whether partial pivoting is performed or not.   
                           
                        </p>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include getrf_example.cpp 
 *   g++ -fopenmp -o a.out getrf_example.o -L/usr/local/cuda/lib64 -lcusolver -lcudart
 */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cudaStream_t stream = NULL;

    cusolverStatus_t status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldb = m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*       | 1 2 3  |
 *   A = | 4 5 6  |
 *       | 7 8 10 |
 *
 * without pivoting: A = L*U
 *       | 1 0 0 |      | 1  2  3 |
 *   L = | 4 1 0 |, U = | 0 -3 -6 |
 *       | 7 2 1 |      | 0  0  1 |
 *  
 * with pivoting: P*A = L*U
 *       | 0 0 1 |
 *   P = | 1 0 0 |
 *       | 0 1 0 |
 *
 *       | 1       0     0 |      | 7  8       10     |
 *   L = | 0.1429  1     0 |, U = | 0  0.8571  1.5714 |
 *       | 0.5714  0.5   1 |      | 0  0       -0.5   |
 */</span>


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*m] = { 1.0, 4.0, 7.0, 2.0, 5.0, 8.0, 3.0, 6.0, 10.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> B[m] = { 1.0, 2.0, 3.0 };
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> X[m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* X = A\B */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> LU[lda*m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* L and U */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> Ipiv[m];      <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host copy of pivoting sequence */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info = 0;     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host copy of error info */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device copy of A */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_B = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device copy of B */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_Ipiv = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* pivoting sequence */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_info = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* error info */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  lwork = 0;     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* size of workspace */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device workspace for getrf */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> pivot_on = 0;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of getrf \n"</span>);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (pivot_on){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"pivot is on : compute P*A = L*U \n"</span>);
    }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"pivot is off: compute A = L*U (not numerically stable)\n"</span>);
    }

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A = (matlab base-1)\n"</span>);
    printMatrix(m, m, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"B = (matlab base-1)\n"</span>);
    printMatrix(m, 1, B, ldb, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"B"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusolver handle, bind a stream */</span>
    status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusolverDnSetStream(cusolverH, stream);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: copy A to device */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_Ipiv, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * m);
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>));
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m, cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(d_B, B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: query working space of getrf */</span>
    status = cusolverDnDgetrf_bufferSize(
        cusolverH,
        m,
        m,
        d_A,
        lda,
        &amp;lwork);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: LU factorization */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (pivot_on){
        status = cusolverDnDgetrf(
            cusolverH,
            m,
            m,
            d_A,
            lda,
            d_work,
            d_Ipiv,
            d_info);
    }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
        status = cusolverDnDgetrf(
            cusolverH,
            m,
            m,
            d_A,
            lda,
            d_work,
            NULL,
            d_info);
    }
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == status);
    assert(cudaSuccess == cudaStat1);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (pivot_on){
    cudaStat1 = cudaMemcpy(Ipiv , d_Ipiv, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*m, cudaMemcpyDeviceToHost);
    }
    cudaStat2 = cudaMemcpy(LU   , d_A   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m, cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(&amp;info, d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 &gt; info ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%d-th parameter is wrong \n"</span>, -info);
        exit(1);
    }
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (pivot_on){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"pivoting sequence, matlab base-1\n"</span>);
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; m ; j++){
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Ipiv(%d) = %d\n"</span>, j+1, Ipiv[j]);
        }
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"L and U = (matlab base-1)\n"</span>);
    printMatrix(m, m, LU, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"LU"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * step 5: solve A*X = B 
 *       | 1 |       | -0.3333 |
 *   B = | 2 |,  X = |  0.6667 |
 *       | 3 |       |  0      |
 *
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (pivot_on){
        status = cusolverDnDgetrs(
            cusolverH,
            CUBLAS_OP_N,
            m,
            1, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* nrhs */</span>
            d_A,
            lda,
            d_Ipiv,
            d_B,
            ldb,
            d_info);
    }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
        status = cusolverDnDgetrs(
            cusolverH,
            CUBLAS_OP_N,
            m,
            1, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* nrhs */</span>
            d_A,
            lda,
            NULL,
            d_B,
            ldb,
            d_info);
    }
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == status);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(X , d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m, cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"X = (matlab base-1)\n"</span>);
    printMatrix(m, 1, X, ldb, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"X"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_B    ) cudaFree(d_B);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_Ipiv ) cudaFree(d_Ipiv);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_info ) cudaFree(d_info);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH   ) cusolverDnDestroy(cusolverH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream      ) cudaStreamDestroy(stream);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}

</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" xml:lang="en-us" id="chol_examples"><a name="chol_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#chol_examples" name="chol_examples" shape="rect">E.&nbsp;Cholesky Examples</a></h2>
                  <div class="topic concept nested1" id="batchol-example1"><a name="batchol-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#batchol-example1" name="batchol-example1" shape="rect">batched Cholesky Factorization</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to use a batched dense Cholesky factorization to solve a sequence of linear systems
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A[i]</mi>
                                          <mo>*</mo>
                                          <mi>x[i]</mi>
                                          <mo>=</mo>
                                          <mi>b[i]</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           each <samp class="ph codeph">A[i]</samp> is a 3x3 dense Hermitian matrix. 
                           In this example, there are two matrices, <samp class="ph codeph">A0</samp> and <samp class="ph codeph">A1</samp>.
                           <samp class="ph codeph">A0</samp> is positive definite and <samp class="ph codeph">A1</samp> is not.
                           
                        </p>
                        <p class="p">
                           The code uses <samp class="ph codeph">potrfBatched</samp> to do Cholesky factorization and 
                           <samp class="ph codeph">potrsBatched</samp> to do backward and forward solve.
                           <samp class="ph codeph">potrfBatched</samp> would report singularity on <samp class="ph codeph">A1</samp>. 
                           
                        </p>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include batchchol_example.cpp 
 *   g++ -o a.out batchchol_example.o -L/usr/local/cuda/lib64 -lcusolver -lcudart
 */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t handle = NULL;
    cudaStream_t stream = NULL;

    cusolverStatus_t status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cublasFillMode_t uplo = CUBLAS_FILL_MODE_LOWER;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchSize = 2;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> nrhs = 1;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldb = m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*       
 *      | 1     2     3 |
 * A0 = | 2     5     5 | = L0 * L0**T
 *      | 3     5    12 |
 *
 *            | 1.0000         0         0 |
 * where L0 = | 2.0000    1.0000         0 |
 *            | 3.0000   -1.0000    1.4142 |
 *
 *      | 1     2     3 |
 * A1 = | 2     4     5 | is not s.p.d., failed at row 2
 *      | 3     5    12 |
 *
 */</span>


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A0[lda*m] = { 1.0, 2.0, 3.0, 2.0, 5.0, 5.0, 3.0, 5.0, 12.0 };
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A1[lda*m] = { 1.0, 2.0, 3.0, 2.0, 4.0, 5.0, 3.0, 5.0, 12.0 };
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> B0[m] = { 1.0, 1.0, 1.0 };
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> X0[m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* X0 = A0\B0 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> infoArray[batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host copy of error info */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> L0[lda*m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* cholesky factor of A0 */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *Aarray[batchSize];
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *Barray[batchSize];

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> **d_Aarray = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> **d_Barray = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_infoArray = NULL;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of batched Cholesky \n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A0 = (matlab base-1)\n"</span>);
    printMatrix(m, m, A0, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A1 = (matlab base-1)\n"</span>);
    printMatrix(m, m, A1, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A1"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"B0 = (matlab base-1)\n"</span>);
    printMatrix(m, 1, B0, ldb, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"B0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusolver handle, bind a stream */</span>
    status = cusolverDnCreate(&amp;handle);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusolverDnSetStream(handle, stream);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: copy A to device */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; batchSize ; j++){
        cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;Aarray[j], <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m);
        assert(cudaSuccess == cudaStat1);
        cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;Barray[j], <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * ldb * nrhs);
        assert(cudaSuccess == cudaStat2);
    }
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_infoArray, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*batchSize);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_Aarray, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*) * batchSize);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_Barray, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*) * batchSize);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

    cudaStat1 = cudaMemcpy(Aarray[0], A0, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m, cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(Aarray[1], A1, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    cudaStat1 = cudaMemcpy(Barray[0], B0, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m, cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(Barray[1], B0, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

    cudaStat1 = cudaMemcpy(d_Aarray, Aarray, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*)*batchSize, cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(d_Barray, Barray, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*)*batchSize, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    cudaDeviceSynchronize();

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: Cholesky factorization */</span>
    status = cusolverDnDpotrfBatched(
        handle,
        uplo,
        m,
        d_Aarray,
        lda,
        d_infoArray,
        batchSize);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == status);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(infoArray, d_infoArray, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*batchSize, cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(L0, Aarray[0], <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m, cudaMemcpyDeviceToHost);
    cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0 ; j &lt; batchSize ; j++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"info[%d] = %d\n"</span>, j, infoArray[j]);
    }

    assert( 0 == infoArray[0] );
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* A1 is singular */</span>
    assert( 2 == infoArray[1] );

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"L = (matlab base-1), upper triangle is don't care \n"</span>);
    printMatrix(m, m, L0, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"L0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * step 4: solve A0*X0 = B0 
 *        | 1 |        | 10.5 |
 *   B0 = | 1 |,  X0 = | -2.5 |
 *        | 1 |        | -1.5 |
 */</span>
    status = cusolverDnDpotrsBatched(
        handle,
        uplo,
        m,
        nrhs, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* only support rhs = 1*/</span>
        d_Aarray,
        lda,
        d_Barray,
        ldb,
        d_infoArray,
        batchSize);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == status);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(infoArray, d_infoArray, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(X0 , Barray[0], <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m, cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    cudaDeviceSynchronize();

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"info = %d\n"</span>, infoArray[0]);
    assert( 0 == infoArray[0] );

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"X0 = (matlab base-1)\n"</span>);
    printMatrix(m, 1, X0, ldb, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"X0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_Aarray    ) cudaFree(d_Aarray);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_Barray    ) cudaFree(d_Barray);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_infoArray ) cudaFree(d_infoArray);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (handle      ) cusolverDnDestroy(handle);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream      ) cudaStreamDestroy(stream);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" xml:lang="en-us" id="eig_examples"><a name="eig_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#eig_examples" name="eig_examples" shape="rect">F.&nbsp;Examples of Dense Eigenvalue Solver</a></h2>
                  <div class="topic concept nested1" id="syevd-example1"><a name="syevd-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#syevd-example1" name="syevd-example1" shape="rect">F.1.&nbsp;Standard Symmetric Dense Eigenvalue Solver</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to use syevd to compute the spectrum of a dense symmetric system by
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>λ</mi>
                                          <mi>x</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where A is a 3x3 dense symmetric matrix
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>3.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The following code uses <samp class="ph codeph">syevd</samp> to compute 
                           eigenvalues and eigenvectors, then compare to exact eigenvalues {2,3,4}.
                           
                        </p>
                        <div class="p"><pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include syevd_example.cpp 
 *   g++ -o a.out syevd_example.o -L/usr/local/cuda/lib64 -lcudart -lcusolver
 *
 */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cusolverStatus_t cusolver_status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*       | 3.5 0.5 0 |
 *   A = | 0.5 3.5 0 |
 *       | 0   0   2 |
 *
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*m] = { 3.5, 0.5, 0, 0.5, 3.5, 0, 0, 0, 2.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda[m] = { 2.0, 3.0, 4.0};

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> V[lda*m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// eigenvectors</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> W[m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// eigenvalues</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_W = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *devInfo = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  lwork = 0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info_gpu = 0;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A = (matlab base-1)\n"</span>);
    printMatrix(m, m, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);


</pre></div>
                        <div class="p">
                           call eigenvalue solver
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create cusolver/cublas handle</span>
    cusolver_status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: copy A and B to device</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>));
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query working space of syevd</span>
    cusolverEigMode_t jobz = CUSOLVER_EIG_MODE_VECTOR; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// compute eigenvalues and eigenvectors.</span>
    cublasFillMode_t uplo = CUBLAS_FILL_MODE_LOWER;
    cusolver_status = cusolverDnDsyevd_bufferSize(
        cusolverH,
        jobz,
        uplo,
        m,
        d_A,
        lda,
        d_W,
        &amp;lwork);
    assert (cusolver_status == CUSOLVER_STATUS_SUCCESS);

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: compute spectrum</span>
    cusolver_status = cusolverDnDsyevd(
        cusolverH,
        jobz,
        uplo,
        m,
        d_A,
        lda,
        d_W,
        d_work,
        lwork,
        devInfo);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(W, d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m, cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(V, d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m, cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(&amp;info_gpu, devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);


</pre></div>
                        <div class="p">
                           check the result 
                           <pre xml:space="preserve"> 
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"after syevd: info_gpu = %d\n"</span>, info_gpu);
    assert(0 == info_gpu);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"eigenvalue = (matlab base-1), ascending order\n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"W[%d] = %E\n"</span>, i+1, W[i]);
    }

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V = (matlab base-1)\n"</span>);
    printMatrix(m, m, V, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: check eigenvalues</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda_sup = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> error = fabs( lambda[i] - W[i]);
        lambda_sup = (lambda_sup &gt; error)? lambda_sup : error;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|lambda - W| = %E\n"</span>, lambda_sup);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// free resources</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_W    ) cudaFree(d_W);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (devInfo) cudaFree(devInfo);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH) cusolverDnDestroy(cusolverH);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}



</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="unique_1002090728"><a name="unique_1002090728" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#unique_1002090728" name="unique_1002090728" shape="rect">Standard Symmetric Dense Eigenvalue Solver</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to use syevd to compute the spectrum of a dense symmetric system by
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>λ</mi>
                                          <mi>x</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where A is a 3x3 dense symmetric matrix
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>3.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The following code uses <samp class="ph codeph">syevd</samp> to compute 
                           eigenvalues and eigenvectors, then compare to exact eigenvalues {2,3,4}.
                           
                        </p>
                        <div class="p"><pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include syevd_example.cpp 
 *   g++ -o a.out syevd_example.o -L/usr/local/cuda/lib64 -lcudart -lcusolver
 *
 */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cusolverStatus_t cusolver_status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*       | 3.5 0.5 0 |
 *   A = | 0.5 3.5 0 |
 *       | 0   0   2 |
 *
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*m] = { 3.5, 0.5, 0, 0.5, 3.5, 0, 0, 0, 2.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda[m] = { 2.0, 3.0, 4.0};

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> V[lda*m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// eigenvectors</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> W[m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// eigenvalues</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_W = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *devInfo = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  lwork = 0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info_gpu = 0;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A = (matlab base-1)\n"</span>);
    printMatrix(m, m, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);


</pre></div>
                        <div class="p">
                           call eigenvalue solver
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create cusolver/cublas handle</span>
    cusolver_status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: copy A and B to device</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>));
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query working space of syevd</span>
    cusolverEigMode_t jobz = CUSOLVER_EIG_MODE_VECTOR; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// compute eigenvalues and eigenvectors.</span>
    cublasFillMode_t uplo = CUBLAS_FILL_MODE_LOWER;
    cusolver_status = cusolverDnDsyevd_bufferSize(
        cusolverH,
        jobz,
        uplo,
        m,
        d_A,
        lda,
        d_W,
        &amp;lwork);
    assert (cusolver_status == CUSOLVER_STATUS_SUCCESS);

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: compute spectrum</span>
    cusolver_status = cusolverDnDsyevd(
        cusolverH,
        jobz,
        uplo,
        m,
        d_A,
        lda,
        d_W,
        d_work,
        lwork,
        devInfo);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(W, d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m, cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(V, d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m, cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(&amp;info_gpu, devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);


</pre></div>
                        <div class="p">
                           check the result 
                           <pre xml:space="preserve"> 
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"after syevd: info_gpu = %d\n"</span>, info_gpu);
    assert(0 == info_gpu);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"eigenvalue = (matlab base-1), ascending order\n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"W[%d] = %E\n"</span>, i+1, W[i]);
    }

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V = (matlab base-1)\n"</span>);
    printMatrix(m, m, V, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: check eigenvalues</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda_sup = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> error = fabs( lambda[i] - W[i]);
        lambda_sup = (lambda_sup &gt; error)? lambda_sup : error;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|lambda - W| = %E\n"</span>, lambda_sup);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// free resources</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_W    ) cudaFree(d_W);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (devInfo) cudaFree(devInfo);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH) cusolverDnDestroy(cusolverH);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}



</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="sygvd-example1"><a name="sygvd-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#sygvd-example1" name="sygvd-example1" shape="rect">F.3.&nbsp;Generalized Symmetric-Definite Dense Eigenvalue Solver</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to use sygvd to compute spectrum of a pair of dense symmetric matrices (A,B) by 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>λ</mi>
                                          <mi>B</mi>
                                          <mi>x</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where A is a 3x3 dense symmetric matrix
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>3.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           and B is a 3x3 positive definite matrix
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>B</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>10</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>10</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>3</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>10</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The following code uses <samp class="ph codeph">sygvd</samp> to compute 
                           eigenvalues and eigenvectors, then compare to exact eigenvalues 
                           {0.158660256604, 0.370751508101882, 0.6}.
                           
                        </p>
                        <div class="p"><pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include sygvd_example.cpp 
 *   g++ -o a.out sygvd_example.o -L/usr/local/cuda/lib64 -lcusolver
 *
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cusolverStatus_t cusolver_status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *       | 3.5 0.5 0 |
 *   A = | 0.5 3.5 0 |
 *       | 0   0   2 |
 *
 *       | 10  2   3 |
 *   B = | 2  10   5 |
 *       | 3   5  10 |
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*m] = { 3.5, 0.5, 0, 0.5, 3.5, 0, 0, 0, 2.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> B[lda*m] = { 10.0, 2.0, 3.0, 2.0, 10.0, 5.0, 3.0, 5.0, 10.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda[m] = { 0.158660256604, 0.370751508101882, 0.6};

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> V[lda*m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// eigenvectors</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> W[m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// eigenvalues</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_B = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_W = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *devInfo = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  lwork = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info_gpu = 0;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A = (matlab base-1)\n"</span>);
    printMatrix(m, m, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"B = (matlab base-1)\n"</span>);
    printMatrix(m, m, B, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"B"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);


</pre></div>
                        <div class="p">
                           call eigenvalue solver
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create cusolver/cublas handle</span>
    cusolver_status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: copy A and B to device</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m);
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>));
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m, cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(d_B, B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query working space of sygvd</span>
    cusolverEigType_t itype = CUSOLVER_EIG_TYPE_1; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// A*x = (lambda)*B*x</span>
    cusolverEigMode_t jobz = CUSOLVER_EIG_MODE_VECTOR; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// compute eigenvalues and eigenvectors.</span>
    cublasFillMode_t uplo = CUBLAS_FILL_MODE_LOWER;
    cusolver_status = cusolverDnDsygvd_bufferSize(
        cusolverH,
        itype,
        jobz,
        uplo,
        m,
        d_A,
        lda,
        d_B,
        lda,
        d_W,
        &amp;lwork);
    assert (cusolver_status == CUSOLVER_STATUS_SUCCESS);
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: compute spectrum of (A,B)</span>
    cusolver_status = cusolverDnDsygvd(
        cusolverH,
        itype,
        jobz,
        uplo,
        m,
        d_A,
        lda,
        d_B,
        lda,
        d_W,
        d_work,
        lwork,
        devInfo);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);
    assert(cudaSuccess == cudaStat1);


</pre></div>
                        <div class="p">
                           check the result 
                           <pre xml:space="preserve"> 
    cudaStat1 = cudaMemcpy(W, d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m, cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(V, d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m, cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(&amp;info_gpu, devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"after sygvd: info_gpu = %d\n"</span>, info_gpu);
    assert(0 == info_gpu);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"eigenvalue = (matlab base-1), ascending order\n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"W[%d] = %E\n"</span>, i+1, W[i]);
    }

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V = (matlab base-1)\n"</span>);
    printMatrix(m, m, V, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: check eigenvalues</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda_sup = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> error = fabs( lambda[i] - W[i]);
        lambda_sup = (lambda_sup &gt; error)? lambda_sup : error;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|lambda - W| = %E\n"</span>, lambda_sup);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// free resources</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_B    ) cudaFree(d_B);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_W    ) cudaFree(d_W);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (devInfo) cudaFree(devInfo);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH) cusolverDnDestroy(cusolverH);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="unique_505535727"><a name="unique_505535727" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#unique_505535727" name="unique_505535727" shape="rect">Generalized Symmetric-Definite Dense Eigenvalue Solver</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to use sygvd to compute spectrum of a pair of dense symmetric matrices (A,B) by 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>λ</mi>
                                          <mi>B</mi>
                                          <mi>x</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where A is a 3x3 dense symmetric matrix
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>3.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           and B is a 3x3 positive definite matrix
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>B</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>10</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>10</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>3</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>10</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The following code uses <samp class="ph codeph">sygvd</samp> to compute 
                           eigenvalues and eigenvectors, then compare to exact eigenvalues 
                           {0.158660256604, 0.370751508101882, 0.6}.
                           
                        </p>
                        <div class="p"><pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include sygvd_example.cpp 
 *   g++ -o a.out sygvd_example.o -L/usr/local/cuda/lib64 -lcusolver
 *
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cusolverStatus_t cusolver_status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *       | 3.5 0.5 0 |
 *   A = | 0.5 3.5 0 |
 *       | 0   0   2 |
 *
 *       | 10  2   3 |
 *   B = | 2  10   5 |
 *       | 3   5  10 |
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*m] = { 3.5, 0.5, 0, 0.5, 3.5, 0, 0, 0, 2.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> B[lda*m] = { 10.0, 2.0, 3.0, 2.0, 10.0, 5.0, 3.0, 5.0, 10.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda[m] = { 0.158660256604, 0.370751508101882, 0.6};

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> V[lda*m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// eigenvectors</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> W[m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// eigenvalues</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_B = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_W = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *devInfo = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  lwork = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info_gpu = 0;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A = (matlab base-1)\n"</span>);
    printMatrix(m, m, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"B = (matlab base-1)\n"</span>);
    printMatrix(m, m, B, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"B"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);


</pre></div>
                        <div class="p">
                           call eigenvalue solver
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create cusolver/cublas handle</span>
    cusolver_status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: copy A and B to device</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m);
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>));
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m, cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(d_B, B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query working space of sygvd</span>
    cusolverEigType_t itype = CUSOLVER_EIG_TYPE_1; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// A*x = (lambda)*B*x</span>
    cusolverEigMode_t jobz = CUSOLVER_EIG_MODE_VECTOR; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// compute eigenvalues and eigenvectors.</span>
    cublasFillMode_t uplo = CUBLAS_FILL_MODE_LOWER;
    cusolver_status = cusolverDnDsygvd_bufferSize(
        cusolverH,
        itype,
        jobz,
        uplo,
        m,
        d_A,
        lda,
        d_B,
        lda,
        d_W,
        &amp;lwork);
    assert (cusolver_status == CUSOLVER_STATUS_SUCCESS);
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: compute spectrum of (A,B)</span>
    cusolver_status = cusolverDnDsygvd(
        cusolverH,
        itype,
        jobz,
        uplo,
        m,
        d_A,
        lda,
        d_B,
        lda,
        d_W,
        d_work,
        lwork,
        devInfo);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);
    assert(cudaSuccess == cudaStat1);


</pre></div>
                        <div class="p">
                           check the result 
                           <pre xml:space="preserve"> 
    cudaStat1 = cudaMemcpy(W, d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m, cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(V, d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m, cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(&amp;info_gpu, devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"after sygvd: info_gpu = %d\n"</span>, info_gpu);
    assert(0 == info_gpu);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"eigenvalue = (matlab base-1), ascending order\n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"W[%d] = %E\n"</span>, i+1, W[i]);
    }

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V = (matlab base-1)\n"</span>);
    printMatrix(m, m, V, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: check eigenvalues</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda_sup = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> error = fabs( lambda[i] - W[i]);
        lambda_sup = (lambda_sup &gt; error)? lambda_sup : error;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|lambda - W| = %E\n"</span>, lambda_sup);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// free resources</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_B    ) cudaFree(d_B);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_W    ) cudaFree(d_W);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (devInfo) cudaFree(devInfo);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH) cusolverDnDestroy(cusolverH);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="syevj-example1"><a name="syevj-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#syevj-example1" name="syevj-example1" shape="rect">F.5.&nbsp;Standard Symmetric Dense Eigenvalue Solver (via Jacobi method)</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to use <samp class="ph codeph">syevj</samp> to compute the spectrum of a dense symmetric system by
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>λ</mi>
                                          <mi>x</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where A is a 3x3 dense symmetric matrix
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>3.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The following code uses <samp class="ph codeph">syevj</samp> to compute 
                           eigenvalues and eigenvectors, then compare to exact eigenvalues {2,3,4}.
                           
                        </p>
                        <div class="p"><pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include syevj_example.cpp 
 *   g++ -o syevj_example syevj_example.o -L/usr/local/cuda/lib64 -lcusolver -lcudart
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cudaStream_t stream = NULL;
    syevjInfo_t syevj_params = NULL;

    cusolverStatus_t status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*       | 3.5 0.5 0 |
 *   A = | 0.5 3.5 0 |
 *       | 0   0   2 |
 *
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*m] = { 3.5, 0.5, 0, 0.5, 3.5, 0, 0, 0, 2.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda[m] = { 2.0, 3.0, 4.0};

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> V[lda*m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* eigenvectors */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> W[m];     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* eigenvalues  */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device copy of A */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_W = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* eigenvalues */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_info = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* error info */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  lwork = 0;     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* size of workspace */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device workspace for syevj */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info = 0;       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host copy of error info */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* configuration of syevj  */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> tol = 1.e-7;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> max_sweeps = 15;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusolverEigMode_t jobz = CUSOLVER_EIG_MODE_VECTOR; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// compute eigenvectors.</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cublasFillMode_t  uplo = CUBLAS_FILL_MODE_LOWER;

</pre></div>
                        <div class="p">
                           configure parameters of syevj
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* numerical results of syevj  */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> residual = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> executed_sweeps = 0;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of syevj \n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"tol = %E, default value is machine zero \n"</span>, tol);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"max. sweeps = %d, default value is 100\n"</span>, max_sweeps);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A = (matlab base-1)\n"</span>);
    printMatrix(m, m, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusolver handle, bind a stream  */</span>
    status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusolverDnSetStream(cusolverH, stream);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: configuration of syevj */</span>
    status = cusolverDnCreateSyevjInfo(&amp;syevj_params);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* default value of tolerance is machine zero */</span>
    status = cusolverDnXsyevjSetTolerance(
        syevj_params,
        tol);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* default value of max. sweeps is 100 */</span>
    status = cusolverDnXsyevjSetMaxSweeps(
        syevj_params,
        max_sweeps);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: copy A to device */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>));
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);


</pre></div>
                        <div class="p">
                           call eigenvalue solver
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: query working space of syevj */</span>
    status = cusolverDnDsyevj_bufferSize(
        cusolverH,
        jobz,
        uplo, 
        m,
        d_A,
        lda,
        d_W, 
        &amp;lwork,
        syevj_params);
    assert(CUSOLVER_STATUS_SUCCESS == status);
 
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: compute eigen-pair   */</span>
    status = cusolverDnDsyevj(
        cusolverH,
        jobz,
        uplo, 
        m,
        d_A,
        lda,
        d_W, 
        d_work,
        lwork,
        d_info,
        syevj_params);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == status);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(W, d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m, cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(V, d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m, cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(&amp;info, d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 == info ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"syevj converges \n"</span>);
    }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 &gt; info ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%d-th parameter is wrong \n"</span>, -info);
        exit(1);
    }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"WARNING: info = %d : syevj does not converge \n"</span>, info );
    }

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Eigenvalue = (matlab base-1), ascending order\n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"W[%d] = %E\n"</span>, i+1, W[i]);
    }

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V = (matlab base-1)\n"</span>);
    printMatrix(m, m, V, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

</pre></div>
                        <div class="p">
                           check the result
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 6: check eigenvalues */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda_sup = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> error = fabs( lambda[i] - W[i]);
        lambda_sup = (lambda_sup &gt; error)? lambda_sup : error;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|lambda - W| = %E\n"</span>, lambda_sup);

    status = cusolverDnXsyevjGetSweeps(
        cusolverH,
        syevj_params,
        &amp;executed_sweeps);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    status = cusolverDnXsyevjGetResidual(
        cusolverH,
        syevj_params,
        &amp;residual);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"residual |A - V*W*V**H|_F = %E \n"</span>, residual );
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"number of executed sweeps = %d \n"</span>, executed_sweeps );

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_W    ) cudaFree(d_W);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_info ) cudaFree(d_info);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH   ) cusolverDnDestroy(cusolverH);   
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream      ) cudaStreamDestroy(stream);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (syevj_params) cusolverDnDestroySyevjInfo(syevj_params);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="sygvj-example1"><a name="sygvj-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#sygvj-example1" name="sygvj-example1" shape="rect">F.6.&nbsp;Generalized Symmetric-Definite Dense Eigenvalue Solver (via Jacobi method) </a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to use <samp class="ph codeph">sygvj</samp> to compute spectrum of a pair of dense symmetric matrices (A,B) by 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>λ</mi>
                                          <mi>B</mi>
                                          <mi>x</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where A is a 3x3 dense symmetric matrix
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>3.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3.5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           and B is a 3x3 positive definite matrix
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>B</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>10</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>3</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>10</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>3</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>10</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The following code uses <samp class="ph codeph">sygvj</samp> to compute 
                           eigenvalues and eigenvectors.
                           
                        </p>
                        <div class="p"><pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include sygvj_example.cpp 
 *   g++ -o sygvj_example sygvj_example.o -L/usr/local/cuda/lib64 -lcusolver -lcudart
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cudaStream_t stream = NULL;
    syevjInfo_t syevj_params = NULL;
    cusolverStatus_t status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *       | 3.5 0.5 0 |
 *   A = | 0.5 3.5 0 |
 *       | 0   0   2 |
 *
 *       | 10  2   3 |
 *   B = | 2  10   5 |
 *       | 3   5  10 |
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*m] = { 3.5, 0.5, 0, 0.5, 3.5, 0, 0, 0, 2.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> B[lda*m] = { 10.0, 2.0, 3.0, 2.0, 10.0, 5.0, 3.0, 5.0, 10.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda[m] = { 0.158660256604, 0.370751508101882, 0.6};

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> V[lda*m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* eigenvectors */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> W[m];     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* eigenvalues  */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device copy of A */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_B = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device copy of B */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_W = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* numerical eigenvalue */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_info = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* error info */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>  lwork = 0;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* size of workspace */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device workspace for sygvj */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info = 0; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host copy of error info */</span>

</pre></div>
                        <div class="p">
                           configure parameters of Jacobi method 
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* configuration of sygvj  */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> tol = 1.e-7;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> max_sweeps = 15;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusolverEigType_t itype = CUSOLVER_EIG_TYPE_1; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// A*x = (lambda)*B*x</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusolverEigMode_t jobz = CUSOLVER_EIG_MODE_VECTOR; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// compute eigenvectors.</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cublasFillMode_t  uplo = CUBLAS_FILL_MODE_LOWER;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* numerical results of syevj  */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> residual = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> executed_sweeps = 0;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of sygvj \n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"tol = %E, default value is machine zero \n"</span>, tol);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"max. sweeps = %d, default value is 100\n"</span>, max_sweeps);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A = (matlab base-1)\n"</span>);
    printMatrix(m, m, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"B = (matlab base-1)\n"</span>);
    printMatrix(m, m, B, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"B"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusolver handle, bind a stream  */</span>
    status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusolverDnSetStream(cusolverH, stream);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: configuration of syevj */</span>
    status = cusolverDnCreateSyevjInfo(&amp;syevj_params);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* default value of tolerance is machine zero */</span>
    status = cusolverDnXsyevjSetTolerance(
        syevj_params,
        tol);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* default value of max. sweeps is 100 */</span>
    status = cusolverDnXsyevjSetMaxSweeps(
        syevj_params,
        max_sweeps);
    assert(CUSOLVER_STATUS_SUCCESS == status);



</pre></div>
                        <div class="p">
                           call eigenvalue solver
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: copy A and B to device */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m);
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>));
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m, cudaMemcpyHostToDevice);
    cudaStat2 = cudaMemcpy(d_B, B, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: query working space of sygvj */</span>
    status = cusolverDnDsygvj_bufferSize(
        cusolverH,
        itype,
        jobz,
        uplo,
        m,
        d_A,
        lda,
        d_B,
        lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ldb */</span>
        d_W,
        &amp;lwork,
        syevj_params);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: compute spectrum of (A,B) */</span>
    status = cusolverDnDsygvj(
        cusolverH,
        itype,
        jobz,
        uplo,
        m,
        d_A,
        lda,
        d_B,
        lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ldb */</span>
        d_W,
        d_work,
        lwork,
        d_info,
        syevj_params);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == status);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(W, d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*m, cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(V, d_A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m, cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(&amp;info, d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);

</pre></div>
                        <div class="p">
                           check the result
                           <pre xml:space="preserve">
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 == info ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"sygvj converges \n"</span>);
    }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 &gt; info ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Error: %d-th parameter is wrong \n"</span>, -info);
        exit(1);
    }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( m &gt;= info ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Error: leading minor of order %d of B is not positive definite\n"</span>, -info);
        exit(1);
    }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span> { <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* info = m+1 */</span>
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"WARNING: info = %d : sygvj does not converge \n"</span>, info );
    }

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Eigenvalue = (matlab base-1), ascending order\n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"W[%d] = %E\n"</span>, i+1, W[i]);
    }

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V = (matlab base-1)\n"</span>);
    printMatrix(m, m, V, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 6: check eigenvalues */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> lambda_sup = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> error = fabs( lambda[i] - W[i]);
        lambda_sup = (lambda_sup &gt; error)? lambda_sup : error;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|lambda - W| = %E\n"</span>, lambda_sup);

    status = cusolverDnXsyevjGetSweeps(
        cusolverH,
        syevj_params,
        &amp;executed_sweeps);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    status = cusolverDnXsyevjGetResidual(
        cusolverH,
        syevj_params,
        &amp;residual);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"residual |M - V*W*V**H|_F = %E \n"</span>, residual );
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"number of executed sweeps = %d \n"</span>, executed_sweeps );

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_B    ) cudaFree(d_B);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_W    ) cudaFree(d_W);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_info ) cudaFree(d_info);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH) cusolverDnDestroy(cusolverH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream      ) cudaStreamDestroy(stream);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (syevj_params) cusolverDnDestroySyevjInfo(syevj_params);

    cudaDeviceReset();
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}

</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="batchsyevj-example1"><a name="batchsyevj-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#batchsyevj-example1" name="batchsyevj-example1" shape="rect">F.7.&nbsp;batch eigenvalue solver for dense symmetric matrix</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to use syevjBatched to compute the spectrum of a sequence of dense symmetric matrices by
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mi>j</mi>
                                          </msub>
                                          <mi>x</mi>
                                          <mo>=</mo>
                                          <mi>λ</mi>
                                          <mi>x</mi>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where A0 and A1 are 3x3 dense symmetric matrices
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A0</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>-1</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>-1</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A1</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>3</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>4</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>4</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>7</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The following code uses <samp class="ph codeph">syevjBatched</samp> to compute 
                           eigenvalues and eigenvectors
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mi>j</mi>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>V</mi>
                                             <mi>j</mi>
                                          </msub>
                                          <mo>*</mo>
                                          <msub>
                                             <mi>W</mi>
                                             <mi>j</mi>
                                          </msub>
                                          <mo>*</mo>
                                          <msubsup>
                                             <mi>V</mi>
                                             <mi>j</mi>
                                             <mi>T</mi>
                                          </msubsup>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The user can disable/enable sorting by the function
                           <samp class="ph codeph">cusolverDnXsyevjSetSortEig</samp>.
                           
                        </p>
                        <div class="p"><pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include batchsyevj_example.cpp 
 *   g++ -o batchsyevj_example batchsyevj_example.o -L/usr/local/cuda/lib64 -lcusolver -lcudart
 *
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cudaStream_t stream = NULL;
    syevjInfo_t syevj_params = NULL;

    cusolverStatus_t status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// 1&lt;= m &lt;= 32</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchSize = 2;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*  
 *        |  1  -1   0 |
 *   A0 = | -1   2   0 |
 *        |  0   0   0 |
 *
 *   A0 = V0 * W0 * V0**T
 *
 *   W0 = diag(0, 0.3820, 2.6180) 
 *
 *        |  3   4  0 |
 *   A1 = |  4   7  0 |
 *        |  0   0  0 |
 *
 *   A1 = V1 * W1 * V1**T
 *
 *   W1 = diag(0, 0.5279, 9.4721) 
 * 
 */</span>

</pre></div>
                        <div class="p">
                           setup matrices A0 and A1
                           <pre xml:space="preserve"> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*m*batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* A = [A0 ; A1] */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> V[lda*m*batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* V = [V0 ; V1] */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> W[m*batchSize];     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* W = [W0 ; W1] */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info[batchSize];       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* info = [info0 ; info1] */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A  = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* lda-by-m-by-batchSize */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_W  = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* m-by-batchSizee */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>* d_info  = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* batchSize */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lwork = 0;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* size of workspace */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device workspace for syevjBatched */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> tol = 1.e-7;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> max_sweeps = 15;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> sort_eig  = 0;   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't sort eigenvalues */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusolverEigMode_t jobz = CUSOLVER_EIG_MODE_VECTOR; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* compute eigenvectors */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cublasFillMode_t  uplo = CUBLAS_FILL_MODE_LOWER;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* residual and executed_sweeps are not supported on syevjBatched */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> residual = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> executed_sweeps = 0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *A0 = A;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *A1 = A + lda*m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *        |  1  -1   0 |
 *   A0 = | -1   2   0 |
 *        |  0   0   0 |
 *   A0 is column-major
 */</span>
    A0[0 + 0*lda] =  1.0;
    A0[1 + 0*lda] = -1.0;
    A0[2 + 0*lda] =  0.0;

    A0[0 + 1*lda] = -1.0;
    A0[1 + 1*lda] =  2.0;
    A0[2 + 1*lda] =  0.0;

    A0[0 + 2*lda] =  0.0;
    A0[1 + 2*lda] =  0.0;
    A0[2 + 2*lda] =  0.0;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *        |  3   4  0 |
 *   A1 = |  4   7  0 |
 *        |  0   0  0 |
 *   A1 is column-major
 */</span>
    A1[0 + 0*lda] = 3.0;
    A1[1 + 0*lda] = 4.0;
    A1[2 + 0*lda] = 0.0;

    A1[0 + 1*lda] = 4.0;
    A1[1 + 1*lda] = 7.0;
    A1[2 + 1*lda] = 0.0;

    A1[0 + 2*lda] = 0.0;
    A1[1 + 2*lda] = 0.0;
    A1[2 + 2*lda] = 0.0;

</pre></div>
                        <div class="p">
                           configure parameters of syevj
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusolver handle, bind a stream  */</span>
    status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusolverDnSetStream(cusolverH, stream);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: configuration of syevj */</span>
    status = cusolverDnCreateSyevjInfo(&amp;syevj_params);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* default value of tolerance is machine zero */</span>
    status = cusolverDnXsyevjSetTolerance(
        syevj_params,
        tol);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* default value of max. sweeps is 100 */</span>
    status = cusolverDnXsyevjSetMaxSweeps(
        syevj_params,
        max_sweeps);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* disable sorting */</span>
    status = cusolverDnXsyevjSetSortEig(
        syevj_params,
        sort_eig);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: copy A to device */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m * batchSize);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_W   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m * batchSize);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>   ) * batchSize);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m * batchSize, cudaMemcpyHostToDevice);
    cudaStat2 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: query working space of syevjBatched */</span>
    status = cusolverDnDsyevjBatched_bufferSize(
        cusolverH,
        jobz,
        uplo,
        m,
        d_A,
        lda,
        d_W,
        &amp;lwork,
        syevj_params,
        batchSize
    );
    assert(CUSOLVER_STATUS_SUCCESS == status);

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

</pre></div>
                        <div class="p">
                           call eigenvalue solver
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: compute spectrum of A0 and A1 */</span>
    status = cusolverDnDsyevjBatched(
        cusolverH,
        jobz,
        uplo,
        m,
        d_A,
        lda,
        d_W,
        d_work,
        lwork,
        d_info,
        syevj_params,
        batchSize
    );
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == status);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(V    , d_A   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * lda * m * batchSize, cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(W    , d_W   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>) * m * batchSize      , cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(&amp;info, d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * batchSize             , cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; batchSize ; i++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 == info[i] ){
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"matrix %d: syevj converges \n"</span>, i);
        }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 &gt; info[i] ){
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* only info[0] shows if some input parameter is wrong.
 * If so, the error is CUSOLVER_STATUS_INVALID_VALUE.
 */</span>
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Error: %d-th parameter is wrong \n"</span>, -info[i] );
            exit(1);
        }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span> { <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* info = m+1 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* if info[i] is not zero, Jacobi method does not converge at i-th matrix. */</span>
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"WARNING: matrix %d, info = %d : sygvj does not converge \n"</span>, i, info[i] );
        }
    }

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Step 6: show eigenvalues and eigenvectors */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *W0 = W;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *W1 = W + m;
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"==== \n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"W0[%d] = %f\n"</span>, i, W0[i]);
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"==== \n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; m ; i++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"W1[%d] = %f\n"</span>, i, W1[i]);
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"==== \n"</span>);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *V0 = V;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *V1 = V + lda*m;
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V0 = (matlab base-1)\n"</span>);
    printMatrix(m, m, V0, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V1 = (matlab base-1)\n"</span>);
    printMatrix(m, m, V1, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V1"</span>);

</pre></div>
                        <div class="p">
                           cannot query residual and executed sweeps.
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * The folowing two functions do not support batched version.
 * The error CUSOLVER_STATUS_NOT_SUPPORTED is returned. 
 */</span>
    status = cusolverDnXsyevjGetSweeps(
        cusolverH,
        syevj_params,
        &amp;executed_sweeps);
    assert(CUSOLVER_STATUS_NOT_SUPPORTED == status);

    status = cusolverDnXsyevjGetResidual(
        cusolverH,
        syevj_params,
        &amp;residual);
    assert(CUSOLVER_STATUS_NOT_SUPPORTED == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_W    ) cudaFree(d_W);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_info ) cudaFree(d_info);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH) cusolverDnDestroy(cusolverH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream      ) cudaStreamDestroy(stream);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (syevj_params) cusolverDnDestroySyevjInfo(syevj_params);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" xml:lang="en-us" id="svd_examples"><a name="svd_examples" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#svd_examples" name="svd_examples" shape="rect">G.&nbsp;Examples of Singular Value Decomposition</a></h2>
                  <div class="topic concept nested1" id="svd-example1"><a name="svd-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#svd-example1" name="svd-example1" shape="rect">G.1.&nbsp;SVD with singular vectors</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to perform singular value decomposition.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mo>=</mo>
                                          <mi>U</mi>
                                          <mo>*</mo>
                                          <mi>Σ</mi>
                                          <mo>*</mo>
                                          <msup>
                                             <mi>V</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>H</mi>
                                             </mrow>
                                          </msup>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           A is a 3x2 dense matrix,
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The following code uses three steps:
                           
                        </p>
                        <p class="p">
                           Step 1: compute A = U*S*VT 
                           
                        </p>
                        <p class="p">
                           Step 2: check accuracy of singular value 
                           
                        </p>
                        <p class="p">
                           Step 3: measure residual A-U*S*VT
                           
                        </p>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include svd_example.cpp 
 *   g++ -o a.out svd_example.o -L/usr/local/cuda/lib64 -lcudart -lcublas -lcusolver
 *
 */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;string.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cublas_v2.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %f\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cublasHandle_t cublasH = NULL;
    cublasStatus_t cublas_status = CUBLAS_STATUS_SUCCESS;
    cusolverStatus_t cusolver_status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    cudaError_t cudaStat5 = cudaSuccess;
    cudaError_t cudaStat6 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 2;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*       | 1 2  |
 *   A = | 4 5  |
 *       | 2 1  |
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*n] = { 1.0, 4.0, 2.0, 2.0, 5.0, 1.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> U[lda*m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// m-by-m unitary matrix </span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> VT[lda*n];  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// n-by-n unitary matrix</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> S[n]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// singular value</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> S_exact[n] = {7.065283497082729, 1.040081297712078};

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_S = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_U = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_VT = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *devInfo = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_rwork = NULL;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_W = NULL;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// W = S*VT</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lwork = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info_gpu = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> h_one = 1;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> h_minus_one = -1;


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A = (matlab base-1)\n"</span>);
    printMatrix(m, n, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 1: create cusolverDn/cublas handle</span>
    cusolver_status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);

    cublas_status = cublasCreate(&amp;cublasH);
    assert(CUBLAS_STATUS_SUCCESS == cublas_status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 2: copy A and B to device</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_S  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*n);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_U  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m);
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_VT , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n);
    cudaStat5 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>));
    cudaStat6 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_W  , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);
    assert(cudaSuccess == cudaStat5);
    assert(cudaSuccess == cudaStat6);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 3: query working space of SVD</span>
    cusolver_status = cusolverDnDgesvd_bufferSize(
        cusolverH,
        m,
        n,
        &amp;lwork );
    assert (cusolver_status == CUSOLVER_STATUS_SUCCESS);

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 4: compute SVD</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">signed</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span> jobu = <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">'A'</span>; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// all m columns of U</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">signed</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span> jobvt = <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">'A'</span>; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// all n columns of VT</span>
    cusolver_status = cusolverDnDgesvd (
        cusolverH,
        jobu,
        jobvt,
        m,
        n,
        d_A,
        lda,
        d_S,
        d_U,
        lda,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// ldu</span>
        d_VT,
        lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// ldvt,</span>
        d_work,
        lwork,
        d_rwork,
        devInfo);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == cusolver_status);
    assert(cudaSuccess == cudaStat1);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    cudaStat1 = cudaMemcpy(U , d_U , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m, cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(VT, d_VT, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n, cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(S , d_S , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*n    , cudaMemcpyDeviceToHost);
    cudaStat4 = cudaMemcpy(&amp;info_gpu, devInfo, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"after gesvd: info_gpu = %d\n"</span>, info_gpu);
    assert(0 == info_gpu);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"S = (matlab base-1)\n"</span>);
    printMatrix(n, 1, S, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"S"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"U = (matlab base-1)\n"</span>);
    printMatrix(m, m, U, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"U"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"VT = (matlab base-1)\n"</span>);
    printMatrix(n, n, VT, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"VT"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 5: measure error of singular value</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> ds_sup = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0; j &lt; n; j++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> err = fabs( S[j] - S_exact[j] );
        ds_sup = (ds_sup &gt; err)? ds_sup : err;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|S - S_exact| = %E \n"</span>, ds_sup);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// step 6: |A - U*S*VT|</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// W = S*VT</span>
    cublas_status = cublasDdgmm(
        cublasH,
        CUBLAS_SIDE_LEFT,
        n,
        n,
        d_VT,
        lda,
        d_S,
         1,
        d_W,
        lda);
    assert(CUBLAS_STATUS_SUCCESS == cublas_status);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// A := -U*W + A</span>
    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cublas_status = cublasDgemm_v2(
        cublasH,
        CUBLAS_OP_N, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// U</span>
        CUBLAS_OP_N, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// W</span>
        m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of rows of A</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of columns of A</span>
        n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// number of columns of U </span>
        &amp;h_minus_one, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host pointer */</span>
        d_U, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// U</span>
        lda,
        d_W, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// W</span>
        lda,
        &amp;h_one, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* hostpointer */</span>
        d_A,
        lda);
    assert(CUBLAS_STATUS_SUCCESS == cublas_status);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> dR_fro = 0.0;
    cublas_status = cublasDnrm2_v2(
        cublasH, lda*n, d_A, 1, &amp;dR_fro);
    assert(CUBLAS_STATUS_SUCCESS == cublas_status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|A - U*S*VT| = %E \n"</span>, dR_fro);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// free resources</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_S    ) cudaFree(d_S);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_U    ) cudaFree(d_U);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_VT   ) cudaFree(d_VT);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (devInfo) cudaFree(devInfo);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_rwork) cudaFree(d_rwork);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_W    ) cudaFree(d_W);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cublasH ) cublasDestroy(cublasH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH) cusolverDnDestroy(cusolverH);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="gesvdj-example1"><a name="gesvdj-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#gesvdj-example1" name="gesvdj-example1" shape="rect">G.2.&nbsp;SVD with singular vectors (via Jacobi method)</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to perform singular value decomposition by <samp class="ph codeph">gesvdj</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mo>=</mo>
                                          <mi>U</mi>
                                          <mo>*</mo>
                                          <mi>Σ</mi>
                                          <mo>*</mo>
                                          <msup>
                                             <mi>V</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>H</mi>
                                             </mrow>
                                          </msup>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           A is a 3x2 dense matrix,
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include gesvdj_example.cpp 
 *   g++ -o gesvdj_example gesvdj_example.o -L/usr/local/cuda/lib64 -lcudart -lcusolver
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;string.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %20.16E\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cudaStream_t stream = NULL;
    gesvdjInfo_t gesvdj_params = NULL;

    cusolverStatus_t status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    cudaError_t cudaStat5 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 2;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*       | 1 2  |
 *   A = | 4 5  |
 *       | 2 1  |
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*n] = { 1.0, 4.0, 2.0, 2.0, 5.0, 1.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> U[lda*m]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* m-by-m unitary matrix, left singular vectors  */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> V[lda*n]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* n-by-n unitary matrix, right singular vectors */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> S[n];     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* numerical singular value */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* exact singular values */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> S_exact[n] = {7.065283497082729, 1.040081297712078};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A = NULL;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device copy of A */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_S = NULL;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* singular values */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_U = NULL;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* left singular vectors */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_V = NULL;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* right singular vectors */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_info = NULL;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* error info */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lwork = 0;       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* size of workspace */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* devie workspace for gesvdj */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info = 0;        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host copy of error info */</span>


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* configuration of gesvdj  */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> tol = 1.e-7;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> max_sweeps = 15;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusolverEigMode_t jobz = CUSOLVER_EIG_MODE_VECTOR; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// compute eigenvectors.</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> econ = 0 ; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* econ = 1 for economy size */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* numerical results of gesvdj  */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> residual = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> executed_sweeps = 0;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of gesvdj \n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"tol = %E, default value is machine zero \n"</span>, tol);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"max. sweeps = %d, default value is 100\n"</span>, max_sweeps);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"econ = %d \n"</span>, econ);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A = (matlab base-1)\n"</span>);
    printMatrix(m, n, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusolver handle, bind a stream */</span>
    status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusolverDnSetStream(cusolverH, stream);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: configuration of gesvdj */</span>
    status = cusolverDnCreateGesvdjInfo(&amp;gesvdj_params);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* default value of tolerance is machine zero */</span>
    status = cusolverDnXgesvdjSetTolerance(
        gesvdj_params,
        tol);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* default value of max. sweeps is 100 */</span>
    status = cusolverDnXgesvdjSetMaxSweeps(
        gesvdj_params,
        max_sweeps);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: copy A and B to device */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_S   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*n);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_U   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m);
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_V   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n);
    cudaStat5 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>));
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);
    assert(cudaSuccess == cudaStat5);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: query workspace of SVD */</span>
    status = cusolverDnDgesvdj_bufferSize(
        cusolverH,
        jobz, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* CUSOLVER_EIG_MODE_NOVECTOR: compute singular values only */</span>
              <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* CUSOLVER_EIG_MODE_VECTOR: compute singular value and singular vectors */</span>
        econ, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* econ = 1 for economy size */</span>
        m,    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* nubmer of rows of A, 0 &lt;= m */</span>
        n,    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of A, 0 &lt;= n  */</span>
        d_A,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* m-by-n */</span>
        lda,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of A */</span>
        d_S,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* min(m,n) */</span>
              <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* the singular values in descending order */</span>
        d_U,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* m-by-m if econ = 0 */</span>
              <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* m-by-min(m,n) if econ = 1 */</span>
        lda,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of U, ldu &gt;= max(1,m) */</span>
        d_V,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* n-by-n if econ = 0  */</span>
              <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* n-by-min(m,n) if econ = 1  */</span>
        lda,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of V, ldv &gt;= max(1,n) */</span>
        &amp;lwork,
        gesvdj_params);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: compute SVD */</span>
    status = cusolverDnDgesvdj(
        cusolverH,
        jobz,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* CUSOLVER_EIG_MODE_NOVECTOR: compute singular values only */</span>
               <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* CUSOLVER_EIG_MODE_VECTOR: compute singular value and singular vectors */</span>
        econ,  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* econ = 1 for economy size */</span>
        m,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* nubmer of rows of A, 0 &lt;= m */</span>
        n,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of A, 0 &lt;= n  */</span>
        d_A,   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* m-by-n */</span>
        lda,   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of A */</span>
        d_S,   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* min(m,n)  */</span>
               <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* the singular values in descending order */</span>
        d_U,   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* m-by-m if econ = 0 */</span>
               <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* m-by-min(m,n) if econ = 1 */</span>
        lda,   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of U, ldu &gt;= max(1,m) */</span>
        d_V,   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* n-by-n if econ = 0  */</span>
               <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* n-by-min(m,n) if econ = 1  */</span>
        lda,   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of V, ldv &gt;= max(1,n) */</span>
        d_work,
        lwork,
        d_info,
        gesvdj_params);
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == status);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(U, d_U, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*m, cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(V, d_V, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n, cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(S, d_S, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*n    , cudaMemcpyDeviceToHost);
    cudaStat4 = cudaMemcpy(&amp;info, d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>), cudaMemcpyDeviceToHost);
    cudaStat5 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);
    assert(cudaSuccess == cudaStat5);

</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 == info ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"gesvdj converges \n"</span>);
    }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 &gt; info ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%d-th parameter is wrong \n"</span>, -info);
        exit(1);
    }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"WARNING: info = %d : gesvdj does not converge \n"</span>, info );
    }

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"S = singular values (matlab base-1)\n"</span>);
    printMatrix(n, 1, S, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"S"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"U = left singular vectors (matlab base-1)\n"</span>);
    printMatrix(m, m, U, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"U"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V = right singular vectors (matlab base-1)\n"</span>);
    printMatrix(n, n, V, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 6: measure error of singular value */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> ds_sup = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0; j &lt; n; j++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> err = fabs( S[j] - S_exact[j] );
        ds_sup = (ds_sup &gt; err)? ds_sup : err;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|S - S_exact|_sup = %E \n"</span>, ds_sup);

    status = cusolverDnXgesvdjGetSweeps(
        cusolverH,
        gesvdj_params,
        &amp;executed_sweeps);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    status = cusolverDnXgesvdjGetResidual(
        cusolverH,
        gesvdj_params,
        &amp;residual);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"residual |A - U*S*V**H|_F = %E \n"</span>, residual );
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"number of executed sweeps = %d \n"</span>, executed_sweeps );

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*  free resources  */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_S    ) cudaFree(d_S);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_U    ) cudaFree(d_U);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_V    ) cudaFree(d_V);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_info) cudaFree(d_info);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH) cusolverDnDestroy(cusolverH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream      ) cudaStreamDestroy(stream);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (gesvdj_params) cusolverDnDestroyGesvdjInfo(gesvdj_params);

    cudaDeviceReset();
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}

</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="batchgesvdj-example1"><a name="batchgesvdj-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#batchgesvdj-example1" name="batchgesvdj-example1" shape="rect">G.3.&nbsp;batch dense SVD solver</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to use <samp class="ph codeph">gesvdjBatched</samp> to compute the SVD of a sequence of dense matrices 
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <msub>
                                             <mi>A</mi>
                                             <mi>j</mi>
                                          </msub>
                                          <mo>=</mo>
                                          <msub>
                                             <mi>U</mi>
                                             <mi>j</mi>
                                          </msub>
                                          <mo>*</mo>
                                          <msub>
                                             <mi>Σ</mi>
                                             <mi>j</mi>
                                          </msub>
                                          <mo>*</mo>
                                          <msubsup>
                                             <mi>V</mi>
                                             <mi>j</mi>
                                             <mi>H</mi>
                                          </msubsup>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           where A0 and A1 are 3x2 dense matrices
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A0</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>-1</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>-1</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A1</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>3</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>4</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>4</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>7</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           The following code uses <samp class="ph codeph">gesvdjBatched</samp> to compute 
                           singular values and singular vectors.
                           
                        </p>
                        <p class="p">
                           The user can disable/enable sorting by the function
                           <samp class="ph codeph">cusolverDnXgesvdjSetSortEig</samp>.
                           
                        </p>
                        <div class="p"><pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include gesvdjbatch_example.cpp 
 *   g++ -o gesvdjbatch_example gesvdjbatch_example.o -L/usr/local/cuda/lib64 -lcusolver -lcudart
 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %20.16E\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cudaStream_t stream = NULL;
    gesvdjInfo_t gesvdj_params = NULL;

    cusolverStatus_t status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    cudaError_t cudaStat5 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* 1 &lt;= m &lt;= 32 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 2; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* 1 &lt;= n &lt;= 32 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* lda &gt;= m */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldu = m; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ldu &gt;= m */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldv = n; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ldv &gt;= n */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchSize = 2;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> minmn = (m &lt; n)? m : n; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* min(m,n) */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*  
 *        |  1  -1  |
 *   A0 = | -1   2  |
 *        |  0   0  |
 *
 *   A0 = U0 * S0 * V0**T
 *   S0 = diag(2.6180, 0.382) 
 *
 *        |  3   4  |
 *   A1 = |  4   7  |
 *        |  0   0  |
 *
 *   A1 = U1 * S1 * V1**T
 *   S1 = diag(9.4721, 0.5279) 
 */</span>

</pre></div>
                        <div class="p">
                           setup matrices A0 and A1
                           <pre xml:space="preserve"> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> A[lda*n*batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* A = [A0 ; A1] */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> U[ldu*m*batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* U = [U0 ; U1] */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> V[ldv*n*batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* V = [V0 ; V1] */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> S[minmn*batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* S = [S0 ; S1] */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info[batchSize];       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* info = [info0 ; info1] */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_A  = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* lda-by-n-by-batchSize */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_U  = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ldu-by-m-by-batchSize */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_V  = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* ldv-by-n-by-batchSize */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_S  = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* minmn-by-batchSizee */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>* d_info  = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* batchSize */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lwork = 0;       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* size of workspace */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *d_work = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device workspace for gesvdjBatched */</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> tol = 1.e-7;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> max_sweeps = 15;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> sort_svd  = 0;   <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* don't sort singular values */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusolverEigMode_t jobz = CUSOLVER_EIG_MODE_VECTOR; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* compute singular vectors */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* residual and executed_sweeps are not supported on gesvdjBatched */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> residual = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> executed_sweeps = 0;

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *A0 = A;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *A1 = A + lda*n; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Aj is m-by-n */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *        |  1  -1  |
 *   A0 = | -1   2  |
 *        |  0   0  |
 *   A0 is column-major
 */</span>
    A0[0 + 0*lda] =  1.0;
    A0[1 + 0*lda] = -1.0;
    A0[2 + 0*lda] =  0.0;

    A0[0 + 1*lda] = -1.0;
    A0[1 + 1*lda] =  2.0;
    A0[2 + 1*lda] =  0.0;

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 *        |  3   4  |
 *   A1 = |  4   7  |
 *        |  0   0  |
 *   A1 is column-major
 */</span>
    A1[0 + 0*lda] = 3.0;
    A1[1 + 0*lda] = 4.0;
    A1[2 + 0*lda] = 0.0;

    A1[0 + 1*lda] = 4.0;
    A1[1 + 1*lda] = 7.0;
    A1[2 + 1*lda] = 0.0;

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of gesvdjBatched \n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"m = %d, n = %d \n"</span>, m, n);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"tol = %E, default value is machine zero \n"</span>, tol);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"max. sweeps = %d, default value is 100\n"</span>, max_sweeps);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A0 = (matlab base-1)\n"</span>);
    printMatrix(m, n, A0, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A1 = (matlab base-1)\n"</span>);
    printMatrix(m, n, A1, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A1"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

</pre></div>
                        <div class="p">
                           configure parameters of gesvdj
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusolver handle, bind a stream  */</span>
    status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == status);

    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);

    status = cusolverDnSetStream(cusolverH, stream);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: configuration of gesvdj */</span>
    status = cusolverDnCreateGesvdjInfo(&amp;gesvdj_params);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* default value of tolerance is machine zero */</span>
    status = cusolverDnXgesvdjSetTolerance(
        gesvdj_params,
        tol);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* default value of max. sweeps is 100 */</span>
    status = cusolverDnXgesvdjSetMaxSweeps(
        gesvdj_params,
        max_sweeps);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* disable sorting */</span>
    status = cusolverDnXgesvdjSetSortEig(
        gesvdj_params,
        sort_svd);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: copy A to device */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n*batchSize);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_U   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*ldu*m*batchSize);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_V   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*ldv*n*batchSize);
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_S   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*minmn*batchSize);
    cudaStat5 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>   )*batchSize);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);
    assert(cudaSuccess == cudaStat5);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lda*n*batchSize, cudaMemcpyHostToDevice);
    cudaStat2 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);


</pre></div>
                        <div class="p">
                           call batched singular value solver
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: query working space of gesvdjBatched */</span>
    status = cusolverDnDgesvdjBatched_bufferSize(
        cusolverH,
        jobz,
        m,
        n,
        d_A,
        lda,
        d_S,
        d_U,
        ldu,
        d_V,
        ldv,
        &amp;lwork,
        gesvdj_params,
        batchSize
    );
    assert(CUSOLVER_STATUS_SUCCESS == status);

    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 5: compute singular values of A0 and A1 */</span>
    status = cusolverDnDgesvdjBatched(
        cusolverH,
        jobz,
        m,
        n,
        d_A,
        lda,
        d_S,
        d_U,
        ldu,
        d_V,
        ldv,
        d_work,
        lwork,
        d_info,
        gesvdj_params,
        batchSize
    );
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == status);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(U    , d_U   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*ldu*m*batchSize, cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(V    , d_V   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*ldv*n*batchSize, cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(S    , d_S   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span>)*minmn*batchSize, cudaMemcpyDeviceToHost);
    cudaStat4 = cudaMemcpy(&amp;info, d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>) * batchSize       , cudaMemcpyDeviceToHost);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);



</pre></div>
                        <div class="p">
                           check the result
                           <pre xml:space="preserve">
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; batchSize ; i++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 == info[i] ){
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"matrix %d: gesvdj converges \n"</span>, i);
        }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 &gt; info[i] ){
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* only info[0] shows if some input parameter is wrong.
 * If so, the error is CUSOLVER_STATUS_INVALID_VALUE.
 */</span>
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"Error: %d-th parameter is wrong \n"</span>, -info[i] );
            exit(1);
        }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span> { <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* info = m+1 */</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* if info[i] is not zero, Jacobi method does not converge at i-th matrix. */</span>
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"WARNING: matrix %d, info = %d : gesvdj does not converge \n"</span>, i, info[i] );
        }
    }

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Step 6: show singular values and singular vectors */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *S0 = S;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *S1 = S + minmn;
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"==== \n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; minmn ; i++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"S0(%d) = %20.16E\n"</span>, i+1, S0[i]);
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"==== \n"</span>);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> i = 0 ; i &lt; minmn ; i++){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"S1(%d) = %20.16E\n"</span>, i+1, S1[i]);
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"==== \n"</span>);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *U0 = U;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *U1 = U + ldu*m; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Uj is m-by-m */</span>
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"U0 = (matlab base-1)\n"</span>);
    printMatrix(m, m, U0, ldu, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"U0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"U1 = (matlab base-1)\n"</span>);
    printMatrix(m, m, U1, ldu, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"U1"</span>);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *V0 = V;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> *V1 = V + ldv*n; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Vj is n-by-n */</span>
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V0 = (matlab base-1)\n"</span>);
    printMatrix(n, n, V0, ldv, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V1 = (matlab base-1)\n"</span>);
    printMatrix(n, n, V1, ldv, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V1"</span>);



</pre></div>
                        <div class="p">
                           cannot query residual and executed sweeps
                           <pre xml:space="preserve">
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * The folowing two functions do not support batched version.
 * The error CUSOLVER_STATUS_NOT_SUPPORTED is returned. 
 */</span>
    status = cusolverDnXgesvdjGetSweeps(
        cusolverH,
        gesvdj_params,
        &amp;executed_sweeps);
    assert(CUSOLVER_STATUS_NOT_SUPPORTED == status);

    status = cusolverDnXgesvdjGetResidual(
        cusolverH,
        gesvdj_params,
        &amp;residual);
    assert(CUSOLVER_STATUS_NOT_SUPPORTED == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* free resources */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_U    ) cudaFree(d_U);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_V    ) cudaFree(d_V);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_S    ) cudaFree(d_S);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_info ) cudaFree(d_info);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH) cusolverDnDestroy(cusolverH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream      ) cudaStreamDestroy(stream);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (gesvdj_params) cusolverDnDestroyGesvdjInfo(gesvdj_params);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
                  <div class="topic concept nested1" id="gesvda-example1"><a name="gesvda-example1" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#gesvda-example1" name="gesvda-example1" shape="rect">G.4.&nbsp;SVD approximation</a></h3>
                     <div class="body conbody">
                        <p class="p">
                           This chapter provides a simple example in the C programming language of 
                           how to approximate singular value decomposition by <samp class="ph codeph">gesvdaStridedBatched</samp>.
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <math xmlns="http://www.w3.org/1998/Math/MathML">
                                          <mi>A</mi>
                                          <mo>=</mo>
                                          <mi>U</mi>
                                          <mo>*</mo>
                                          <mi>Σ</mi>
                                          <mo>*</mo>
                                          <msup>
                                             <mi>V</mi>
                                             <mrow class="MJX-TeXAtom-ORD">
                                                <mi>H</mi>
                                             </mrow>
                                          </msup>
                                       </math>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <p class="p">
                           A0 and A1 are a 3x2 dense matrices,
                           
                        </p>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A0</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>4.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>2.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>1.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="tablenoborder">
                           <table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="void" border="1" rules="all">
                              <tbody class="tbody">
                                 <tr class="row">
                                    <td class="entry" align="center" valign="top" rowspan="1" colspan="1">
                                       <p class="p d4p_eqn_block">
                                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                                             <mi>A1</mi>
                                             <mo>=</mo>
                                             <mfenced open="(" close=")">
                                                <mtable rowspacing="4pt" columnspacing="1em">
                                                   <mtr>
                                                      <mtd>
                                                         <mi>10.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>9.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>8.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>7.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                   <mtr>
                                                      <mtd>
                                                         <mi>6.0</mi>
                                                      </mtd>
                                                      <mtd>
                                                         <mi>5.0</mi>
                                                      </mtd>
                                                   </mtr>
                                                </mtable>
                                             </mfenced>
                                          </math>
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*
 * How to compile (assume cuda is installed at /usr/local/cuda/)
 *   nvcc -c -I/usr/local/cuda/include gesvda_example.cpp 
 *   g++ -o gesvda_example gesvda_example.o -L/usr/local/cuda/lib64 -lcudart -lcusolver
 */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdio.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;stdlib.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;string.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;assert.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cuda_runtime.h&gt;</span>
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-directive">#include &lt;cusolverDn.h&gt;</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span> printMatrix(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>*A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>* name)
{
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> row = 0 ; row &lt; m ; row++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> col = 0 ; col &lt; n ; col++){
            <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> Areg = A[row + col*lda];
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%s(%d,%d) = %20.16E\n"</span>, name, row+1, col+1, Areg);
        }
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> main(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> argc, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">char</span>*argv[])
{
    cusolverDnHandle_t cusolverH = NULL;
    cudaStream_t stream = NULL;

    cusolverStatus_t status = CUSOLVER_STATUS_SUCCESS;
    cudaError_t cudaStat1 = cudaSuccess;
    cudaError_t cudaStat2 = cudaSuccess;
    cudaError_t cudaStat3 = cudaSuccess;
    cudaError_t cudaStat4 = cudaSuccess;
    cudaError_t cudaStat5 = cudaSuccess;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> batchSize = 2;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> m = 3;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> n = 2;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lda = m;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldu = m;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> ldv = n;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> rank = n;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> strideA = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)lda*n;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> strideS = n;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> strideU = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)ldu*n;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> strideV = (<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">long</span> <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)ldv*n;
<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*        | 1 2  |       | 10 9 |
 *   A0 = | 4 5  |, A1 = |  8 7 |
 *        | 2 1  |       |  6 5 |
 */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> A[strideA*batchSize] = { 1.0, 4.0, 2.0, 2.0, 5.0, 1.0, 10.0, 8.0, 6.0, 9.0, 7.0, 5.0};
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> U[strideU*batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* left singular vectors  */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> V[strideV*batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* right singular vectors */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> S[strideS*batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* numerical singular value */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* exact singular values */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> S_exact[strideS*batchSize] = {7.065283497082729, 1.040081297712078, 18.839649186929730, 0.260035600289472};


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_A = NULL;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* device copy of A */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_S = NULL;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* singular values */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_U = NULL;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* left singular vectors */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_V = NULL;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* right singular vectors */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> *d_info = NULL;  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* error info */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> lwork = 0;       <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* size of workspace */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> *d_work = NULL; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* devie workspace for gesvda */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">const</span> cusolverEigMode_t jobz = CUSOLVER_EIG_MODE_VECTOR; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">// compute eigenvectors.</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">double</span> RnrmF[batchSize]; <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* residual norm */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> info[batchSize];  <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* host copy of error info */</span>

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"example of gesvdaStridedBatched \n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A = (matlab base-1)\n"</span>);
    printMatrix(m, n, A, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);
    printMatrix(m, n, A + strideA, lda, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"A1"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 1: create cusolver handle, bind a stream */</span>
    status = cusolverDnCreate(&amp;cusolverH);
    assert(CUSOLVER_STATUS_SUCCESS == status);
    cudaStat1 = cudaStreamCreateWithFlags(&amp;stream, cudaStreamNonBlocking);
    assert(cudaSuccess == cudaStat1);
    status = cusolverDnSetStream(cusolverH, stream);
    assert(CUSOLVER_STATUS_SUCCESS == status);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 2: copy A to device */</span>
    cudaStat1 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_A   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*strideA*batchSize);
    cudaStat2 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_S   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*strideS*batchSize);
    cudaStat3 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_U   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*strideU*batchSize);
    cudaStat4 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_V   , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*strideV*batchSize);
    cudaStat5 = cudaMalloc ((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*batchSize);
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);
    assert(cudaSuccess == cudaStat5);

    cudaStat1 = cudaMemcpy(d_A, A, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*strideA*batchSize, cudaMemcpyHostToDevice);
    assert(cudaSuccess == cudaStat1);
    cudaDeviceSynchronize(); <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* sync with null stream */</span>

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 3: query workspace of SVD */</span>
    status = cusolverDnSgesvdaStridedBatched_bufferSize(
        cusolverH,
        jobz, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* CUSOLVER_EIG_MODE_NOVECTOR: compute singular values only */</span>
              <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* CUSOLVER_EIG_MODE_VECTOR: compute singular value and singular vectors */</span>
        rank, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of singular values */</span>
        m,    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* nubmer of rows of Aj, 0 &lt;= m */</span>
        n,    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of Aj, 0 &lt;= n  */</span>
        d_A,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Aj is m-by-n */</span>
        lda,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of Aj */</span>
        strideA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* &gt;= lda*n */</span>
        d_S,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Sj is rank-by-1, singular values in descending order */</span>
        strideS, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* &gt;= rank */</span>
        d_U,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Uj is m-by-rank */</span>
        ldu,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of Uj, ldu &gt;= max(1,m) */</span>
        strideU, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* &gt;= ldu*rank */</span>
        d_V,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Vj is n-by-rank */</span>
        ldv,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of Vj, ldv &gt;= max(1,n) */</span>
        strideV, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* &gt;= ldv*rank */</span>
        &amp;lwork,
        batchSize <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of matrices */</span>
    );
    assert(CUSOLVER_STATUS_SUCCESS == status);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    cudaStat1 = cudaMalloc((<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">void</span>**)&amp;d_work , <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*lwork);
    assert(cudaSuccess == cudaStat1);

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* step 4: compute SVD */</span>
    status = cusolverDnSgesvdaStridedBatched(
        cusolverH,
        jobz, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* CUSOLVER_EIG_MODE_NOVECTOR: compute singular values only */</span>
              <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* CUSOLVER_EIG_MODE_VECTOR: compute singular value and singular vectors */</span>
        rank, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of singular values */</span>
        m,    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* nubmer of rows of Aj, 0 &lt;= m */</span>
        n,    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of columns of Aj, 0 &lt;= n  */</span>
        d_A,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Aj is m-by-n */</span>
        lda,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of Aj */</span>
        strideA, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* &gt;= lda*n */</span>
        d_S,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Sj is rank-by-1 */</span>
                 <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* the singular values in descending order */</span>
        strideS, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* &gt;= rank */</span>
        d_U,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Uj is m-by-rank */</span>
        ldu,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of Uj, ldu &gt;= max(1,m) */</span>
        strideU, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* &gt;= ldu*rank */</span>
        d_V,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* Vj is n-by-rank */</span>
        ldv,     <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* leading dimension of Vj, ldv &gt;= max(1,n) */</span>
        strideV, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* &gt;= ldv*rank */</span>
        d_work,
        lwork,
        d_info,
        RnrmF,
        batchSize <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/* number of matrices */</span>
    );
    cudaStat1 = cudaDeviceSynchronize();
    assert(CUSOLVER_STATUS_SUCCESS == status);
    assert(cudaSuccess == cudaStat1);

    cudaStat1 = cudaMemcpy(U, d_U, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*strideU*batchSize, cudaMemcpyDeviceToHost);
    cudaStat2 = cudaMemcpy(V, d_V, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*strideV*batchSize, cudaMemcpyDeviceToHost);
    cudaStat3 = cudaMemcpy(S, d_S, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span>)*strideS*batchSize, cudaMemcpyDeviceToHost);
    cudaStat4 = cudaMemcpy(info, d_info, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">sizeof</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span>)*batchSize, cudaMemcpyDeviceToHost);
    cudaStat5 = cudaDeviceSynchronize();
    assert(cudaSuccess == cudaStat1);
    assert(cudaSuccess == cudaStat2);
    assert(cudaSuccess == cudaStat3);
    assert(cudaSuccess == cudaStat4);
    assert(cudaSuccess == cudaStat5);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 &gt; info[0] ){
        printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%d-th parameter is wrong \n"</span>, -info[0]);
        exit(1);
    }
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> idx = 0 ; idx &lt; batchSize; idx++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> ( 0 == info[idx] ){
            printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"%d-th matrix, gesvda converges \n"</span>, idx );
        }<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">else</span>{
           printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"WARNING: info[%d] = %d : gesvda does not converge \n"</span>, idx, info[idx] );
        }
    }

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"S = singular values (matlab base-1)\n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"U = left singular vectors (matlab base-1)\n"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V = right singular vectors (matlab base-1)\n\n"</span>);


</pre></div>
                        <div class="p">
                           ...
                           <pre xml:space="preserve"> 
    printMatrix(rank, 1, S, n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"S0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printMatrix(m, rank, U, ldu, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"U0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printMatrix(n, rank, V, ldv, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V0"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> ds_sup = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0; j &lt; n; j++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> err = fabs( S[j] - S_exact[j] );
        ds_sup = (ds_sup &gt; err)? ds_sup : err;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|S0 - S0_exact|_sup = %E \n"</span>, ds_sup);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"residual |A0 - U0*S0*V0**H|_F = %E \n"</span>, RnrmF[0] );

    printMatrix(rank, 1, S + strideS, n, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"S1"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printMatrix(m, rank, U + strideU, ldu, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"U1"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    printMatrix(n, rank, V + strideV, ldv, <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"V1"</span>);
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"=====\n"</span>);

    ds_sup = 0;
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">for</span>(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">int</span> j = 0; j &lt; n; j++){
        <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">float</span> err = fabs( S[strideS + j] - S_exact[strideS + j] );
        ds_sup = (ds_sup &gt; err)? ds_sup : err;
    }
    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"|S1 - S1_exact|_sup = %E \n"</span>, ds_sup);

    printf(<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-string">"residual |A1 - U1*S1*V1**H|_F = %E \n"</span>, RnrmF[1] );

<span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-comment">/*  free resources  */</span>
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_A    ) cudaFree(d_A);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_S    ) cudaFree(d_S);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_U    ) cudaFree(d_U);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_V    ) cudaFree(d_V);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_info ) cudaFree(d_info);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (d_work ) cudaFree(d_work);

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (cusolverH) cusolverDnDestroy(cusolverH);
    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">if</span> (stream   ) cudaStreamDestroy(stream);

    cudaDeviceReset();

    <span xmlns:xslthl="http://xslthl.sf.net" class="xslthl-keyword">return</span> 0;
}


</pre></div>
                     </div>
                  </div>
               </div>
               <div class="topic concept nested0" id="appendix-acknowledgements"><a name="appendix-acknowledgements" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#appendix-acknowledgements" name="appendix-acknowledgements" shape="rect">Acknowledgements</a></h2>
                  <div class="body conbody">
                     <p class="p">
                        NVIDIA would like to thank the following individuals and
                        institutions for their contributions:
                        
                     </p>
                     <ul class="ul">
                        <li class="li">
                           CPU LAPACK routines from netlib, CLAPACK-3.2.1 (http://www.netlib.org/clapack/)
                           
                        </li>
                     </ul>
                     <p class="p">
                        The following is license of CLAPACK-3.2.1.
                        
                     </p>
                     <p class="p">
                        Copyright (c) 1992-2008 The University of Tennessee.  All rights reserved.
                        
                     </p>
                     <p class="p">
                        Redistribution and use in source and binary forms, with or without
                        modification, are permitted provided that the following conditions are
                        met:
                        
                     </p>
                     <p class="p">
                        - Redistributions of source code must retain the above copyright
                        notice, this list of conditions and the following disclaimer.
                        
                     </p>
                     <p class="p">
                        - Redistributions in binary form must reproduce the above copyright
                        notice, this list of conditions and the following disclaimer listed
                        in this license in the documentation and/or other materials
                        provided with the distribution.
                        
                     </p>
                     <p class="p">
                        - Neither the name of the copyright holders nor the names of its
                        contributors may be used to endorse or promote products derived from
                        this software without specific prior written permission.
                        
                     </p>
                     <p class="p">
                        THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
                        "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
                        LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
                        A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
                        OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
                        SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
                        LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
                        DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
                        THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
                        (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
                        OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
                        
                     </p>
                     <ul class="ul">
                        <li class="li">
                           METIS-5.1.0 (http://glaros.dtc.umn.edu/gkhome/metis/metis/overview)
                           
                        </li>
                     </ul>
                     <p class="p">
                        The following is license of METIS (Apache 2.0 license).
                        
                     </p>
                     <p class="p">
                        Copyright 1995-2013, Regents of the University of Minnesota
                        
                     </p>
                     <p class="p">
                        Licensed under the Apache License, Version 2.0 (the "License");
                        you may not use this file except in compliance with the License.
                        You may obtain a copy of the License at
                        
                     </p>
                     <p class="p">
                        http://www.apache.org/licenses/LICENSE-2.0
                        
                     </p>
                     <p class="p">
                        Unless required by applicable law or agreed to in writing, software
                        distributed under the License is distributed on an "AS IS" BASIS,
                        WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
                        implied. See the License for the specific language governing
                        permissions and limitations under the License.
                        
                     </p>
                     <ul class="ul">
                        <li class="li">
                           QD (A C++/fortran-90 double-double and quad-double package) (http://crd-legacy.lbl.gov/~dhbailey/mpdist/)
                           
                        </li>
                     </ul>
                     <p class="p">
                        The following is license of QD (modified BSD license).
                        
                     </p>
                     <p class="p">
                        Copyright (c) 2003-2009, The Regents of the University of California,
                        through Lawrence Berkeley National Laboratory (subject to receipt of
                        any required approvals from U.S. Dept. of Energy) All rights reserved.
                        
                     </p>
                     <p class="p">
                        1. Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following
                        conditions are met:
                        
                     </p>
                     <p class="p">
                        (1) Redistributions of source code must retain the copyright notice, this list of conditions and the following disclaimer.
                        
                     </p>
                     <p class="p">
                        (2) Redistributions in binary form must reproduce the copyright notice, this list of conditions and the following disclaimer
                        in the documentation and/or other materials provided with the distribution.
                        
                     </p>
                     <p class="p">
                        (3) Neither the name of the University of California, Lawrence Berkeley National Laboratory, U.S. Dept. of Energy nor the
                        names of its contributors may be used to endorse or promote products derived from this software without specific prior written
                        permission.
                        
                     </p>
                     <p class="p">
                        2. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING,
                        BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
                        SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
                        DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
                        INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
                        OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
                        
                     </p>
                     <p class="p">
                        3. You are under no obligation whatsoever to provide any bug fixes, patches, or upgrades to the features, functionality or
                        performance of the source code ("Enhancements") to anyone; however, if you choose to make your Enhancements available either
                        publicly, or directly to Lawrence Berkeley National Laboratory, without imposing a separate written license agreement for
                        such Enhancements, then you hereby grant the following license: a non-exclusive, royalty-free perpetual license to install,
                        use, modify, prepare derivative works, incorporate into other computer software, distribute, and sublicense such enhancements
                        or derivative works thereof, in binary and source code form.
                        
                     </p>
                  </div>
               </div>
               <div class="topic concept nested0" id="bibliography"><a name="bibliography" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#bibliography" name="bibliography" shape="rect">I.&nbsp;Bibliography</a></h2>
                  <div class="body conbody">
                     <p class="p">
                        [1] Timothy A. Davis, Direct Methods for sparse Linear Systems, siam 2006.
                        
                     </p>
                     <p class="p">
                        [2] E. Chuthill and J. McKee, reducing the bandwidth of sparse symmetric matrices,  
                        ACM '69 Proceedings of the 1969 24th national conference, Pages 157-172. 
                        
                     </p>
                     <p class="p">
                        [3] Alan George, Joseph W. H. Liu, An Implementation of a Pseudoperipheral
                        Node Finder,
                        ACM Transactions on Mathematical Software (TOMS) Volume 5 Issue 3, Sept. 1979 
                        Pages 284-295.
                        
                     </p>
                     <p class="p">
                        [4] J. R. Gilbert and T. Peierls, Sparse partial pivoting in time proportional to 
                        arithmetic operations, SIAM J. Sci. Statist. Comput., 9 (1988), pp. 862-874.
                        
                     </p>
                     <p class="p">
                        [5] Alan George and Esmond Ng,
                        An Implementation of Gaussian Elimination with Partial Pivoting for Sparse Systems,
                        SIAM J. Sci. and Stat. Comput., 6(2), 390-409.
                        
                     </p>
                     <p class="p">
                        [6] Alan George and Esmond Ng,
                        Symbolic Factorization for Sparse Gaussian Elimination with Paritial Pivoting,
                        SIAM J. Sci. and Stat. Comput., 8(6), 877-898.
                        
                     </p>
                     <p class="p">
                        [7] John R. Gilbert, Xiaoye S. Li, Esmond G. Ng, Barry W. Peyton,
                        Computing Row and Column Counts for Sparse QR and LU Factorization,
                        BIT 2001, Vol. 41, No. 4, pp. 693-711.  
                        
                     </p>
                     <p class="p">
                        [8] Patrick R. Amestoy, Timothy A. Davis, Iain S. Duff,
                        An Approximate Minimum Degree Ordering Algorithm, 
                        SIAM J. Matrix Analysis Applic. Vol 17, no 4, pp. 886-905, Dec. 1996.
                        
                     </p>
                     <p class="p">
                        [9] Alan George, Joseph W. Liu, A Fast Implementation of the Minimum Degree Algorithm 
                        Using Quotient Graphs, ACM Transactions on Mathematical Software, Vol 6, No. 3, September 1980, page 337-358.
                        
                     </p>
                     <p class="p">
                        [10] Alan George, Joseph W. Liu, Computer Solution of Large Sparse Positive Definite Systems, 
                        Englewood Cliffs, New Jersey: Prentice-Hall, 1981.
                        
                     </p>
                     <p class="p">
                        [11] Iain S. Duff, ALGORITHM 575 Permutations for a Zero-Free Diagonal,
                        ACM Transactions on Mathematical Software, Vol 7, No 3, September 1981, Page 387-390
                        
                     </p>
                     <p class="p">
                        [12] Iain S. Duff and Jacko Koster, On algorithms for permuting large entries to the 
                        diagonal of a sparse matrix, SIAM Journal on Matrix Analysis and Applications, 
                        2001, Vol. 22, No. 4  : pp. 973-996  
                        
                     </p>
                     <p class="p">
                        [13] "A Fast and Highly Quality Multilevel Scheme for Partitioning Irregular Graphs". George Karypis and Vipin Kumar. SIAM
                        Journal on Scientific Computing, Vol. 20, No. 1, pp. 359-392, 1999. 
                        
                     </p>
                  </div>
               </div>
               <div class="topic concept nested0" id="notices-header"><a name="notices-header" shape="rect">
                     <!-- --></a><h2 class="title topictitle1"><a href="#notices-header" name="notices-header" shape="rect">Notices</a></h2>
                  <div class="topic reference nested1" id="notice"><a name="notice" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#notice" name="notice" shape="rect"></a></h3>
                     <div class="body refbody">
                        <div class="section">
                           <h3 class="title sectiontitle">Notice</h3>
                           <p class="p">ALL NVIDIA DESIGN SPECIFICATIONS, REFERENCE BOARDS, FILES, DRAWINGS, DIAGNOSTICS, LISTS, AND OTHER DOCUMENTS (TOGETHER AND
                              SEPARATELY, "MATERIALS") ARE BEING PROVIDED "AS IS." NVIDIA MAKES NO WARRANTIES, EXPRESSED, IMPLIED, STATUTORY, OR OTHERWISE
                              WITH RESPECT TO THE MATERIALS, AND EXPRESSLY DISCLAIMS ALL IMPLIED WARRANTIES OF NONINFRINGEMENT, MERCHANTABILITY, AND FITNESS
                              FOR A PARTICULAR PURPOSE. 
                           </p>
                           <p class="p">Information furnished is believed to be accurate and reliable. However, NVIDIA Corporation assumes no responsibility for the
                              consequences of use of such information or for any infringement of patents or other rights of third parties that may result
                              from its use. No license is granted by implication of otherwise under any patent rights of NVIDIA Corporation. Specifications
                              mentioned in this publication are subject to change without notice. This publication supersedes and replaces all other information
                              previously supplied. NVIDIA Corporation products are not authorized as critical components in life support devices or systems
                              without express written approval of NVIDIA Corporation.
                           </p>
                        </div>
                     </div>
                  </div>
                  <div class="topic reference nested1" id="trademarks"><a name="trademarks" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#trademarks" name="trademarks" shape="rect"></a></h3>
                     <div class="body refbody">
                        <div class="section">
                           <h3 class="title sectiontitle">Trademarks</h3>
                           <p class="p">NVIDIA and the NVIDIA logo are trademarks or registered trademarks of NVIDIA Corporation
                              in the U.S. and other countries.  Other company and product names may be trademarks of
                              the respective companies with which they are associated.
                           </p>
                        </div>
                     </div>
                  </div>
                  <div class="topic reference nested1" id="copyright-past-to-present"><a name="copyright-past-to-present" shape="rect">
                        <!-- --></a><h3 class="title topictitle2"><a href="#copyright-past-to-present" name="copyright-past-to-present" shape="rect"></a></h3>
                     <div class="body refbody">
                        <div class="section">
                           <h3 class="title sectiontitle">Copyright</h3>
                           <p class="p">© <span class="ph">2014</span>-<span class="ph">2019</span> NVIDIA
                              Corporation. All rights reserved.
                           </p>
                           <p class="p">This product includes software developed by the Syncro Soft SRL (http://www.sync.ro/).</p>
                        </div>
                     </div>
                  </div>
               </div>
               
               <hr id="contents-end"></hr>
               
            </article>
         </div>
      </div>
      <script language="JavaScript" type="text/javascript" charset="utf-8" src="../common/formatting/common.min.js"></script>
      <script language="JavaScript" type="text/javascript" charset="utf-8" src="../common/scripts/google-analytics/google-analytics-write.js"></script>
      <script language="JavaScript" type="text/javascript" charset="utf-8" src="../common/scripts/google-analytics/google-analytics-tracker.js"></script>
      <script type="text/javascript">var switchTo5x=true;</script><script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script><script type="text/javascript">stLight.options({publisher: "998dc202-a267-4d8e-bce9-14debadb8d92", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script><script type="text/javascript">_satellite.pageBottom();</script></body>
</html>